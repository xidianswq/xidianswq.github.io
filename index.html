<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%A6%82%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:30" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%A1%86%E6%9E%B6">一.项目管理框架</a></p>
<p><a href="about:blank#1.%E4%B8%80%E4%BA%9B%E6%B5%81%E8%A1%8C%E7%9A%84%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E5%92%8C%E6%8A%80%E6%9C%AF">1.一些流行的时间管理工具和技术</a></p>
<p><a href="about:blank#2.%E9%A1%B9%E7%9B%AE%E7%AB%A0%E7%A8%8B">2.项目章程</a></p>
<p><a href="about:blank#3.%E8%8C%83%E5%9B%B4%E8%AF%B4%E6%98%8E%E4%B9%A6">3.范围说明书</a></p>
<p><a href="about:blank#4.%E5%B7%A5%E4%BD%9C%E5%88%86%E8%A7%A3%E7%BB%93%E6%9E%84">4.工作分解结构</a></p>
<p><a href="about:blank#5.%E4%B8%80%E4%BA%9B%E5%B9%BF%E6%B3%9B%E4%BD%BF%E7%94%A8%EF%BC%8C%E8%A2%AB%E5%8F%91%E7%8E%B0%E5%8F%AF%E4%BB%A5%E4%BF%83%E8%BF%9B%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%B1%95%E7%9A%84%E9%87%8D%E8%A6%81%E5%B7%A5%E5%85%B7">5.一些广泛使用，被发现可以促进项目开展的重要工具</a></p>
<p><a href="about:blank#6.%E9%A1%B9%E7%9B%AE%E4%BA%A4%E4%BB%98%E8%83%BD%E5%8A%9B%E5%87%BA%E8%89%B2%E7%9A%84%E5%85%AC%E5%8F%B8%E7%9A%84%E5%9B%9B%E4%B8%AA%E9%87%8D%E8%A6%81%E7%9A%84%E5%AE%9E%E8%B7%B5%E8%A6%81%E7%B4%A0">6.项目交付能力出色的公司的四个重要的实践要素</a></p>
<p><a href="about:blank#7.%E9%A1%B9%E7%9B%AE%E7%BB%8F%E7%90%86%E6%89%80%E9%9C%80%E7%9F%A5%E8%AF%86">7.项目经理所需知识</a></p>
<p><a href="about:blank#8.%E9%A1%B9%E7%9B%AE%E5%9B%A2%E9%98%9F%E7%BB%8F%E7%90%86%E9%98%B6%E6%AE%B5">8.项目团队经理阶段</a></p>
<p><a href="about:blank#%E4%BA%8C.%E9%A1%B9%E7%9B%AE%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E7%AE%A1%E7%90%86%E8%BF%87%E7%A8%8B%E7%BB%84">二.项目生命周期和管理过程组</a></p>
<p><a href="about:blank#1.%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%9A%84%E7%B3%BB%E7%BB%9F%E8%A7%82%E4%BB%A5%E5%8F%8A%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E7%9A%84%E4%B8%89%E7%90%83%E6%A8%A1%E5%9E%8B">1.项目管理的系统观以及系统管理的三球模型</a></p>
<p><a href="about:blank#2.%E9%A2%84%E6%B5%8B%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%A8%A1%E5%9E%8B">2.预测生命周期和自适应软件开发生命周期模型</a></p>
<p><a href="about:blank#3.IT%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E6%9C%80%E6%96%B0%E8%B6%8B%E5%8A%BF%EF%BC%9A">3.IT项目管理最新趋势：</a></p>
<p><a href="about:blank#4.%E6%95%8F%E6%8D%B7%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86">4.敏捷项目管理</a></p>
<p><a href="about:blank#5.%E9%A1%B9%E7%9B%AE%E4%B8%9A%E5%8A%A1%E8%BF%87%E7%A8%8B%E5%92%8C%E7%AE%A1%E7%90%86%E8%BF%87%E7%A8%8B">5.项目业务过程和管理过程</a></p>
<p><a href="about:blank#%3C1%3E%E8%B5%B7%E8%8D%89%E9%A1%B9%E7%9B%AE%E7%AB%A0%E7%A8%8B%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0">&lt;1&gt;起草项目章程​编辑
</a></p>
<p><a href="about:blank#%3C2%3E%E5%BC%80%E9%A1%B9%E7%9B%AE%E5%90%AF%E5%8A%A8%E4%BC%9A%E8%AE%AE%C2%A0">&lt;2&gt;开项目启动会议
</a></p>
<p><a href="about:blank#%3C3%3E%E5%85%B6%E4%BB%96">&lt;3&gt;其他</a></p>
<p><a href="about:blank#%E4%B8%89.%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5">三.项目实践</a></p>
<p><a href="about:blank#%C2%A0%E4%B8%89.%E5%85%B6%E4%BB%96">四.其他</a></p>
<hr>
<h2 id="一-项目管理框架"><a href="#一-项目管理框架" class="headerlink" title="一.项目管理框架"></a>一.项目管理框架</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/7d6561e507e27384e79a36ac6d5a8acb.png"></p>
<h3 id="1-一些流行的时间管理工具和技术"><a href="#1-一些流行的时间管理工具和技术" class="headerlink" title="1.一些流行的时间管理工具和技术"></a><strong>1.一些流行的时间管理工具和技术</strong></h3><p>◦ 项目章程, 范围说明书, 以及工作分解结构 (范围)</p>
<p>◦ 甘特图, 项目网络图, 关键路径分析, 关键链排程 (时间)</p>
<p>◦ 成本估算和挣值管理 (成本)</p>
<h3 id="2-项目章程"><a href="#2-项目章程" class="headerlink" title="2.项目章程"></a><strong>2.项目章程</strong></h3><p>◦ 编写一份<strong><strong>正式批准项目</strong></strong> 并授权项目经理在项目活动中使用组织资源的文件的过程。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b6e40deeb4c39947d46f1e5e21e22db7.png"></p>
<h3 id="3-范围说明书"><a href="#3-范围说明书" class="headerlink" title="3.范围说明书"></a><strong>3.范围说明书</strong></h3><h3 id="4-工作分解结构"><a href="#4-工作分解结构" class="headerlink" title="4.工作分解结构"></a><strong>4.工作分解结构</strong></h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/bb3053d170916cfedd694bb9272efd5d.png"></p>
<h3 id="5-一些广泛使用，被发现可以促进项目开展的重要工具"><a href="#5-一些广泛使用，被发现可以促进项目开展的重要工具" class="headerlink" title="5.一些广泛使用，被发现可以促进项目开展的重要工具"></a>5.<strong>一些广泛使用，被发现可以促进项目开展的重要工具</strong></h3><p>◦ 进程报告</p>
<p>◦ 开工会议</p>
<p>◦ 甘特图</p>
<p>◦ 变更请求</p>
<h3 id="6-项目交付能力出色的公司的四个重要的实践要素"><a href="#6-项目交付能力出色的公司的四个重要的实践要素" class="headerlink" title="6.项目交付能力出色的公司的四个重要的实践要素"></a>6.<strong>项目交付能力出色的公司的四个重要的实践要素</strong></h3><p>◦ 使用集成工具箱 (使用标准&#x2F;高级项目管理工具， 大量的模板)</p>
<p>◦ 培养项目领导人, 尤其是商业技巧和软件技术</p>
<p>◦ 开发一个流线型的项目交付过程</p>
<p>◦ 对项目的健康度进行量化（例如，客户满意度和投 资回报等）</p>
<h3 id="7-项目经理所需知识"><a href="#7-项目经理所需知识" class="headerlink" title="7.项目经理所需知识"></a>7.项目经理所需知识</h3><p>} 项目管理知识体系</p>
<p>} 应用领域的知识、标准和规则</p>
<p>} 项目环境知识</p>
<p>} 通用管理知识和技能</p>
<p>} 软技能或人际关系能力</p>
<pre><code>    1\. 人际关系技能

    2\. 领导能力

    3\. 倾听能力

    4\. 正直、行为道德、坚定

    5\. 善于建立信任关系

    6\. 口头沟通

    7\. 善于创建团队

    8\. 解决冲突、冲突管理

    9\. 批判式思考、解决问题

    10\. 理解、权衡优先
</code></pre>
<p>不同种类项目所需能力：</p>
<p>} 大型项目：领导力、相关经历、计划、人际关系技能、 口头沟通和团队建设技能是最重要的。</p>
<p>} 高不确定性项目: 风险管理、期望管理、领导力、人 际关系技能和计划能力是最重要的。</p>
<p>} 非常新颖项目：领导力、人际关系技能、有远见和目 标、自信、期望管理和倾听技能是最重要的</p>
<h3 id="8-项目团队经理阶段"><a href="#8-项目团队经理阶段" class="headerlink" title="8.项目团队经理阶段"></a><strong>8.项目团队经理阶段</strong></h3><p>组建期、激荡期、规范期、执行期和休整期</p>
<p>PMI 提供项目管理师 (PMP)认证</p>
<h2 id="二-项目生命周期和管理过程组"><a href="#二-项目生命周期和管理过程组" class="headerlink" title="二.项目生命周期和管理过程组"></a><strong><strong>二.项目生命周期和管理过程组</strong></strong></h2><h3 id="1-项目管理的系统观以及系统管理的三球模型"><a href="#1-项目管理的系统观以及系统管理的三球模型" class="headerlink" title="1.项目管理的系统观以及系统管理的三球模型"></a>1.项目管理的系统观以及系统管理的三球模型</h3><p>} 不能孤立地执行项目</p>
<p>} 必须在广阔的组织环境中运作</p>
<p>} 项目经理也不能孤立地领导项目，需要使用系统 思维、整体的观点，理解项目的组织环境</p>
<p>◦ 在组织情境内采用整体观点来实施项目</p>
<p>◦ 高级管理人员必须确保项目持续支持当前的业务需求</p>
<h3 id="2-预测生命周期和自适应软件开发生命周期模型"><a href="#2-预测生命周期和自适应软件开发生命周期模型" class="headerlink" title="2.预测生命周期和自适应软件开发生命周期模型"></a>2.预测生命周期和自适应软件开发生命周期模型</h3><p>◦ 项目阶段 ：传统项目管理存在一些基本阶段：概念、开发、实施和收 尾阶段。</p>
<p>◦ 这些阶段不能与今后提到的项目管理过程组的启动、计划、 执行、监控、收尾相混淆。</p>
<p>} 项目生命周期 是一系列项目阶段的集合</p>
<p>◦ 在每个阶段中要进行的工作</p>
<p>◦ 什么时候给出什么样的可交付成果</p>
<p>◦ 每个阶段涉及的人员和时间</p>
<p>◦ 管理层将如何控制和验证每个阶段产生的工作</p>
<p>} 一个 可交付成果 是作为项目的一部分生产或提供 的产品或服务。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8e6a54b386d3f4b133d946789a016a0d.png"></p>
<p> } 瀑布式生命周期模型: 定义了良好的线性系统分析、 设计、编码、测试和维护的阶段。</p>
<p>} 原型生命周期模型: 用于开发软件原型来阐明用户 操作软件的需求。</p>
<p>} 渐增式构建生命周期模型: 提供了对操作软件累进 的开发。</p>
<p>} 螺旋式生命周期模型: 显示了多数软件是使用迭代 或者螺旋方法而不是线性方法开发出来的。 } 快速应用开发(RAD)生命周期模型: 用于在不牺牲<br>质量的前提下快速开发项目。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8df9890e84386a023ed31d1c7949d1f4.png"></p>
<h3 id="3-IT项目管理最新趋势："><a href="#3-IT项目管理最新趋势：" class="headerlink" title="3.IT项目管理最新趋势："></a>3.IT项目管理最新趋势：</h3><p><strong>全球化</strong></p>
<p>◦ 问题——沟通、信任、工作方式、工具</p>
<p>◦ 建议——项目规范、全球化与本地化、合作、新技术等</p>
<p><strong>外包</strong> ：从外部寻找来源以获得需要的产品和服务。</p>
<p>虚拟团队: 运用通信技术实现跨时间和跨地域工 作的个人组成的团队。</p>
<h3 id="4-敏捷项目管理"><a href="#4-敏捷项目管理" class="headerlink" title="4.敏捷项目管理"></a>4.敏捷项目管理</h3><p>敏捷宣言：</p>
<p>◦ 个体和交互 重于 过程和工具</p>
<p>◦ 可运行的软件 重于 面面俱到的文档</p>
<p>◦ 客户合作 重于 合同谈判</p>
<p>◦ 响应变化 重于 遵循计划</p>
<h3 id="5-项目业务过程和管理过程"><a href="#5-项目业务过程和管理过程" class="headerlink" title="5.项目业务过程和管理过程"></a>5.项目业务过程和管理过程</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/a293d6846a5fc6174773cfe4d2d21824.png"></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&lt;1&gt;起草项目章程<img src="https://i-blog.csdnimg.cn/blog_migrate/23428b81336d7764ceef3d263a46b820.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a9a191e6eb24a199568ffd4c1c83bf5c.png"></p>
<h4 id="开项目启动会议"><a href="#开项目启动会议" class="headerlink" title="&lt;2&gt;开项目启动会议"></a>&lt;2&gt;开项目启动会议</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/44f91820f373f7b555aa503d8bfd6232.png"></p>
<h4 id="其他"><a href="#其他" class="headerlink" title="&lt;3&gt;其他"></a>&lt;3&gt;其他</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/b5081537ca94bfe3852addd9a2661845.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/156f32c4a921fc7addcce0b3e179376e.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6c1d2a14497ac2dddb0faa40d2bf4c4d.png"><br><img src="https://i-blog.csdnimg.cn/blog_migrate/090816d0caa2f7c0ea69492a9e497bc7.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/66c4ba44817c651e2cb865aabd3dcfd3.png"></p>
<h2 id="三-项目实践"><a href="#三-项目实践" class="headerlink" title="三.项目实践"></a>三.项目实践</h2><p>见资源绑定部分，作者描述了曾经的一个项目进行规范化后的流程。</p>
<h2 id="四-其他"><a href="#四-其他" class="headerlink" title="四.其他"></a>四.其他</h2><p>项目总监—项目经理—— 项目主管—项目助理<br>产品总监—产品经理—产品助理—产品实习生<br>技术总监—技术经理—研发经理—技术主管—架构师</p>
<p>PDCA（plan ，do，check，action）<br>愿景-&gt;甲方（利益相关方、领导、客户）-&gt;产品经理-——（理解需求，记录）——&gt;开发团队<br>沟通：快速、高效、记录</p>
<p>产品负责人-&gt;做什么<br>开发团队-&gt;怎么做<br>项目经理（敏捷教练）-&gt;怎么快速交付</p>
<p>敏捷监控-&gt;判断敏捷项目状态（VT图【功能-时间图，最乐观、悲观两条直线，项目在这两条直线之间】）-&gt;提供方案</p>
<p><strong>相关资料及了解：</strong></p>
<p><a target="_blank" rel="noopener" href="https://download.csdn.net/download/qq_32971095/88226711" title="西安电子科技大学工程概论相关资料资源">西安电子科技大学工程概论相关资料资源<img src="https://i-blog.csdnimg.cn/blog_migrate/003a2ce7eb50c2e24a8c624c260c5930.png" alt="icon-
default.png?t&#x3D;N7T8">https://download.csdn.net/download/qq_32971095&#x2F;88226711</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wypblog/article/details/108701343?spm=1001.2014.3001.5506&ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMyOTcxMDk1P3R5cGU9Y29sbGVjdA==" title="互联网大厂的薪资和职级一览">互联网大厂的薪资和职级一览<img src="https://i-blog.csdnimg.cn/blog_migrate/003a2ce7eb50c2e24a8c624c260c5930.png" alt="icon-
default.png?t&#x3D;N7T8">https://blog.csdn.net/wypblog/article/details/108701343?spm=1001.2014.3001.5506&amp;ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMyOTcxMDk1P3R5cGU9Y29sbGVjdA%3D%3D</a><a target="_blank" rel="noopener" href="https://blog.csdn.net/Albert_weiku/article/details/123089529?spm=1001.2014.3001.5506" title="一个大厂的项目组织架构学习">一个大厂的项目组织架构学习<img src="https://i-blog.csdnimg.cn/blog_migrate/003a2ce7eb50c2e24a8c624c260c5930.png" alt="icon-
default.png?t&#x3D;N7T8">https://blog.csdn.net/Albert_weiku&#x2F;article&#x2F;details&#x2F;123089529?spm&#x3D;1001.2014.3001.5506</a><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhtchina/article/details/112859450?spm=1001.2014.3001.5506" title="大厂人才结构">大厂人才结构<img src="https://i-blog.csdnimg.cn/blog_migrate/003a2ce7eb50c2e24a8c624c260c5930.png" alt="icon-
default.png?t&#x3D;N7T8">https://blog.csdn.net/xhtchina/article/details/112859450?spm=1001.2014.3001.5506</a></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/132343604">https://blog.csdn.net/qq_32971095/article/details/132343604</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%BD%9C%E4%B8%9A%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%BD%9C%E4%B8%9A%E5%90%88%E9%9B%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:30:37" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>34k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>30 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.VHDL%E8%AE%BE%E8%AE%A1%E4%BD%9C%E4%B8%9A">一.VHDL设计作业</a></p>
<p><a href="about:blank#1.%E5%9F%BA%E4%BA%8E%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80%E7%9A%843-8%E8%AF%91%E7%A0%81%E5%99%A8%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1">1.基于硬件描述语言的3-8译码器逻辑电路设计</a></p>
<p><a href="about:blank#2.8%E4%BD%8D%E5%8F%8C%E5%90%91%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8%E8%AE%BE%E8%AE%A1">2.8位双向移位寄存器设计</a></p>
<p><a href="about:blank#3.%E5%9F%BA%E4%BA%8E%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA%E7%9A%84%E8%87%AA%E5%8A%A9%E5%94%AE%E7%A5%A8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1">3.基于有限状态机的自助售票系统设计</a></p>
<p><a href="about:blank#4.%E6%8C%89%E9%94%AE%E6%B6%88%E6%8A%96%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1">4.按键消抖电路设计</a></p>
<p><a href="about:blank#5.%E5%90%8C%E6%AD%A5%E7%8E%AF%E5%BD%A2FIFO%E8%AE%BE%E8%AE%A1">5.同步环形FIFO设计</a></p>
<p><a href="about:blank#6.%E7%BA%BF%E4%B8%8A%E5%AE%9E%E9%AA%8C%E2%80%94%E2%80%94%E6%97%B6%E9%92%9F%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1">6.线上实验——时钟模块设计</a></p>
<p><a href="about:blank#7.%E7%BA%BF%E4%B8%8A%E5%AE%9E%E9%AA%8C%E2%80%94%E2%80%94%E5%8E%9F%E7%A0%81%E4%BA%8C%E4%BD%8D%E4%B9%98%E6%B3%95%E5%99%A8%E8%AE%BE%E8%AE%A1%C2%A0">7.线上实验——原码二位乘法器设计
</a></p>
<p><a href="about:blank#8.%E7%BA%BF%E4%B8%8A%E5%AE%9E%E9%AA%8C%E2%80%94%E2%80%94%E5%B8%83%E6%96%AF%E4%B9%98%E6%B3%95%E5%99%A8%E8%AE%BE%E8%AE%A1">8.线上实验——布斯乘法器设计</a></p>
<hr>
<h2 id="一-VHDL设计作业"><a href="#一-VHDL设计作业" class="headerlink" title="一.VHDL设计作业"></a>一.VHDL设计作业</h2><p>源文件、测试文件及仿真结果</p>
<h3 id="1-基于硬件描述语言的3-8译码器逻辑电路设计"><a href="#1-基于硬件描述语言的3-8译码器逻辑电路设计" class="headerlink" title="1.基于硬件描述语言的3-8译码器逻辑电路设计"></a>1.基于硬件描述语言的3-8译码器逻辑电路设计</h3><p>根据3-8译码器基本原理，采用硬件描述语言设计一个3-8译码器逻辑电路，并给出仿真结果。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity decoder3_8 is
    Port (  
        OE: in std_logic;
        X: in std_logic_vector(2 downto 0);
        Y: out std_logic_vector(7 downto 0)
    );
end decoder3_8;

architecture Behavioral of decoder3_8 is
begin
process(OE,X)
begin
    if OE=&#39;0&#39; then Y&lt;=&quot;00000000&quot;;
    elsif OE=&#39;1&#39;then
        Case X is
            When &quot;000&quot; =&gt;Y&lt;=&quot;11111110&quot;;
            When &quot;001&quot; =&gt;Y&lt;=&quot;11111101&quot;;
            When &quot;010&quot; =&gt;Y&lt;=&quot;11111011&quot;;
            When &quot;011&quot; =&gt;Y&lt;=&quot;11110111&quot;;
            When &quot;100&quot; =&gt;Y&lt;=&quot;11101111&quot;;
            When &quot;101&quot; =&gt;Y&lt;=&quot;11011111&quot;;
            When &quot;110&quot; =&gt;Y&lt;=&quot;10111111&quot;;
            When &quot;111&quot; =&gt;Y&lt;=&quot;01111111&quot;;
            When others =&gt;Y&lt;=&quot;11111111&quot;;
        END CASE;    
   end if;
end process;
end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity decoder3_8_tb is
--  Port ( );
end decoder3_8_tb;

architecture structural of decoder3_8_tb is
component decoder3_8
    port(
        OE: in std_logic;
        X: in std_logic_vector(2 downto 0);
        Y: out std_logic_vector(7 downto 0)
    );
end component;
signal oe:std_logic;
signal input:std_logic_vector(2 downto 0);
signal output:std_logic_vector(7 downto 0);
begin
d1:decoder3_8 port map(oe,input,output);

ensure:process
    begin
        oe&lt;=&#39;0&#39;;
        wait for 50ns;
        oe&lt;=&#39;1&#39;;
        wait;
end process;

sel:process
    begin
        input&lt;=&quot;000&quot;;
        wait for 20ns;
        input&lt;=&quot;001&quot;;
        wait for 20ns;
        input&lt;=&quot;010&quot;;
        wait for 20ns;
        input&lt;=&quot;011&quot;;
        wait for 20ns;
        input&lt;=&quot;100&quot;;
        wait for 20ns;
        input&lt;=&quot;101&quot;;
        wait for 20ns;
        input&lt;=&quot;110&quot;;
        wait for 20ns;
        input&lt;=&quot;111&quot;;
        wait for 20ns;
end process;
end structural;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2cdaef1463aa82317fd6029b8c7bb08e.png"></p>
<h3 id="2-8位双向移位寄存器设计"><a href="#2-8位双向移位寄存器设计" class="headerlink" title="2.8位双向移位寄存器设计"></a>2.8位双向移位寄存器设计</h3><p>采用硬件描述语言实现8位双向移位寄存器，其功能包括异步置零，同步置数，左移，右移和保持状态不变等5种功能。其中输入端口包括8位并行数据、两位的选择信号和两个1位串行数据，输出是8位并行数据。当RESET信号为低电平时，寄存器的输出被异步置零；否则当RESET&#x3D;1时，与时钟有关的四种功能由输入信号MODE决定。请给出仿真结果。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity shift_register is
    Port (
        clk,reset,left,right:in std_logic;
        mode:in std_logic_vector(1 downto 0);
        input_data:in std_logic_vector(7 downto 0);
        output_data:inout std_logic_vector(7 downto 0)
    );
end shift_register;

architecture Behavioral of shift_register is
begin
process(reset,clk,mode)

begin
    if (reset=&#39;0&#39;)then
        output_data&lt;=&quot;00000000&quot;;
    elsif(reset=&#39;1&#39;and clk=&#39;1&#39;)then
        case mode is
            when &quot;00&quot;=&gt;output_data&lt;=output_data;
            when &quot;01&quot;=&gt;output_data&lt;=input_data;
            when &quot;10&quot;=&gt;
                    output_data(0)&lt;=left;
                    output_data(7)&lt;=output_data(6);
                    output_data(6)&lt;=output_data(5);
                    output_data(5)&lt;=output_data(4);
                    output_data(4)&lt;=output_data(3);
                    output_data(3)&lt;=output_data(2);
                    output_data(2)&lt;=output_data(1);
                    output_data(1)&lt;=output_data(0);              
            when &quot;11&quot;=&gt;
                    output_data(0)&lt;=output_data(1);
                    output_data(1)&lt;=output_data(2);
                    output_data(2)&lt;=output_data(3);
                    output_data(3)&lt;=output_data(4);
                    output_data(4)&lt;=output_data(5);
                    output_data(5)&lt;=output_data(6);
                    output_data(6)&lt;=output_data(7);
                    output_data(7)&lt;=right;
            when others=&gt;output_data&lt;=output_data;
        end case;         
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity shift_register_tb is
--  Port ( );
end shift_register_tb;

architecture Behavioral of shift_register_tb is
component shift_register
port(
        clk,reset,left,right:in std_logic;
        mode:in std_logic_vector(1 downto 0);
        input_data:in std_logic_vector(7 downto 0);
        output_data:inout std_logic_vector(7 downto 0)   
);
end component;
signal clk,reset,left,right:std_logic;
signal mode:std_logic_vector(1 downto 0);
signal input_data:std_logic_vector(7 downto 0);
signal output_data:std_logic_vector(7 downto 0);   
begin
sr1:shift_register port map(clk,reset,left,right,mode,input_data,output_data);

clock_gen:process
    begin
        left&lt;=output_data(7);
        right&lt;=output_data(0);
        clk&lt;=&#39;0&#39;;
        wait for 10ns;
        clk&lt;=&#39;1&#39;;
        wait for 10ns;
end process;

reset_gen:process
    begin
        reset&lt;=&#39;0&#39;;
        wait for 25ns;
        reset&lt;=&#39;1&#39;;
        wait;
end process;

mode_test:process
    begin
        mode&lt;=&quot;00&quot;;
        wait for 30ns;
        mode&lt;=&quot;01&quot;;
        input_data&lt;=&quot;00001111&quot;;
        wait for 30ns;
        mode&lt;=&quot;10&quot;;
        wait for 200ns;
        mode&lt;=&quot;01&quot;;
        input_data&lt;=&quot;00001111&quot;;
        wait for 30ns;
        mode&lt;=&quot;11&quot;;
        wait for 200ns;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5dcfe13e83a9275011aae48f12d1be1c.png"></p>
<h3 id="3-基于有限状态机的自助售票系统设计"><a href="#3-基于有限状态机的自助售票系统设计" class="headerlink" title="3.基于有限状态机的自助售票系统设计"></a>3.基于有限状态机的自助售票系统设计</h3><p>某自助售票系统只能接收 5元和10元纸币，若一张票的价格设定为 25元。<br>请利用有限状态机设计该售票系统，<br>1. 首先给出状态说明，然后画出具体的状态图及说明状态转移关系。<br>2. 并完成硬件描述语言程序设计。</p>
<p>3.将第1和2题的答案做成word文档上传。</p>
<p>4.扩展要求（加分10分）：增加20元纸币输入。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity ticket_state_machine is
    Port (
        clk,reset:in std_logic;
        input_money:in std_logic_vector(2 downto 0);
        return_money:out std_logic_vector(2 downto 0);
        output_ticket:out std_logic
    );
end ticket_state_machine;

architecture Behavioral of ticket_state_machine is
type states is (m0,m5,m10,m15,m20,m25,m30,m35,m40);
signal current_state,next_state:states;
begin

start:process(reset,clk)
    begin
        if(reset=&#39;1&#39;)then
            current_state&lt;=m0;
        elsif(reset=&#39;0&#39;and clk=&#39;1&#39;and clk&#39;event)then
            current_state&lt;=next_state;
        end if;         
end process;

state_machine:process(current_state,input_money)
    begin
        case current_state is
            when m0=&gt;
                output_ticket&lt;=&#39;0&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m0;
                    when&quot;001&quot;=&gt;next_state&lt;=m5;
                    when&quot;010&quot;=&gt;next_state&lt;=m10;
                    when&quot;100&quot;=&gt;next_state&lt;=m20;
                    when others=&gt;next_state&lt;=current_state;
                end case;
            when m5=&gt;
                output_ticket&lt;=&#39;0&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m5;
                    when&quot;001&quot;=&gt;next_state&lt;=m10;
                    when&quot;010&quot;=&gt;next_state&lt;=m15;
                    when&quot;100&quot;=&gt;next_state&lt;=m25;
                    when others=&gt;next_state&lt;=current_state;
                end case;
            when m10=&gt;
                output_ticket&lt;=&#39;0&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m10;
                    when&quot;001&quot;=&gt;next_state&lt;=m15;
                    when&quot;010&quot;=&gt;next_state&lt;=m20;
                    when&quot;100&quot;=&gt;next_state&lt;=m30;
                    when others=&gt;next_state&lt;=current_state;
                end case; 
            when m15=&gt;
                output_ticket&lt;=&#39;0&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m15;
                    when&quot;001&quot;=&gt;next_state&lt;=m20;
                    when&quot;010&quot;=&gt;next_state&lt;=m25;
                    when&quot;100&quot;=&gt;next_state&lt;=m35;
                    when others=&gt;next_state&lt;=current_state;
                end case; 
            when m20=&gt;
                output_ticket&lt;=&#39;0&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m20;
                    when&quot;001&quot;=&gt;next_state&lt;=m25;
                    when&quot;010&quot;=&gt;next_state&lt;=m30;
                    when&quot;100&quot;=&gt;next_state&lt;=m40;
                    when others=&gt;next_state&lt;=current_state;
                end case; 
            when m25=&gt;
                output_ticket&lt;=&#39;1&#39;;
                return_money&lt;=&quot;000&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m0;
                    when&quot;001&quot;=&gt;next_state&lt;=m5;
                    when&quot;010&quot;=&gt;next_state&lt;=m10;
                    when&quot;100&quot;=&gt;next_state&lt;=m20;
                    when others=&gt;next_state&lt;=current_state;
                end case; 
            when m30=&gt;
                output_ticket&lt;=&#39;1&#39;;
                return_money&lt;=&quot;001&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m0;
                    when&quot;001&quot;=&gt;next_state&lt;=m5;
                    when&quot;010&quot;=&gt;next_state&lt;=m10;
                    when&quot;100&quot;=&gt;next_state&lt;=m20;
                    when others=&gt;next_state&lt;=current_state;
                end case;
             when m35=&gt;
                output_ticket&lt;=&#39;1&#39;;
                return_money&lt;=&quot;010&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m0;
                    when&quot;001&quot;=&gt;next_state&lt;=m5;
                    when&quot;010&quot;=&gt;next_state&lt;=m10;
                    when&quot;100&quot;=&gt;next_state&lt;=m20;
                    when others=&gt;next_state&lt;=current_state;
                end case;    
            when m40=&gt;
                output_ticket&lt;=&#39;1&#39;;
                return_money&lt;=&quot;011&quot;;
                case input_money is
                    when&quot;000&quot;=&gt;next_state&lt;=m0;
                    when&quot;001&quot;=&gt;next_state&lt;=m5;
                    when&quot;010&quot;=&gt;next_state&lt;=m10;
                    when&quot;100&quot;=&gt;next_state&lt;=m20;
                    when others=&gt;next_state&lt;=current_state;
                end case;    
        end case;             
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity ticket_state_machine_tb is
--  Port ( );
end ticket_state_machine_tb;

architecture Behavioral of ticket_state_machine_tb is
component ticket_state_machine
    Port (
        clk,reset:in std_logic;
        input_money:in std_logic_vector(2 downto 0);
        return_money:out std_logic_vector(2 downto 0);
        output_ticket:out std_logic
    );
end component;
signal clk,reset: std_logic;
signal input_money: std_logic_vector(2 downto 0);
signal return_money: std_logic_vector(2 downto 0);
signal output_ticket: std_logic;
begin
tsm:ticket_state_machine port map(clk,reset,input_money,return_money,output_ticket);

clock:process
    begin
        clk&lt;=&#39;0&#39;;
        wait for 10ns;
        clk&lt;=&#39;1&#39;;
        wait for 10ns;
end process;

start:process
    begin
        reset&lt;=&#39;1&#39;;
        wait for 20ns;
        reset&lt;=&#39;0&#39;;
        wait;
end process;

test:process
    begin
        wait for 50ns;
        input_money&lt;=&quot;001&quot;;
        wait for 20ns;
        input_money&lt;=&quot;000&quot;;
        wait for 50ns;
        input_money&lt;=&quot;010&quot;;
        wait for 20ns;
        input_money&lt;=&quot;000&quot;;
        wait for 50ns;
        input_money&lt;=&quot;100&quot;;
        wait for 20ns;
        input_money&lt;=&quot;000&quot;;
        wait for 50ns;
        input_money&lt;=&quot;010&quot;;
        wait for 20ns;
        input_money&lt;=&quot;000&quot;;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/711bd6d2672a650569b2474d89e3f38e.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/dfad20f27e654f243f373cfb9b80256c.png"></p>
<h3 id="4-按键消抖电路设计"><a href="#4-按键消抖电路设计" class="headerlink" title="4.按键消抖电路设计"></a>4.按键消抖电路设计</h3><p>请使用硬件描述语言设计一个按键消抖电路，假设输入时钟频率为50MHZ。请给出设计方案及仿真验证结果。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity key_stroke is
    generic(CLK_FRE:integer:=50000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end key_stroke;

architecture Behavioral of key_stroke is

type states is(s0,s1,s2,s3,s4);
signal state:states;

begin
process(reset,clk,key_in)
variable count_num:integer:=3*CLK_FRE/1000;
variable count:integer:=0;
    begin
        if reset=&#39;1&#39;then
            state&lt;=s0;
            count:=0;
            output&lt;=&#39;0&#39;;
        elsif reset=&#39;0&#39;then
            case state is
                when s0=&gt;if key_in=&#39;1&#39; then state&lt;=s1;end if;
                when s1=&gt;
                    if clk=&#39;1&#39; then count:=count+1;end if;
                    if count=count_num then state&lt;=s2; end if;
                when s2=&gt;
                    if(key_in=&#39;1&#39;)then output&lt;=&#39;1&#39;;state&lt;=s3;
                    elsif(key_in=&#39;0&#39;)then output&lt;=&#39;0&#39;;state&lt;=s4;
                    end if;
                when s3=&gt;
                    output&lt;=&#39;0&#39;;
                    if(key_in=&#39;0&#39;)then state&lt;=s4;end if;
                when s4=&gt;
                    state&lt;=s0;
                    count:=0;
                    output&lt;=&#39;0&#39;;             
            end case;               
        end if;     
end process;



end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity key_stroke_tb is
--  Port ( );
end key_stroke_tb;

architecture Behavioral of key_stroke_tb is
component key_stroke
    generic(CLK_FRE:integer:=50000000);
    port(
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic 
    ); 
end component;
signal clk:std_logic;
signal reset:std_logic;
signal key_in:std_logic;
signal output:std_logic;
begin
ks:key_stroke generic map(50000000)port map(clk,reset,key_in,output);

clock:process
begin
    clk&lt;=&#39;0&#39;;
    wait for 10ns;
    clk&lt;=&#39;1&#39;;
    wait for 10ns;
end process;

rst:process
begin
    reset&lt;=&#39;1&#39;;
    wait for 25ns;
    reset&lt;=&#39;0&#39;;
    wait;
end process;

test:process
begin
    key_in&lt;=&#39;1&#39;;
    wait for 50ns;
    key_in&lt;=&#39;0&#39;;
    wait for 70ns;
    key_in&lt;=&#39;1&#39;;
    wait for 100ns;
    key_in&lt;=&#39;0&#39;;
    wait for 40ns;
    key_in&lt;=&#39;1&#39;;
    wait for 120ns;
    key_in&lt;=&#39;0&#39;;
    wait for 30ns;
    key_in&lt;=&#39;1&#39;;
    wait for 40ns;
    key_in&lt;=&#39;0&#39;;
    wait for 70ns;
    key_in&lt;=&#39;1&#39;;
    wait for 30ns;
    key_in&lt;=&#39;0&#39;;
    wait for 100ns;
    key_in&lt;=&#39;1&#39;;
    wait for 50ns;
    key_in&lt;=&#39;0&#39;;
    wait for 20ns;
    key_in&lt;=&#39;1&#39;;
    wait for 1000ns;
    key_in&lt;=&#39;0&#39;;
    wait for 2000ns;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2b1e4d12b3c904bbdb1f64914294b450.png"></p>
<h3 id="5-同步环形FIFO设计"><a href="#5-同步环形FIFO设计" class="headerlink" title="5.同步环形FIFO设计"></a>5.同步环形FIFO设计</h3><p>请采用硬件描述语言设计实现一个存储深度M和数据宽度N可以用户配置的同步FIFO存储器，请给出仿真结果。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity FIFO_ring is
generic(
    depth:positive :=8;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
--        wr_clr:in std_logic;
--        wr_en:in std_logic;
--        rd_clr:in std_logic;
--        rd_en:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end FIFO_ring;

architecture Behavioral of FIFO_ring is
component duaram
generic(
    depth:positive :=8;
    width:positive:=8
);
Port(
    clka:in std_logic;
    wr:in std_logic;
    addra:in std_logic_vector(depth-1 downto 0);
    datain:in std_logic_vector(width-1 downto 0);
    
    clkb:in std_logic;
    rd:in std_logic;
    addrb:in std_logic_vector(depth-1 downto 0);
    dataout:out std_logic_vector(width-1 downto 0)
); 
end component;
component write_pointer
    generic(
        depth:positive
    );
    Port(
        clk:in std_logic;
        rst:in std_logic;
        wq:in std_logic;
        wr_pt:out std_logic_vector(depth-1 downto 0)
    );
end component;
component read_pointer
    generic(
        depth:positive
    );
    Port(
        clk:in std_logic;
        rst:in std_logic;
        rq:in std_logic;
        rd_pt:out std_logic_vector(depth-1 downto 0)
    );
end component;
component judge_status
    generic(
        depth:positive
    );
    port(
        clk:in std_logic;
        rst:in std_logic;
        wr_pt:in std_logic_vector(depth-1 downto 0);
        rd_pt:in std_logic_vector(depth-1 downto 0);
        empty:out std_logic;
        full:out std_logic
    );
end component;

signal rp_line:std_logic_vector(depth-1 downto 0);
signal wp_line:std_logic_vector(depth-1 downto 0);

begin
duaram_inst:duaram generic map(depth,width)port map(clka=&gt;clk,clkb=&gt;clk,datain=&gt;data_in,dataout=&gt;data_out,addra=&gt;wp_line,addrb=&gt;rp_line,rd=&gt;rd,wr=&gt;wr);
write_pointer_inst:write_pointer generic map(depth)port map(clk=&gt;clk,rst=&gt;rst,wq=&gt;wr,wr_pt=&gt;wp_line);
read_pointer_inst:read_pointer generic map(depth)port map(clk=&gt;clk,rst=&gt;rst,rq=&gt;rd,rd_pt=&gt;rp_line);
judge_status_inst:judge_status generic map(depth)port map(clk=&gt;clk,rst=&gt;rst,wr_pt=&gt;wp_line,rd_pt=&gt;rp_line,full=&gt;full,empty=&gt;empty);


end Behavioral;



library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity duaram is
generic(
    depth:positive :=8;
    width:positive:=8
);
Port(
    clka:in std_logic;
    wr:in std_logic;
    addra:in std_logic_vector(depth-1 downto 0);
    datain:in std_logic_vector(width-1 downto 0);
    
    clkb:in std_logic;
    rd:in std_logic;
    addrb:in std_logic_vector(depth-1 downto 0);
    dataout:out std_logic_vector(width-1 downto 0)
);
end duaram;

architecture Behavioral of duaram is

type ram is array(2**depth-1 downto 0)of std_logic_vector(width-1 downto 0);
signal dualram:ram;

begin

process(clka,clkb)
begin
    if(clka&#39;event and clka=&#39;1&#39;)then
        if(wr=&#39;0&#39;)then dualram(conv_integer(addra))&lt;=datain;end if;
    end if;
end process;

process(clkb)
begin
    if(clkb&#39;event and clkb=&#39;1&#39;)then
        if(rd=&#39;0&#39;)then dataout&lt;=dualram(conv_integer(addrb));end if;
    end if;
end process;

end Behavioral;



library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity write_pointer is
    generic(
        depth:positive
    );
    Port(
        clk:in std_logic;
        rst:in std_logic;
        wq:in std_logic;
        wr_pt:out std_logic_vector(depth-1 downto 0)
    );
end write_pointer;

architecture Behavioral of write_pointer is

signal wr_pt_t:std_logic_vector(depth-1 downto 0);

begin
process(rst,clk)
begin
    if(rst=&#39;0&#39;)then
        wr_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk&#39;event and clk=&#39;1&#39;)then
        if wq=&#39;0&#39;then wr_pt_t&lt;=wr_pt_t+1;end if;
    end if;     
end process;
wr_pt&lt;=wr_pt_t;
end Behavioral;



library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity read_pointer is
    generic(
        depth:positive
    );
    Port(
        clk:in std_logic;
        rst:in std_logic;
        rq:in std_logic;
        rd_pt:out std_logic_vector(depth-1 downto 0)
    );
end read_pointer;

architecture Behavioral of read_pointer is

signal rd_pt_t:std_logic_vector(depth-1 downto 0);

begin
process(rst,clk)
begin
    if(rst=&#39;0&#39;)then
        rd_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk&#39;event and clk=&#39;1&#39;)then
        if rq=&#39;0&#39;then rd_pt_t&lt;=rd_pt_t+1;end if;
    end if;     
end process;
rd_pt&lt;=rd_pt_t;
end Behavioral;



library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity judge_status is
    generic(
        depth:positive
    );
    port(
        clk:in std_logic;
        rst:in std_logic;
        wr_pt:in std_logic_vector(depth-1 downto 0);
        rd_pt:in std_logic_vector(depth-1 downto 0);
        empty:out std_logic;
        full:out std_logic
    );
end entity judge_status;

architecture Behavioral of judge_status is

begin

process(rst,clk)
begin
    if(rst=&#39;0&#39;)then empty&lt;=&#39;1&#39;;
    elsif clk&#39;event and clk=&#39;1&#39;then
        if wr_pt=rd_pt then empty&lt;=&#39;1&#39;;
        else empty&lt;=&#39;0&#39;;
        end if;
    end if;  
end process;

process(rst,clk)
begin
    if(rst=&#39;0&#39;)then full&lt;=&#39;0&#39;;
    elsif clk&#39;event and clk=&#39;1&#39;then
        if wr_pt&gt;rd_pt then
            if(depth+rd_pt)=wr_pt then full&lt;=&#39;1&#39;;else full&lt;=&#39;0&#39;;end if;
        end if;
    end if;  
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity FIFO_ring_tb is
--  Port ( );
end FIFO_ring_tb;

architecture Behavioral of FIFO_ring_tb is

component FIFO_ring
generic(
    depth:positive :=8;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
--        wr_clr:in std_logic;
--        wr_en:in std_logic;
--        rd_clr:in std_logic;
--        rd_en:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal clk:std_logic;
signal rst:std_logic;
signal data_in:std_logic_vector(7 downto 0);
signal wr:std_logic;
signal rd:std_logic;
signal empty:std_logic;
signal full:std_logic;
signal data_out:std_logic_vector(7 downto 0);

begin

FIFO_ring_inst:FIFO_ring generic map(8,8)port map(clk,rst,data_in,wr,rd,empty,full,data_out);

clock:process
begin
    clk&lt;=&#39;0&#39;;
    wait for 10ns;
    clk&lt;=&#39;1&#39;;
    wait for 10ns;
end process;

reset:process
begin
    rst&lt;=&#39;0&#39;;
    wait for 25ns;
    rst&lt;=&#39;1&#39;;
    wait;
end process;

test:process
begin
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;1&#39;;
    data_in&lt;=&quot;00000000&quot;;
    wait for 50ns;
    data_in&lt;=&quot;00000001&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;00000010&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;00000100&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;00001000&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;00010000&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;00100000&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;01000000&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 30ns;
    data_in&lt;=&quot;10000000&quot;;
    wr&lt;=&#39;0&#39;;
    wait for 20ns;
    wr&lt;=&#39;1&#39;;
    wait for 50ns;
    
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    rd&lt;=&#39;0&#39;;
    wait for 20ns;
    rd&lt;=&#39;1&#39;;
    wait for 30ns;
    
    wait;
    
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9085cd14c31cada75062d36a643fb2b5.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4dbe7b6e7886a88433a6fb76f77ee7f8.png"></p>
<h3 id="6-线上实验——时钟模块设计"><a href="#6-线上实验——时钟模块设计" class="headerlink" title="6.线上实验——时钟模块设计"></a>6.线上实验——时钟模块设计</h3><p>采用硬件描述语言设计实现CPU时钟模块，输出信号包括四个节拍信号（每两个时钟周期一个节拍），时钟反相信号，时钟2分频信号及其反相信号，完成逻辑功能设计及仿真验证，并给出仿真结果。</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity clock is
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end clock;

architecture Behavioral of clock is
begin

process(clk)
variable count_clk2:integer:=0;
variable count_w:integer:=0;
begin
    if(rst=&#39;0&#39;)then
        w0&lt;=&#39;0&#39;;
        w1&lt;=&#39;0&#39;;
        w2&lt;=&#39;0&#39;;
        w3&lt;=&#39;0&#39;;
        clk1&lt;=&#39;0&#39;;
        nclk1&lt;=&#39;1&#39;;
        clk2&lt;=&#39;0&#39;;
        nclk2&lt;=&#39;1&#39;;
        count_clk2:=0;
        count_w:=0;
    elsif(rst=&#39;1&#39;)then
        clk1&lt;=clk;
        nclk1&lt;=not clk;
        if(clk&#39;event and clk=&#39;1&#39;)then
            if(count_clk2=0)then count_clk2:=1;clk2&lt;=&#39;1&#39;;nclk2&lt;=&#39;0&#39;;
            elsif(count_clk2=1)then count_clk2:=0;clk2&lt;=&#39;0&#39;;nclk2&lt;=&#39;1&#39;;
            end if;
            if(count_w&gt;=0 and count_w&lt;=3)then w0&lt;=&#39;1&#39;;else w0&lt;=&#39;0&#39;;end if;
            if(count_w&gt;=4 and count_w&lt;=7)then w1&lt;=&#39;1&#39;;else w1&lt;=&#39;0&#39;;end if;
            if(count_w&gt;=8 and count_w&lt;=11)then w2&lt;=&#39;1&#39;;else w2&lt;=&#39;0&#39;;end if;
            if(count_w&gt;=12 and count_w&lt;=15)then w3&lt;=&#39;1&#39;;else w3&lt;=&#39;0&#39;;end if;
            if(count_w&lt;15)then count_w:=count_w+1;else count_w:=0;end if;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity clock_tb is
--  Port ( );
end clock_tb;

architecture Behavioral of clock_tb is
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;

signal clk,rst:std_logic;
signal clk1,nclk1:std_logic;   --clk
signal clk2,nclk2:std_logic;   --clk二分频
signal w0,w1,w2,w3:std_logic;  --节拍信号

begin
clock_inst:clock port map(clk,rst,clk1,nclk1,clk2,nclk2,w0,w1,w2,w3);

clock_gen:process
begin
    clk&lt;=&#39;0&#39;;
    wait for 10ns;
    clk&lt;=&#39;1&#39;;
    wait for 10ns;
end process;

reset_gen:process
begin
    rst&lt;=&#39;0&#39;;
    wait for 25ns;
    rst&lt;=&#39;1&#39;;
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/adec0f2295677479c7321988b4b0f166.png"></p>
<h3 id="7-线上实验——原码二位乘法器设计"><a href="#7-线上实验——原码二位乘法器设计" class="headerlink" title="7.线上实验——原码二位乘法器设计"></a>7.线上实验——原码二位乘法器设计</h3><p>请用硬件描述语言设计一个原码二位乘法器，其中两个操作数位宽为8，请给出仿真结果。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7bb5fc46ac6d878964e59ddeb1fe803c.png"></p>
<p>顶层——multiplier_2bit：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity multiplier_2bit is
    Port(
        clk,start:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        done:out std_logic;
        sout:inout std_logic_vector(15 downto 0)
    );
end multiplier_2bit;

architecture Behavioral of multiplier_2bit is

component multiplier_ctrl
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end component;
component multiplier_8bitshiftreg
    Port (
        clk,load:in std_logic;
        din:in std_logic_vector(7 downto 0);
        qb0,qb1:out std_logic
     );
end component;
component multiplier_16bitreg
    Port (
        clk,clr:in std_logic;
        d:in std_logic_vector(8 downto 0);
        q:out std_logic_vector(15 downto 0)
     );
end component;
component multiplier_selector
    Port (
        clk,rst:in std_logic;
        a0,a1,cin:in std_logic;
        din:in std_logic_vector(7 downto 0);
        cout:out std_logic;
        dout:out std_logic_vector(7 downto 0)
     );
end component;
component multiplier_8bitadder
    Port (
        clk,rst:in std_logic;
        cin:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end component;

signal clk_line:std_logic;
signal rst_line:std_logic;
signal cin_line:std_logic;
signal qb1_line,qb0_line:std_logic;
signal bin_line:std_logic_vector(7 downto 0);
signal sout_line:std_logic_vector(8 downto 0);
signal test_line:std_logic_vector(8 downto 0);

begin
multiplier_ctrl_inst:multiplier_ctrl port map(clk=&gt;clk,start=&gt;start,clkout=&gt;clk_line,rstall=&gt;rst_line,done=&gt;done);
multiplier_8bitshiftreg_inst:multiplier_8bitshiftreg port map(clk=&gt;clk_line,load=&gt;rst_line,din=&gt;ain,qb0=&gt;qb0_line,qb1=&gt;qb1_line);
multiplier_16bitreg_inst:multiplier_16bitreg port map(clk=&gt;clk_line,clr=&gt;rst_line,d=&gt;sout_line,q=&gt;sout);
multiplier_selector_inst:multiplier_selector port map(clk=&gt;clk_line,rst=&gt;rst_line,a0=&gt;qb0_line,a1=&gt;qb1_line,cin=&gt;sout_line(8),din=&gt;bin,cout=&gt;cin_line,dout=&gt;bin_line);
multiplier_8bitadder_inst:multiplier_8bitadder port map(clk=&gt;clk_line,rst=&gt;rst_line,cin=&gt;cin_line,ain=&gt;sout(15 downto 8),bin=&gt;bin_line,sout=&gt;sout_line);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8f30332a988566f33bab93454ab0c0ca.png"></p>
<p>testbench:</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity multiplier_2bit_tb is
--  Port ( );
end multiplier_2bit_tb;

architecture Behavioral of multiplier_2bit_tb is
component multiplier_2bit
    Port(
        clk,start:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        done:out std_logic;
        sout:inout std_logic_vector(15 downto 0)
    );
end component;
signal clk,start: std_logic;
signal ain,bin: std_logic_vector(7 downto 0);
signal done: std_logic;
signal sout: std_logic_vector(15 downto 0);
begin
multiplier_2bit_inst:multiplier_2bit port map(clk,start,ain,bin,done,sout);

clock_gen:process
begin  
    clk&lt;=&#39;1&#39;;
    wait for 10ns;
    clk&lt;=&#39;0&#39;;
    wait for 10ns;
end process;

test:process
begin
    ain&lt;=&quot;10011010&quot;;
    bin&lt;=&quot;01100101&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 150ns;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/559a1c00923a7cda00c06f63c6dec1cc.png"></p>
<p>模块：</p>
<p>multiplier_2bit_ctrl ：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_ctrl is
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end multiplier_ctrl;

architecture Behavioral of multiplier_ctrl is

signal cnt3b:std_logic_vector(2 downto 0);

begin

process(clk,start)
begin
    rstall&lt;=start;
    if(start=&#39;1&#39;)then cnt3b&lt;=&quot;000&quot;;
    elsif clk&#39;event and clk=&#39;1&#39;then if cnt3b&lt;=4 then cnt3b&lt;=cnt3b+1;end if;
    end if;
end process;

process(clk,cnt3b,start)
begin
    if (start=&#39;1&#39;)then
        clkout&lt;=&#39;0&#39;;done&lt;=&#39;0&#39;; 
    elsif(start=&#39;0&#39;)then    
        if cnt3b&lt;=4 then clkout&lt;=clk;
        else clkout&lt;=&#39;0&#39;;done&lt;=&#39;1&#39;;
        end if; 
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/920cb7c013bd5af2e09bc59aafba028c.png"></p>
<p>multiplier_2bit_8bitshiftreg：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_8bitshiftreg is
    Port (
        clk,load:in std_logic;
        din:in std_logic_vector(7 downto 0);
        qb0,qb1:out std_logic
     );
end multiplier_8bitshiftreg;

architecture Behavioral of multiplier_8bitshiftreg is

signal reg8b:std_logic_vector(7 downto 0);

begin

process(clk,load)
begin
    if load=&#39;1&#39;then reg8b&lt;=din;qb0&lt;=&#39;0&#39;;qb1&lt;=&#39;0&#39;;end if;
    if(load=&#39;0&#39;and clk=&#39;1&#39;)then 
        qb0&lt;=reg8b(0);
        qb1&lt;=reg8b(1);
        reg8b(5 downto 0)&lt;=reg8b(7 downto 2);
        reg8b(7 downto 6)&lt;=&quot;00&quot;;   
    end if;     
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d171f9dc0e6d54b72cf1ffe1f8c759ec.png"></p>
<p>multiplier_2bit_16bitreg：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_16bitreg is
    Port (
        clk,clr:in std_logic;
        d:in std_logic_vector(8 downto 0);
        q:out std_logic_vector(15 downto 0)
     );
end multiplier_16bitreg;

architecture Behavioral of multiplier_16bitreg is

begin

process(clk,clr)
variable sr16b:std_logic_vector(15 downto 0);
begin
    if clr=&#39;1&#39;then
        sr16b:=&quot;0000000000000000&quot;;
    elsif(clr=&#39;0&#39;and clk&#39;event and clk=&#39;1&#39;)then  
        sr16b(15 downto 8):=d(7 downto 0);
        sr16b(13 downto 0):=sr16b(15 downto 2);
        sr16b(15):=d(8);
        sr16b(14):=d(8);
    end if;   
    q&lt;=sr16b;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/08847d6e576be1f9f61c68f8d15899b6.png"></p>
<p>multiplier_2bit_selector：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_selector is
    Port (
        clk,rst:in std_logic;
        a0,a1,cin:in std_logic;
        din:in std_logic_vector(7 downto 0);
        cout:out std_logic;
        dout:out std_logic_vector(7 downto 0)
     );
end multiplier_selector;

architecture Behavioral of multiplier_selector is

begin

process(clk,a0,a1,cin,din)
begin
    if(rst=&#39;1&#39;)then cout&lt;=&#39;0&#39;;dout&lt;=&quot;00000000&quot;;
    elsif(rst=&#39;0&#39;and clk&#39;event and clk=&#39;0&#39;)then
        if(a0=a1 and a0=cin)then dout&lt;=&quot;00000000&quot;;cout&lt;=cin;
        elsif(a1=&#39;0&#39;and (a0 xor cin)=&#39;1&#39;)then dout&lt;=din;cout&lt;=&#39;0&#39;;
        elsif((a1 xor a0)=&#39;1&#39;and a0=cin)then
            dout(7 downto 1)&lt;=din(6 downto 0);  
            dout(0)&lt;=&#39;0&#39;;
            cout&lt;=&#39;0&#39;;
        elsif(a1=&#39;1&#39;and(a0 xor cin)=&#39;1&#39;)then
            dout&lt;=(not din)+1;
            cout&lt;=&#39;1&#39;;  
        end if;
    end if;    
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e286d15abce298cf0b629350ba7e076e.png"></p>
<p>multiplier_2bit_8bitadder：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_8bitadder is
    Port (
        clk,rst:in std_logic;
        cin:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end multiplier_8bitadder;

architecture Behavioral of multiplier_8bitadder is
begin

process(clk,rst,ain,bin,cin)
begin
    if(rst=&#39;1&#39;)then sout&lt;=&quot;000000000&quot;;
    elsif(rst=&#39;0&#39;and clk=&#39;0&#39;)then
        sout&lt;=(&#39;0&#39;&amp; ain)+(cin &amp; bin);
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/cdd818c3fea80ef3bef0a36c7c6ab446.png"></p>
<p><strong>设计注意点：</strong></p>
<p>0.设计顺序：控制器-8b移位寄存器-16位缓存器-选择器-加法器</p>
<p>1.输入位8位无符号数，若输入有符号数需修改位宽并另外计算符号位。</p>
<p>2.共用总线需注意时序，防止总线冲突以及数据读取错误</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b25fa007565503bdd4b69b5d6c31496d.png"></p>
<p>共用总线sout时序设计：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/daac7ca07dca672e89a3e831d4b8bd9a.png"></p>
<p>3.process内语句顺序执行的次序。</p>
<p>4.变量的使用：mulitiplier_16bitreg中</p>
<pre><code>variable sr16b:std_logic_vector(15 downto 0);
</code></pre>
<p>若使用 signal sr16b，则 q&lt;&#x3D;sr16b; 无效</p>
<p>5.位拓展：</p>
<pre><code>sout&lt;=(&#39;0&#39;&amp; ain)+(cin &amp; bin); 
</code></pre>
<p>使用 &amp; 符拓展位宽</p>
<h3 id="8-线上实验——布斯乘法器设计"><a href="#8-线上实验——布斯乘法器设计" class="headerlink" title="8.线上实验——布斯乘法器设计"></a>8.线上实验——布斯乘法器设计</h3><p>采用硬件描述语言设计实现布斯乘法器，完成逻辑功能设计及仿真验证，并给出仿真结果。</p>
<p>按照7中的设计顺序对7中设计文件进行修改：</p>
<pre><code>    ctrl模块发出时钟周期数改为8；8bitshiftreg和16bitreg模块每个时钟周期移动1位，且8；8bitshiftreg输出的是a0和a-1；16bitreg和selector模块载入数值后求补；selector模块删去cin和cout信号并修改规则；adder无cin...
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8c09ab4e531a18f069ba4afb9e18d438.png"></p>
<p>顶层模块——multiplier_booth：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity multiplier_booth is
    Port(
        clk,start:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        done:out std_logic;
        sout:inout std_logic_vector(15 downto 0)
    );
end multiplier_booth;

architecture Behavioral of multiplier_booth is

component multiplier_booth_ctrl
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end component;
component multiplier_booth_8bitshiftreg
    Port (
        clk,load:in std_logic;
        din:in std_logic_vector(7 downto 0);
        qb0,qb1:out std_logic
     );
end component;
component multiplier_booth_16bitreg
    Port (
        clk,clr:in std_logic;
        d:in std_logic_vector(8 downto 0);
        q:out std_logic_vector(15 downto 0)
     );
end component;
component multiplier_booth_selector
    Port (
        clk,rst:in std_logic;
        a0,a1:in std_logic;
        din:in std_logic_vector(7 downto 0);
        dout:out std_logic_vector(7 downto 0)
     );
end component;
component multiplier_booth_8bitadder
    Port (
        clk,rst:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end component;

signal clk_line:std_logic;
signal rst_line:std_logic;
signal qb1_line,qb0_line:std_logic;
signal bin_line:std_logic_vector(7 downto 0);
signal sout_line:std_logic_vector(8 downto 0);
signal test_line:std_logic_vector(8 downto 0);

begin
multiplier_booth_ctrl_inst:multiplier_booth_ctrl port map(clk=&gt;clk,start=&gt;start,clkout=&gt;clk_line,rstall=&gt;rst_line,done=&gt;done);
multiplier_booth_8bitshiftreg_inst:multiplier_booth_8bitshiftreg port map(clk=&gt;clk_line,load=&gt;rst_line,din=&gt;ain,qb0=&gt;qb0_line,qb1=&gt;qb1_line);
multiplier_booth_16bitreg_inst:multiplier_booth_16bitreg port map(clk=&gt;clk_line,clr=&gt;rst_line,d=&gt;sout_line,q=&gt;sout);
multiplier_booth_selector_inst:multiplier_booth_selector port map(clk=&gt;clk_line,rst=&gt;rst_line,a0=&gt;qb0_line,a1=&gt;qb1_line,din=&gt;bin,dout=&gt;bin_line);
multiplier_booth_8bitadder_inst:multiplier_booth_8bitadder port map(clk=&gt;clk_line,rst=&gt;rst_line,ain=&gt;sout(15 downto 8),bin=&gt;bin_line,sout=&gt;sout_line);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d3e67513e1e27963a8e15f23f6a8cc7c.png"></p>
<p>testbench：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity multiplier_booth_tb is
--  Port ( );
end multiplier_booth_tb;

architecture Behavioral of multiplier_booth_tb is
component multiplier_booth
    Port(
        clk,start:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        done:out std_logic;
        sout:inout std_logic_vector(15 downto 0)
    );
end component;
signal clk,start: std_logic;
signal ain,bin: std_logic_vector(7 downto 0);
signal done: std_logic;
signal sout: std_logic_vector(15 downto 0);
begin
multiplier_booth_inst:multiplier_booth port map(clk,start,ain,bin,done,sout);

clock_gen:process
begin  
    clk&lt;=&#39;1&#39;;
    wait for 10ns;
    clk&lt;=&#39;0&#39;;
    wait for 10ns;
end process;

test:process
begin
    ain&lt;=&quot;00000010&quot;;
    bin&lt;=&quot;10000010&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 200ns;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4cd31e8dc5958ee6e4b4eedfd590f2fa.png"></p>
<p>模块：</p>
<p>multiplier_booth_ctrl：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_booth_ctrl is
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end multiplier_booth_ctrl;

architecture Behavioral of multiplier_booth_ctrl is

signal cnt4b:std_logic_vector(3 downto 0);

begin

process(clk,start)
begin
    rstall&lt;=start;
    if(start=&#39;1&#39;)then cnt4b&lt;=&quot;0000&quot;;
    elsif clk&#39;event and clk=&#39;1&#39;then if cnt4b&lt;=8 then cnt4b&lt;=cnt4b+1;end if;
    end if;
end process;

process(clk,cnt4b,start)
begin
    if (start=&#39;1&#39;)then
        clkout&lt;=&#39;0&#39;;done&lt;=&#39;0&#39;; 
    elsif(start=&#39;0&#39;)then    
        if cnt4b&lt;=8 then clkout&lt;=clk;
        else clkout&lt;=&#39;0&#39;;done&lt;=&#39;1&#39;;
        end if; 
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/83c13baff1be05be6cda0e582d59099f.png"></p>
<p>multiplier_booth_8bitshiftreg：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_booth_8bitshiftreg is
    Port (
        clk,load:in std_logic;
        din:in std_logic_vector(7 downto 0);
        qb0,qb1:out std_logic
     );
end multiplier_booth_8bitshiftreg;

architecture Behavioral of multiplier_booth_8bitshiftreg is

signal reg8b:std_logic_vector(8 downto 0);

begin

process(clk,load)
begin
    if load=&#39;1&#39;then 
        if(din(7)=&#39;1&#39;)then reg8b(8 downto 1)&lt;=(din(7)&amp;(not din(6 downto 0)))+1;else reg8b(8 downto 1)&lt;=din;end if;  --取补码
        reg8b(0)&lt;=&#39;0&#39;;
        qb0&lt;=&#39;0&#39;;qb1&lt;=&#39;0&#39;;
    end if;
    if(load=&#39;0&#39;and clk=&#39;1&#39;)then 
        qb0&lt;=reg8b(0);
        qb1&lt;=reg8b(1);
        reg8b(7 downto 0)&lt;=reg8b(8 downto 1);
        reg8b(8)&lt;=&#39;0&#39;;   
    end if;     
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/61bbc405e10beaea2c2635a94871b4cb.png"></p>
<p>multiplier_booth_16bitreg：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_booth_16bitreg is
    Port (
        clk,clr:in std_logic;
        d:in std_logic_vector(8 downto 0);
        q:out std_logic_vector(15 downto 0)
     );
end multiplier_booth_16bitreg;

architecture Behavioral of multiplier_booth_16bitreg is

begin

process(clk,clr)
variable sr16b:std_logic_vector(15 downto 0);
begin
    if clr=&#39;1&#39;then
        sr16b:=&quot;0000000000000000&quot;;
    elsif(clr=&#39;0&#39;and clk&#39;event and clk=&#39;1&#39;)then  
        sr16b(15 downto 8):=d(7 downto 0);
        sr16b(14 downto 0):=sr16b(15 downto 1);
        sr16b(15):=d(8);    --移位复制符号位
    end if;   
    q&lt;=sr16b;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/78e8dae445e0aa8620fd29c657228abd.png"></p>
<p>multiplier_booth_selector：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_booth_selector is
    Port (
        clk,rst:in std_logic;
        a0,a1:in std_logic;
        din:in std_logic_vector(7 downto 0);
        dout:out std_logic_vector(7 downto 0)
     );
end multiplier_booth_selector;

architecture Behavioral of multiplier_booth_selector is

begin

process(clk,a0,a1,din)
variable complement_x:std_logic_vector(7 downto 0);
variable complement_x_negative:std_logic_vector(7 downto 0);
begin
    if(rst=&#39;1&#39;)then dout&lt;=&quot;00000000&quot;;
    elsif(rst=&#39;0&#39;and clk&#39;event and clk=&#39;0&#39;)then
        if(din(7)=&#39;1&#39;)then complement_x:=(din(7)&amp;(not din(6 downto 0)))+1;else complement_x:=din;end if;    --取X补码
        if((not din(7))=&#39;1&#39;)then complement_x_negative:=((not din(7))&amp;(not din(6 downto 0)))+1;else complement_x_negative:=(not din(7))&amp;din(6 downto 0);end if; --取-X补码
        if(a1=a0)then dout&lt;=&quot;00000000&quot;;
        elsif(a0=&#39;1&#39;and a1=&#39;0&#39;)then dout&lt;=complement_x;
        elsif(a0=&#39;0&#39;and a1=&#39;1&#39;)then dout&lt;=complement_x_negative;
        end if;
    end if;    
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9597c2a19cccbc17358d377d0ee32df8.png"></p>
<p>multiplier_booth_8bitadder：</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity multiplier_booth_8bitadder is
    Port (
        clk,rst:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end multiplier_booth_8bitadder;

architecture Behavioral of multiplier_booth_8bitadder is
begin

process(clk,rst,ain,bin)
begin
    if(rst=&#39;1&#39;)then sout&lt;=&quot;000000000&quot;;
    elsif(rst=&#39;0&#39;and clk=&#39;0&#39;)then
        sout&lt;=(ain(7) &amp; ain)+(bin(7)  &amp; bin);   --符号位扩展加法
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d7c983ed1ce45af2d329d820c088e9dd.png"></p>
<p><strong>设计注意点：</strong></p>
<p>1.求补码的方法：</p>
<pre><code>if(din(7)=&#39;1&#39;)then 
    reg8b(8 downto 1)&lt;=(din(7)&amp;(not din(6 downto 0)))+1;
else reg8b(8 downto 1)&lt;=din;
end if;  
--取补码
</code></pre>
<p>2.求和时符号位拓展：</p>
<pre><code>sout&lt;=(ain(7) &amp; ain)+(bin(7)  &amp; bin);   --符号位扩展加法
</code></pre>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/137247923">https://blog.csdn.net/qq_32971095/article/details/137247923</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E4%BD%8D%E5%9B%BE%E5%9B%BE%E5%83%8F%E6%96%87%E4%BB%B6%E7%BC%A9%E6%94%BE-%E8%A5%BF%E5%AE%89%E7%94%B5%E5%AD%90%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6%E5%A4%A7%E4%B8%80%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80%E8%AE%BE%E8%AE%A1%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%BD%9C%E4%B8%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E4%BD%8D%E5%9B%BE%E5%9B%BE%E5%83%8F%E6%96%87%E4%BB%B6%E7%BC%A9%E6%94%BE-%E8%A5%BF%E5%AE%89%E7%94%B5%E5%AD%90%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6%E5%A4%A7%E4%B8%80%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80%E8%AE%BE%E8%AE%A1%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%BD%9C%E4%B8%9A/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:53" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>问题描述：</li>
</ul>
<p>编写一个程序，可以在命令行输入参数，完成指定文件的缩放，并存储到新文件，命令行参数如下</p>
<p>zoom file1.bmp 200 file2.bmp</p>
<p>第一个参数为可执行程序名称，第二个参数为原始图像文件名，第三个参数为缩放比例（百分比），第四个参数为新文件名</p>
<ul>
<li>问题分析：</li>
</ul>
<ol>
<li>综述：</li>
</ol>
<p>要实现对bmp图像操作，首先要知道bmp图像的存储机理（图像信息如何以二进制信息存储）及文件包含的内容；其次知晓基本的图像缩放算法即可；最后要知晓如何读取和存储文件信息。</p>
<ol>
<li>实现时的困难：<br>1. 定义何种类型变量？<br>2. 文件大小如何读取、计算？<br>3. 像素信息如何读取、写入？</li>
<li>对应解决方案<br>1. 首先创建全局变量，如src_：原图宽高；dst_：缩放后宽高；各函数都可对其进行访问；其次用一个字符数组typedef unsigned char pixel[3];存储一个像素的RGB信息；对于缩放比例用double height_zoom_rate,width_zoom_rate;操作更精准，计算缩放后像素用类型转换即可，如：dst_width&#x3D;(int)(width_zoom_rate<em>src_width); 而在访问文件文件头和信息头时，定义unsigned char <em>buf&#x3D;NULL,<em>bui&#x3D;NULL;方便逐个字节访问，也可以处理小端对齐。<br>2. 即如何根据字节小端对齐计算文件大小；前面已经用buf、bui逐个访问文件头，信息头的每个字节数据，故如：b_size&#x3D;bui[23]<em>16</em>16</em>16</em>16</em>16<em>16+bui[22]<em>16</em>16</em>16*16+bui[21]<em>16</em>16+bui[20];</li>
</ol>
<p>可以读取图像大小；而：</p>
<p>f_size&#x3D;dst_width*dst_height+54;则可计算操作后的文件大小</p>
<ol>
<li><pre><code>1. 每个像素的RGB信息各占一个字节，用fgetc即可读取每个字节。读取完一行的像素后，通过计算填充字节个数（pad_num=(4-(src_width*3)%4)%4;），再用fgetc读掉填充字节，即可读取下一行。写入时采用三个字节为一组（即一个像素的RGB信息），结合最近邻插入法用fwrite写入fwrite(&amp;info[si*src_width+sj],sizeof(pixel),1,fp_n);
</code></pre>
</li>
</ol>
<p>再用fputc（0，fp_n）写入填充字节数。</p>
<pre><code>#define _CRT_SECURE_NO_WARNINGS
#include&quot;bmp.h&quot;

extern double height_zoom_rate,width_zoom_rate;

int main(int argc, char* argv[]) &#123;
	
	//打开文件 
	FILE*fp=fopen(argv[1],&quot;rb&quot;),*fp_n = fopen(argv[3], &quot;wb&quot;);
	
	//读取文件头、信息头 
	read_bmp_head(fp);
	//读取像素信息 
	read_bmp_data(fp);
	
	//计算长宽缩放比例 
	width_zoom_rate=height_zoom_rate=(atoi(argv[2]) /100.0);
	
	//结合最近邻插入法写入缩放后的图像信息 
	write_data(fp_n);
	//展示操作好的图像信息 
	read_bmp_head(fp_n);
	
	//关闭两个图像文件 
	fclose(fp);
	fclose(fp_n);

	return 0;
&#125;



/*头文件使用说明：
在主程序中：extern double height_zoom_rate,width_zoom_rate;并赋值方可正常运行
包含三个函数：
void read_bmp_head(FILE*fp)； 
void read_bmp_data(FILE*fp)；
void write_data(FILE* fp_n)； 
*/ 
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;
//改对取模数为1个字节（默认为8，只可是2^n）
#pragma pack(1)
//存储一个像素信息的三元素字符数组 
typedef unsigned char pixel[3];
//文件头信息
typedef struct tagBITMAPFILEHEADER
&#123;
	unsigned short bfType;		 //保存图片类型。 &#39;BM&#39;(1-2字节) 
	unsigned long bfSize; 	 //位图文件的大小，以字节为单位（3-6字节，低位在前）
	unsigned short bfReserved1;//位图文件保留字，必须为0(7-8字节）
	unsigned short bfReserved2;//位图文件保留字，必须为0(9-10字节）
	unsigned long bfOffBits;  //RGB数据偏移地址,位图数据的起始位置，以相对于位图（11-14字节，低位在前）
&#125;BITMAP_FILE_HEADER;
//信息头信息
typedef struct tagBITMAPINFOHEADER
&#123;
	unsigned long 	biSize; 		 //本结构所占用字节数（15-18字节）
	unsigned long  biWidth; 	 //位图的宽度，以像素为单位（19-22字节）
	unsigned long  biHeight; 	 //位图的高度，以像素为单位（23-26字节）
	unsigned short biPlanes; 	 //目标设备的级别，必须为1(27-28字节）
	unsigned short biBitCount;  //每个像素所需的位数，必须是1（双色）（29-30字节）,4(16色），8(256色）16(高彩色)或24（真彩色）之一

	unsigned long  biCompression;//位图压缩类型，必须是0（不压缩），（31-34字节）
	//1(BI_RLE8压缩类型）或2(BI_RLE4压缩类型）之一

	unsigned long  biSizeImage;  //位图的大小(其中包含了为了补齐每行字节数是4的倍数而添加的空字节)，以字节为单位（35-38字节）

	unsigned long  biXPelsPerMeter;//位图水平分辨率，每米像素数（39-42字节）
	unsigned long  biYPelsPerMeter;//位图垂直分辨率，每米像素数（43-46字节)
	unsigned long  biClrUsed; 		 //位图实际使用的颜色表中的颜色数（47-50字节）
	unsigned long  biClrImportant; //位图显示过程中重要的颜色数（51-54字节）
&#125;BITMAP_INFO_HEADER;

//全局变量说明：src_：原图宽高；dst_：缩放后宽高；pad_num：每行补齐空字节数；
//f_size: bfSize; b_size: biSizeImage; _zoom_rate: 宽高缩放倍数；sign：是否没计算过宽高标志 
int sign1=1;
int src_width,src_height,dst_width,dst_height;
int pad_num,f_size,b_size;
double height_zoom_rate,width_zoom_rate;
unsigned char *buf=NULL,*bui=NULL;
//创建两个结构体存储文件头和信息头信息 
BITMAP_FILE_HEADER file_head;
BITMAP_INFO_HEADER info_head;
//info指向像素信息的头地址，以info[i](=*(info+i))访问第i个像素 
pixel *info=NULL;

//读取文件头和信息头的信息 
void read_bmp_head(FILE*fp)&#123;
	
	if ( fp == NULL ) &#123;
		printf(&quot;file doesn&#39;t exist!\n&quot;);
		exit(0);
	&#125;
	rewind(fp); 

	//读取信息 
	fread(&amp;file_head, sizeof(BITMAP_FILE_HEADER), 1, fp);
	fread(&amp;info_head, sizeof(BITMAP_INFO_HEADER), 1, fp);
	
	//因为信息是小端对齐，以字节为单位方便读取 
	buf=(unsigned char*)&amp;file_head;
	printf(&quot;\nbfType:\t\t%c %c&quot;,buf[1],buf[0]);
	f_size=buf[5]*16*16*16*16*16*16+buf[4]*16*16*16*16+buf[3]*16*16+buf[2];
	printf(&quot;\nbfSize:\t\t%02x %02x %02x %02x   ----   %d&quot;,buf[5],buf[4],buf[3],buf[2],f_size);
	printf(&quot;\nbfReserved1:\t%02x %02x\nbfReserved2:\t%02x %02x&quot;,buf[7],buf[6],buf[9],buf[8]);
	printf(&quot;\nbf0ffbits:\t%02x %02x %02x %02x&quot;,buf[13],buf[12],buf[11],buf[10]); 
	printf(&quot;\n\n&quot;); 
	
	bui=(unsigned char*)&amp;info_head;
	printf(&quot;\nbiSize:\t\t%02x %02x %02x %02x&quot;,bui[3],bui[2],bui[1],bui[0]);
	src_width=bui[7]*16*16*16*16*16*16+bui[6]*16*16*16*16+bui[5]*16*16+bui[4];
	src_height=bui[11]*16*16*16*16*16*16+bui[10]*16*16*16*16+bui[9]*16*16+bui[8];
	printf(&quot;\nbiWidth:\t%02x %02x %02x %02x   ----   %d&quot;,bui[7],bui[6],bui[5],bui[4],src_width);
	printf(&quot;\nbiHeight:\t%02x %02x %02x %02x   ----   %d&quot;,bui[11],bui[10],bui[9],bui[8],src_height);
	printf(&quot;\nbiPlans:\t%02x %02x&quot;,bui[13],bui[12]);
	printf(&quot;\nbiBitCount:\t%02x %02x&quot;,bui[15],bui[14]);
	printf(&quot;\nbiCompression:\t%02x %02x %02x %02x&quot;,bui[19],bui[18],bui[17],bui[16]);
	b_size=bui[23]*16*16*16*16*16*16+bui[22]*16*16*16*16+bui[21]*16*16+bui[20];
	printf(&quot;\nbiSizeImage:\t%02x %02x %02x %02x   ----   %d&quot;,bui[23],bui[22],bui[21],bui[20],b_size);
	printf(&quot;\nbiXPelsPerMeter:%02x %02x %02x %02x&quot;,bui[27],bui[26],bui[25],bui[24]);
	printf(&quot;\nbiYPelsPerMeter:%02x %02x %02x %02x&quot;,bui[31],bui[30],bui[29],bui[28]);
	printf(&quot;\nbiClrUsed:\t%02x %02x %02x %02x&quot;,bui[35],bui[34],bui[33],bui[32]);
	printf(&quot;\nbiClrImportant:\t%02x %02x %02x %02x\n&quot;,bui[39],bui[38],bui[37],bui[36]);
	
	sign1=0; 
&#125;
	
//将照片像素信息读取，通过全局变量info访问 
void read_bmp_data(FILE*fp)&#123;
	
	void read_bmp_head(FILE*fp);
	if ( fp == NULL ) &#123;
		printf(&quot;file doesn&#39;t exist!\n&quot;);
		exit(0);
	&#125;
	//判断是否计算好了图像的长宽，没有则执行 
	if(sign1)&#123;
		rewind(fp);
		read_bmp_head(fp);
	&#125;
	
	int i,j,k;

	//填充字节数 
	pad_num=(4-(src_width*3)%4)%4;
	//开辟空间 
	info=(pixel*)malloc(src_width*src_height*sizeof(pixel));
	
	//读取像素信息RGB 
	for(i=0;i&lt;src_height;i++)&#123;
		for(j=0;j&lt;src_width;j++)&#123;
			info[i*src_width+j][0]=fgetc(fp);
			info[i*src_width+j][1]=fgetc(fp);
			info[i*src_width+j][2]=fgetc(fp);
		&#125;
		//读掉填充字节 
		for(k=0;k&lt;pad_num;k++)fgetc(fp);
	&#125;
	
&#125;

//将信息写入新文件 
void write_data(FILE* fp_n) &#123;
	
	rewind(fp_n);
	dst_width=(int)(width_zoom_rate*src_width);
	dst_height=(int)(height_zoom_rate*src_height);
	
	//文件头信息修改、拷贝（小对齐，故用&amp;、&gt;&gt;位操作） 
	int f_size=dst_width*dst_height+54,i,j,k;
	buf[2]=0x000000FF&amp;f_size;
	buf[3]=(0x0000FF00&amp;f_size)&gt;&gt;8;
	buf[4]=(0x00FF0000&amp;f_size)&gt;&gt;16;
	buf[5]=(0xFF000000&amp;f_size)&gt;&gt;24;
	
	for(i=0;i&lt;14;i++)fputc(buf[i],fp_n);
	
	//信息头信息修改、拷贝 
	bui[4]=0x000000FF&amp;dst_width;
	bui[5]=(0x0000FF00&amp;dst_width)&gt;&gt;8;
	bui[6]=(0x00FF0000&amp;dst_width)&gt;&gt;16;
	bui[7]=(0xFF000000&amp;dst_width)&gt;&gt;24;
	bui[8]=0x000000FF&amp;dst_height;
	bui[9]=(0x0000FF00&amp;dst_height)&gt;&gt;8;
	bui[10]=(0x00FF0000&amp;dst_height)&gt;&gt;16;
	bui[11]=(0xFF000000&amp;dst_height)&gt;&gt;24;
	
	pad_num= (4-(dst_width*3)%4)%4;
	b_size=dst_height*(dst_width+pad_num)*3;
	bui[20]=0x000000FF&amp;b_size;
	bui[21]=(0x0000FF00&amp;b_size)&gt;&gt;8;
	bui[22]=(0x00FF0000&amp;b_size)&gt;&gt;16;
	bui[23]=(0xFF000000&amp;b_size)&gt;&gt;24; 
	
	for(i=0;i&lt;40;i++)fputc(bui[i],fp_n);
	
	int si,sj;
	
	//像素信息写入 
	for(i=0;i&lt;dst_height;i++)&#123;
		si=i/height_zoom_rate;
		for(j=0;j&lt;dst_width;j++)&#123;
			//最近邻插入法 
			sj=j/width_zoom_rate;
			fwrite(&amp;info[si*src_width+sj],sizeof(pixel),1,fp_n);
		&#125;
		for(k=0;k&lt;pad_num;k++)fputc(0,fp_n);
	&#125;
	/*
	//不行的写法！低效且数值越界 
	for(i=0;i&lt;dst_height;i++)&#123;
		for(j=0;j&lt;dst_width;j++)&#123;
			//最近邻插入法 
			fwrite(&amp;info[(int)(i*src_width/height_zoom_rate+j/width_zoom_rate)],sizeof(pixel),1,fp_n);
		&#125;
		for(k=0;k&lt;pad_num;k++)fputc(0,fp_n);
	&#125;
	*/
&#125;
</code></pre>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/124532108">https://blog.csdn.net/qq_32971095/article/details/124532108</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88%E7%94%B5%E6%BA%90%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%881%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88%E7%94%B5%E6%BA%90%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%881%EF%BC%89/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:48" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>992</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="学习资料来源：B站唐老师讲电赛"><a href="#学习资料来源：B站唐老师讲电赛" class="headerlink" title="学习资料来源：B站唐老师讲电赛"></a><em><strong>学习资料来源：B站唐老师讲电赛</strong></em></h2><p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.%E7%BA%BF%E6%80%A7%E7%94%B5%E6%BA%90%EF%BC%88%E7%BA%BF%E6%80%A7%E7%A8%B3%E5%8E%8B%E5%99%A8LDO%EF%BC%89%EF%BC%9AVin%E3%80%81Vout%EF%BC%9B%E5%8E%8B%E5%B7%AE%EF%BC%88Vin-V%E5%B7%AE%3EVout%E6%97%B6%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C%EF%BC%89%C2%A0%E3%80%81Ci%E3%80%81Co%EF%BC%88%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%BB%A4%E6%B3%A2%E7%94%B5%E5%AE%B9%EF%BC%8C%E9%99%8D%E5%99%AA%EF%BC%89">一.线性电源（线性稳压器LDO）：Vin、Vout；压差（Vin-V差&gt;Vout时正常工作）<br>、Ci、Co（输入输出滤波电容，降噪）</a></p>
<p><a href="about:blank#1.%E5%8F%82%E6%95%B0%EF%BC%9AVi%EF%BC%8CVo%EF%BC%88%E5%8F%AF%E8%B0%83%EF%BC%8C%E7%94%B5%E9%98%BB%E5%88%86%E5%8E%8B%EF%BC%89%EF%BC%8C%E5%8E%8B%E9%99%8D%EF%BC%8C%E8%BE%93%E5%87%BA%E7%94%B5%E6%B5%81Io%EF%BC%88max%EF%BC%89%EF%BC%8C%EF%BC%88%E5%99%AA%E5%A3%B0%EF%BC%8C%E9%9D%99%E6%80%81%E7%94%B5%E6%B5%81Iq%EF%BC%8C%E6%95%88%E7%8E%87%3DVo%2FVi%EF%BC%8C%E8%80%97%E6%95%A3%E5%8A%9F%E7%8E%87%3Dv%E5%B7%AE*Iload%EF%BC%89">1.参数：Vi，Vo（可调，电阻分压），压降，输出电流Io（max），（噪声，静态电流Iq，效率&#x3D;Vo&#x2F;Vi，耗散功率&#x3D;v差*Iload）</a></p>
<p><a href="about:blank#2.PCB">        2.PCB</a></p>
<p><a href="about:blank#%C2%A0%E4%BA%8C.%E7%94%B5%E5%AE%B9%E5%BC%8F%E5%BC%80%E5%85%B3%E7%94%B5%E6%BA%90%EF%BC%88%E7%94%B5%E8%8D%B7%E6%B3%B5%EF%BC%89"><br>二.电容式开关电源（电荷泵）</a></p>
<p><a href="about:blank#1%C2%B7%E7%A8%B3%E5%8E%8B%E5%9E%8B%E7%94%B5%E8%8D%B7%E6%B3%B5%E5%BC%80%E5%85%B3%E7%A8%B3%E5%8E%8B%E5%99%A8%E5%8E%9F%E7%90%86%EF%BC%88%E9%A3%9E%E8%B7%A8%E7%94%B5%E5%AE%B9%EF%BC%8CS1%E3%80%81S3%2FS2%E3%80%81S4%E5%88%87%E6%8D%A2%E5%BC%80%E5%85%B3%EF%BC%8CC1%E5%85%85%E6%94%BE%E7%94%B5%EF%BC%89%E2%80%8B%E7%BC%96%E8%BE%91%C2%A0%E8%B4%9F%E5%8E%8B">1·稳压型电荷泵开关稳压器原理（飞跨电容，S1、S3&#x2F;S2、S4切换开关，C1充放电）​编辑<br>负压</a></p>
<p><a href="about:blank#PCB%EF%BC%9A">PCB：</a></p>
<p><a href="about:blank#%E4%B8%89.%E7%94%B5%E6%84%9F%E5%BC%8F%E5%BC%80%E5%85%B3%E7%94%B5%E6%BA%90%EF%BC%88%E5%8F%82%E6%95%B0%EF%BC%9AVI%EF%BC%9BV0%EF%BC%9BIO%EF%BC%9B%E5%BC%80%E5%85%B3%E8%AF%84%E7%8E%87Fsw%EF%BC%9BEN%EF%BC%9BFB%EF%BC%89">三.电感式开关电源（参数：VI；V0；IO；开关评率Fsw；EN；FB）</a></p>
<p><a href="about:blank#*%E8%AE%BE%E8%AE%A1%E5%AE%9E%E4%BE%8B%EF%BC%9A">*设计实例：</a></p>
<p><a href="about:blank#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9A">解决方案：</a></p>
<hr>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/d33cf8d47d4d2de8371c40cc43edf710.png"></p>
<h2 id="一-线性电源（线性稳压器LDO）：Vin、Vout；压差（Vin-V差-Vout时正常工作）-、Ci、Co（输入输出滤波电容，降噪）"><a href="#一-线性电源（线性稳压器LDO）：Vin、Vout；压差（Vin-V差-Vout时正常工作）-、Ci、Co（输入输出滤波电容，降噪）" class="headerlink" title="一.线性电源（线性稳压器LDO）：Vin、Vout；压差（Vin-V差&gt;Vout时正常工作） 、Ci、Co（输入输出滤波电容，降噪）"></a>一.线性电源（线性稳压器LDO）：Vin、Vout；压差（Vin-V差&gt;Vout时正常工作） 、Ci、Co（输入输出滤波电容，降噪）</h2><p>常用：LM1117</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7603ed872f9f27c253be1de796edc562.png"><img src="https://i-blog.csdnimg.cn/blog_migrate/32f005e1cec50c5099ca1201cacda1cb.png"></p>
<p>（模电达林顿管）</p>
<h3 id="1-参数：Vi，Vo（可调，电阻分压），压降，输出电流Io（max），（噪声，静态电流Iq，效率-Vo-Vi，耗散功率-v差-I-load-）"><a href="#1-参数：Vi，Vo（可调，电阻分压），压降，输出电流Io（max），（噪声，静态电流Iq，效率-Vo-Vi，耗散功率-v差-I-load-）" class="headerlink" title="1.参数：Vi，Vo（可调，电阻分压），压降，输出电流Io（max），（噪声，静态电流Iq，效率&#x3D;Vo&#x2F;Vi，耗散功率&#x3D;v差*I load ）"></a>1.参数：Vi，Vo（可调，电阻分压），压降，输出电流Io（max），（噪声，静态电流Iq，效率&#x3D;Vo&#x2F;Vi，耗散功率&#x3D;v差*I <em>load</em> ）</h3><p>建立元件参数表</p>
<p>线性电源无法并联扩流</p>
<h4 id="2-PCB"><a href="#2-PCB" class="headerlink" title="2.PCB"></a>2.PCB</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/516abda141133974961903290093a41b.png"></p>
<p>PCB例子：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1e1e1ee1439d5fa0b8dc96cc70d84a13.png"><img src="https://i-blog.csdnimg.cn/blog_migrate/d4a91d9caca72e80e2bb1c0717d16977.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/fb3f95733581716c40d244efdb00fbb5.png">散热面积大，VCC连GND先过C</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a094e2dea7328ad1cc700b48f97748b4.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f7b1902e953d9978de38505d24f1141f.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e6edd9ed81123ce89e76fcd672972982.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ae73145b8a1e4c2a6707fbf38c1d0486.png"></p>
<h2 id="二-电容式开关电源（电荷泵）"><a href="#二-电容式开关电源（电荷泵）" class="headerlink" title="二.电容式开关电源（电荷泵）"></a>二.电容式开关电源（电荷泵）</h2><p>常用：HX4002（2.7~5.5-&gt;5）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c570bfe596d08bd80536caa7bc3996b7.png"></p>
<h3 id="1·稳压型电荷泵开关稳压器原理（飞跨电容，S1、S3-S2、S4切换开关，C1充放电）"><a href="#1·稳压型电荷泵开关稳压器原理（飞跨电容，S1、S3-S2、S4切换开关，C1充放电）" class="headerlink" title="1·稳压型电荷泵开关稳压器原理（飞跨电容，S1、S3&#x2F;S2、S4切换开关，C1充放电）"></a>1·稳压型电荷泵开关稳压器原理（飞跨电容，S1、S3&#x2F;S2、S4切换开关，C1充放电）</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/c1e956f406406b2a825f0b7d7c9b99a6.png"><br>负压</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/203446207be2fbe6c344b483e902a9e9.png"></p>
<p>半压（两跨容，串联充电，并联充电）、倍压反之</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d3c11d9321a69b002cc2346187f8b3f9.png"></p>
<p>ESR（等效串联电阻）；为防电流过大，跨容选2倍手册推荐大小；</p>
<p>减小纹波：加大跨容&#x2F;减小ESR；ESR：MLCC&lt;钽&lt;固态&lt;高频低阻电解&lt;电解</p>
<h3 id="PCB："><a href="#PCB：" class="headerlink" title="PCB："></a>PCB：</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/a62028779584be27bedc9a881cf1b0af.png"></p>
<p>2.稳压型（加入稳压模块）</p>
<h2 id="三-电感式开关电源（参数：VI；V0；IO；开关评率Fsw；EN；FB）"><a href="#三-电感式开关电源（参数：VI；V0；IO；开关评率Fsw；EN；FB）" class="headerlink" title="三.电感式开关电源（参数：VI；V0；IO；开关评率Fsw；EN；FB）"></a>三.电感式开关电源（参数：VI；V0；IO；开关评率Fsw；EN；FB）</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/cccdb639def67c103b72fc6c89d6bfbe.png"></p>
<p>1.开关关充电，开L&#x2F;C双供电</p>
<p>二极管续流（肖特基&#x2F;快恢复，损耗：导通压*电流）<img src="https://i-blog.csdnimg.cn/blog_migrate/01519524c2764e4bb98ef2d0d4a94422.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2abc250f6c37683f7865759f76cd83e7.png"></p>
<p> 改成负压输出的改造（接地端与原输出端互换）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2d21361e0b91acac3643071203b9c022.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/df20a2e55b8792485d63db18ccf2a9e6.png"></p>
<p>  例：SY8120I稳压芯片结构<br><img src="https://i-blog.csdnimg.cn/blog_migrate/28a2114b9b75501ad4ca1dd053b2eddd.png"></p>
<p>FB接内部误差放大器反相输入端，正向端接0.6V参考，根据RH&#x2F;RL得Vo</p>
<h3 id="设计实例："><a href="#设计实例：" class="headerlink" title="*设计实例："></a>*设计实例：</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/284bbac4e893f0274aa71c622f768211.png"></p>
<p> 注：内部电磁干扰问题（EMI），造成高频振铃信号</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/35d73073e335edcb4b1485cfe40bd770.png"></p>
<h3 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/580b343296343253de0d82c49beb967e.png"></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/131397697">https://blog.csdn.net/qq_32971095/article/details/131397697</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8A%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA%E4%BB%A3%E7%A0%81%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8A%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA%E4%BB%A3%E7%A0%81%E5%90%88%E9%9B%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:30:52" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>17k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>15 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.%E8%AF%BE%E6%9C%AC%E8%AF%BE%E5%90%8E%E4%BD%9C%E4%B8%9A%E8%A7%A3%E6%9E%90">一.课本课后作业解析</a></p>
<p><a href="about:blank#1.%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E">1.问题说明</a></p>
<p><a href="about:blank#%3C1%3E%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">&lt;1&gt;代码解析</a></p>
<p><a href="about:blank#2.%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E">2.问题说明</a></p>
<p><a href="about:blank#%C2%A0%3C1%3E%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90"> &lt;1&gt;代码解析</a></p>
<p><a href="about:blank#%C2%A03.%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E"> 3.问题说明</a></p>
<p><a href="about:blank#%3C1%3E%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">&lt;1&gt;代码解析</a></p>
<p><a href="about:blank#%C2%A04.%E9%97%AE%E9%A2%98%E8%AF%B4%E6%98%8E"> 4.问题说明</a></p>
<p><a href="about:blank#%3C1%3E%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">&lt;1&gt;代码解析</a></p>
<p><a href="about:blank#%E4%BA%8C.openGauss%E5%AE%9E%E8%B7%B5%E5%B9%B3%E5%8F%B0%E5%AE%9E%E9%AA%8C">二.openGauss实践平台实验</a></p>
<p><a href="about:blank#1.%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E6%8F%8F%E8%BF%B0">1.关系模型描述</a></p>
<p><a href="about:blank#%C2%A0%3C1%3E%E6%9E%84%E5%BB%BA%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B"><br>&lt;1&gt;构建关系模型</a></p>
<p><a href="about:blank#%3C2%3E%E6%8F%92%E5%85%A5%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%C2%A0">&lt;2&gt;插入测试数据
</a></p>
<p><a href="about:blank#2.%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90">2.问题解析</a></p>
<p><a href="about:blank#%E4%B8%89.%E4%B8%8A%E6%9C%BA%E4%BD%9C%E4%B8%9A">三.上机作业</a></p>
<p><a href="about:blank#1.%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90">1.需求分析</a></p>
<p><a href="about:blank#%3C1%3E%E5%86%85%E5%AE%B9">&lt;1&gt;内容</a></p>
<p><a href="about:blank#%3C2%3E%E5%9F%BA%E6%9C%AC%E8%A6%81%E6%B1%82">&lt;2&gt;基本要求</a></p>
<p><a href="about:blank#2.%E6%A6%82%E5%BF%B5%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1">2.概念结构设计</a></p>
<p><a href="about:blank#%3C1%3E%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E4%B9%89">&lt;1&gt;数据库语义</a></p>
<p><a href="about:blank#%3C2%3EE-R%E5%9B%BE%E8%AE%BE%E8%AE%A1">&lt;2&gt;E-R图设计</a></p>
<p><a href="about:blank#3.%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1">3.逻辑结构设计</a></p>
<p><a href="about:blank#%EF%BC%881%EF%BC%89%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B">（1）关系模型</a></p>
<p><a href="about:blank#4.%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0">4.功能实现</a></p>
<p><a href="about:blank#%3C1%3E%E5%BB%BA%E5%BA%93%E6%97%B6%E5%BA%94%E5%BD%95%E5%85%A5%E4%B8%80%E5%AE%9A%E6%95%B0%E9%87%8F%E7%9A%84%EF%BC%88%E4%B8%8D%E8%83%BD%E8%BF%87%E5%B0%91%EF%BC%89%E5%AD%A6%E7%94%9F%E3%80%81%E6%95%99%E5%B8%88%E3%80%81%E8%AF%BE%E7%A8%8B%E3%80%81%E6%88%90%E7%BB%A9%E7%AD%89%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF">&lt;1&gt;建库时应录入一定数量的（不能过少）学生、教师、课程、成绩等基本信息</a></p>
<p><a href="about:blank#%3C2%3E%E5%BD%95%E5%85%A5%E4%B8%80%E4%BD%8D%E5%AD%A6%E7%94%9F%EF%BC%8C%E5%BA%94%E5%8C%85%E5%90%AB%E5%AD%A6%E5%8F%B7%E3%80%81%E5%A7%93%E5%90%8D%E3%80%81%E6%80%A7%E5%88%AB%E3%80%81%E5%87%BA%E7%94%9F%E5%B9%B4%E6%9C%88%E3%80%81%E7%8F%AD%E7%BA%A7%E7%AD%89%E4%BF%A1%E6%81%AF">&lt;2&gt;录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息</a></p>
<p><a href="about:blank#%3C3%3E%E6%8C%89%E5%AD%A6%E5%8F%B7%E3%80%81%E5%A7%93%E5%90%8D%E3%80%81%E4%B8%93%E4%B8%9A%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%E6%9F%A5%E8%AF%A2%E5%AD%A6%E7%94%9F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF">&lt;3&gt;按学号、姓名、专业三种方式查询学生基本信息</a></p>
<p><a href="about:blank#%3C4%3E%E5%BD%95%E5%85%A5%E4%B8%80%E4%BD%8D%E5%AD%A6%E7%94%9F%E4%B8%80%E9%97%A8%E8%AF%BE%E7%9A%84%E6%88%90%E7%BB%A9">&lt;4&gt;录入一位学生一门课的成绩</a></p>
<p><a href="about:blank#%3C5%3E%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%BD%8D%E5%AD%A6%E7%94%9F%E6%89%80%E4%BF%AE%E7%9A%84%E8%AF%BE%E7%A8%8B%E3%80%81%E6%80%A7%E8%B4%A8%EF%BC%88%E5%BF%85%E4%BF%AE%E6%88%96%E9%80%89%E4%BF%AE%EF%BC%89%E3%80%81%E5%AD%A6%E6%9C%9F%E3%80%81%E5%AD%A6%E5%88%86%E5%8F%8A%E6%88%90%E7%BB%A9">&lt;5&gt;查询一位学生所修的课程、性质（必修或选修）、学期、学分及成绩</a></p>
<p><a href="about:blank#%3C6%3E%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%BD%8D%E5%AD%A6%E7%94%9F%E8%A2%AB%E5%93%AA%E4%BA%9B%E6%95%99%E5%B8%88%E6%95%99%E8%BF%87%E8%AF%BE">&lt;6&gt;查询一位学生被哪些教师教过课</a></p>
<p><a href="about:blank#%3C7%3E%E6%9F%A5%E8%AF%A2%E5%BF%AB%E8%A6%81%E8%A2%AB%E5%BC%80%E9%99%A4%E7%9A%84%E5%AD%A6%E7%94%9F%EF%BC%88%E8%B7%9D%E8%A2%AB%E5%BC%80%E9%99%A4%E5%B7%AE3%E5%AD%A6%E5%88%86%E4%B9%8B%E5%86%85%EF%BC%89">&lt;7&gt;查询快要被开除的学生（距被开除差3学分之内）</a></p>
<p><a href="about:blank#5.%E4%B8%BB%E8%A6%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3">5.主要问题及解决</a></p>
<p><a href="about:blank#6.%E6%80%BB%E7%BB%93">6.总结</a></p>
<p><a href="about:blank#7.%E9%99%84%E5%BD%95">7.附录</a></p>
<p><a href="about:blank#%3C1%3ETXT%E8%BD%ACSQL%20C%E8%AF%AD%E8%A8%80%E7%A8%8B%E5%BA%8F%E8%84%9A%E6%9C%AC">&lt;1&gt;TXT转SQL<br>C语言程序脚本</a></p>
<hr>
<h2 id="一-课本课后作业解析"><a href="#一-课本课后作业解析" class="headerlink" title="一.课本课后作业解析"></a>一.课本课后作业解析</h2><h3 id="1-问题说明"><a href="#1-问题说明" class="headerlink" title="1.问题说明"></a>1.问题说明</h3><pre><code>    用SQL语句建立第2章习题6中的4个表（要求给出主码和外码约束，但无需插入记录）：
</code></pre>
<p>设有一个SPJ数据库，包括S，P，J及SPJ4个关系模式：</p>
<p>S(SNO, SNAME, STATUS, CITY);</p>
<p>P(PNO, PNAME, COLOR, WEIGHT);</p>
<p>J(JNO, JNAME, CITY);</p>
<p>SPJ(SNO, PNO, JNO, QTY)。</p>
<pre><code>    供应商表S由供应商代码（SNO）、供应商姓名（SNAME）、供应商状态（STATUS）、供应商所在城市（CITY）组成。

    零件表P由零件代码（PNO）、零件名（PNAME）、颜色（COLOR）、重量（WEIGHT）组成。

    工程项目表J由工程项目代码（JNO）、工程项目名（JNAME）、工程项目所在城市（CITY）组成。

    供应情况表SPJ由供应商代码（SNO）、零件代码（PNO）、工程项目代码（JNO）、供应数量（QTY）组成，表示某供应商供应某种零件给某工程项目的数量为QTY。
</code></pre>
<h4 id="代码解析"><a href="#代码解析" class="headerlink" title="&lt;1&gt;代码解析"></a>&lt;1&gt;代码解析</h4><pre><code>/*-- 删除已有的表*/
/*-- 注意要先删除参照表（如SC），再删除被参照表（如Student，Course）*/
DROP TABLE SPJ;
DROP TABLE S;
DROP TABLE P;
DROP TABLE J;


/*创建基本表*/
/*注意要先创建被参照表，再创建参照表*/
CREATE TABLE S(
SNO CHAR(10) PRIMARY KEY,	/*-- 列级完整性约束的方式，定义主码*/
SNAME CHAR(20),
STATUS INT,
CITY CHAR(10)
); 

CREATE TABLE P(
PNO CHAR(10) PRIMARY KEY,
PNAME CHAR(20),
COLOR CHAR(10),
WEIGHT CHAR(10)
);

CREATE TABLE J(
JNO CHAR(10) PRIMARY KEY,
JNAME CHAR(20),
CITY CHAR(10)
);

CREATE TABLE SPJ(
SNO CHAR(10),
PNO CHAR(10),
JNO CHAR(10),
QTY INT,
PRIMARY KEY (SNO,PNO,JNO),
FOREIGN KEY (SNO) REFERENCES S(SNO),	/*-- 表级完整性约束的方式，定义外码；注意参照列Cpno必须加括号*/
FOREIGN KEY (PNO) REFERENCES P(PNO),	
FOREIGN KEY (JNO) REFERENCES J(JNO)	
);
</code></pre>
<p>插入测试数据：</p>
<pre><code>/*-- 向基本表中插入数据*/
INSERT INTO S VALUES (&#39;S1&#39;,&#39;精益&#39;,20,&#39;天津&#39;);
INSERT INTO S VALUES (&#39;S2&#39;,&#39;盛锡&#39;,10,&#39;北京&#39;);
INSERT INTO S VALUES (&#39;S3&#39;,&#39;东方红&#39;,30,&#39;北京&#39;);
INSERT INTO S VALUES (&#39;S4&#39;,&#39;丰泰盛&#39;,20,&#39;天津&#39;);
INSERT INTO S VALUES (&#39;S5&#39;,&#39;为民&#39;,20,&#39;上海&#39;);

/*-- 如果根据参照关系表中一行参照了另外一行，应先插入被参照行（如(&#39;6&#39;,...,...,...)），后插入参照行（如(...,...,&#39;6&#39;,...)）*/
INSERT INTO P VALUES (&#39;P1&#39;,&#39;螺母&#39;,&#39;红&#39;,12);
INSERT INTO P VALUES (&#39;P2&#39;,&#39;螺栓&#39;,&#39;绿&#39;,17);
INSERT INTO P VALUES (&#39;P3&#39;,&#39;螺丝刀&#39;,&#39;蓝&#39;,14);
INSERT INTO P VALUES (&#39;P4&#39;,&#39;螺丝刀&#39;,&#39;红&#39;,14);
INSERT INTO P VALUES (&#39;P5&#39;,&#39;凸轮&#39;,&#39;蓝&#39;,40);
INSERT INTO P VALUES (&#39;P6&#39;,&#39;齿轮&#39;,&#39;红&#39;,30);

INSERT INTO J VALUES (&#39;J1&#39;,&#39;三建&#39;,&#39;北京&#39;);
INSERT INTO J VALUES (&#39;J2&#39;,&#39;一汽&#39;,&#39;长春&#39;);
INSERT INTO J VALUES (&#39;J3&#39;,&#39;弹簧厂&#39;,&#39;天津&#39;);
INSERT INTO J VALUES (&#39;J4&#39;,&#39;造船厂&#39;,&#39;天津&#39;);
INSERT INTO J VALUES (&#39;J5&#39;,&#39;机车厂&#39;,&#39;唐山&#39;);
INSERT INTO J VALUES (&#39;J6&#39;,&#39;无线电厂&#39;,&#39;常州&#39;);
INSERT INTO J VALUES (&#39;J7&#39;,&#39;半导体厂&#39;,&#39;南京&#39;);

INSERT INTO SPJ VALUES (&#39;S1&#39;,&#39;P1&#39;,&#39;J1&#39;,200);
INSERT INTO SPJ VALUES (&#39;S1&#39;,&#39;P1&#39;,&#39;J3&#39;,100);
INSERT INTO SPJ VALUES (&#39;S1&#39;,&#39;P1&#39;,&#39;J4&#39;,700);
INSERT INTO SPJ VALUES (&#39;S1&#39;,&#39;P2&#39;,&#39;J2&#39;,100);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P3&#39;,&#39;J1&#39;,400);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P3&#39;,&#39;J2&#39;,200);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P3&#39;,&#39;J4&#39;,500);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P3&#39;,&#39;J5&#39;,400);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P5&#39;,&#39;J1&#39;,400);
INSERT INTO SPJ VALUES (&#39;S2&#39;,&#39;P5&#39;,&#39;J2&#39;,100);
INSERT INTO SPJ VALUES (&#39;S3&#39;,&#39;P1&#39;,&#39;J1&#39;,200);
INSERT INTO SPJ VALUES (&#39;S3&#39;,&#39;P3&#39;,&#39;J1&#39;,200);
INSERT INTO SPJ VALUES (&#39;S4&#39;,&#39;P5&#39;,&#39;J1&#39;,100);
INSERT INTO SPJ VALUES (&#39;S4&#39;,&#39;P6&#39;,&#39;J3&#39;,300);
INSERT INTO SPJ VALUES (&#39;S4&#39;,&#39;P6&#39;,&#39;J4&#39;,200);
INSERT INTO SPJ VALUES (&#39;S5&#39;,&#39;P2&#39;,&#39;J4&#39;,100);
INSERT INTO SPJ VALUES (&#39;S5&#39;,&#39;P3&#39;,&#39;J1&#39;,200);
INSERT INTO SPJ VALUES (&#39;S5&#39;,&#39;P6&#39;,&#39;J2&#39;,200);
INSERT INTO SPJ VALUES (&#39;S5&#39;,&#39;P6&#39;,&#39;J4&#39;,500);
</code></pre>
<h3 id="2-问题说明"><a href="#2-问题说明" class="headerlink" title="2.问题说明"></a>2.问题说明</h3><p>针对建立的4个表用SQL完成第2章习题6中的查询：</p>
<p>（1）求供应工程J1零件的供应商号码SNO；</p>
<p>（2）求供应工程J1零件P1的供应商号码SNO;</p>
<p>（3）求供应工程J1零件为红色的供应商号码SNO；</p>
<p>（4）求没有使用天津供应商生产的红色零件的工程号JNO；</p>
<p>（5）求至少使用了供应商S1所供应的全部零件的工程号JNO。</p>
<h4 id="代码解析-1"><a href="#代码解析-1" class="headerlink" title="&lt;1&gt;代码解析"></a>&lt;1&gt;代码解析</h4><pre><code>/*求供应工程J1零件的供应商号码SNO*/
SELECT DISTINCT SNO
FROM SPJ
WHERE JNO=&#39;J1&#39;;

/*求供应工程J1零件P1的供应商号码SNO*/
SELECT DISTINCT SNO
FROM SPJ
WHERE JNO=&#39;J1&#39; AND PNO=&#39;P1&#39;;

/*求供应工程J1零件为红色的供应商号码SNO*/
SELECT DISTINCT SNO
FROM SPJ
WHERE JNO=&#39;J1&#39; AND PNO IN(
    SELECT DISTINCT PNO
    FROM P
    WHERE COLOR=&#39;红&#39;
);

/*求没有使用天津供应商生产的红色零件的工程号JNO*/
SELECT DISTINCT JNO
FROM SPJ
WHERE SNO NOT IN (
    SELECT SNO
    FROM S
    WHERE CITY=&#39;天津&#39;
    ) OR PNO NOT IN(
        SELECT DISTINCT PNO
        FROM P
        WHERE COLOR=&#39;红&#39;
);

/*求至少使用了供应商S1所供应的全部零件的工程号JNO*/
/*方法一*/
SELECT DISTINCT JNO
FROM SPJ
WHERE SNO=&#39;S1&#39;
GROUP BY JNO 
HAVING COUNT(PNO)=(SELECT COUNT(DISTINCT PNO) FROM SPJ WHERE SNO=&#39;S1&#39;);

/*方法二*/
SELECT DISTINCT JNO
FROM SPJ X
WHERE NOT EXISTS(
    SELECT DISTINCT PNO
    FROM SPJ Y
    WHERE SNO=&#39;S1&#39; AND NOT EXISTS(
        SELECT *
        FROM SPJ Z
        WHERE Z.SNO=&#39;S1&#39; AND Y.PNO=Z.PNO AND X.JNO=Z.JNO
    )
);
</code></pre>
<h3 id="3-问题说明"><a href="#3-问题说明" class="headerlink" title="3.问题说明"></a>3.问题说明</h3><p>针对建立的4个表用SQL完成一下各项操作：</p>
<p>（1）找出所有供应商的姓名和所在城市；</p>
<p>（2）找出所有零件的名称、颜色、重量；</p>
<p>（3）找出使用供应商S1所供应零件的工程号码；</p>
<p>（4）找出工程项目J2使用的各种零件的名称及其数量；</p>
<p>（5）找出上海厂商供应的所有零件号码；</p>
<p>（6）找出使用上海产的零件的工程名称；</p>
<p>（7）找出没有使用天津产的零件的工程号码；</p>
<p>（8）把全部红色零件的颜色改成蓝色；</p>
<p>（9）由S5供给J4的零件P6改为由S3供应，请作出必要的修改；</p>
<p>（10）从供应商关系中删除S2的记录，并从供应情况关系中删除相应的记录；</p>
<p>（11）请将(S2,J6,P4,200)插入供应情况关系。</p>
<h4 id="代码解析-2"><a href="#代码解析-2" class="headerlink" title="&lt;1&gt;代码解析"></a>&lt;1&gt;代码解析</h4><pre><code>/*找出所有供应商的姓名和所在城市*/
SELECT SNAME,CITY
FROM S;

/*找出所有零件的名称、颜色、重量*/
SELECT PNAME,COLOR,WEIGHT
FROM P;

/*找出使用供应商S1所供应零件的工程号码*/
SELECT DISTINCT JNO
FROM SPJ
WHERE SNO=&#39;S1&#39;;

/*找出工程项目J2使用的各种零件的名称及其数量*/
SELECT PNAME,QTY
FROM SPJ,P
WHERE SPJ.PNO=P.PNO AND JNO=&#39;J2&#39;;

/*找出上海厂商供应的所有零件号码*/
SELECT DISTINCT PNO
FROM SPJ,S
WHERE SPJ.SNO=S.SNO AND CITY=&#39;上海&#39;;

/*找出使用上海产的零件的工程名称*/
SELECT DISTINCT JNO
FROM SPJ,S
WHERE SPJ.SNO=S.SNO AND CITY=&#39;上海&#39;;

/*找出没有使用天津产的零件的工程号码*/
SELECT DISTINCT JNO
FROM SPJ,S
WHERE SPJ.SNO=S.SNO AND CITY!=&#39;天津&#39;;

/*把全部红色零件的颜色改成蓝色*/
UPDATE P
SET COLOR=&#39;蓝&#39;
WHERE COLOR=&#39;红&#39;;

/*由S5供给J4的零件P6改为由S3供应，请作出必要的修改*/
UPDATE SPJ
SET SNO=&#39;S3&#39;
WHERE SNO=&#39;S5&#39; AND PNO=&#39;P6&#39; AND JNO=&#39;J4&#39;;

/*从供应商关系中删除S2的记录，并从供应情况关系中删除相应的记录*/
ALTER TABLE SPJ 
ADD FOREIGN KEY (SNO) REFERENCES S(SNO) ON DELETE CASCADE;/*添加外键，设置级联删除*/
DELETE FROM S WHERE SNO=&#39;S2&#39;;


/*请将(S2,J6,P4,200)插入供应情况关系*/
INSERT INTO SPJ VALUES (&#39;S1&#39;,&#39;P1&#39;,&#39;J1&#39;,200);
</code></pre>
<h3 id="4-问题说明"><a href="#4-问题说明" class="headerlink" title="4.问题说明"></a>4.问题说明</h3><pre><code>    请为三建工程项目建立一个供应情况的视图，包括供应商代码（SNO）、零件代码（PNO）、供应数量（QTY）。针对该视图完成下列查询：
</code></pre>
<p>（1）找出三建工程项目使用的各种零件代码及其数量；</p>
<p>（2）找出供应商S1的供应情况。</p>
<h4 id="代码解析-3"><a href="#代码解析-3" class="headerlink" title="&lt;1&gt;代码解析"></a>&lt;1&gt;代码解析</h4><pre><code>/*为三建工程项目建立一个供应情况的视图，包括供应商代码（SNO）、零件代码（PNO）、供应数量（QTY）*/
CREATE VIEW PROD(SNO,PNO,QTY)
AS
SELECT SNO,PNO,QTY
FROM SPJ
WHERE JNO=&#39;J1&#39;

/*找出三建工程项目使用的各种零件代码及其数量*/
SELECT PNO,SUM(QTY)
FROM PROD
GROUP BY PNO;


/*找出供应商S1的供应情况*/
SELECT PNO,QTY
FROM PROD
WHERE SNO=&#39;S1&#39;;
</code></pre>
<h2 id="二-openGauss实践平台实验"><a href="#二-openGauss实践平台实验" class="headerlink" title="二.openGauss实践平台实验"></a>二.openGauss实践平台实验</h2><h3 id="1-关系模型描述"><a href="#1-关系模型描述" class="headerlink" title="1.关系模型描述"></a>1.关系模型描述</h3><p>学籍管理数据库有如下关系模式：</p>
<p>学生Student（学号Sno，姓名Sname，性别Ssex，年龄Sage，系别Sdept）；</p>
<p>课程Course（课程号Cno，课程名称Cname，先修课Cpno，学分Ccredit）；</p>
<p>成绩SC（学号Sno，课程号Cno，成绩Grade）。</p>
<h4 id="构建关系模型"><a href="#构建关系模型" class="headerlink" title="&lt;1&gt;构建关系模型"></a>&lt;1&gt;构建关系模型</h4><pre><code>/*构建关系模型*/
CREATE TABLE Student(
    Sno CHAR(10) PRIMARY KEY,	/*-- 列级完整性约束的方式，定义主码*/
    Sname CHAR(20),
    Ssex CHAR(10),
    Sage INT,
    Sdept CHAR(10)
);

CREATE TABLE Course(
    Cno CHAR(10) PRIMARY KEY,	/*-- 列级完整性约束的方式，定义主码*/
    Cname CHAR(20),
    Cpno CHAR(10),
    Ccredit INT
);

CREATE TABLE SC(
    Sno CHAR(10),
    Cno CHAR(10),
    Grade INT,
    PRIMARY KEY (Sno,Cno),
    FOREIGN KEY (Sno) REFERENCES Student(Sno),	/*-- 表级完整性约束的方式，定义外码；注意参照列Cpno必须加括号*/
    FOREIGN KEY (Cno) REFERENCES Course(Cno)
);
</code></pre>
<h4 id="插入测试数据"><a href="#插入测试数据" class="headerlink" title="&lt;2&gt;插入测试数据"></a>&lt;2&gt;插入测试数据</h4><pre><code>/*插入示例数据*/
INSERT INTO Student VALUES (&#39;1&#39;,&#39;SWQ&#39;,&#39;男&#39;,20,&#39;CS&#39;);
INSERT INTO Student VALUES (&#39;2&#39;,&#39;SSS&#39;,&#39;男&#39;,19,&#39;CS&#39;);
INSERT INTO Student VALUES (&#39;3&#39;,&#39;WWW&#39;,&#39;男&#39;,17,&#39;CS&#39;);
INSERT INTO Student VALUES (&#39;4&#39;,&#39;QQQ&#39;,&#39;男&#39;,17,&#39;IS&#39;);

INSERT INTO Course VALUES (&#39;1&#39;,&#39;OS&#39;,&#39;2&#39;,4);
INSERT INTO Course VALUES (&#39;2&#39;,&#39;MATH&#39;,&#39;3&#39;,5);
INSERT INTO Course VALUES (&#39;3&#39;,&#39;ENG&#39;,&#39;3&#39;,2);

INSERT INTO SC VALUES (&#39;1&#39;,&#39;1&#39;,94);
INSERT INTO SC VALUES (&#39;2&#39;,&#39;1&#39;,85);
INSERT INTO SC VALUES (&#39;3&#39;,&#39;1&#39;,72);
INSERT INTO SC VALUES (&#39;4&#39;,&#39;1&#39;,94);
INSERT INTO SC VALUES (&#39;1&#39;,&#39;2&#39;,69);
INSERT INTO SC VALUES (&#39;2&#39;,&#39;2&#39;,99);
INSERT INTO SC VALUES (&#39;3&#39;,&#39;2&#39;,77);
INSERT INTO SC VALUES (&#39;4&#39;,&#39;2&#39;,58);
INSERT INTO SC VALUES (&#39;1&#39;,&#39;3&#39;,100);
INSERT INTO SC VALUES (&#39;2&#39;,&#39;3&#39;,78);
INSERT INTO SC VALUES (&#39;3&#39;,&#39;3&#39;,87);
INSERT INTO SC VALUES (&#39;4&#39;,&#39;3&#39;,67);
</code></pre>
<h3 id="2-问题解析"><a href="#2-问题解析" class="headerlink" title="2.问题解析"></a>2.问题解析</h3><pre><code>/*查询年龄不大于19的“女”生的学号和姓名。*/
SELECT Sno,Sname
FROM Student
WHERE Sage&lt;20 AND Ssex=&#39;女&#39;;

/*查询所有姓“王”的学生的学号、姓名和性别。*/
SELECT Sno,Sname,Ssex
FROM Student
WHERE Sname LIKE &#39;王%&#39;;

/*查询“CS”系年龄大于本系平均年龄的学生的学号、姓名和年龄。*/
SELECT Sno,Sname,Sage
FROM Student X
WHERE Sdept=&#39;CS&#39; AND Sage&gt;(
    SELECT AVG(Sage)
    FROM Student
    GROUP BY Sdept
    HAVING Sdept=&#39;CS&#39;
)

/*
错误写法：
SELECT Sno,Sname,Sage
FROM Student
WHERE Sdept=&#39;CS&#39;
GROUP BY Sdept
HAVING Sage&gt;AVG(Sage);
*/

/*查询每门课程的课程号、课程名、平均成绩、最低成绩和最高成绩。*/
SELECT DISTINCT Course.Cno,Cname,AVG(Grade),MIN(Grade),MAX(Grade)
FROM Course,SC
WHERE Course.Cno=SC.Cno
GROUP BY Course.Cno;

/*查询至少选修了学号为“200215121”的学生所选全部课程*/
SELECT Sno
FROM Student
WHERE NOT EXISTS(
    SELECT Cno
    FROM SC X
    WHERE Sno=&#39;200215121&#39; AND NOT EXISTS(
        SELECT *
        FROM SC Y
        WHERE Y.Sno=Student.Sno AND X.Cno=Y.Cno
    )
);

/*查询每门课程分数排名第1的学生学号、课程号和成绩。*/
SELECT Sno,Cno,Grade
FROM SC X
WHERE NOT EXISTS(
    SELECT *
    FROM SC Y
    WHERE X.Cno=Y.Cno AND Y.Grade&gt;X.Grade
);

/*查询每门课程分数排名第2的学生学号、课程号和成绩。*/
SELECT Sno,Cno,Grade
FROM SC X
WHERE EXISTS(
    SELECT Cno
    FROM SC Y
    WHERE X.Cno=Y.Cno AND X.Grade&lt;Y.Grade
    GROUP BY Y.Cno
    HAVING COUNT(Y.Sno)=1
);

/*将一个新学生元组（学号：200215228；姓名：陈冬；性别*/
INSERT
INTO Student(Sno,Sname,Ssex,Sage,Sdept)
VALUES(&#39;200215228&#39;,&#39;陈冬&#39;,&#39;男&#39;,18,&#39;IS&#39;);

/*将所有学生的年龄增加1岁。*/
UPDATE Student
SET Sage=Sage+1;

/*删除学号为“200215122”的学生的选课记录。*/
DELETE
FROM SC
WHERE Sno=&#39;200215122&#39;;

/*创建视图View_IS，找出Sdept为IS的学生的学号*/
CREATE VIEW View_IS(Sno,Sname)
AS
SELECT Sno,Sname
FROM Student
WHERE Sdept=&#39;IS&#39;;
</code></pre>
<h2 id="三-上机作业"><a href="#三-上机作业" class="headerlink" title="三.上机作业"></a>三.上机作业</h2><h3 id="1-需求分析"><a href="#1-需求分析" class="headerlink" title="1.需求分析"></a>1.需求分析</h3><h4 id="内容"><a href="#内容" class="headerlink" title="&lt;1&gt;内容"></a>&lt;1&gt;内容</h4><pre><code>    为某大学设计一套学籍管理数据库系统
</code></pre>
<h4 id="基本要求"><a href="#基本要求" class="headerlink" title="&lt;2&gt;基本要求"></a>&lt;2&gt;基本要求</h4><p>①设计学籍管理数据库，符合给定的语义（P3），并实现一定的功能需求（P4）<br>②使用一种DBMS，如SQL Server，具体不限</p>
<h3 id="2-概念结构设计"><a href="#2-概念结构设计" class="headerlink" title="2.概念结构设计"></a>2.概念结构设计</h3><h4 id="数据库语义"><a href="#数据库语义" class="headerlink" title="&lt;1&gt;数据库语义"></a>&lt;1&gt;数据库语义</h4><p>①学校有若干专业，每个专业每年招若干个班，每个班有若干学生<br>②每个专业有自己的教学计划，规定了该专业相关课程的性质（必修或选修）以及授课学期；例如，数据库课程对计算机专业为必修、在大三上学期，但对数学专业可能为选修、在大三下学期，而中文专业可能不学这门课<br>③一位教师可以给多个班带课，但不能给一个班带多门课<br>④一门课程最多允许学生一次补考；学生达到如下条件之一的被开除：不及格必修课累计达10学分、或不及格选修课累计达15学分<br>⑤上述语义未涉及到的事项和细节，可自行做出合理假定</p>
<h4 id="E-R图设计"><a href="#E-R图设计" class="headerlink" title="&lt;2&gt;E-R图设计"></a>&lt;2&gt;E-R图设计</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/912e583d76c9b2ec0803211714b62171.png"></p>
<h3 id="3-逻辑结构设计"><a href="#3-逻辑结构设计" class="headerlink" title="3.逻辑结构设计"></a>3.逻辑结构设计</h3><h4 id="（1）关系模型"><a href="#（1）关系模型" class="headerlink" title="（1）关系模型"></a>（1）关系模型</h4><pre><code>DROP TABLE Schedule;
DROP TABLE SC;
DROP TABLE Student;
DROP TABLE Teather;
DROP TABLE Course;
DROP TABLE Class;
DROP TABLE Department;
</code></pre>
<p>专业信息表（专业代号和专业名）：</p>
<pre><code>CREATE TABLE Department(
    Dept CHAR(10) PRIMARY KEY,
    Dname CHAR(75)
);
</code></pre>
<p>班级表（班级编号和从属专业）：</p>
<pre><code>CREATE TABLE Class(
    Class_no CHAR(10) PRIMARY KEY,
    Dept CHAR(10),
    FOREIGN KEY (Dept) REFERENCES Department(Dept) ON DELETE CASCADE
);
</code></pre>
<p>学生表（学号、姓名、性别、出生年月、从属班级）：</p>
<pre><code>CREATE TABLE Student(
    Sno CHAR(10) PRIMARY KEY,
    Sname CHAR(20),
    Ssex CHAR(4),
    Sbrith CHAR(10),
    Class_no CHAR(20),
    FOREIGN KEY (Class_no) REFERENCES Class(Class_no) ON DELETE CASCADE
);
</code></pre>
<p>课程表（课程号、课程名、从属专业、必&#x2F;选修、开课时间、学分）：</p>
<pre><code>CREATE TABLE Course(
    Cno CHAR(20) PRIMARY KEY,
    Cname CHAR(75),
    Dept CHAR(10),
    Creq CHAR(10),
    Cterm CHAR(20),
    Ccredit INT,
    FOREIGN KEY (Dept) REFERENCES Department(Dept) ON DELETE CASCADE
);
</code></pre>
<p>教师表（编号、姓名、所带课程）：</p>
<pre><code>CREATE TABLE Teacher(
    Tno CHAR(10) PRIMARY KEY,
    Tname CHAR(20),
    Cno CHAR(10),
    FOREIGN KEY (Cno) REFERENCES Course(Cno) ON DELETE CASCADE
);
</code></pre>
<p>上课表（班级、老师、课程号）：</p>
<pre><code>CREATE TABLE Schedule(
    Class_no CHAR(10),
    Cno CHAR(10),
    Tno CHAR(10),
    PRIMARY KEY (Class_no,Cno),
    FOREIGN KEY (Class_no) REFERENCES Class(Class_no) ON DELETE CASCADE,
    FOREIGN KEY (Cno) REFERENCES Course(Cno) ON DELETE CASCADE,
    FOREIGN KEY (Tno) REFERENCES Teacher(Tno) ON DELETE CASCADE
);
</code></pre>
<p>成绩表（学号、课程号、成绩）：</p>
<pre><code>CREATE TABLE SC(
    Sno CHAR(10),
    Cno CHAR(10),
    Score INT,
    PRIMARY KEY (Sno,Cno),
    FOREIGN KEY (Sno) REFERENCES Student(Sno) ON DELETE CASCADE,
     FOREIGN KEY (Cno) REFERENCES Course(Cno) ON DELETE CASCADE
);
</code></pre>
<p>其中相关约束条件均实现，各个编号的主码约束及引用约束。  </p>
<h3 id="4-功能实现"><a href="#4-功能实现" class="headerlink" title="4.功能实现"></a>4.功能实现</h3><p>*说明：由于示例数据数量庞大且与自己设计的表格结构不同，如果要在示例数据中自行添加其他信息过于繁杂，于是将课程信息表Course和学生信息表Student拆分成两部分，基本信息和细节信息表_Detail。见下面示例。<br>本数据库的功能实现采用MySQL软件实现，安装过程参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_64338546/article/details/127149096?spm=1001.2014.3001.5506" title="【MySQL基础】MySQL介绍及安装">【MySQL基础】MySQL介绍及安装<img src="https://i-blog.csdnimg.cn/blog_migrate/003a2ce7eb50c2e24a8c624c260c5930.png" alt="icon-
default.png?t&#x3D;N7T8">https://blog.csdn.net/m0_64338546&#x2F;article&#x2F;details&#x2F;127149096?spm&#x3D;1001.2014.3001.5506</a>完成后进入界面如下：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1f4aa57e5edc0f357d8688c3877bb324.png"></p>
<p> 建表结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/226e6c620c54190be5bd6eabc8a25a30.png"></p>
<p>另外可使用table_status和desc命令查看表格详细数据：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/cde497672b0b674364b7e6fbc2bc75ad.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/bb274a08847e8854f4719fcce5fb89a4.png"></p>
<h4 id="建库时应录入一定数量的（不能过少）学生、教师、课程、成绩等基本信息"><a href="#建库时应录入一定数量的（不能过少）学生、教师、课程、成绩等基本信息" class="headerlink" title="&lt;1&gt;建库时应录入一定数量的（不能过少）学生、教师、课程、成绩等基本信息"></a>&lt;1&gt;建库时应录入一定数量的（不能过少）学生、教师、课程、成绩等基本信息</h4><p>将示例数据文件通过C语言程序导出SQL插入信息语句，如下：</p>
<p>示例数据：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ba24a79a9bde63b6f40780345bc96984.png"></p>
<p>导出的SQL插入语句：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c20b757c92574505beb2946017fb2a29.png"></p>
<p>插入结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/dd918f68acfc938d9057152b7a15b0b0.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d3057357a7d4e952deced2417493b28d.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4c6794ab2d25179d8b29f1c4bd9f6533.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c80ab3a13c2d49e9a14e3314fdfc8d47.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c3db46ba539941fed33d161dc47b0762.png"></p>
<h4 id="录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息"><a href="#录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息" class="headerlink" title="&lt;2&gt;录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息"></a>&lt;2&gt;录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息</h4><pre><code>/*录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息*/
INSERT INTO Student (Sno, Sname, Ssex, Sbrith, Class_no) VALUES (&#39;03051108&#39;,&#39;司武强&#39;,&#39;男&#39;,&#39;20030411&#39;,&#39;2103014&#39;);
</code></pre>
<p>实际拆分成两部分插入：</p>
<pre><code>/*录入一位学生，应包含学号、姓名、性别、出生年月、班级等信息*/
INSERT INTO Student (Sno, Sname, Ssex) VALUES (&#39;03051109&#39;,&#39;司武强&#39;,&#39;男&#39;);
INSERT INTO Student_Detail (Sno, Sbrith, Class_no) VALUES (&#39;03051109&#39;,&#39;20030411&#39;,&#39;210101&#39;);
</code></pre>
<h4 id="按学号、姓名、专业三种方式查询学生基本信息"><a href="#按学号、姓名、专业三种方式查询学生基本信息" class="headerlink" title="&lt;3&gt;按学号、姓名、专业三种方式查询学生基本信息"></a>&lt;3&gt;按学号、姓名、专业三种方式查询学生基本信息</h4><pre><code>/*按学号、姓名、专业三种方式查询学生基本信息*/
SELECT *
FROM Student
WHERE Sno=&#39;03051108&#39;;

SELECT *
FROM Student
WHERE Sname=&#39;司武强&#39;;

SELECT *
FROM Student,Class
WHERE Student.Class_no=Class.Class_no AND Dept=&#39;CS&#39;;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f0fd577e9a6cc2cb7c09c1023cc9d8bc.png"></p>
<h4 id="录入一位学生一门课的成绩"><a href="#录入一位学生一门课的成绩" class="headerlink" title="&lt;4&gt;录入一位学生一门课的成绩"></a>&lt;4&gt;录入一位学生一门课的成绩</h4><pre><code>/*录入一位学生一门课的成绩*/
INSERT INTO SC (Sno,Cno,Score) VALUES (&#39;03051108&#39;,&#39;CS3121014&#39;,99);
</code></pre>
<p>录入结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/98e6d06dd16ce5436e2aac93f85ad6cd.png"></p>
<h4 id="查询一位学生所修的课程、性质（必修或选修）、学期、学分及成绩"><a href="#查询一位学生所修的课程、性质（必修或选修）、学期、学分及成绩" class="headerlink" title="&lt;5&gt;查询一位学生所修的课程、性质（必修或选修）、学期、学分及成绩"></a>&lt;5&gt;查询一位学生所修的课程、性质（必修或选修）、学期、学分及成绩</h4><pre><code>SELECT Student.Sno,Sname,Cname,Creq,Cterm,Score
FROM Course,SC,Student
WHERE Course.Cno=SC.Cno AND SC.Sno=Student.Sno AND (Student.Sno=&#39;03051108&#39; OR Sname=&#39;司武强&#39;);
</code></pre>
<p>查询他的必修课平均成绩：</p>
<pre><code>SELECT AVG(Score)
FROM SC
WHERE Sno=&#39;03051108&#39; AND EXISTS(
    SELECT *
    FROM Course
    WHERE SC.Cno=Course.Cno AND Course.Creq=&#39;必修&#39;
);
/*或*/
SELECT Student.Sno,Sname,AVG(Score)
FROM Student,SC,Course
WHERE Student.Sno=SC.Sno AND SC.Cno=Course.Cno
GROUP BY Student.Sno,SC.Sno,Course.Creq
HAVING Course.Creq=&#39;必修&#39; AND (SC.Sno=&#39;03051108&#39; OR Sname=&#39;司武强&#39;);
</code></pre>
<p> 所有课程平均成绩（平均成绩应按学分加权）：</p>
<pre><code>SELECT Student.Sno,Sname,SUM(Score*Ccredit)/SUM(Ccredit)
FROM Student,SC,Course
WHERE Student.Sno=SC.Sno AND SC.Cno=Course.Cno
GROUP BY Student.Sno
HAVING Student.Sno=&#39;03051108&#39; OR Sname=&#39;司武强&#39;;
</code></pre>
<p>注：由于课程信息庞大，查询时皆忽略条件“必修”</p>
<p>查询结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c061cd1cbc43256dba341cce842c1fef.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0524d3e8e4cea528fe7d439432b449db.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/bfbea01fbea4ba90344d8e8a3b4a76a5.png"></p>
<h4 id="查询一位学生被哪些教师教过课"><a href="#查询一位学生被哪些教师教过课" class="headerlink" title="&lt;6&gt;查询一位学生被哪些教师教过课"></a>&lt;6&gt;查询一位学生被哪些教师教过课</h4><pre><code>/*查询一位学生被哪些教师教过课*/
SELECT Tname,Cname
FROM Student,Schedule,Teacher,Course
WHERE Student.Class_no=Schedule.Class_no AND Schedule.Tno=Teacher.Tno AND Schedule.Cno=Course.Cno AND (Student.Sno=&#39;03051108&#39; OR Student.Sname=&#39;司武强&#39;;
</code></pre>
<h4 id="查询快要被开除的学生（距被开除差3学分之内）"><a href="#查询快要被开除的学生（距被开除差3学分之内）" class="headerlink" title="&lt;7&gt;查询快要被开除的学生（距被开除差3学分之内）"></a>&lt;7&gt;查询快要被开除的学生（距被开除差3学分之内）</h4><pre><code>/*查询快要被开除的学生（距被开除差3学分之内）*/
SELECT Sno,Sname
FROM Student
WHERE 10&lt;=(
    SELECT SUM(Ccredit)
    FROM SC,Course
    WHERE Student.Sno=SC.Sno AND SC.Cno=Course.Cno AND Course.Creq=&#39;必修&#39; AND Score&lt;60
) OR 15&lt;=(
    SELECT SUM(Ccredit)
    FROM SC,Course
    WHERE Student.Sno=SC.Sno AND SC.Cno=Course.Cno AND Course.Creq=&#39;选修&#39; AND Score&lt;60
);
</code></pre>
<p>查询结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/766ca586e00ab2d430092a38e54e9465.png"></p>
<h3 id="5-主要问题及解决"><a href="#5-主要问题及解决" class="headerlink" title="5.主要问题及解决"></a>5.主要问题及解决</h3><p>&lt;1&gt;问题：插入数据工作量庞大且繁琐，示例数据与期望表结构不同</p>
<pre><code>    解决：于是将课程信息表Course和学生信息表Student拆分成两部分，基本信息和细节信息表_Detail。将示例数据文件通过C语言程序导出SQL插入信息语句。

    改进：利用const char数组定义某个属性的可能取值，利用random函数插入细节数据
</code></pre>
<h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6.总结"></a>6.总结</h3><pre><code>    数据库的查询速度极快，基本在0.01s左右。但唯一的不足之处在于插入数据不便，需要用INSERT语句且符合表的结构。采用图形界面将优化这一不足。
</code></pre>
<h3 id="7-附录"><a href="#7-附录" class="headerlink" title="7.附录"></a>7.附录</h3><h4 id="TXT转SQL-C语言程序脚本"><a href="#TXT转SQL-C语言程序脚本" class="headerlink" title="&lt;1&gt;TXT转SQL C语言程序脚本"></a>&lt;1&gt;TXT转SQL C语言程序脚本</h4><p>主程序（INSERT_SQL.c）：</p>
<pre><code>#define _CRT_SECURE_NO_WARNINGS
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;stdlib.h&gt;
#include&quot;school_sql.h&quot;

int main()
&#123;

	INSERT_(&quot;Department&quot;,&quot;Department.txt&quot;, &quot;INSERT_Department.sql&quot;);
	INSERT_(&quot;Class&quot;,&quot;Class.txt&quot;, &quot;INSERT_Class.sql&quot;);
	INSERT_Course(&quot;Course&quot;, &quot;Course.txt&quot;, &quot;INSERT_Course.sql&quot;);
	INSERT_(&quot;Student&quot;,&quot;Student.txt&quot;, &quot;INSERT_Student.sql&quot;);
	INSERT_(&quot;SC&quot;,&quot;SC.txt&quot;, &quot;INSERT_SC.sql&quot;);

	return 0;
&#125;
</code></pre>
<p>头文件（school.h）:</p>
<pre><code>#ifndef SCHOOL_SQL_H
#define SCHOOL_SQL_H
#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

const char Dept[5]=
&#123;
	&quot;CS&quot;, &quot;IS&quot;, &quot;AI&quot;, &quot;ES&quot;, &quot;CE&quot;
&#125;;

const char Class_no[10]=
&#123;
	&quot;_210101&quot;, &quot;_210102&quot;, &quot;_210103&quot;, &quot;_210204&quot;，&quot;_210305&quot;，&quot;_210406&quot;，&quot;_210407&quot;，&quot;_210508&quot;，&quot;_210509&quot;，&quot;_210510&quot;
&#125;;

const char Creq=
&#123;
    &quot;选修&quot;，&quot;必修&quot;
&#125;;


//函数功能：读取文本数据生成插入SQL语句 
void INSERT_(char [], char [], char []);
#endif
</code></pre>
<p>插入函数（school.c）:</p>
<pre><code>#include&quot;school_sql.h&quot;

/*
@function：将文件中的数据导出成SQL插入语句
@parameter：插入表的名字，数据来源文件名src，导出文件名dst
@account：默认导出形式字符CHAR
*/
void INSERT_(char table[], char src[], char dst[])
&#123;
	FILE* fr, * fw;
	char c;
	if ((fr = fopen(src, &quot;r&quot;)) == NULL) &#123;
		printf(&quot;%s File not exist\n&quot;, src);
		exit(0);
	&#125;
	fw = fopen(dst, &quot;w&quot;);
	fprintf(fw, &quot;\nINSERT INTO %s VALUES\n(&#39;&quot;,table);
	while (!feof(fr)) &#123;
		c = fgetc(fr);
		printf(&quot;%c&quot;, c);
		if (c == &#39;\n&#39;)fprintf(fw, &quot;&#39;),\n(&#39;&quot;);
		else if (c == &#39;,&#39;)fprintf(fw, &quot;&#39;,&#39;&quot;);
		else fprintf(fw, &quot;%c&quot;, c);
	&#125;
	//需手动检查结果是否正确 
	fprintf(fw, &quot;&#39;);&quot;);
&#125;

/*
@function：将文件中的数据导出成SQL插入语句（定制）
@parameter：插入表的名字，数据来源文件名src，导出文件名dst
@account：第三个数据形式为INT（插入SQL语句第三个数据无&#39;&#39;）
*/
void INSERT_Course(char table[], char src[], char dst[])
&#123;
	FILE* fr, * fw;
	char c;
	int i = 0, cnt = 0;
	if ((fr = fopen(src, &quot;r&quot;)) == NULL) &#123;
		printf(&quot;%s File not exist\n&quot;, src);
		exit(0);
	&#125;
	fw = fopen(dst, &quot;w&quot;);
	fprintf(fw, &quot;\nINSERT INTO %s VALUES\n(&#39;&quot;, table);
	while (!feof(fr)) &#123;
		c = fgetc(fr);
		printf(&quot;%c&quot;, c);
		if (c == &#39;\n&#39;) &#123;
			cnt = 0;
			fprintf(fw, &quot;),\n(&#39;&quot;);
		&#125;
		else if (c == &#39;,&#39;) &#123;
			cnt++;
			if (cnt == 2)fprintf(fw, &quot;&#39;,&quot;);
			else fprintf(fw, &quot;&#39;,&#39;&quot;);
		&#125;
		else fprintf(fw, &quot;%c&quot;, c);
	&#125;
	//需手动检查结果是否正确 
	fprintf(fw, &quot;);&quot;);
&#125;
</code></pre>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/134984670">https://blog.csdn.net/qq_32971095/article/details/134984670</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:30:30" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>174k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2:38</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%BA%8C.%E7%BA%BF%E4%B8%8B%E5%AE%9E%E9%AA%8C">二.线下实验</a></p>
<p><a href="about:blank#%E7%AE%A1%E8%84%9A%E7%BB%91%E5%AE%9A%E6%A8%A1%E7%89%88">管脚绑定模版</a></p>
<p><a href="about:blank#%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9D%97%E6%A8%A1%E7%89%88">通用模块模版</a></p>
<p><a href="about:blank#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项</a></p>
<p><a href="about:blank#1.%E8%B7%91%E9%A9%AC%E7%81%AF%E6%8E%A7%E5%88%B6%E8%AE%BE%E8%AE%A1">1.跑马灯控制设计</a></p>
<p><a href="about:blank#2.8%20%E4%BD%8D%E5%B9%B6%E8%A1%8C%E5%85%A8%E5%8A%A0%E5%99%A8%E8%AE%BE%E8%AE%A1%2B%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">2.8<br>位并行全加器设计+数码管显示程序设计</a></p>
<p><a href="about:blank#3.%E9%98%B5%E5%88%97%E4%B9%98%E6%B3%95%E5%99%A8%E8%AE%BE%E8%AE%A1">3.阵列乘法器设计</a></p>
<p><a href="about:blank#4.%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%20FIFO%20%E7%9A%84%E8%AE%BE%E8%AE%A1">4.先进先出 FIFO<br>的设计</a></p>
<p><a href="about:blank#5.PC%20%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8%E8%AE%BE%E8%AE%A1">5.PC<br>程序计数器设计</a></p>
<p><a href="about:blank#6.%E7%A8%8B%E5%BA%8F%E5%AD%98%E5%82%A8%E5%99%A8%20ROM%20%E8%AE%BE%E8%AE%A1">6.程序存储器 ROM<br>设计</a></p>
<p><a href="about:blank#7.%E5%8A%A0%E5%87%8F%E4%BA%A4%E6%9B%BF%E9%99%A4%E6%B3%95%E5%99%A8">7.加减交替除法器</a></p>
<p><a href="about:blank#8.%E6%8C%87%E4%BB%A4%E5%AD%98%E5%82%A8%E5%99%A8%20IR%20%E8%AE%BE%E8%AE%A1">8.指令存储器 IR<br>设计</a></p>
<p><a href="about:blank#9.%E5%AF%84%E5%AD%98%E5%99%A8%20RN%20%E8%AE%BE%E8%AE%A1">9.寄存器 RN<br>设计</a></p>
<p><a href="about:blank#10.ALU%E7%AE%97%E6%9C%AF%E9%80%BB%E8%BE%91%E5%8D%95%E5%85%83%E8%AE%BE%E8%AE%A1">10.ALU算术逻辑单元设计</a></p>
<p><a href="about:blank#11.%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%99%A8%20RAM%20%E8%AE%BE%E8%AE%A1">11.数据存储器 RAM<br>设计</a></p>
<p><a href="about:blank#12.%E5%A0%86%E6%A0%88%E6%8C%87%E9%92%88%20SP%20%E8%AE%BE%E8%AE%A1">12.堆栈指针 SP<br>设计</a></p>
<p><a href="about:blank#13.%E9%87%87%E7%94%A8%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80%E8%AF%AD%E8%A8%80%E8%AE%BE%E8%AE%A1%20IO%20%E6%A8%A1%E5%9D%97">13.采用硬件描述语言语言设计 IO<br>模块</a></p>
<p><a href="about:blank#14.%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1">14.微控制器设计</a></p>
<p><a href="about:blank#15.8%20%E4%BD%8D%20SOC%20%E7%BB%BC%E5%90%88%E8%AE%BE%E8%AE%A1">15.8 位 SOC<br>综合设计</a></p>
<p><a href="about:blank#1.%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90">1.实验结果分析</a></p>
<p><a href="about:blank#%3C1%3E%E6%A8%A1%E5%9D%97%E5%B7%A5%E4%BD%9C%E9%A1%BA%E5%BA%8F%E5%88%86%E6%9E%90">&lt;1&gt;模块工作顺序分析</a></p>
<p><a href="about:blank#%3C2%3E%E2%80%8B%E2%80%8B%E2%80%8B%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90">&lt;2&gt;​​​指令执行过程分析</a></p>
<p><a href="about:blank#2.%E5%85%B6%E4%BB%96">2.其他</a></p>
<p><a href="about:blank#%3C1%3ESOC%E6%A8%A1%E5%9D%97%E9%9B%86%E6%88%90%E8%AE%BE%E8%AE%A1%E7%BB%8F%E9%AA%8C">&lt;1&gt;SOC模块集成设计经验</a></p>
<p><a href="about:blank#%3C2%3E%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8BSOC%E9%9B%86%E6%88%90%E5%85%B3%E9%94%AE">&lt;2&gt;SOC集成关键</a></p>
<hr>
<h2 id="二-线下实验"><a href="#二-线下实验" class="headerlink" title="二.线下实验"></a>二.线下实验</h2><h3 id="管脚绑定模版"><a href="#管脚绑定模版" class="headerlink" title="管脚绑定模版"></a>管脚绑定模版</h3><pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/18 13:02:24
#----------------------------------------------------------------------------------
#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;a_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;a_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;a_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;a_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;a_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;a_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;a_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;a_in[7]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[7]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;b_in[0]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;b_in[1]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;b_in[2]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;b_in[3]&#125;]
set_property PACKAGE_PIN A13        [get_ports &#123;b_in[4]&#125;]
set_property PACKAGE_PIN A12        [get_ports &#123;b_in[5]&#125;]
set_property PACKAGE_PIN D8         [get_ports &#123;b_in[6]&#125;]
set_property PACKAGE_PIN D9         [get_ports &#123;b_in[7]&#125;]

#SW16~23
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[7]&#125;]
set_property PACKAGE_PIN F8         [get_ports &#123;c_in[0]&#125;]
set_property PACKAGE_PIN F9         [get_ports &#123;c_in[1]&#125;]
set_property PACKAGE_PIN H11        [get_ports &#123;c_in[2]&#125;]
set_property PACKAGE_PIN H12        [get_ports &#123;c_in[3]&#125;]
set_property PACKAGE_PIN G14        [get_ports &#123;c_in[4]&#125;]
set_property PACKAGE_PIN J10        [get_ports &#123;c_in[5]&#125;]
set_property PACKAGE_PIN H14        [get_ports &#123;c_in[6]&#125;]
set_property PACKAGE_PIN J11        [get_ports &#123;c_in[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports key_in]
set_property IOSTANDARD LVCMOS18    [get_ports key_in]
set_property PACKAGE_PIN H9         [get_ports wr]
set_property IOSTANDARD LVCMOS18    [get_ports wr]
set_property PACKAGE_PIN H8         [get_ports rd]
set_property IOSTANDARD LVCMOS18    [get_ports rd]
set_property PACKAGE_PIN G10        [get_ports a]
set_property IOSTANDARD LVCMOS18    [get_ports a]
set_property PACKAGE_PIN G9         [get_ports b]
set_property IOSTANDARD LVCMOS18    [get_ports b]
set_property PACKAGE_PIN J13        [get_ports c]
set_property IOSTANDARD LVCMOS18    [get_ports c]
set_property PACKAGE_PIN H13        [get_ports d]
set_property IOSTANDARD LVCMOS18    [get_ports d]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

#led15
set_property PACKAGE_PIN L20        [get_ports empty]
set_property IOSTANDARD LVCMOS33    [get_ports empty]
#led11
set_property PACKAGE_PIN J20        [get_ports full]
set_property IOSTANDARD LVCMOS33    [get_ports full]
</code></pre>
<h3 id="通用模块模版"><a href="#通用模块模版" class="headerlink" title="通用模块模版"></a>通用模块模版</h3><p>时钟分频：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity clk_div is
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end clk_div;

architecture Behavioral of clk_div is

begin

process(rst,clk_in)
variable count:integer:=0;
begin
    if(rst=&#39;1&#39;)then count:=0; 
    elsif(clk_in=&#39;1&#39;and clk_in&#39;event)then 
        count:=count+1;
        if(count&lt;=DIV_NUM/2)then
            clk_out&lt;=&#39;1&#39;;
        elsif(count&gt;DIV_NUM/2 and count&lt;DIV_NUM)then
            clk_out&lt;=&#39;0&#39;;
        elsif(count&gt;=DIV_NUM)then
            count:=0;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>按键消抖：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity key_stroke is
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end key_stroke;

architecture Behavioral of key_stroke is

type states is(s0,s1,s2,s3);
signal state:states;

begin

process(reset,clk,key_in)
variable count_num:integer:=3*CLK_FRE/1000;--delay 3ms
variable count:integer:=0;
    begin
        if reset=&#39;0&#39;then
            state&lt;=s0;
            count:=0;
            output&lt;=&#39;0&#39;;
        elsif(clk=&#39;1&#39;and clk&#39;event)then
            case state is
                when s0=&gt;if(key_in=&#39;1&#39;)then count:=0;output&lt;=&#39;0&#39;;state&lt;=s1;end if;
                when s1=&gt;
                    count:=count+1;
                    if (count&gt;=count_num) then state&lt;=s2; end if;
                when s2=&gt;
                    if(key_in=&#39;1&#39;)then output&lt;=&#39;1&#39;;state&lt;=s3;
                    --if(key_in=&#39;1&#39;)then output&lt;=&#39;1&#39;;state&lt;=s0;--one clk cycle
                    elsif(key_in=&#39;0&#39;)then state&lt;=s0;
                    end if;
                when s3=&gt;if(key_in=&#39;0&#39;)then state&lt;=s0;end if;                                                                   
            end case;               
        end if;     
end process;

end Behavioral;
</code></pre>
<p> 数码管显示：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity seg_dis is
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );

end seg_dis;

architecture Behavioral of seg_dis is

signal data_in_line: std_logic_vector(3 downto 0);

type states is(s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15);
signal state,next_state:states;

begin   

process(rst,clk)
begin 
    if(rst=&#39;1&#39;)then state&lt;=s0;
    elsif(clk=&#39;1&#39;and clk&#39;event)then 
        state&lt;=next_state;
    end if;
end process;


process(state)
begin
    case state is
    when s0 =&gt;  seg_dig&lt;=not&quot;0000000000000001&quot;;   data_in_line&lt;=data_in_A(3 downto 0);   next_state&lt;=s1;
    when s1 =&gt;  seg_dig&lt;=not&quot;0000000000000010&quot;;   data_in_line&lt;=data_in_A(7 downto 4);   next_state&lt;=s2;
    when s2 =&gt;  seg_dig&lt;=not&quot;0000000000000100&quot;;   data_in_line&lt;=data_in_A(11 downto 8);  next_state&lt;=s3;
    when s3 =&gt;  seg_dig&lt;=not&quot;0000000000001000&quot;;   data_in_line&lt;=data_in_A(15 downto 12); next_state&lt;=s4;   
    when s4 =&gt;  seg_dig&lt;=not&quot;0000000000010000&quot;;   data_in_line&lt;=data_in_B(3 downto 0);   next_state&lt;=s5;
    when s5 =&gt;  seg_dig&lt;=not&quot;0000000000100000&quot;;   data_in_line&lt;=data_in_B(7 downto 4);   next_state&lt;=s6;
    when s6 =&gt;  seg_dig&lt;=not&quot;0000000001000000&quot;;   data_in_line&lt;=data_in_B(11 downto 8);  next_state&lt;=s7;
    when s7 =&gt;  seg_dig&lt;=not&quot;0000000010000000&quot;;   data_in_line&lt;=data_in_B(15 downto 12); next_state&lt;=s8;     
    when s8 =&gt;  seg_dig&lt;=not&quot;0000000100000000&quot;;   data_in_line&lt;=data_in_C(3 downto 0);   next_state&lt;=s9;
    when s9 =&gt;  seg_dig&lt;=not&quot;0000001000000000&quot;;   data_in_line&lt;=data_in_C(7 downto 4);   next_state&lt;=s10;
    when s10=&gt;  seg_dig&lt;=not&quot;0000010000000000&quot;;   data_in_line&lt;=data_in_C(11 downto 8);  next_state&lt;=s11;
    when s11=&gt;  seg_dig&lt;=not&quot;0000100000000000&quot;;   data_in_line&lt;=data_in_C(15 downto 12); next_state&lt;=s12;
    when s12=&gt;  seg_dig&lt;=not&quot;0001000000000000&quot;;   data_in_line&lt;=data_in_D(3 downto 0);   next_state&lt;=s13;
    when s13=&gt;  seg_dig&lt;=not&quot;0010000000000000&quot;;   data_in_line&lt;=data_in_D(7 downto 4);   next_state&lt;=s14;
    when s14=&gt;  seg_dig&lt;=not&quot;0100000000000000&quot;;   data_in_line&lt;=data_in_D(11 downto 8);  next_state&lt;=s15;
    when s15=&gt;  seg_dig&lt;=not&quot;1000000000000000&quot;;   data_in_line&lt;=data_in_D(15 downto 12); next_state&lt;=s0;
    when others=&gt;next_state&lt;=s0;
    end case;
end process;

process(data_in_line)
begin
    case data_in_line is
        when &quot;0000&quot;=&gt;seg_data&lt;=not&quot;00111111&quot;;
        when &quot;0001&quot;=&gt;seg_data&lt;=not&quot;00000110&quot;;
        when &quot;0010&quot;=&gt;seg_data&lt;=not&quot;01011011&quot;;
        when &quot;0011&quot;=&gt;seg_data&lt;=not&quot;01001111&quot;;
        when &quot;0100&quot;=&gt;seg_data&lt;=not&quot;01100110&quot;;
        when &quot;0101&quot;=&gt;seg_data&lt;=not&quot;01101101&quot;;
        when &quot;0110&quot;=&gt;seg_data&lt;=not&quot;01111101&quot;;
        when &quot;0111&quot;=&gt;seg_data&lt;=not&quot;00000111&quot;;
        when &quot;1000&quot;=&gt;seg_data&lt;=not&quot;01111111&quot;;
        when &quot;1001&quot;=&gt;seg_data&lt;=not&quot;01101111&quot;;
        when &quot;1010&quot;=&gt;seg_data&lt;=not&quot;01110111&quot;;
        when &quot;1011&quot;=&gt;seg_data&lt;=not&quot;01111100&quot;;
        when &quot;1100&quot;=&gt;seg_data&lt;=not&quot;00111001&quot;;
        when &quot;1101&quot;=&gt;seg_data&lt;=not&quot;01011110&quot;;
        when &quot;1110&quot;=&gt;seg_data&lt;=not&quot;01111001&quot;;
        when &quot;1111&quot;=&gt;seg_data&lt;=not&quot;01110001&quot;;
        when others=&gt;seg_data&lt;=not&quot;11111111&quot;;
    end case;
end process;

end Behavioral;
</code></pre>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a><strong>注意事项</strong></h3><p>1.器件型号：xc7k160tfbg676-2</p>
<p>2.输入一般cmos18 输出cmos33</p>
<p>3.输入数码管的时钟需分频</p>
<p>4.按键加消抖</p>
<p>5.程序的运行结合.xdc文件进行理解</p>
<h3 id="1-跑马灯控制设计"><a href="#1-跑马灯控制设计" class="headerlink" title="1.跑马灯控制设计"></a>1.跑马灯控制设计</h3><pre><code>    功能叙述：初始情况下 Y0=‘1’，其它为‘0’。然后，在 en 为高电平的情况下，在时钟信 号 clk 的下降沿进行移位。当 dir=‘1’时，每来一个时钟信号，循环左移一位，当 dir=‘0’时， 每来一个时钟，循环右移一位。 另外，移位控制时钟可以选择为按键，即每按键一次相当于一个时钟信号，系统可以在 按键和系统分频时钟之间进行选择。
</code></pre>
<p>资源使用：</p>
<p>1）用 LED0~LED7 作为跑马灯输出显示，LED7 为高位，LED0 为低位；</p>
<p>2）SW0 为循环方向控制；</p>
<p>3）SW1 为工作允许 EN 控制端；</p>
<p>4）计数时钟频率为 1Hz，通过对 50Mhz 系统时钟分频得到；</p>
<p>5）扩展：可以由按键来控制循环（按键为 BTN_SOUTH），即每按一次 BTN_SOUTH, 则完成一次移位。通过 SW2 选择移位控制时钟沿。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/fbc0bb7faf453566ef923063e4d002fb.png"></p>
<p>源文件：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity run_led is
    Port(
        en,dir,sel,clk,con:in std_logic;
        y:out std_logic_vector(7 downto 0)
    );
end run_led;

architecture Behavioral of run_led is
signal input:std_logic;
signal clk_div:std_logic;
begin

process(clk)
variable clk_cnt:integer:=0;
variable clk_cnt_2:integer:=0;
begin 
    if(clk=&#39;1&#39;and clk&#39;event)then 
        clk_cnt_2:=clk_cnt_2+1;
        if(clk_cnt_2&gt;=10000)then 
        clk_cnt:=clk_cnt+1;
        clk_cnt_2:=0;
        end if;
        if(clk_cnt&lt;5000)then clk_div&lt;=&#39;1&#39;;
        elsif(clk_cnt&gt;=5000)then clk_div&lt;=&#39;0&#39;;
        end if;
        if(clk_cnt&gt;=10000)then clk_cnt:=0;
        end if; 
    end if;
end process;

process(clk,en,clk_div,con,sel)
    begin
        if(en=&#39;1&#39;)then
            if(sel=&#39;0&#39;)then input&lt;=clk_div;
            elsif(sel=&#39;1&#39;)then input&lt;=con;
            end if;
        elsif(en=&#39;0&#39;)then input&lt;=&#39;0&#39;;
        end if;
end process;

process(input,dir)
variable count:integer:=0;
begin
if(input=&#39;1&#39;and input&#39;event)then 
    if(dir=&#39;1&#39;)then
        count:=count+1;
        if(count&gt;7)then count:=0;end if;
    elsif(dir=&#39;0&#39;)then 
        count:=count-1;
        if(count&lt;0)then count:=7;end if;
    end if;  
        
    if(count=0)then y&lt;=&quot;00000001&quot;;
    elsif(count=1)then y&lt;=&quot;00000010&quot;;
    elsif(count=2)then y&lt;=&quot;00000100&quot;;
    elsif(count=3)then y&lt;=&quot;00001000&quot;;
    elsif(count=4)then y&lt;=&quot;00010000&quot;;
    elsif(count=5)then y&lt;=&quot;00100000&quot;;
    elsif(count=6)then y&lt;=&quot;01000000&quot;;
    elsif(count=7)then y&lt;=&quot;10000000&quot;;
    else y&lt;=&quot;11111111&quot;;
    end if;
    
end if;       
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;


entity run_led_tb is
end run_led_tb;

architecture Behavioral of run_led_tb is
component run_led
    Port(
        en,dir,sel,clk,con:in std_logic;
        y:out std_logic_vector(7 downto 0)
    );
end component;

SIGNAL en,dir,sel,clk,con: std_logic;
SIGNAL y: std_logic_vector(7 downto 0);

begin
run_led_inst:run_led port map(en=&gt;en,dir=&gt;dir,sel=&gt;sel,clk=&gt;clk,con=&gt;con,y=&gt;y); 

clock:process
begin 
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

key:process
begin 
    con&lt;=&#39;1&#39;;
    wait for 25ns;
    con&lt;=&#39;0&#39;;
    wait for 25ns;
end process;

test:process
begin
    en&lt;=&#39;0&#39;;
    sel&lt;=&#39;1&#39;;
    dir&lt;=&#39;1&#39;;
    wait for 25ns;
    en&lt;=&#39;1&#39;;
    wait;

end process;


end Behavioral;
</code></pre>
<p>xdc:</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/18 13:02:24
#----------------------------------------------------------------------------------
set_property PACKAGE_PIN C9 [get_ports dir]
set_property PACKAGE_PIN AF12 [get_ports con]
set_property PACKAGE_PIN B9 [get_ports en]
set_property PACKAGE_PIN E10 [get_ports clk]
set_property PACKAGE_PIN G11 [get_ports sel]
set_property PACKAGE_PIN G16 [get_ports &#123;y[0]&#125;]
set_property PACKAGE_PIN H16 [get_ports &#123;y[1]&#125;]
set_property PACKAGE_PIN D16 [get_ports &#123;y[2]&#125;]
set_property PACKAGE_PIN D15 [get_ports &#123;y[3]&#125;]
set_property PACKAGE_PIN C18 [get_ports &#123;y[4]&#125;]
set_property PACKAGE_PIN C17 [get_ports &#123;y[5]&#125;]
set_property PACKAGE_PIN B19 [get_ports &#123;y[6]&#125;]
set_property PACKAGE_PIN C19 [get_ports &#123;y[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;y[3]&#125;]

set_property DRIVE 12 [get_ports &#123;y[4]&#125;]
set_property DRIVE 12 [get_ports &#123;y[5]&#125;]
set_property DRIVE 12 [get_ports &#123;y[0]&#125;]
set_property DRIVE 12 [get_ports &#123;y[6]&#125;]
set_property DRIVE 12 [get_ports &#123;y[1]&#125;]
set_property DRIVE 12 [get_ports &#123;y[7]&#125;]
set_property DRIVE 12 [get_ports &#123;y[2]&#125;]
set_property DRIVE 12 [get_ports &#123;y[3]&#125;]

set_property IOSTANDARD LVCMOS18 [get_ports dir]
set_property IOSTANDARD LVCMOS18 [get_ports con]
set_property IOSTANDARD LVCMOS18 [get_ports en]
set_property IOSTANDARD LVCMOS18 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports sel]
</code></pre>
<h3 id="2-8-位并行全加器设计-数码管显示程序设计"><a href="#2-8-位并行全加器设计-数码管显示程序设计" class="headerlink" title="2.8 位并行全加器设计+数码管显示程序设计"></a>2.8 位并行全加器设计+数码管显示程序设计</h3><p><strong>注：数码管部分未使用优化代码</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ce6fd932b35130aa5e27c5aed20ea4d1.png"></p>
<pre><code>    其中 a_in，b_in：数据输入，使用板上开关（SW0~SW15）； sum_out：运算结果输出，使用 LED 显示运算结果。
</code></pre>
<p>（1）用硬件描述语言实现 16 个七段数码管扫描显示模块</p>
<pre><code>    七段数码管扫描显示模块电路如图所示，主要包括顶层的数码管扫描显示模块，以及输入数据向七段数码管进行译码的模块。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c7d8f4a915fe5bd8c1ead81f14b23a98.png"></p>
<pre><code>    该模块实现数码管扫描显示功能，扩展板上的 16 个数码管四个一组，分为 A，B，C，D 四组。模块管脚说明如下：clk 为系统的时钟输入，rst 信号为复位信号，data_in_A(15:0)为 A 组四个数码管的输入显示值，其中，data_in_A(3:0)对应于第一个数码管的输入显示值； data_in_A(7:4)对应第二个数码管的输入显示值；data_in_A(11:8）对应第三个数码管的输入显 示值；data_in_A(15:12)对应第四个数码管的输入显示值，其它各组与 A 组分配一致； data_in_B(15:0)为 B 组四个数码管的输入显示值；data_in_C(15:0)为 C 组四个数码管的输入显 示值；data_in_D(15:0)为 D 组四个数码管的输入显示值；seg_sel(3:0)为数码管选择编码输出 信号，seg_data(7:0)为数码管显示数据输出。 
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/80cc88d89b55bfa5281ac1e8bd0b69bc.png"></p>
<pre><code>    该模块实现将输入的 4 为二进制数转换为数码管显示的数据；其中，data_in(3:0)为输入 值，seg_data(7:0)为数码管编码的输出值。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity adder is
    Port (
        clk,rst:in std_logic;
        a,b:in std_logic_vector(7 downto 0);
        c:in std_logic;
        
        c_out:out std_logic;
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
     );
end adder;

architecture Behavioral of adder is

component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;
component decoder4_16
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end component;

signal clk_out_line:std_logic;
signal sum_line:std_logic_vector(16 downto 0);
signal data_line:std_logic_vector(15 downto 0);
signal c_line:std_logic;
signal sel_out_line:std_logic_vector(3 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(clk,clk_out_line);
seg_dis_inst:seg_dis port map(rst,clk_out_line,data_line,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,sel_out_line,seg_data);
decoder4_16_inst:decoder4_16 port map(sel_out_line,sel_out);

process(a,b,c)
begin  
    sum_line&lt;=(&quot;00000000&quot;&amp;a)+(&quot;00000000&quot;&amp;b)+(&quot;0000000000000000&quot;&amp;c);
    data_line&lt;=sum_line(15 downto 0);
    c_out&lt;=sum_line(16);
end process;
    

end Behavioral;
</code></pre>
<p>模块：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity decoder4_16 is
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end decoder4_16;

architecture Behavioral of decoder4_16 is

begin

process(sel_in)
begin
    case sel_in is
    when &quot;0000&quot;=&gt;sel_out&lt;=not&quot;0000000000000001&quot;;
    when &quot;0001&quot;=&gt;sel_out&lt;=not&quot;0000000000000010&quot;;
    when &quot;0010&quot;=&gt;sel_out&lt;=not&quot;0000000000000100&quot;;
    when &quot;0011&quot;=&gt;sel_out&lt;=not&quot;0000000000001000&quot;;
    when &quot;0100&quot;=&gt;sel_out&lt;=not&quot;0000000000010000&quot;;
    when &quot;0101&quot;=&gt;sel_out&lt;=not&quot;0000000000100000&quot;;
    when &quot;0110&quot;=&gt;sel_out&lt;=not&quot;0000000001000000&quot;;
    when &quot;0111&quot;=&gt;sel_out&lt;=not&quot;0000000010000000&quot;;
    when &quot;1000&quot;=&gt;sel_out&lt;=not&quot;0000000100000000&quot;;
    when &quot;1001&quot;=&gt;sel_out&lt;=not&quot;0000001000000000&quot;;
    when &quot;1010&quot;=&gt;sel_out&lt;=not&quot;0000010000000000&quot;;
    when &quot;1011&quot;=&gt;sel_out&lt;=not&quot;0000100000000000&quot;;
    when &quot;1100&quot;=&gt;sel_out&lt;=not&quot;0001000000000000&quot;;
    when &quot;1101&quot;=&gt;sel_out&lt;=not&quot;0010000000000000&quot;;
    when &quot;1110&quot;=&gt;sel_out&lt;=not&quot;0100000000000000&quot;;
    when &quot;1111&quot;=&gt;sel_out&lt;=not&quot;1000000000000000&quot;;
    when others=&gt;sel_out&lt;=not&quot;1111111111111111&quot;;
    end case;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity seg_dis is
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );

end seg_dis;

architecture Behavioral of seg_dis is
component data2seg
    port(
        data_in:in std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;

signal data_in_line: std_logic_vector(3 downto 0);

type states is(s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15);
signal state,next_state:states;

begin   

data2seg_inst:data2seg port map(data_in_line,seg_data);

process(rst,clk)
begin 
    if(rst=&#39;1&#39;)then state&lt;=s0;
    elsif(clk=&#39;1&#39;and clk&#39;event)then
        state&lt;=next_state;
    end if;
end process;


process(state)
begin
    case state is
    when s0=&gt;
        seg_sel&lt;=&quot;0000&quot;;
        data_in_line&lt;=data_in_A(3 downto 0);
        next_state&lt;=s1;
    when s1=&gt;
        seg_sel&lt;=&quot;0001&quot;;
        data_in_line&lt;=data_in_A(7 downto 4);
        next_state&lt;=s2;
    when s2=&gt;
        seg_sel&lt;=&quot;0010&quot;;
        data_in_line&lt;=data_in_A(11 downto 8);
        next_state&lt;=s3;
    when s3=&gt;
        seg_sel&lt;=&quot;0011&quot;;
        data_in_line&lt;=data_in_A(15 downto 12);
        next_state&lt;=s4;
    
    when s4=&gt;seg_sel&lt;=&quot;0100&quot;;data_in_line&lt;=data_in_B(3 downto 0);next_state&lt;=s5;
    when s5=&gt;seg_sel&lt;=&quot;0101&quot;;data_in_line&lt;=data_in_B(7 downto 4);next_state&lt;=s6;
    when s6=&gt;seg_sel&lt;=&quot;0110&quot;;data_in_line&lt;=data_in_B(11 downto 8);next_state&lt;=s7;
    when s7=&gt;seg_sel&lt;=&quot;0111&quot;;data_in_line&lt;=data_in_B(15 downto 12);next_state&lt;=s8;
    
    when s8=&gt;seg_sel&lt;=&quot;1000&quot;;data_in_line&lt;=data_in_C(3 downto 0);next_state&lt;=s9;
    when s9=&gt;seg_sel&lt;=&quot;1001&quot;;data_in_line&lt;=data_in_C(7 downto 4);next_state&lt;=s10;
    when s10=&gt;seg_sel&lt;=&quot;1010&quot;;data_in_line&lt;=data_in_C(11 downto 8);next_state&lt;=s11;
    when s11=&gt;seg_sel&lt;=&quot;1011&quot;;data_in_line&lt;=data_in_C(15 downto 12);next_state&lt;=s12;
    
    when s12=&gt;seg_sel&lt;=&quot;1100&quot;;data_in_line&lt;=data_in_D(3 downto 0);next_state&lt;=s13;
    when s13=&gt;seg_sel&lt;=&quot;1101&quot;;data_in_line&lt;=data_in_D(7 downto 4);next_state&lt;=s14;
    when s14=&gt;seg_sel&lt;=&quot;1110&quot;;data_in_line&lt;=data_in_D(11 downto 8);next_state&lt;=s15;
    when s15=&gt;seg_sel&lt;=&quot;1111&quot;;data_in_line&lt;=data_in_D(15 downto 12);next_state&lt;=s0;
    
    when others=&gt;state&lt;=next_state;
    end case;
end process;

end Behavioral;


----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity data2seg is
    port(
        data_in:in std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );

end data2seg;

architecture Behavioral of data2seg is
begin 
process(data_in)
begin
    case data_in is
        when &quot;0000&quot;=&gt;seg_data&lt;=not&quot;00111111&quot;;
        when &quot;0001&quot;=&gt;seg_data&lt;=not&quot;00000110&quot;;
        when &quot;0010&quot;=&gt;seg_data&lt;=not&quot;01011011&quot;;
        when &quot;0011&quot;=&gt;seg_data&lt;=not&quot;01001111&quot;;
        when &quot;0100&quot;=&gt;seg_data&lt;=not&quot;01100110&quot;;
        when &quot;0101&quot;=&gt;seg_data&lt;=not&quot;00110111&quot;;
        when &quot;0110&quot;=&gt;seg_data&lt;=not&quot;01111101&quot;;
        when &quot;0111&quot;=&gt;seg_data&lt;=not&quot;00000111&quot;;
        when &quot;1000&quot;=&gt;seg_data&lt;=not&quot;01111111&quot;;
        when &quot;1001&quot;=&gt;seg_data&lt;=not&quot;01101111&quot;;
        when &quot;1010&quot;=&gt;seg_data&lt;=not&quot;01110111&quot;;
        when &quot;1011&quot;=&gt;seg_data&lt;=not&quot;01111100&quot;;
        when &quot;1100&quot;=&gt;seg_data&lt;=not&quot;00111000&quot;;
        when &quot;1101&quot;=&gt;seg_data&lt;=not&quot;01011110&quot;;
        when &quot;1110&quot;=&gt;seg_data&lt;=not&quot;01111001&quot;;
        when &quot;1111&quot;=&gt;seg_data&lt;=not&quot;01110001&quot;;
        when others=&gt;seg_data&lt;=not&quot;11111111&quot;;
    end case;
        
end process;
end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity adder_tb is
--  Port ( );
end adder_tb;

architecture Behavioral of adder_tb is
component adder
    Port (
        clk,rst:in std_logic;
        a,b:in std_logic_vector(7 downto 0);
        c:in std_logic;
        c_out:out std_logic;
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
     );
end component;
signal clk,rst :std_logic;
signal a,b     :std_logic_vector(7 downto 0);
signal c       :std_logic;
signal c_out   : std_logic;
signal sel_out : std_logic_vector(15 downto 0);
signal seg_data: std_logic_vector(7 downto 0);

begin
adder_inst:adder port map(clk,rst,a,b,c,c_out,sel_out,seg_data);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

restart:process
begin
    rst&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait;
end process;

test:process
begin
    a&lt;=&quot;00100010&quot;;
    b&lt;=&quot;01000100&quot;;
    c&lt;=&#39;1&#39;;
    wait for 100ns;
    
    a&lt;=&quot;11111111&quot;;
    b&lt;=&quot;11111111&quot;;
    c&lt;=&#39;1&#39;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<pre><code>set_property PACKAGE_PIN E26 [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26 [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26 [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21 [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21 [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23 [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24 [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21 [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[0]&#125;]

set_property PACKAGE_PIN E10 [get_ports clk]
set_property PACKAGE_PIN C9 [get_ports &#123;a[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;a[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;a[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;a[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;a[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;a[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;a[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;a[7]&#125;]

set_property PACKAGE_PIN B10 [get_ports &#123;b[0]&#125;]
set_property PACKAGE_PIN A10 [get_ports &#123;b[1]&#125;]
set_property PACKAGE_PIN B15 [get_ports &#123;b[2]&#125;]
set_property PACKAGE_PIN A15 [get_ports &#123;b[3]&#125;]
set_property PACKAGE_PIN A13 [get_ports &#123;b[4]&#125;]
set_property PACKAGE_PIN A12 [get_ports &#123;b[5]&#125;]
set_property PACKAGE_PIN D8 [get_ports &#123;b[6]&#125;]
set_property PACKAGE_PIN D9 [get_ports &#123;b[7]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[7]&#125;]

set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[7]&#125;]


set_property IOSTANDARD LVCMOS18 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
set_property IOSTANDARD LVCMOS33 [get_ports c_out]
set_property IOSTANDARD LVCMOS18 [get_ports c]

set_property PACKAGE_PIN J14 [get_ports c]
set_property PACKAGE_PIN G16 [get_ports c_out]
set_property PACKAGE_PIN J8 [get_ports rst]

#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[0]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[1]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[2]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[3]&#125;]

#set_property PACKAGE_PIN F8 [get_ports &#123;sel_in[0]&#125;]
#set_property PACKAGE_PIN F9 [get_ports &#123;sel_in[1]&#125;]
#set_property PACKAGE_PIN H11 [get_ports &#123;sel_in[2]&#125;]
#set_property PACKAGE_PIN H12 [get_ports &#123;sel_in[3]&#125;]

set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[10]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[15]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[12]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[13]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[8]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[11]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[14]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[9]&#125;]
set_property PACKAGE_PIN A23 [get_ports &#123;sel_out[15]&#125;]
set_property PACKAGE_PIN A24 [get_ports &#123;sel_out[14]&#125;]
set_property PACKAGE_PIN D26 [get_ports &#123;sel_out[13]&#125;]
set_property PACKAGE_PIN C26 [get_ports &#123;sel_out[12]&#125;]
set_property PACKAGE_PIN A20 [get_ports &#123;sel_out[11]&#125;]
set_property PACKAGE_PIN J25 [get_ports &#123;sel_out[10]&#125;]
set_property PACKAGE_PIN J24 [get_ports &#123;sel_out[9]&#125;]
set_property PACKAGE_PIN H22 [get_ports &#123;sel_out[8]&#125;]
set_property PACKAGE_PIN K21 [get_ports &#123;sel_out[7]&#125;]
set_property PACKAGE_PIN L23 [get_ports &#123;sel_out[6]&#125;]
set_property PACKAGE_PIN B25 [get_ports &#123;sel_out[5]&#125;]
set_property PACKAGE_PIN B26 [get_ports &#123;sel_out[4]&#125;]
set_property PACKAGE_PIN C24 [get_ports &#123;sel_out[3]&#125;]
set_property PACKAGE_PIN D21 [get_ports &#123;sel_out[2]&#125;]
set_property PACKAGE_PIN C22 [get_ports &#123;sel_out[1]&#125;]
set_property PACKAGE_PIN B20 [get_ports &#123;sel_out[0]&#125;]
</code></pre>
<h3 id="3-阵列乘法器设计"><a href="#3-阵列乘法器设计" class="headerlink" title="3.阵列乘法器设计"></a>3.阵列乘法器设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/d9b23c4e7c365f7e9bd09cd34b890dbe.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b8ebdee3a1727312ec82f82a48997c04.png"></p>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier_seg is
    Port (
        rst,clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end array_multiplier_seg;

architecture Behavioral of array_multiplier_seg is

component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component array_multiplier
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;
component decoder4_16
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end component;

signal clk_out_line:std_logic;
signal sum_out_line:std_logic_vector(15 downto 0);
signal seg_dig_line:std_logic_vector(3 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(clk,clk_out_line);
array_multiplier_inst:array_multiplier port map(clk_out_line,a_in,b_in,sum_out_line);
seg_dis_inst:seg_dis port map(rst,clk_out_line,sum_out_line,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,seg_dig_line,seg_data);
decoder4_16_inst:decoder4_16 port map(seg_dig_line,seg_dig);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/48f312e41997369070448630c369ef88.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier is
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end array_multiplier;

architecture Behavioral of array_multiplier is
component array_multiplier_top
    Port (
        a_in:in std_logic;
        b_in:in std_logic_vector(7 downto 0);
        s:out std_logic_vector(7 downto 0)
     );
end component;
component array_multiplier_unit
    Port (
        x_in:in std_logic;
        y_in:in std_logic_vector(7 downto 0);
        c_in:in std_logic_vector(6 downto 0);
        z_in:in std_logic_vector(7 downto 0);
        c_out:out std_logic_vector(6 downto 0);
        z_out:out std_logic_vector(7 downto 0)
     );
end component;
component array_multiplier_low
    Port (
        z_in,c_in:in std_logic_vector(6 downto 0);
        s_out:out std_logic_vector(7 downto 0)
     );
end component;

signal z_in0:std_logic_vector(7 downto 0);
signal z_in1:std_logic_vector(7 downto 0);
signal z_in2:std_logic_vector(7 downto 0);
signal z_in3:std_logic_vector(7 downto 0);
signal z_in4:std_logic_vector(7 downto 0);
signal z_in5:std_logic_vector(7 downto 0);
signal z_in6:std_logic_vector(7 downto 0);
signal z_in7:std_logic_vector(7 downto 0);
signal c_in1:std_logic_vector(6 downto 0);
signal c_in2:std_logic_vector(6 downto 0);
signal c_in3:std_logic_vector(6 downto 0);
signal c_in4:std_logic_vector(6 downto 0);
signal c_in5:std_logic_vector(6 downto 0);
signal c_in6:std_logic_vector(6 downto 0);
signal c_in7:std_logic_vector(6 downto 0);

begin

array_multiplier_top_inst:array_multiplier_top port map(a_in(0),b_in,z_in0);
array_multiplier_unit_inst1:array_multiplier_unit port map(a_in(1),b_in,&quot;0000000&quot;,z_in0,c_in1,z_in1);
array_multiplier_unit_inst2:array_multiplier_unit port map(a_in(2),b_in,c_in1,z_in1,c_in2,z_in2);
array_multiplier_unit_inst3:array_multiplier_unit port map(a_in(3),b_in,c_in2,z_in2,c_in3,z_in3);
array_multiplier_unit_inst4:array_multiplier_unit port map(a_in(4),b_in,c_in3,z_in3,c_in4,z_in4);
array_multiplier_unit_inst5:array_multiplier_unit port map(a_in(5),b_in,c_in4,z_in4,c_in5,z_in5);
array_multiplier_unit_inst6:array_multiplier_unit port map(a_in(6),b_in,c_in5,z_in5,c_in6,z_in6);
array_multiplier_unit_inst7:array_multiplier_unit port map(a_in(7),b_in,c_in6,z_in6,c_in7,z_in7);
array_multiplier_low_inst:array_multiplier_low port map(z_in7(7 downto 1),c_in7,sum_out(15 downto 8));

process(clk,a_in,b_in)
begin
    sum_out(0)&lt;=z_in0(0);
    sum_out(1)&lt;=z_in1(0);
    sum_out(2)&lt;=z_in2(0);
    sum_out(3)&lt;=z_in3(0);
    sum_out(4)&lt;=z_in4(0);
    sum_out(5)&lt;=z_in5(0);
    sum_out(6)&lt;=z_in6(0);
    sum_out(7)&lt;=z_in7(0);
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b2b81a5e7b42395fba8c9fb656d835fd.png"></p>
<p>模块：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier_top is
    Port (
        a_in:in std_logic;
        b_in:in std_logic_vector(7 downto 0);
        s:out std_logic_vector(7 downto 0)
     );
end array_multiplier_top;

architecture Behavioral of array_multiplier_top is

begin

process(a_in,b_in)
begin
    for i in 0 to 7 loop
       s(i)&lt;=a_in and b_in(i); 
    end loop;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier_unit is
    Port (
        x_in:in std_logic;
        y_in:in std_logic_vector(7 downto 0);
        c_in:in std_logic_vector(6 downto 0);
        z_in:in std_logic_vector(7 downto 0);
        c_out:out std_logic_vector(6 downto 0);
        z_out:out std_logic_vector(7 downto 0)
     );
end array_multiplier_unit;

architecture Behavioral of array_multiplier_unit is
component adder_1bit
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end component;

signal a_line:std_logic_vector(7 downto 0);

begin

adder_1bit_inst1:adder_1bit port map(a_line(0),c_in(0),z_in(1),z_out(0),c_out(0));
adder_1bit_inst2:adder_1bit port map(a_line(1),c_in(1),z_in(2),z_out(1),c_out(1));
adder_1bit_inst3:adder_1bit port map(a_line(2),c_in(2),z_in(3),z_out(2),c_out(2));
adder_1bit_inst4:adder_1bit port map(a_line(3),c_in(3),z_in(4),z_out(3),c_out(3));
adder_1bit_inst5:adder_1bit port map(a_line(4),c_in(4),z_in(5),z_out(4),c_out(4));
adder_1bit_inst6:adder_1bit port map(a_line(5),c_in(5),z_in(6),z_out(5),c_out(5));
adder_1bit_inst7:adder_1bit port map(a_line(6),c_in(6),z_in(7),z_out(6),c_out(6));

process(x_in,y_in)
begin 
    z_out(7)&lt;=x_in and y_in(7);
    for i in 0 to 7 loop
       a_line(i)&lt;=x_in and y_in(i);
    end loop;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a2c62b9b632c261aa03fc7767147d496.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier_low is
    Port (
        z_in,c_in:in std_logic_vector(6 downto 0);
        s_out:out std_logic_vector(7 downto 0)
     );
end array_multiplier_low;

architecture Behavioral of array_multiplier_low is
component adder_1bit
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end component;

signal c_line:std_logic_vector(5 downto 0);

begin

adder_1bit_inst0:adder_1bit port map(z_in(0),c_in(0),&#39;0&#39;,s_out(0),c_line(0));
adder_1bit_inst1:adder_1bit port map(z_in(1),c_in(1),c_line(0),s_out(1),c_line(1));
adder_1bit_inst2:adder_1bit port map(z_in(2),c_in(2),c_line(1),s_out(2),c_line(2));
adder_1bit_inst3:adder_1bit port map(z_in(3),c_in(3),c_line(2),s_out(3),c_line(3));
adder_1bit_inst4:adder_1bit port map(z_in(4),c_in(4),c_line(3),s_out(4),c_line(4));
adder_1bit_inst5:adder_1bit port map(z_in(5),c_in(5),c_line(4),s_out(5),c_line(5));
adder_1bit_inst6:adder_1bit port map(z_in(6),c_in(6),c_line(5),s_out(6),s_out(7));

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity adder_1bit is
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end adder_1bit;

architecture Behavioral of adder_1bit is

begin

process(a,b,c_in)
begin
    s&lt;=a xor b xor c_in;
    c_out&lt;=(a and b)or((a xor b)and c_in);
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity array_multiplier_tb is
--  Port ( );
end array_multiplier_tb;

architecture Behavioral of array_multiplier_tb is
component array_multiplier_seg
    Port (
        rst,clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;

signal rst,clk:std_logic;
signal a_in,b_in:std_logic_vector(7 downto 0);
signal seg_dig:std_logic_vector(15 downto 0);
signal seg_data:std_logic_vector(7 downto 0);


begin

array_multiplier_seg_inst:array_multiplier_seg port map(rst,clk,a_in,b_in,seg_dig,seg_data);

clock:process
begin 
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

restart:process
begin
    rst&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait;
end process;

test:process
begin
    a_in&lt;=&quot;10111101&quot;;
    b_in&lt;=&quot;11001010&quot;;
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4c1acafbbcf9f2fcb9878c936a3f2244.png"></p>
<p>xdc:</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/18 13:02:24
#----------------------------------------------------------------------------------
#CLK_100M
set_property PACKAGE_PIN E10 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports clk]

#SW0~15
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[7]&#125;]
set_property PACKAGE_PIN C9 [get_ports &#123;a_in[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;a_in[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;a_in[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;a_in[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;a_in[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;a_in[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;a_in[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;a_in[7]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[7]&#125;]
set_property PACKAGE_PIN B10 [get_ports &#123;b_in[0]&#125;]
set_property PACKAGE_PIN A10 [get_ports &#123;b_in[1]&#125;]
set_property PACKAGE_PIN B15 [get_ports &#123;b_in[2]&#125;]
set_property PACKAGE_PIN A15 [get_ports &#123;b_in[3]&#125;]
set_property PACKAGE_PIN A13 [get_ports &#123;b_in[4]&#125;]
set_property PACKAGE_PIN A12 [get_ports &#123;b_in[5]&#125;]
set_property PACKAGE_PIN D8 [get_ports &#123;b_in[6]&#125;]
set_property PACKAGE_PIN D9 [get_ports &#123;b_in[7]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23 [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24 [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26 [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26 [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20 [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25 [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24 [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22 [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21 [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23 [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25 [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26 [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24 [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21 [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22 [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20 [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26 [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26 [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26 [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21 [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21 [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23 [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24 [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21 [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[0]&#125;]


set_property PACKAGE_PIN J8 [get_ports rst]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
</code></pre>
<h3 id="4-先进先出-FIFO-的设计"><a href="#4-先进先出-FIFO-的设计" class="headerlink" title="4.先进先出 FIFO 的设计"></a>4.先进先出 FIFO 的设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/311aeef9dede913202b7df632c3aa302.png"></p>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
-- Module Name: FIFO_ring_test - Behavioral
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity FIFO_ring_test is
generic(
    CLK_FRE:integer:=100000000;
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        key_in:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end FIFO_ring_test;

architecture Behavioral of FIFO_ring_test is

component key_stroke
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end component;
component FIFO_ring
generic(
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk,clk_rd,clk_wr:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal out_put:std_logic;

begin
key_stroke_inst:key_stroke generic map(CLK_FRE)port map(clk=&gt;clk,reset=&gt;rst,key_in=&gt;key_in,output=&gt;out_put);
FIFO_ring_inst:FIFO_ring generic map(cycle_max,depth,width)port map(rst=&gt;rst,clk=&gt;clk,clk_rd=&gt;out_put,clk_wr=&gt;out_put,wr=&gt;wr,rd=&gt;rd,data_in=&gt;data_in,full=&gt;full,empty=&gt;empty,data_out=&gt;data_out);

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
-- Module Name: FIFO_ring - Behavioral
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity FIFO_ring is
generic(
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk,clk_rd,clk_wr:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end FIFO_ring;

architecture Behavioral of FIFO_ring is
component duaram
generic(
    depth:positive:=3;
    width:positive:=8
);
Port(
    clka:in std_logic;
    wr:in std_logic;
    wr_en:in std_logic;
    addra:in std_logic_vector(depth-1 downto 0);
    datain:in std_logic_vector(width-1 downto 0);
    
    clkb:in std_logic;
    rd:in std_logic;
    rd_en:in std_logic;
    addrb:in std_logic_vector(depth-1 downto 0);
    dataout:out std_logic_vector(width-1 downto 0)
); 
end component;
component FIFO_ring_duaram_controller
generic(
    cycle_max:positive;--最大读写圈数
    depth:positive
);
Port(
    rst:in std_logic;
    clk,clka,clkb:in std_logic;
    wq:in std_logic;
    rq:in std_logic;
    full:out std_logic;
    empty:out std_logic;
    
    wr_pt:out std_logic_vector(depth-1 downto 0);
    rd_pt:out std_logic_vector(depth-1 downto 0)
);
end component;

signal rp_line:std_logic_vector(depth-1 downto 0);
signal wp_line:std_logic_vector(depth-1 downto 0);
signal empty_line:std_logic;
signal full_line:std_logic;

begin
duaram_inst:duaram generic map(depth,width)port map(clka=&gt;clk_wr,clkb=&gt;clk_rd,datain=&gt;data_in,dataout=&gt;data_out,addra=&gt;wp_line,addrb=&gt;rp_line,rd=&gt;rd,wr=&gt;wr,rd_en=&gt;empty_line,wr_en=&gt;full_line);
FIFO_ring_duaram_controller_inst:FIFO_ring_duaram_controller generic map(cycle_max,depth)port map(rst=&gt;rst,clk=&gt;clk,clkb=&gt;clk_rd,clka=&gt;clk_wr,wq=&gt;wr,rq=&gt;rd,full=&gt;full_line,empty=&gt;empty_line,wr_pt=&gt;wp_line,rd_pt=&gt;rp_line);

process(empty_line,full_line)
begin
    empty&lt;=empty_line;
    full&lt;=full_line;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a99a9296939596a5890faf5f0a592e12.png"></p>
<p>模块：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
-- Module Name: FIFO_ring - Behavioral
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity duaram is
    generic(
        depth:positive;
        width:positive
    );
    Port(
        clka:in std_logic;
        wr:in std_logic;
        wr_en:in std_logic;
        addra:in std_logic_vector(depth-1 downto 0);
        datain:in std_logic_vector(width-1 downto 0);
        
        clkb:in std_logic;
        rd:in std_logic;
        rd_en:in std_logic;
        addrb:in std_logic_vector(depth-1 downto 0);
        dataout:out std_logic_vector(width-1 downto 0)
    );
end duaram;

architecture Behavioral of duaram is
type ram is array(2**depth-1 downto 0)of std_logic_vector(width-1 downto 0);
signal dualram:ram;
begin

    process(clka)
    begin
        if(clka&#39;event and clka=&#39;1&#39;)then
            if(wr=&#39;0&#39;and wr_en=&#39;0&#39;)then dualram(conv_integer(addra))&lt;=datain;end if;
        end if;
    end process;
    
    process(clkb)
    begin
        if(clkb&#39;event and clkb=&#39;1&#39;)then
            if(rd=&#39;0&#39;and rd_en=&#39;0&#39;)then dataout&lt;=dualram(conv_integer(addrb));end if;
        end if;
    end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
-- Module Name: FIFO_ring_duaram_controller - Behavioral
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity FIFO_ring_duaram_controller is
generic(
    cycle_max:positive;--最大读写圈数
    depth:positive
);
Port(
    rst:in std_logic;
    clk,clka,clkb:in std_logic;
    wq:in std_logic;
    rq:in std_logic;
    full:out std_logic;
    empty:out std_logic;
    
    wr_pt:out std_logic_vector(depth-1 downto 0);
    rd_pt:out std_logic_vector(depth-1 downto 0)
);
end FIFO_ring_duaram_controller;

architecture Behavioral of FIFO_ring_duaram_controller is
signal wr_pt_t:std_logic_vector(depth+cycle_max-1 downto 0);
signal rd_pt_t:std_logic_vector(depth+cycle_max-1 downto 0);
signal full_line:std_logic;
signal empty_line:std_logic;
begin

--write_pointer
process(rst,clka)
begin
    if(rst=&#39;0&#39;)then
        wr_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clka&#39;event and clka=&#39;1&#39;)then
        if (wq=&#39;0&#39;and full_line=&#39;0&#39;)then wr_pt_t&lt;=wr_pt_t+1;end if;
    end if;     
end process;

--read_pointer
process(rst,clkb)
begin
    if(rst=&#39;0&#39;)then
        rd_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clkb&#39;event and clkb=&#39;1&#39;)then
        if (rq=&#39;0&#39;and empty_line=&#39;0&#39;)then 
rd_pt_t&lt;=rd_pt_t+1;
end if;
    end if;
end process;

--judge_status
process(rst,clk)
begin
    if(rst=&#39;0&#39;)then empty_line&lt;=&#39;1&#39;;full_line&lt;=&#39;0&#39;;
    elsif(clk&#39;event and clk=&#39;1&#39;)then
        if(wr_pt_t=rd_pt_t)then empty_line&lt;=&#39;1&#39;;full_line&lt;=&#39;0&#39;;
        elsif(wr_pt_t=rd_pt_t+2**depth)then empty_line&lt;=&#39;0&#39;;full_line&lt;=&#39;1&#39;;
        else empty_line&lt;=&#39;0&#39;;full_line&lt;=&#39;0&#39;;
        end if;
    end if;  
end process;

process(wr_pt_t)
begin wr_pt&lt;=wr_pt_t(depth-1 downto 0);
end process;

process(rd_pt_t)
begin rd_pt&lt;=rd_pt_t(depth-1 downto 0);
end process;

process(empty_line)
begin empty&lt;=empty_line;
end process;

process(full_line)
begin full&lt;=full_line;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
-- Module Name: FIFO_ring_tb - Behavioral
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity FIFO_ring_tb is
--  Port ( );
end FIFO_ring_tb;

architecture Behavioral of FIFO_ring_tb is

component FIFO_ring_test
generic(
    CLK_FRE:integer:=100000000;
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        key_in:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal clk:std_logic;
signal rst:std_logic;
signal key_in:std_logic;
signal data_in:std_logic_vector(7 downto 0);
signal wr:std_logic;
signal rd:std_logic;
signal empty:std_logic;
signal full:std_logic;
signal data_out:std_logic_vector(7 downto 0);

begin

FIFO_ring_test_inst:FIFO_ring_test generic map(100000000,3,8)port map(clk,rst,key_in,data_in,wr,rd,empty,full,data_out);

clock:process
begin
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
end process;

reset:process
begin
    rst&lt;=&#39;0&#39;;
    wait for 25ns;
    rst&lt;=&#39;1&#39;;
    wait;
end process;

test:process
begin
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;1&#39;;
    data_in&lt;=&quot;00000000&quot;;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;0&#39;;
    data_in&lt;=&quot;00000001&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00000010&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00000100&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00001000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00010000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00100000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;01000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;10000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;11111111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00001111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;11110000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wr&lt;=&#39;1&#39;;
    rd&lt;=&#39;0&#39;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;0&#39;;
    data_in&lt;=not&quot;00000001&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00000010&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00000100&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00001000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00010000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00100000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;01000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;10000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;11111111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00001111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;11110000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wr&lt;=&#39;1&#39;;
    rd&lt;=&#39;0&#39;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/36a731b3be24e70c8626b6c8ffc27d7b.png"></p>
<p>xdc：</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/18 13:02:24
#----------------------------------------------------------------------------------
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9 [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;data_in[7]&#125;]

set_property PACKAGE_PIN E10 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports clk]

#sw31
set_property PACKAGE_PIN J8 [get_ports rst]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
#sw30
set_property PACKAGE_PIN J14 [get_ports key_in]
set_property IOSTANDARD LVCMOS18 [get_ports key_in]
#sw29
set_property PACKAGE_PIN H9 [get_ports wr]
set_property IOSTANDARD LVCMOS18 [get_ports wr]
#sw28
set_property PACKAGE_PIN H8 [get_ports rd]
set_property IOSTANDARD LVCMOS18 [get_ports rd]
#led15
set_property PACKAGE_PIN L20 [get_ports empty]
set_property IOSTANDARD LVCMOS33 [get_ports empty]
#led11
set_property PACKAGE_PIN J20 [get_ports full]
set_property IOSTANDARD LVCMOS33 [get_ports full]
#led0-7
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]
</code></pre>
<h3 id="5-PC-程序计数器设计"><a href="#5-PC-程序计数器设计" class="headerlink" title="5.PC 程序计数器设计"></a>5.PC 程序计数器设计</h3><p> PC 功能分析 加 1 功能、更新地址功能、PC 数值送到数据总线</p>
<p> PC 功能实现</p>
<p>1）全局异步复位功能</p>
<pre><code>     ADDR&lt;=“000000000000”;

     数据总线高阻态;
</code></pre>
<p>2）加 1 功能</p>
<pre><code>     clk_PC 上升沿有效;

     M_PC 高电平有效，PC+1=&gt;ADDR;
</code></pre>
<p>3）地址更新功能</p>
<pre><code>     clk_PC 上升沿有效，nLD_PC 低电平有效，新的 PC=&gt;ADDR；

     PC 数值送到数据总线，nPCH 和 nPCL 低电平有效，注意分两次输出到总线上，先高 8 位后低 8 位。
</code></pre>
<p><strong>注：自行添加按键消抖模块</strong></p>
<p>源码：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity pc is
    Port (        
        rst,clk_PC,M_PC,nLD_PC:in std_logic;
        PC_in:in std_logic_vector(11 downto 0);
        
        DATA_BUS:inout std_logic_vector(7 downto 0);
        
        nPCH,nPCL:out std_logic
     );
end pc;

architecture Behavioral of pc is

signal pc_count:std_logic_vector(11 downto 0);
signal ADDR:std_logic_vector(11 downto 0);


begin

process(rst,clk_PC)
variable addr_count:integer:=0;
begin
    if(rst=&#39;1&#39;)then 
        pc_count&lt;=PC_in;
        ADDR&lt;=pc_count;
        DATA_BUS&lt;=&quot;XXXXXXXX&quot;;
        nPCH&lt;=&#39;1&#39;;nPCL&lt;=&#39;1&#39;;

    elsif(clk_PC=&#39;1&#39;and clk_PC&#39;event)then
        if(addr_count=0)then pc_count&lt;=pc_count+1;end if;
        if(M_PC=&#39;1&#39;)then ADDR&lt;=pc_count;end if;
        if(nLD_PC=&#39;0&#39;)then 
            if(addr_count=0)then DATA_BUS&lt;=&quot;0000&quot;&amp; ADDR(11 downto 8);addr_count:=addr_count+1;nPCH&lt;=&#39;0&#39;;nPCL&lt;=&#39;1&#39;;
            elsif(addr_count=1)then DATA_BUS&lt;=ADDR(7 downto 0);addr_count:=addr_count-1;nPCH&lt;=&#39;1&#39;;nPCL&lt;=&#39;0&#39;;
            end if;
        end if;
    end if;
end process;



end Behavioral;
</code></pre>
<p>xdc:</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/18 13:02:24
#----------------------------------------------------------------------------------
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;PC_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;PC_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;PC_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;PC_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;PC_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;PC_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;PC_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;PC_in[7]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[8]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[9]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[10]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;PC_in[11]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;PC_in[8]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;PC_in[9]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;PC_in[10]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;PC_in[11]&#125;]


set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;DATA_BUS[7]&#125;]

#sw31
set_property PACKAGE_PIN J8 [get_ports rst]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
#sw30
set_property CLOCK_DEDICATED_ROUTE FALSE [get_nets clk_PC]
set_property PACKAGE_PIN J14 [get_ports clk_PC]
set_property IOSTANDARD LVCMOS18 [get_ports clk_PC]
#sw29
set_property PACKAGE_PIN H9 [get_ports M_PC]
set_property IOSTANDARD LVCMOS18 [get_ports M_PC]
#sw28
set_property PACKAGE_PIN H8 [get_ports nLD_PC]
set_property IOSTANDARD LVCMOS18 [get_ports nLD_PC]

#led15
set_property PACKAGE_PIN L20 [get_ports nPCH]
set_property IOSTANDARD LVCMOS33 [get_ports nPCH]
#led11
set_property PACKAGE_PIN J20 [get_ports nPCL]
set_property IOSTANDARD LVCMOS33 [get_ports nPCL]
</code></pre>
<h3 id="6-程序存储器-ROM-设计"><a href="#6-程序存储器-ROM-设计" class="headerlink" title="6.程序存储器 ROM 设计"></a>6.程序存储器 ROM 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/ca1179f853bd18943bce21382adae2c2.png"></p>
<p>源码：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_unsigned.ALL;
use IEEE.STD_LOGIC_textio.ALL;
use std.textio.all;

entity ROM is
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end ROM;

architecture Behavioral of ROM is
type matrix is array (integer range&lt;&gt;)of std_logic_vector(width-1 downto 0);
signal rom:matrix(0 to 2**depth-1);

procedure load_rom (signal data_word:out matrix)is
file romfile:text open read_mode is &quot;romfile.dat&quot;;
variable lbuf:line;
variable i:integer:=0;
variable fdata:std_logic_vector(7 downto 0);
begin
    while(not endfile(romfile)and i&lt;2**depth)loop
        readline(romfile,lbuf);
        read(lbuf,fdata);
        data_word(i)&lt;=fdata;
        i:=i+1;
    end loop;
end procedure;

begin

load_rom(rom);

process(clk_ROM)
begin
    if(clk_ROM=&#39;1&#39;and clk_ROM&#39;event)then        
        if(ROM_EN=&#39;0&#39;and M_ROM=&#39;1&#39;)then
            DATA_BUS&lt;=rom(conv_integer(addr));
        else DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;        
        
end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 13:02:24
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity ROM_tb is
--  Port ( );
end ROM_tb;

architecture Behavioral of ROM_tb is
component ROM
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal rst:std_logic;
signal clk_ROM,M_ROM,ROM_EN:std_logic;
signal addr:std_logic_vector(11 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);

begin

ROM_inst:ROM generic map(12,8)port map(clk_ROM,M_ROM,ROM_EN,addr,DATA_BUS);

clock:process
begin
    clk_ROM&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_ROM&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    M_ROM&lt;=&#39;0&#39;;
    ROM_EN&lt;=&#39;1&#39;;
    addr&lt;=(others=&gt;&#39;0&#39;);
    wait for 25ns;
    M_ROM&lt;=&#39;1&#39;;
    wait for 25ns;
    ROM_EN&lt;=&#39;0&#39;;
    
    wait for 5ns;
    addr&lt;=&quot;000000000000&quot;;
    wait for 20ns;  
    wait for 5ns;
    addr&lt;=&quot;000000000001&quot;;
    wait for 20ns;
    wait for 5ns;
    addr&lt;=&quot;000000000010&quot;;
    wait for 20ns;
    wait for 5ns;
    addr&lt;=&quot;000000000011&quot;;
    wait for 20ns;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p>xdc:</p>
<pre><code>set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[7]&#125;]
set_property PACKAGE_PIN C9 [get_ports &#123;addr[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;addr[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;addr[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;addr[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;addr[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;addr[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;addr[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;addr[7]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[8]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[9]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[10]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;addr[11]&#125;]
set_property PACKAGE_PIN B10 [get_ports &#123;addr[8]&#125;]
set_property PACKAGE_PIN A10 [get_ports &#123;addr[9]&#125;]
set_property PACKAGE_PIN B15 [get_ports &#123;addr[10]&#125;]
set_property PACKAGE_PIN A15 [get_ports &#123;addr[11]&#125;]

set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN G16 [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN H16 [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN D16 [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN D15 [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN C18 [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN C17 [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN B19 [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN C19 [get_ports &#123;DATA_BUS[7]&#125;]

#sw30
set_property PACKAGE_PIN J14 [get_ports ROM_EN]
set_property IOSTANDARD LVCMOS18 [get_ports ROM_EN]

#sw31
set_property PACKAGE_PIN J8 [get_ports M_ROM]
set_property IOSTANDARD LVCMOS18 [get_ports M_ROM]

set_property PACKAGE_PIN E10 [get_ports clk_ROM]
set_property IOSTANDARD LVCMOS18 [get_ports clk_ROM]
</code></pre>
<h3 id="7-加减交替除法器"><a href="#7-加减交替除法器" class="headerlink" title="7.加减交替除法器"></a>7.加减交替除法器</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/36f7c7ddcdd765b4f80b09904c236f2c.png"></p>
<p>原码加减交替除法器的运算法则：</p>
<p>1）除法运算前，应满足条件：X*&lt;Y*,且 Y*≠0,否则，按溢出或非法除数处理；</p>
<p>2）符号位不参与运算，单独处理：qf&#x3D; xf xor yf ;</p>
<p>3）部分余数采用单符号位或双符号位；</p>
<p>4）每步部分余数运算规则：</p>
<pre><code>    ①若余数 R≥0, 则商上 1，左移一次，减除数；

    ②若余数 R＜0, 则商上 0，左移一次，加除数。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity divider_origin_test is
    Port(
        rst,clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end divider_origin_test;

architecture Behavioral of divider_origin_test is
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;

signal clk_line:std_logic;
signal s,r:std_logic_vector(7 downto 0);
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(rst,clk,clk_line);
seg_dis_inst:seg_dis port map(rst,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
divider_origin_inst:divider_origin port map(clk,start,ain,bin,done,s,r);

process(s,r,ain,bin)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;s;
    data_in_B&lt;=&quot;00000000&quot;&amp;r;
    data_in_C&lt;=&quot;00000000&quot;&amp;bin;
    data_in_D&lt;=ain;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3579eeb2efc9ed74282411d3cc4a7c43.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity divider_origin is
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end divider_origin;

architecture Behavioral of divider_origin is

component divider_origin_ctrl
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end component;
component divider_origin_16bitreg
    Port (
        clk,rst:in std_logic;
        ain:in std_logic_vector(15 downto 0);
        d:in std_logic_vector(8 downto 0);
        c_out:out std_logic;
        q:out std_logic_vector(15 downto 0)
     );
end component;
component divider_origin_selector
    Port (
        clk,rst:in std_logic;
        a0:in std_logic;
        din:in std_logic_vector(7 downto 0);
        cout:out std_logic;
        dout:out std_logic_vector(7 downto 0)
     );
end component;
component divider_origin_8bitadder
    Port (
        clk,rst:in std_logic;
        cina,cinb:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end component;

signal clk_line:std_logic;
signal rst_line:std_logic;
signal cina_line,cinb_line:std_logic;
signal bin_line:std_logic_vector(7 downto 0);
signal sout_line:std_logic_vector(8 downto 0);
signal q_line:std_logic_vector(15 downto 0);

begin
divider_origin_ctrl_inst:divider_origin_ctrl port map(clk=&gt;clk,start=&gt;start,clkout=&gt;clk_line,rstall=&gt;rst_line,done=&gt;done);
divider_origin_16bitreg_inst:divider_origin_16bitreg port map(clk=&gt;clk_line,rst=&gt;rst_line,ain=&gt;ain,d=&gt;sout_line,c_out=&gt;cina_line,q=&gt;q_line);
divider_origin_selector_inst:divider_origin_selector port map(clk=&gt;clk_line,rst=&gt;rst_line,a0=&gt;q_line(0),din=&gt;bin,cout=&gt;cinb_line,dout=&gt;bin_line);
divider_origin_8bitadder_inst:divider_origin_8bitadder port map(clk=&gt;clk_line,rst=&gt;rst_line,cina=&gt;cina_line,cinb=&gt;cinb_line,ain=&gt;q_line(15 downto 8),bin=&gt;bin_line,sout=&gt;sout_line);

process(q_line)
begin
    s&lt;=q_line(7 downto 0);--&amp;not sout_line(8);
    r&lt;=cina_line&amp;q_line(15 downto 9);
    --r&lt;=q_line(15 downto 8);
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/19d7c0eaa963aceabd7b7c37f2e266a9.png"></p>
<p>模块：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity divider_origin_ctrl is
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end divider_origin_ctrl;

architecture Behavioral of divider_origin_ctrl is

signal cnt4b:std_logic_vector(3 downto 0);

begin

process(clk,start)
begin
    rstall&lt;=start;
    if(start=&#39;1&#39;)then cnt4b&lt;=&quot;0000&quot;;
    elsif clk&#39;event and clk=&#39;1&#39;then if cnt4b&lt;=7 then cnt4b&lt;=cnt4b+1;end if;
    end if;
end process;

process(clk,cnt4b,start)
begin
    if (start=&#39;1&#39;)then
        clkout&lt;=&#39;0&#39;;done&lt;=&#39;0&#39;; 
    elsif(start=&#39;0&#39;)then    
        if cnt4b&lt;=7 then clkout&lt;=clk;
        else clkout&lt;=&#39;0&#39;;done&lt;=&#39;1&#39;;
        end if; 
    end if;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity divider_origin_16bitreg is
    Port (
        clk,rst:in std_logic;
        ain:in std_logic_vector(15 downto 0);
        d:in std_logic_vector(8 downto 0);
        c_out:out std_logic;
        q:out std_logic_vector(15 downto 0)
     );
end divider_origin_16bitreg;

architecture Behavioral of divider_origin_16bitreg is

begin

process(clk,rst)
variable sr16b:std_logic_vector(15 downto 0);
begin
    if rst=&#39;1&#39;then
        sr16b:=ain;
        c_out&lt;=sr16b(15);--发送符号位
        sr16b(15 downto 1):=sr16b(14 downto 0);--左移一位
        sr16b(0):=&#39;0&#39;;--上0
    elsif(clk=&#39;1&#39;and clk&#39;event)then  
        sr16b(15 downto 8):=d(7 downto 0);
        c_out&lt;=sr16b(15);--发送符号位
        sr16b(15 downto 1):=sr16b(14 downto 0);--左移一位
        sr16b(0):=not d(8);    --上商取反符号位
    end if;   
    q&lt;=sr16b;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity divider_origin_selector is
    Port (
        clk,rst:in std_logic;
        a0:in std_logic;
        din:in std_logic_vector(7 downto 0);
        cout:out std_logic;
        dout:out std_logic_vector(7 downto 0)
     );
end divider_origin_selector;

architecture Behavioral of divider_origin_selector is

signal complement_x_negative:std_logic_vector(7 downto 0);

begin

process(din)
begin
    complement_x_negative&lt;=(not din)+1;
end process;

process(clk,rst,a0,din)

begin
    if(rst=&#39;1&#39;)then dout&lt;=complement_x_negative;cout&lt;=&#39;1&#39;;
    elsif(clk&#39;event and clk=&#39;0&#39;)then
        if(a0=&#39;1&#39;)then dout&lt;=complement_x_negative;cout&lt;=&#39;1&#39;;--输出加数和其符号位
        else dout&lt;=din;cout&lt;=&#39;0&#39;;
        end if;
    end if;    
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;
entity divider_origin_8bitadder is
    Port (
        clk,rst:in std_logic;
        cina,cinb:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end divider_origin_8bitadder;

architecture Behavioral of divider_origin_8bitadder is
begin

process(rst,clk,ain,bin,cina,cinb)
begin
    if(rst=&#39;1&#39;)then sout&lt;=(cina &amp; ain)+(cinb &amp; bin);
    elsif(clk=&#39;0&#39;)then
        sout&lt;=(cina &amp; ain)+(cinb &amp; bin);
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/18 19:49:35
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity divider_origin_tb is
--  Port ( );
end divider_origin_tb;

architecture Behavioral of divider_origin_tb is
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;
signal clk,start: std_logic;
signal ain: std_logic_vector(15 downto 0);
signal bin: std_logic_vector(7 downto 0);
signal done: std_logic;
signal s,r: std_logic_vector(7 downto 0);
begin
divider_origin_inst:divider_origin port map(clk,start,ain,bin,done,s,r);

clock_gen:process
begin  
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    --09 0d
    ain&lt;=x&quot;008B&quot;;
    bin&lt;=x&quot;0E&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --00 ff
    ain&lt;=x&quot;0001&quot;;
    bin&lt;=x&quot;02&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --01 33
    ain&lt;=x&quot;00AB&quot;;
    bin&lt;=x&quot;78&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --ad 27
    ain&lt;=x&quot;ABCD&quot;;
    bin&lt;=x&quot;FE&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
   
    --01 01
    ain&lt;=x&quot;0100&quot;;
    bin&lt;=x&quot;FF&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/bb48954106bbd0bf39a333bc9517b390.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8445a0d3d348041fe6fd9b83e6bbab68.png"></p>
<p>xdc:</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/23 21:55:51
#----------------------------------------------------------------------------------
#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]
#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;ain[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;ain[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;ain[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;ain[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;ain[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;ain[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;ain[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;ain[7]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[8]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[9]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[10]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[11]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[12]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[13]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[14]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;ain[15]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;ain[8]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;ain[9]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;ain[10]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;ain[11]&#125;]
set_property PACKAGE_PIN A13        [get_ports &#123;ain[12]&#125;]
set_property PACKAGE_PIN A12        [get_ports &#123;ain[13]&#125;]
set_property PACKAGE_PIN D8         [get_ports &#123;ain[14]&#125;]
set_property PACKAGE_PIN D9         [get_ports &#123;ain[15]&#125;]
#SW16~SW23
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;bin[7]&#125;]
set_property PACKAGE_PIN F8         [get_ports &#123;bin[0]&#125;]
set_property PACKAGE_PIN F9         [get_ports &#123;bin[1]&#125;]
set_property PACKAGE_PIN H11        [get_ports &#123;bin[2]&#125;]
set_property PACKAGE_PIN H12        [get_ports &#123;bin[3]&#125;]
set_property PACKAGE_PIN G14        [get_ports &#123;bin[4]&#125;]
set_property PACKAGE_PIN J10        [get_ports &#123;bin[5]&#125;]
set_property PACKAGE_PIN H14        [get_ports &#123;bin[6]&#125;]
set_property PACKAGE_PIN J11        [get_ports &#123;bin[7]&#125;]


#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports start]
set_property IOSTANDARD LVCMOS18    [get_ports start]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports done]
set_property PACKAGE_PIN G16			[get_ports done]
</code></pre>
<h3 id="8-指令存储器-IR-设计"><a href="#8-指令存储器-IR-设计" class="headerlink" title="8.指令存储器 IR 设计"></a>8.指令存储器 IR 设计</h3><p> IR 功能分析</p>
<pre><code>     传送指令编码到微控制器

     生成 PC 的新地址

     生成 RAM 的读写地址
</code></pre>
<p> IR 功能实现</p>
<pre><code>     传送指令编码到微控制器

            clk_IR 上升沿有效，LD_IR1 高电平有效， data-&gt;IR。

     寄存器地址操作 Data[0]-&gt; RS；Data[1]-&gt;RD；

     生成 PC 的新地址

            clk_IR 上升沿有效，LD_IR2 高电平有效，data[3..0]-&gt;PC[11..8];

            clk_IR 上升沿有效，LD_IR3 高电平有效，data[7..0]-&gt;PC[7..0]。

     生成 RAM 的读写地址

            clk_IR 上升沿有效，LD_IR3 高电平有效 data[7..0]-&gt;PC[7..0];

            nARen 低电平有效， PC[6..0]-&gt;AR[6..0]。
</code></pre>
<p>源码：  </p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/20 10:29:36
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IR_test is
    port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end IR_test;

architecture Behavioral of IR_test is
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line: std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal DATA_BUS_line :std_logic_vector(7 downto 0);
signal IR_line_line       :std_logic_vector(7 downto 0);--传送指令到指令寄存器
signal PC_out_line   :std_logic_vector(11 downto 0);--PC地址总线
signal AR_line       :std_logic_vector(6 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(rst,clk_IR,clk_line);
sig_dis_inst:seg_dis port map(rst,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
IR_inst:IR port map(rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen,DATA_BUS_line,IR_line_line,RS,RD,PC_out_line,AR_line);

process(DATA_BUS_line,IR_line_line,PC_out_line,AR_line)
begin
        data_in_A&lt;=&quot;00000000&quot;&amp;DATA_BUS_line;
        data_in_B&lt;=&quot;00000000&quot;&amp;IR_line_line;
        data_in_C&lt;=&quot;0000&quot;&amp;PC_out_line;
        data_in_D&lt;=&quot;000000000&quot;&amp;AR_line;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9b9e9bdcb11e643277242864ba0880d9.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/20 10:29:36
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IR is
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end IR;

architecture Behavioral of IR is

begin

process(rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen)
begin
    if(rst=&#39;1&#39;)then
        IR_out&lt;=(others=&gt;&#39;0&#39;);
        PC_out&lt;=(others=&gt;&#39;0&#39;);
        RS&lt;=&#39;0&#39;;RD&lt;=&#39;0&#39;;
    elsif(clk_IR=&#39;1&#39; and clk_IR&#39;event)then
        if(LD_IR1=&#39;1&#39;)then IR_out&lt;=DATA_BUS;end if;
        RS&lt;=DATA_BUS(0);RD&lt;=DATA_BUS(1);
        if(LD_IR2=&#39;1&#39;)then PC_out(11 downto 8)&lt;=DATA_BUS(3 downto 0);
        elsif(LD_IR3=&#39;1&#39;)then 
            PC_out(7 downto 0)&lt;=DATA_BUS(7 downto 0);
            if(nARen=&#39;0&#39;)then AR&lt;=DATA_BUS(6 downto 0);end if;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/20 10:29:36
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IR_tb is
--  Port ( );
end IR_tb;

architecture Behavioral of IR_tb is
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;

signal rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen,RS,RD: std_logic;
signal DATA_BUS :std_logic_vector(7 downto 0);
signal IR_line       :std_logic_vector(7 downto 0);--传送指令到指令寄存器
signal PC_out   :std_logic_vector(11 downto 0);--PC地址总线
signal AR       :std_logic_vector(6 downto 0);

begin

IR_inst:IR port map(rst=&gt;rst,clk_IR=&gt;clk_IR,LD_IR1=&gt;LD_IR1,LD_IR2=&gt;LD_IR2,LD_IR3=&gt;LD_IR3,nARen=&gt;nARen,DATA_BUS=&gt;DATA_BUS,IR_out=&gt;IR_line,RS=&gt;RS,RD=&gt;RD,PC_out=&gt;PC_out,AR=&gt;AR);

clock:process
begin
    clk_IR&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_IR&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    rst&lt;=&#39;1&#39;;
    --DATA_BUS&lt;=x&quot;EE&quot;;
    DATA_BUS&lt;=&quot;11111111&quot;;
    LD_IR1&lt;=&#39;1&#39;;
    LD_IR2&lt;=&#39;0&#39;;
    LD_IR3&lt;=&#39;0&#39;;
    nARen&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait for 20ns;
    DATA_BUS&lt;=x&quot;FA&quot;;
    LD_IR1&lt;=&#39;0&#39;;
    LD_IR2&lt;=&#39;1&#39;;
    LD_IR3&lt;=&#39;0&#39;;
    nARen&lt;=&#39;1&#39;;
    wait for 20ns;
    DATA_BUS&lt;=x&quot;BC&quot;;
    LD_IR1&lt;=&#39;0&#39;;
    LD_IR2&lt;=&#39;0&#39;;
    LD_IR3&lt;=&#39;1&#39;;
    nARen&lt;=&#39;0&#39;;   
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/366b42fa88d3bab2b3d92539815238d9.png"></p>
<p>xdc：</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/23 21:55:51
#----------------------------------------------------------------------------------
#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports LD_IR1]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR1]
set_property PACKAGE_PIN H9         [get_ports LD_IR2]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR2]
set_property PACKAGE_PIN H8         [get_ports LD_IR3]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR3]
set_property PACKAGE_PIN G10        [get_ports nARen]
set_property IOSTANDARD LVCMOS18    [get_ports nARen]

#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk_IR]
set_property IOSTANDARD LVCMOS18    [get_ports clk_IR]

#LED0~1
set_property IOSTANDARD LVCMOS33 		[get_ports RS]
set_property IOSTANDARD LVCMOS33 		[get_ports RD]
set_property PACKAGE_PIN G16			[get_ports RS]
set_property PACKAGE_PIN H16 			[get_ports RD]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;data_in[7]&#125;]
</code></pre>
<h3 id="9-寄存器-RN-设计"><a href="#9-寄存器-RN-设计" class="headerlink" title="9.寄存器 RN 设计"></a>9.寄存器 RN 设计</h3><p>RN 功能分析：</p>
<p> 数据锁存功能</p>
<p> 读写功能</p>
<pre><code>     读寄存器操作

            clk_RN 上升沿有效，Ri_EN 低电平有效，读信号 RDRi 高电平有效，选择 RS 寄存器， 输出 data[7..0]。

     写寄存器操作

            clk_RN 上升沿有效，Ri_EN 低电平有效，写信号 WRRi 高电平有效，选择 RD 寄存器， data[7..0] RD 。
</code></pre>
<p>源码：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/20 17:36:21
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity RN is
    generic(
        depth:integer:=1
    );
    Port(
        clk_RN,Ri_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic_vector(depth-1 downto 0);
        data_in:in std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
        --DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end RN;

architecture Behavioral of RN is
type RN is array(2**depth-1 downto 0)of std_logic_vector(7 downto 0);
signal RN_in:RN;

begin

process(clk_RN)
begin
    if(Ri_EN=&#39;1&#39;)then data_out&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_RN=&#39;1&#39;and clk_RN&#39;event)then
        if(RDRi=&#39;1&#39;)then data_out&lt;=RN_in(conv_integer(RS));
        elsif(WRRi=&#39;1&#39;)then RN_in(conv_integer(RD))&lt;=data_in;
        else data_out&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/22 09:34:26
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity RN_tb is
--  Port ( );
end RN_tb;

architecture Behavioral of RN_tb is
component RN
    generic(
        depth:integer:=1
    );
    Port(
        clk_RN,Ri_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic_vector(depth-1 downto 0);
        data_in:in std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
        --DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_RN,Ri_EN,RDRi,WRRi:std_logic;
signal RS,RD:std_logic_vector(0 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
signal data_in:std_logic_vector(7 downto 0);
signal data_out:std_logic_vector(7 downto 0);

begin

RN_inst:RN generic map(1)port map(clk_RN,Ri_EN,RDRi,WRRi,RS,RD,data_in,data_out);
--RN_inst:RN generic map(1)port map(clk_RN,Ri_EN,RDRi,WRRi,RS,RD,DATA_BUS);

clock:process
begin
    clk_RN&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_RN&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    Ri_EN&lt;=&#39;1&#39;;
    wait for 25ns;
    Ri_EN&lt;=&#39;0&#39;;
    
    RDRi&lt;=&#39;0&#39;;
    WRRi&lt;=&#39;1&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;0&quot;;
    data_in&lt;=x&quot;FF&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;0&#39;;
    WRRi&lt;=&#39;1&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;1&quot;;
    data_in&lt;=x&quot;EE&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;1&#39;;
    WRRi&lt;=&#39;0&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;0&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;1&#39;;
    WRRi&lt;=&#39;0&#39;;
    RS&lt;=&quot;1&quot;;
    RD&lt;=&quot;0&quot;;
       
    wait for 25ns;
    Ri_EN&lt;=&#39;1&#39;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>xdc:</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/23 21:55:51
#----------------------------------------------------------------------------------
#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;data_in[7]&#125;]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk_RN]
set_property IOSTANDARD LVCMOS18    [get_ports clk_RN]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports Ri_EN]
set_property IOSTANDARD LVCMOS18    [get_ports Ri_EN]
set_property PACKAGE_PIN J14        [get_ports RDRi]
set_property IOSTANDARD LVCMOS18    [get_ports RDRi]
set_property PACKAGE_PIN H9         [get_ports WRRi]
set_property IOSTANDARD LVCMOS18    [get_ports WRRi]
set_property PACKAGE_PIN H8         [get_ports &#123;RS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;RS[0]&#125;]
set_property PACKAGE_PIN G10        [get_ports &#123;RD[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;RD[0]&#125;]
</code></pre>
<h3 id="10-ALU算术逻辑单元设计"><a href="#10-ALU算术逻辑单元设计" class="headerlink" title="10.ALU算术逻辑单元设计"></a>10.ALU算术逻辑单元设计</h3><p>算术逻辑单元（ALU）:执行各种算术和逻辑运算。</p>
<p> 算术运算操作 :加、减、乘、除</p>
<p> 逻辑运算操作:与、或、非、异或</p>
<p> ALU 输入:操作数以及来自控制单元的控制命令</p>
<p> ALU 输出:运算结果，以及状态信息</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/43bde231cdd8555e9e66b22f437d9014.png"></p>
<p>源码：</p>
<p>顶层;</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/23 12:35:51
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
USE IEEE.STD_LOGIC_UNSIGNED.ALL;

entity ALU_test is
    port(
        clk : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end ALU_test;

architecture Behavioral of ALU_test is
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
component ALU 
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal nclk2,clk_line:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal regA_out,regB_out,result_out:std_logic_vector(7 downto 0);

signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志

begin
clock_inst:clock port map(clk=&gt;clk,rst=&gt;nreset,nclk2=&gt;nclk2);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
ALU_inst:ALU port map(clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,regA_out,regB_out,result_out,DATA_BUS,AC,CY,ZN,OV);

process(DATA_BUS,AC,CY,ZN,OV,regA_out,regB_out,result_out)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;DATA_BUS;
    data_in_B&lt;=&quot;000&quot;&amp; AC &amp; &quot;000&quot; &amp; CY &amp; &quot;000&quot; &amp; ZN &amp; &quot;000&quot; &amp; OV;
    data_in_C&lt;=regA_out&amp;regB_out;
    data_in_D&lt;=result_out&amp;&quot;00000000&quot;;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/22 11:58:10
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
USE IEEE.STD_LOGIC_UNSIGNED.ALL;

entity ALU is
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end ALU;

architecture Behavioral of ALU is
component array_multiplier
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end component;
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;

signal regA:std_logic_vector(8 downto 0);
signal regB:std_logic_vector(8 downto 0);
signal result:std_logic_vector(8 downto 0);
signal PSW_reg:std_logic_vector(7 downto 0);        --pws(0):CY psw(1):ZN

signal AC_signal :std_logic;
signal CY_signal :std_logic;
signal ZN_signal :std_logic;
signal OV_signal :std_logic;

signal multiplier_out:std_logic_vector(15 downto 0);
signal start,done:std_logic;
signal divider_ina:std_logic_vector(15 downto 0);
signal divider_r:std_logic_vector(7 downto 0);

begin
array_multiplier_inst:array_multiplier port map(clk_ALU,regA(7 downto 0),regB(7 downto 0),multiplier_out);
--divider_origin_inst:divider_origin port map(clk,start,divider_ina,DATA_BUS,done,result(7 downto 0),divider_r);

process(clk_ALU,nreset) 
variable count:integer:=0;
begin
    if(nreset = &#39;1&#39;)then
        start&lt;=&#39;1&#39;;   
        regA &lt;= &quot;000000000&quot;;
        regA &lt;= &quot;000000000&quot;;
        result &lt;= &quot;000000000&quot;;
        DATA_BUS &lt;= &quot;ZZZZZZZZ&quot;;
        AC&lt;= &#39;0&#39;;CY&lt;= &#39;0&#39;;ZN&lt;= &#39;0&#39;;OV&lt;= &#39;0&#39;;
        
    elsif(clk_ALU&#39;event and clk_ALU = &#39;1&#39;)then
        if(M_A=&#39;1&#39;and M_B=&#39;0&#39;)then     --锁存到A
            regA(7 downto 0) &lt;= DATA_BUS;
            regA(8) &lt;= &#39;0&#39;;
        elsif(M_A=&#39;0&#39;and M_B=&#39;1&#39;)then     --锁存到B 
            regB(7 downto 0) &lt;= DATA_BUS;
            regB(8) &lt;= &#39;0&#39;;
            
        elsif(nALU_EN = &#39;0&#39;)then
            case S is
                when &quot;00000&quot; =&gt;         --直传
                    result &lt;= regA;
                    CY_signal &lt;= result(8);
                when &quot;00001&quot; =&gt;         --加法
                    result &lt;= regA+regB+C0;
                    CY_signal &lt;= result(8);
                when &quot;00010&quot; =&gt;         --减法
                    result &lt;= regA - regB;
                    CY_signal &lt;= result(8);
                    if(regA&lt;regB)then OV_signal&lt;=&#39;1&#39;;end if; 
                when &quot;00100&quot; =&gt;         --乘法
                    result(7 downto 0) &lt;= multiplier_out(7 downto 0);
                    CY_signal &lt;= regA(8)xor regB(8);
                    if(regA*regB&gt;x&quot;FF&quot;)then OV_signal&lt;=&#39;1&#39;;end if; 
                when &quot;01000&quot; =&gt;         --除法
                    case count is
                        when 0=&gt;
                            divider_ina&lt;=regA(7 downto 0)&amp;regB(7 downto 0);
                            start&lt;=&#39;0&#39;;
                            count:=count+1;
                        when others=&gt;null;
                    end case;
                    CY_signal &lt;= regA(8)xor regB(8);
                    
                when &quot;10000&quot; =&gt;         --清零
                    regA &lt;= &quot;000000000&quot;;
                    result &lt;= regA;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10001&quot; =&gt;         --与
                    result &lt;= regA and regB;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10010&quot; =&gt;         --或
                    result &lt;= regA or regB;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10100&quot; =&gt;         --A取非
                    result &lt;= not regA;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;11000&quot; =&gt;         --异或
                    result &lt;= regA xor regB;
                    CY_signal &lt;= &#39;0&#39;;
                when others =&gt;
                    result &lt;= &quot;000000000&quot;;
            end case;
            
            case F_in is 
                when &quot;00&quot; =&gt; DATA_BUS&lt;= result(7 downto 0);--直接传送
                when &quot;01&quot; =&gt; DATA_BUS&lt;= result(8 downto 1);--带C右移
                when &quot;10&quot; =&gt; DATA_BUS&lt;= result(6 downto 0)&amp;CY_signal;--循环左移
                when &quot;11&quot; =&gt; DATA_BUS&lt;= result(6 downto 0)&amp;&#39;0&#39;;--逻辑左移
                when others =&gt; DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
            end case;
            
            CY &lt;= CY_signal;
            if(result=&quot;000000000&quot;)then ZN_signal&lt;=&#39;1&#39;;else ZN_signal&lt;=&#39;0&#39;;end if;
            ZN&lt;=ZN_signal;
            
        elsif(nPSW_EN = &#39;0&#39;)then
            PSW_reg(0) &lt;= CY_signal;
            PSW_reg(1) &lt;= ZN_signal;
            DATA_BUS&lt;= PSW_reg;
        else
            DATA_BUS &lt;= &quot;ZZZZZZZZ&quot;;
        end if;
        
    end if;
end process;

process(regA,regB,result)
begin
    regA_out&lt;=regA(7 downto 0);
    regB_out&lt;=regB(7 downto 0);
    result_out&lt;=result(7 downto 0);
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/23 13:34:13
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity ALU_tb is
--  Port ( );
end ALU_tb;

architecture Behavioral of ALU_tb is
component ALU
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0:std_logic;

signal S :std_logic_vector(4 downto 0);
signal F_in :std_logic_vector(1 downto 0);     
signal DATA_BUS:std_logic_vector(7 downto 0);   
signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志

begin
ALU_inst:ALU port map(clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,DATA_BUS,AC,CY,ZN,OV);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

clock_nclk2:process
begin
    nclk2&lt;=&#39;0&#39;;
    wait for 10ns;
    nclk2&lt;=&#39;1&#39;;
    wait for 10ns;
end process;

test:process
begin
    nreset&lt;=&#39;1&#39;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;0&#39;;
    M_F&lt;=&#39;0&#39;;
    nALU_EN&lt;=&#39;1&#39;;
    nPSW_EN&lt;=&#39;1&#39;;
    C0&lt;=&#39;0&#39;;
    S&lt;=&quot;10010&quot;;
    F_in&lt;=&quot;00&quot;;
    wait for 25ns;
    
    nreset&lt;=&#39;0&#39;;
    DATA_BUS&lt;=X&quot;04&quot;;
    M_A&lt;=&#39;1&#39;;
    M_B&lt;=&#39;0&#39;;
    wait for 25ns;
    DATA_BUS&lt;=X&quot;02&quot;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;1&#39;;
    wait for 25ns;
--    DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;0&#39;;
    nALU_EN&lt;=&#39;0&#39;;
    wait for 50ns;
    
    nALU_EN&lt;=&#39;1&#39;;
    nPSW_EN&lt;=&#39;0&#39;;
    wait;
    
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/23 21:55:51
#----------------------------------------------------------------------------------
#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;DATA_BUS[7]&#125;]

#sw31~23
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports nALU_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nALU_EN]
set_property PACKAGE_PIN H9         [get_ports nPSW_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nPSW_EN]
set_property PACKAGE_PIN H8         [get_ports M_A]
set_property IOSTANDARD LVCMOS18    [get_ports M_A]
set_property PACKAGE_PIN G10        [get_ports M_B]
set_property IOSTANDARD LVCMOS18    [get_ports M_B]
set_property PACKAGE_PIN G9         [get_ports M_F]
set_property IOSTANDARD LVCMOS18    [get_ports M_F]
set_property PACKAGE_PIN J13        [get_ports C0]
set_property IOSTANDARD LVCMOS18    [get_ports C0]

#SW16~20
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[4]&#125;]
set_property PACKAGE_PIN F8         [get_ports &#123;S[0]&#125;]
set_property PACKAGE_PIN F9         [get_ports &#123;S[1]&#125;]
set_property PACKAGE_PIN H11        [get_ports &#123;S[2]&#125;]
set_property PACKAGE_PIN H12        [get_ports &#123;S[3]&#125;]
set_property PACKAGE_PIN G14        [get_ports &#123;S[4]&#125;]

#SW22~23
set_property IOSTANDARD LVCMOS18    [get_ports &#123;F_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;F_in[1]&#125;]
set_property PACKAGE_PIN H14        [get_ports &#123;F_in[0]&#125;]
set_property PACKAGE_PIN J11        [get_ports &#123;F_in[1]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]
</code></pre>
<h3 id="11-数据存储器-RAM-设计"><a href="#11-数据存储器-RAM-设计" class="headerlink" title="11.数据存储器 RAM 设计"></a>11.数据存储器 RAM 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/b0f5ae5f7d65bf36add50df2465e24d2.png"></p>
<p>高电平写操作有效，低电平读有效。其中 clk_RAM&#x3D;nclk1 &amp; W1，在组建 CPU 模块时使用。</p>
<p>1）读数据操作：clk_RAM 上升沿有效，RAM_CS 高电平，wr_nRD 低电平，nRAM_EN 低 电平，[AR] -&gt; data 。</p>
<p>2）写数据操作：clk_RAM 上升沿有效，RAM_CS 高电平，wr_nRD 高电平有效，data-&gt;[AR]。</p>
<p>源码：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/23 21:55:51
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity RAM is
    generic(
        depth:integer:=7;
        width:integer:=8
        );
    port( 
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        --DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
        data_in:in STD_LOGIC_VECTOR (width-1 downto 0);
        data_out:out STD_LOGIC_VECTOR (width-1 downto 0)
        );
end RAM;

architecture Behavioral of RAM is

type ram_array is array(0 to 2**depth) of STD_LOGIC_VECTOR (width-1 downto 0);
signal index : integer range 0 to 2**depth;
signal SRAM:ram_array;

begin

process (n_reset,clk_RAM) 
begin
    index&lt;=conv_integer(AR);
    if(n_reset=&#39;1&#39;)  then 
        --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
        data_out&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_RAM&#39;event and clk_RAM=&#39;1&#39;) then
        if(RAM_CS=&#39;1&#39;)then
            if(Wr_nRD=&#39;1&#39;)then
                --SRAM(index)&lt;=DATA_BUS;
                SRAM(index)&lt;=data_in;
            elsif(nRAM_EN=&#39;0&#39;)then
                --DATA_BUS&lt;=SRAM(index);
                data_out&lt;=SRAM(index);
            else
                --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
                data_out&lt;=(others=&gt;&#39;Z&#39;);
            end if;
        else 
            --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
            data_out&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/23 21:55:51
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity RAM_tb is
--  Port ( );
end RAM_tb;

architecture Behavioral of RAM_tb is
component RAM
    generic(
        depth:positive:=7;
        width:positive:=8
    );
    Port (
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
        --data_in:in STD_LOGIC_VECTOR (width-1 downto 0);
        --data_out:out STD_LOGIC_VECTOR (width-1 downto 0))
    );
end component;

signal clk_RAM,n_reset,RAM_CS,nRAM_EN,Wr_nRD:std_logic;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
signal data_in,data_out:std_logic_vector(7 downto 0);

begin

RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;n_reset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,DATA_BUS=&gt;DATA_BUS);
--RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;n_reset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,data_in=&gt;data_in,data_out=&gt;data_out);

clock:process
begin
    clk_RAM&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_RAM&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    n_reset&lt;=&#39;1&#39;;
    wait for 25ns;
    n_reset&lt;=&#39;0&#39;;
    
    RAM_CS&lt;=&#39;1&#39;;
    nRAM_EN&lt;=&#39;1&#39;;
    Wr_nRD&lt;=&#39;1&#39;;
    AR&lt;=&quot;0000000&quot;;
    wait for 25ns;
    DATA_BUS&lt;=x&quot;FF&quot;;
    wait for 25ns;
    AR&lt;=&quot;0000001&quot;;
    wait for 25ns;
    DATA_BUS&lt;=x&quot;EE&quot;;
    wait for 25ns;
    
    nRAM_EN&lt;=&#39;0&#39;;
    Wr_nRD&lt;=&#39;0&#39;;
    AR&lt;=&quot;0000000&quot;;
    wait for 25ns;
    AR&lt;=&quot;0000001&quot;;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/23 21:55:51
#----------------------------------------------------------------------------------
#sw0~6
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;AR[6]&#125;]
set_property PACKAGE_PIN C9 [get_ports &#123;AR[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;AR[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;AR[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;AR[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;AR[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;AR[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;AR[6]&#125;]

#LED
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[0]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[1]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[2]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[3]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[4]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[5]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[6]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[7]&#125;]
#set_property PACKAGE_PIN G16 [get_ports &#123;DATA_BUS[0]&#125;]
#set_property PACKAGE_PIN H16 [get_ports &#123;DATA_BUS[1]&#125;]
#set_property PACKAGE_PIN D16 [get_ports &#123;DATA_BUS[2]&#125;]
#set_property PACKAGE_PIN D15 [get_ports &#123;DATA_BUS[3]&#125;]
#set_property PACKAGE_PIN C18 [get_ports &#123;DATA_BUS[4]&#125;]
#set_property PACKAGE_PIN C17 [get_ports &#123;DATA_BUS[5]&#125;]
#set_property PACKAGE_PIN B19 [get_ports &#123;DATA_BUS[6]&#125;]
#set_property PACKAGE_PIN C19 [get_ports &#123;DATA_BUS[7]&#125;]

#sw31
set_property PACKAGE_PIN J8 [get_ports n_reset]
set_property IOSTANDARD LVCMOS18 [get_ports n_reset]

#sw30~28
set_property PACKAGE_PIN J14 [get_ports RAM_CS]
set_property IOSTANDARD LVCMOS18 [get_ports RAM_CS]
set_property PACKAGE_PIN H9         [get_ports nRAM_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nRAM_EN]
set_property PACKAGE_PIN H8         [get_ports Wr_nRD]
set_property IOSTANDARD LVCMOS18    [get_ports Wr_nRD]

#clk
set_property PACKAGE_PIN E10 [get_ports clk_RAM]
set_property IOSTANDARD LVCMOS18 [get_ports clk_RAM]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN A13        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN A12        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D8         [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN D9         [get_ports &#123;data_in[7]&#125;]
</code></pre>
<h3 id="12-堆栈指针-SP-设计"><a href="#12-堆栈指针-SP-设计" class="headerlink" title="12.堆栈指针 SP 设计"></a>12.堆栈指针 SP 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/450ff7787e4fbc15befc93420b279e3f.png"></p>
<p>其中 clk_SP&#x3D;nclk2，在组建 CPU 模块时使用。</p>
<p>1）数据存储功能：clk_SP 上升沿有效，SP_CS 高电平，nSP_EN 高电平，data-&gt;SP。</p>
<p>2）加 1 功能：clk_SP 上升沿有效，SP_CS 高电平，SP_UP 高电平，nSP_EN 低电平有效，SP+1-&gt;SP,SP-&gt;AR。</p>
<p>3）减 1 功能：clk_SP 上升沿有效，SP_CS 高电平，SP_DN 高电平，nSP_EN 低电平有效， SP-1-&gt;SP,SP-&gt;AR。</p>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 13:45:37
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity SP_test is
    Port(
        clk:in std_logic;       --时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        key_in:in std_logic;    --按键时钟
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end SP_test;

architecture Behavioral of SP_test is
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;
component key_stroke
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end component;

signal clk_line:STD_LOGIC;

begin

key_stroke_inst:key_stroke generic map(100000000)port map(clk,nreset,key_in,clk_line);
SP_inst:SP PORT MAP(clk_line,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);


end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4ca7b953040d5420bd324dcceae3363c.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 10:52:17
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_UNSIGNED.ALL;

entity SP is
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end SP;

architecture Behavioral of SP is

signal SP_p:std_logic_vector(6 downto 0);--指向RAM地址

begin

process(clk_SP,nreset)
begin   
    if(nreset=&#39;0&#39;)then AR&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_SP=&#39;1&#39;and clk_SP&#39;event)then
        if(SP_CS=&#39;1&#39;)then
            if(nSP_EN=&#39;1&#39;)then 
                --SP_p&lt;=data_in;
                SP_p&lt;=DATA_BUS(6 downto 0);
            else
                if(SP_UP=&#39;1&#39;and SP_DN=&#39;0&#39;)then SP_p&lt;=SP_p+1;
                elsif(SP_UP=&#39;0&#39;and SP_DN=&#39;1&#39;)then SP_p&lt;=SP_p-1;
                end if;
                --data_out&lt;=SP_p;
                AR&lt;=SP_p;
            end if;
        else AR&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 13:29:19
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity SP_tb is
--  Port ( );
end SP_tb;

architecture Behavioral of SP_tb is
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;

signal clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN:STD_LOGIC;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);

begin

SP_inst:SP PORT MAP(clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);

clock:process
begin
    clk_SP&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_SP&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    nreset&lt;=&#39;0&#39;;
    SP_CS&lt;=&#39;1&#39;;
    SP_UP&lt;=&#39;0&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;1&#39;;
    DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    wait for 25ns;
    
    DATA_BUS&lt;=x&quot;0F&quot;;
    nreset&lt;=&#39;1&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;1&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;1&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;0&#39;;
    SP_DN&lt;=&#39;1&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    wait;
    
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<pre><code>#clk
set_property PACKAGE_PIN E10 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports clk]

#sw31~28
set_property PACKAGE_PIN J8 [get_ports nreset]
set_property IOSTANDARD LVCMOS18 [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports SP_CS]
set_property IOSTANDARD LVCMOS18    [get_ports SP_CS]
set_property PACKAGE_PIN H9         [get_ports key_in]
set_property IOSTANDARD LVCMOS18    [get_ports key_in]
set_property PACKAGE_PIN H8         [get_ports nSP_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nSP_EN]
set_property PACKAGE_PIN G10        [get_ports SP_UP ]
set_property IOSTANDARD LVCMOS18    [get_ports SP_UP ]
set_property PACKAGE_PIN G9         [get_ports SP_DN ]
set_property IOSTANDARD LVCMOS18    [get_ports SP_DN ]

#LED0~6
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[6]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;AR[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;AR[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;AR[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;AR[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;AR[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;AR[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;AR[6]&#125;]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;DATA_BUS[7]&#125;]
</code></pre>
<h3 id="13-采用硬件描述语言语言设计-IO-模块"><a href="#13-采用硬件描述语言语言设计-IO-模块" class="headerlink" title="13.采用硬件描述语言语言设计 IO 模块"></a>13.采用硬件描述语言语言设计 IO 模块</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/de38a24f3d908b663a479d455c4f613d.png"></p>
<p>其中 clk_P0&#x3D;nclk2，在组建 CPU 模块时使用。</p>
<p>1）输入锁存：</p>
<pre><code>    clk_PO 上升沿有效，P0_CS 高电平，P0_IEN 低电平，

    P0_IN-&gt; 暂存器，RIEN 低电平， 暂存器 -&gt;数据总线（data）。
</code></pre>
<p>2）输出锁存：</p>
<pre><code>    clk_PO 上升沿有效，P0_CS 高电平，P0_OEN 低电平，

    数据总线（data）-&gt;暂存器，ROEN 低电平，暂存器 -&gt;P0_OUT。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 14:37:22
----------------------------------------------------------------------------------

library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IO_test is
    Port(
        clk:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end IO_test;

architecture Behavioral of IO_test is

component IO
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line,rst_seg:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0); 
signal IO_out,DATA_BUS:std_logic_vector(7 downto 0);

begin

IO_inst:IO port map(clk,nreset,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN,IO_in,IO_out,DATA_BUS);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);

process(IO_in,IO_out,DATA_BUS)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;IO_in;
    data_in_B&lt;=&quot;00000000&quot;&amp;DATA_BUS;
    data_in_C&lt;=&quot;00000000&quot;&amp;IO_out;
    data_in_D&lt;=&quot;0000000000000000&quot;;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7c0424c57486f62ce1df707bbc1d0f14.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: 
-- Create Date: 2024/04/24 14:06:31
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IO is
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end IO;

architecture Behavioral of IO is
signal reg:std_logic_vector(7 downto 0);
begin

process(nreset,clk_IO)
begin
    if(nreset=&#39;0&#39;)then IO_out&lt;=&quot;ZZZZZZZZ&quot;;DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    elsif(clk_IO=&#39;1&#39;and clk_IO&#39;event)then
        if(IO_CS=&#39;1&#39;)then
            if(IO_IEN=&#39;0&#39;)then 
                reg&lt;=IO_in;
                if(RI_EN=&#39;0&#39;)then DATA_BUS&lt;=reg;end if;
            elsif(IO_OEN=&#39;0&#39;)then 
                reg&lt;=DATA_BUS;
                if(RO_EN=&#39;0&#39;)then IO_out&lt;=reg;END IF;
            end if; 
        else IO_out&lt;=&quot;ZZZZZZZZ&quot;;DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<pre><code>#----------------------------------------------------------------------------------
#-- Engineer: switch_swq
#-- Create Date: 2024/04/24 15:50:00
#----------------------------------------------------------------------------------
#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;IO_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;IO_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;IO_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;IO_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;IO_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;IO_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;IO_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;IO_in[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports IO_CS]
set_property IOSTANDARD LVCMOS18    [get_ports IO_CS]
set_property PACKAGE_PIN H9         [get_ports IO_IEN]
set_property IOSTANDARD LVCMOS18    [get_ports IO_IEN]
set_property PACKAGE_PIN H8         [get_ports IO_OEN]
set_property IOSTANDARD LVCMOS18    [get_ports IO_OEN]
set_property PACKAGE_PIN G10        [get_ports RI_EN]
set_property IOSTANDARD LVCMOS18    [get_ports RI_EN]
set_property PACKAGE_PIN G9         [get_ports RO_EN]
set_property IOSTANDARD LVCMOS18    [get_ports RO_EN]
</code></pre>
<h3 id="14-微控制器设计"><a href="#14-微控制器设计" class="headerlink" title="14.微控制器设计"></a>14.微控制器设计</h3><p>微程序控制器基本原理：</p>
<pre><code>    1)将指令分解为基本的微命令序列，把操作控制信号编制成微指令，存放到控制存储器 (CM)。

    2)运行时，从控存中取出微指令，产生指令运行所需的操作控制信号。
</code></pre>
<p>微程序控制器基本结构：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3df769d2ac5eb7d9b1a2a850829c1e56.png"></p>
<p> 控制存储器 CM –存放微程序</p>
<p> 微指令寄存器 µIR –存放现行微指令</p>
<p> 微地址形成电路–提供下一条微地址</p>
<p> 微地址寄存器 µAR–存放现在微地址</p>
<p>控制信号设计：</p>
<pre><code>    • 39 条控制信号（39 位编码）

    • 27 条指令（5 位编码）-&gt;8 位微地址
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/29292e122740addc20eb4a530ec67bd0.png"></p>
<p>其中 clk_MC&#x3D;clk2 &amp; W0，在组建 CPU 模块时使用。</p>
<p>源码：</p>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/25 16:09:02
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity uC_test is
    Port(
        clk:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        seg_dig : out std_logic_vector(15 downto 0);
        seg_data : out std_logic_vector(7 downto 0)
    );
end uC_test;

architecture Behavioral of uC_test is
component uC
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end component;
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line,clk_line2,clk_uC,clk2,w0:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0); 
signal CM_line:std_logic_vector(47 downto 8);

begin

uC_inst:uC port map(clk_uC,nreset,M_uA,IR,CMROM_CS,CM_line);
clock_inst:clock port map(clk=&gt;clk_line2,rst=&gt;nreset,clk2=&gt;clk2,w0=&gt;w0);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
clk_div_inst2:clk_div generic map(10000000)port map(nreset,clk,clk_line2);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);

process(clk2,w0)
begin
    clk_uC&lt;=clk2 and w0;
end process;

process(IR,CM_line)
begin
    data_in_A&lt;=&quot;0000000000&quot;&amp;IR;
    data_in_B&lt;=CM_line(15 downto 8)&amp;&quot;00000000&quot;;
    data_in_C&lt;=CM_line(31 downto 16);
    data_in_D&lt;=CM_line(47 downto 32);
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ef02d5402b0594182dafe67debe07644.png"></p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 16:22:50
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity uC is
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end uC;

architecture Behavioral of uC is
component uC_uA
    Port(
        clk:in std_logic;
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;
        IR:in std_logic_vector(7 downto 2);     --IR操作码信息
        uA_in:in std_logic_vector(7 downto 0);  --uIR传送的微地址
        
        uA_out:out std_logic_vector(7 downto 0) --下一条微指令的地址
    );
end component;
component uC_uAR
    Port(
        clk:in std_logic;
        nreset: in std_logic;
        uAR_in:in std_logic_vector(7 downto 0);  --uA传送的微地址
        
        uAR_out:out std_logic_vector(7 downto 0) --送至uCM的地址
    );
end component;
component uC_CM
    generic(
        width:integer := 48;    --位宽
        depth:integer := 8      --深度
    );
    port(
        clk:in std_logic;
        addr:in std_logic_vector(depth-1 downto 0);     ----uC_ROM地址
        CMROM_CS:in std_logic;  --uC_ROM输出使能
        
        data_out:out std_logic_vector(width-1 downto 0) --uC_ROM输出
    );
end component;
component uC_uIR
  Port (
    clk:in std_logic;
    CM:in std_logic_vector(47 downto 0);
    
    uA:out std_logic_vector(7 downto 0);
    uI:out std_logic_vector(47 downto 8)
  );
end component;

signal uA_in,uA_out,uAR_out:std_logic_vector(7 downto 0); 
signal CM_line:std_logic_vector(47 downto 0);

begin

uC_uA_inst:uC_uA port map(clk_uC,nreset,M_uA,IR,uA_in,uA_out);
uC_uAR_inst:uC_uAR port map(clk_uC,nreset,uA_out,uAR_out);
uC_uCM_inst:uC_CM generic map(48,8)port map(clk_uC,uAR_out,CMROM_CS,CM_line);
uC_uIR_inst:uC_uIR port map(clk_uC,CM_line,uA_in,CM);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/63008edd2b3325b6e6ef2c8e700998d8.png"></p>
<p><img src="https://img-blog.csdnimg.cn/direct/e135b733d411449797e2018f91c18b99.png"></p>
<p>  模块：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 16:22:50
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.std_logic_unsigned.all;
use IEEE.std_logic_textio.all;
use STD.textio.all;

entity uC_CM is
    generic(
        width:integer := 48;    --位宽
        depth:integer := 8      --深度
    );
    port(
        clk:in std_logic;
        addr:in std_logic_vector(depth-1 downto 0);     ----uC_ROM地址
        CMROM_CS:in std_logic;  --uC_ROM输出使能
        
        data_out:out std_logic_vector(width-1 downto 0) --uC_ROM输出
    );
end uC_CM;

architecture Behavioral of uC_CM is

type matrix is array(integer range&lt;&gt;) of std_logic_vector(width-1 downto 0);
signal uC_ROM : matrix(0 to 2**depth-1);

procedure load_rom(signal data_word:out matrix) is 
    file romfile:text open read_mode is &quot;uC_ROM.txt&quot;;
    variable lbuf:line;
    variable i:integer := 0; --循环变量
    variable fdata:std_logic_vector(width-1 downto 0);
begin
    while(not endfile(romfile) and i&lt;2**depth) loop
        readline(romfile,lbuf); -- 逐行读数据
        read(lbuf,fdata); -- 将行数据保存到变量fdata
        data_word(i)&lt;=fdata; -- 将fdata保存到内存信号量中
        i := i+1;
    end loop;
end procedure;

begin

load_rom(uC_ROM);
data_out &lt;= uC_ROM(conv_integer(addr)) when CMROM_CS=&#39;1&#39;else(others=&gt;&#39;0&#39;);

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 16:22:50
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity uC_uA is
    Port(
        clk:in std_logic;
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;
        IR:in std_logic_vector(7 downto 2);     --IR操作码信息
        uA_in:in std_logic_vector(7 downto 0);  --uIR传送的微地址
        
        uA_out:out std_logic_vector(7 downto 0) --下一条微指令的地址
    );
end uC_uA;

architecture Behavioral of uC_uA is

begin

process(clk,nreset)
begin
    if(nreset=&#39;0&#39;)then uA_out&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk=&#39;1&#39;and clk&#39;event)then
        if(M_uA=&#39;1&#39;)then uA_out&lt;=IR&amp;&quot;00&quot;;
        else uA_out&lt;=uA_in;
        end if;
    end if;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 16:22:50
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity uC_uAR is
    Port(
        clk:in std_logic;
        nreset: in std_logic;
        uAR_in:in std_logic_vector(7 downto 0);  --uA传送的微地址
        
        uAR_out:out std_logic_vector(7 downto 0) --送至uCM的地址
    );
end uC_uAR;

architecture Behavioral of uC_uAR is

begin

process(clk,nreset)
begin
    if(nreset=&#39;0&#39;)then uAR_out&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk=&#39;1&#39;and clk&#39;event)then uAR_out&lt;=uAR_in;
    end if;
end process;

end Behavioral;



----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/24 16:22:50
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity uC_uIR is
  Port (
    clk:in std_logic;
    CM:in std_logic_vector(47 downto 0);
    
    uA:out std_logic_vector(7 downto 0);
    uI:out std_logic_vector(47 downto 8)
  );
end uC_uIR;

architecture Behavioral of uC_uIR is

begin

uA&lt;=CM(7 downto 0);
uI&lt;=CM(47 downto 8);

end Behavioral;
</code></pre>
<p> uC_ROM.txt：</p>
<pre><code>100000000000000000000000000000000000000000000001
010000000000000000000000000000000000000000000010
001000000000000000000000000000000000000000000011
000100000000000000000000000000000000000000000100
000010000000000000000000000000000000000000000101
000001000000000000000000000000000000000000000110
000000100000000000000000000000000000000000000111
000000010000000000000000000000000000000000000000
</code></pre>
<p>xdc：</p>
<pre><code>#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[7]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;IR[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;IR[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;IR[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;IR[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;IR[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;IR[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14         [get_ports CMROM_CS]
set_property IOSTANDARD LVCMOS18    [get_ports CMROM_CS]
set_property PACKAGE_PIN H9        [get_ports M_uA]
set_property IOSTANDARD LVCMOS18    [get_ports M_uA]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]
</code></pre>
<h3 id="15-8-位-SOC-综合设计"><a href="#15-8-位-SOC-综合设计" class="headerlink" title="15.8 位 SOC 综合设计"></a>15.8 位 SOC 综合设计</h3><p>根据以上所设计的功能模块连接成完整的 8 位 SOC 结构。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/cfdc1dbc85d346b9c3541e7e13e4fd2f.png"></p>
<p>模块修改记录：</p>
<pre><code>SOC:
修改PC/ROM
*修改各模块时钟
修改各模块总线输出时机提高片选及使能优先级，并加入到敏感检测列表
修改uC使能：M_uA和CMROM_CS低电平有效（根据指令知）
uC输入输出冲突，同时输入输出控制信号
修改微指令34H：IO_CS位
修改微指令38H：IO_CS位
修改微指令24H：Ri_EN错误
修改微指令8AH：M_PC位
修改微指令65H： RDRi位
PC不再产生nPCL和nPCH信号并修改PC模块
ADD微程序增加一条微指令
</code></pre>
<p>源码：</p>
<p>顶层测试：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/27 20:08:24
----------------------------------------------------------------------------------


library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity CPU_test is
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end CPU_test;

architecture Behavioral of CPU_test is
component CPU
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
signal clk_line:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal regA_out,regB_out,result_out,data_out:std_logic_vector(7 downto 0);
begin
clk_div_inst:clk_div generic map(1000000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
CPU_inst:CPU generic map(100000000)port map(clk_line,nreset,data_in,regA_out,regB_out,result_out,data_out);

process(regA_out,regB_out,result_out,data_out)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;result_out;
    data_in_B&lt;=&quot;00000000&quot;&amp;regB_out;
    data_in_C&lt;=&quot;00000000&quot;&amp;regA_out;
    data_in_D&lt;=&quot;00000000&quot;&amp;data_out;
end process;

end Behavioral;
</code></pre>
<p>顶层：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/25 17:50:57
----------------------------------------------------------------------------------
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity CPU is
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
    );
end CPU;

architecture Behavioral of CPU is
signal clk1,nclk1:std_logic;   --clk
signal clk2,nclk2:std_logic;   --clk二分频
signal w0,w1,w2,w3:std_logic;   --节拍信号
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;

signal clk_uC,M_uA,CMROM_CS:std_logic;
signal IR_line:std_logic_vector(7 downto 0);
signal CTR_BUS:std_logic_vector(47 downto 8);
component uC
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end component;

signal clk_SP,SP_CS,SP_UP,SP_DN,nSP_EN:STD_LOGIC;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;

signal clk_IO,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN:std_logic;
signal IO_in,IO_out:std_logic_vector(7 downto 0);
component IO
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end component;

signal clk_RAM,RAM_CS,nRAM_EN,Wr_nRD:std_logic;
component RAM
    generic(
        depth:positive:=7;
        width:positive:=8
    );
    Port (
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
    );
end component;

signal clk_ALU,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0:std_logic;
signal S :std_logic_vector(4 downto 0);
signal F_in :std_logic_vector(1 downto 0);    
--signal regA_out,regB_out,result_out:std_logic_vector(7 downto 0);
signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志
component ALU 
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal clk_RN,Rn_CS,nRi_EN,RDRi,WRRi:std_logic;
signal RS,RD:std_logic;
component RN
    Port(
        clk_RN,Rn_CS,nRi_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic;

        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen: std_logic;
signal IR_AR       :std_logic_vector(6 downto 0);
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;

signal clk_ROM,M_ROM,ROM_EN:std_logic;
signal ROM_PC:std_logic_vector(11 downto 0);
component ROM
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_PC,M_PC,nLD_PC,nPCH,nPCL:std_logic;
signal PC_in:std_logic_vector(11 downto 0):=(others=&gt;&#39;0&#39;);
component pc
    Port (        
        rst,clk_PC,M_PC,nLD_PC:in std_logic;
        nPCH,nPCL:in std_logic;
        PC_in:in std_logic_vector(11 downto 0);
        
        PC_out:out std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
     );
end component;

signal test_line:std_logic_vector(7 downto 0);

begin

clock_inst:clock port map(clk,nreset,clk1,nclk1,clk2,nclk2,w0,w1,w2,w3);
PC_inst:PC port map(nreset,clk_PC,M_PC,nLD_PC,nPCH,nPCL,PC_in,ROM_PC,DATA_BUS);
ROM_inst:ROM generic map(12,8)port map(clk_ROM,M_ROM,ROM_EN,ROM_PC,DATA_BUS);
uC_inst:uC port map(clk_uC,nreset,M_uA,IR_line(7 downto 2),CMROM_CS,CTR_BUS);
IR_inst:IR port map(rst=&gt;nreset,clk_IR=&gt;clk_IR,LD_IR1=&gt;LD_IR1,LD_IR2=&gt;LD_IR2,LD_IR3=&gt;LD_IR3,nARen=&gt;nARen,DATA_BUS=&gt;DATA_BUS,IR_out=&gt;IR_line,RS=&gt;RS,RD=&gt;RD,PC_out=&gt;PC_in,AR=&gt;AR(6 downto 0));
RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;nreset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,DATA_BUS=&gt;DATA_BUS);
IO_inst:IO port map(clk_IO,nreset,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN,data_in,data_out,DATA_BUS);
--SP_inst:SP PORT MAP(clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);
ALU_inst:ALU port map(clk,clk_ALU,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,regA_out,regB_out,result_out,DATA_BUS,AC,CY,ZN,OV);
RN_inst:RN port map(clk_RN,Rn_CS,nRi_EN,RDRi,WRRi,RS,RD,DATA_BUS);

clk_PC&lt;=clk1 and clk2;
clk_ROM&lt;=nclk1 and clk2;
clk_IR&lt;=clk1 and nclk2;
clk_uC&lt;=nclk1 and nclk2;
clk_RN&lt;=clk1 and nclk2;
clk_ALU&lt;=nclk1 and nclk2;
--clk_IO&lt;=clk2;--（LED程序使用）
clk_IO&lt;=nclk1 and clk2;--（ADD程序使用）
clk_RAM&lt;=nclk1 and w1;
clk_SP&lt;=clk1 and clk2 and w1;

M_A &lt;= CTR_BUS(47);
M_B &lt;= CTR_BUS(46);
M_F &lt;= CTR_BUS(45);
S(4) &lt;= CTR_BUS(44);
S(3) &lt;= CTR_BUS(43);
S(2) &lt;= CTR_BUS(42);
S(1) &lt;= CTR_BUS(41);
S(0) &lt;= CTR_BUS(40);
F_in(1) &lt;= CTR_BUS(39);
F_in(0) &lt;= CTR_BUS(38);
nALU_EN &lt;= CTR_BUS(37);
nPSW_EN &lt;= CTR_BUS(36);
C0 &lt;= CTR_BUS(35);
RAM_CS &lt;= CTR_BUS(34);
Wr_nRD &lt;= CTR_BUS(33); 
nRAM_EN &lt;= CTR_BUS(32);
Rn_CS &lt;= CTR_BUS(31);
RDRi &lt;= CTR_BUS(30);
WRRi &lt;= CTR_BUS(29);
nRi_EN &lt;= CTR_BUS(28);
LD_IR1 &lt;= CTR_BUS(27);
LD_IR2 &lt;= CTR_BUS(26);
LD_IR3 &lt;= CTR_BUS(25);
nAREN &lt;= CTR_BUS(24);
M_PC &lt;= CTR_BUS(23);
nLD_PC &lt;= CTR_BUS(22); 
nPCH &lt;= CTR_BUS(21); 
nPCL &lt;= CTR_BUS(20); 
SP_UP &lt;= CTR_BUS(19);
SP_DN &lt;= CTR_BUS(18);
SP_CS &lt;= CTR_BUS(17); 
nSP_EN &lt;= CTR_BUS(16); 
IO_CS &lt;= CTR_BUS(15);
IO_IEN &lt;= CTR_BUS(14);
IO_OEN &lt;= CTR_BUS(13);
RI_EN&lt;=&#39;0&#39;;
RO_EN&lt;=&#39;0&#39;;
-- &lt;= CTR_BUS(12);
M_ROM &lt;= CTR_BUS(11);
ROM_EN &lt;= CTR_BUS(10);
M_uA &lt;= CTR_BUS(9);
CMROM_CS &lt;= CTR_BUS(8);

process(nPCH,nPCL)
begin
    if(nPCH=&#39;0&#39;)then PC_in(11 downto 8)&lt;=DATA_BUS(3 downto 0);
    elsif(nPCL=&#39;0&#39;)then PC_in(7 downto 0)&lt;=DATA_BUS;
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b870e7e63c2438527c9603091d047576.png"></p>
<p>时钟：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5bd3c1b7d51ed7ee02fd3b42b4c4ba89.png"></p>
<p>ADD微程序：</p>
<pre><code>00111000 --IR:38H MOV Ri,IO
00111011 --IR:38H MOV Ri,IO
00001000 --ADD R0,R1
00000100 --JMP addr12
00000000 --addr1:00H
00000000 --addr2:00H
</code></pre>
<p>LED微程序：</p>
<pre><code>00100100 --IR:24H MOV Ri,#data
00000001 --data:01H
00110100 --IR:34H MOV IO,Ri
00100100 --IR:24H
00000010 --data:02H
00110100 --IR:34H
00100100 --IR:24H
00000100 --data:04H
00110100 --IR:34H
00100100 --IR:24H
00001000 --data:08H
00110100 --IR:34H
00100100 --IR:24H
00010000 --data:10H
00110100 --IR:34H
00100100 --IR:24H
00100000 --data:20H
00110100 --IR:34H
00100100 --IR:24H
01000000 --data:40H
00110100 --IR:34H
00100100 --IR:24H
10000000 --data:80H
00110100 --IR:34H
00000100 --JMP addr12
00000000 --addr:00H
00000000 --addr:00H
00000000
</code></pre>
<p> 程序：</p>
<pre><code>000000000011000100011001111100110111100100000000		--00H
000000000000000000000000000000000000000000000000		--01H
000000000000000000000000000000000000000000000000		--02H
000000000000000000000000000000000000000000000000		--03H
000000000011000100010101111100110111101100000101		--04H JMP addr12
000000000011000100010011111100110111101100000110		--05H
000000000011000100010001101100110111011100000000		--06H
000000000000000000000000000000000000000000000000		--07H
010000000011000101000001011100110111011100001001		--08H ADD Ri,Rj
100000000011000101000001011100110111011100001010		--09H
001000010001000100110001011100110111011100000000		--0AH
000000000001000100100001111100110111011100000000		--0BH
000000000000000000000000000000000000000000000000		--0CH
000000000000000000000000000000000000000000000000		--0DH
000000000000000000000000000000000000000000000000		--0EH
000000000000000000000000000000000000000000000000		--0FH
000000000000000000000000000000000000000000000000		--10H
000000000000000000000000000000000000000000000000		--11H
000000000000000000000000000000000000000000000000		--12H
000000000000000000000000000000000000000000000000		--13H
000000000000000000000000000000000000000000000000		--14H
000000000000000000000000000000000000000000000000		--15H
000000000000000000000000000000000000000000000000		--16H
000000000000000000000000000000000000000000000000		--17H
000000000000000000000000000000000000000000000000		--18H
000000000000000000000000000000000000000000000000		--19H
000000000000000000000000000000000000000000000000		--1AH
000000000000000000000000000000000000000000000000		--1BH
000000000000000000000000000000000000000000000000		--1CH
000000000000000000000000000000000000000000000000		--1DH
000000000000000000000000000000000000000000000000		--1EH
000000000000000000000000000000000000000000000000		--1FH
000000000000000000000000000000000000000000000000		--20H
000000000000000000000000000000000000000000000000		--21H
000000000000000000000000000000000000000000000000		--22H
000000000000000000000000000000000000000000000000		--23H
000000000011000100100001111100110111101100100101		--24H MOV Ri,#data ***修改***
000000000011000100010001011100110111011100100110		--25H
000000000011000100010001011100110111011100000000		--26H
000000000000000000000000000000000000000000000000		--27H
000000000011000101100001011100110111011100101001		--28H
000000000011000101100001011100110111011100101010		--29H
000000000011000100010001011100110111011100000000		--2AH
000000000000000000000000000000000000000000000000		--2BH
000000000011000100010010111100110111101100101101		--2CH
000000000011010000100000011100110111011100101110		--2DH
000000000011000100010001011100110111011100000000		--2EH
000000000000000000000000000000000000000000000000		--2FH
000000000011000100010010111100110111101100110001		--30H
000000000011011101000000011100110111011100110010		--31H
000000000011000100010001011100110111011100000000		--32H
000000000000000000000000000000000000000000000000		--33H
000000000011000101000001011100111101011100110101		--34H MOV IO,Ri
000000000011000100010001011100110101011100110110		--35H 
000000000011000100010001011100110111011100000000		--36H
000000000000000000000000000000000000000000000000		--37H
000000000011000100010001011100111011011100111001		--38H MOV Ri,IO
000000000011000100100001011100111001011100111010		--39H
000000000011000100010001011100110111011100000000		--3AH
000000000000000000000000000000000000000000000000		--3BH
000000000011000100010001111100010111101100111101		--3CH
000000000011000100010001011100110111011100111110		--3DH
000000000011000100010001011100110111011100000000		--3EH
000000000000000000000000000000000000000000000000		--3FH
010000010011000101000001011100110111011101000001		--40H
000000000011000101100001011100110111011101000010		--41H
100000000011000111000001011100110111011101000011		--42H
001000010001000100110001111100110111011101000100		--43H
000000000011000100010001011100110111011100000000		--44H
000000000000000000000000000000000000000000000000		--45H
</code></pre>
<p>testbench：</p>
<pre><code>----------------------------------------------------------------------------------
-- Engineer: switch_swq
-- Create Date: 2024/04/26 08:47:54
----------------------------------------------------------------------------------

library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity CPU_tb is

end CPU_tb;

architecture Behavioral of CPU_tb is
component CPU
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal clk,nreset:std_logic;
signal data_in,data_out:std_logic_vector(7 downto 0);

begin

CPU_inst:CPU generic map(100000000)port map(clk,nreset,data_in,data_out);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

reset:process
begin
    nreset&lt;=&#39;0&#39;;
    wait for 15ns;
    nreset&lt;=&#39;1&#39;;
    wait;
end process;

test:process
begin
    data_in&lt;=x&quot;FF&quot;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>LED结果：</p>
<p>整体：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0f9cfb770135c8cd06409fe765cdb265.png"></p>
<p>取数（00100100 –IR:24H MOV Ri,#data 00000001 –data:01H）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/595f539ee9983cb3ad064110256b9d3d.png"></p>
<p>IO输出（00110100 –IR:34H MOV IO,Ri）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/deb8630114a8896456e6eea801735970.png"></p>
<p>ADD结果：</p>
<p>整体：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/08792675191fd507e190b166618ace0c.png"></p>
<p>IO输入（00111000 –IR:38H MOV Ri,IO）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b48d14803e3b211bfb14f2d81f5dc40a.png"></p>
<p>加法（00001000 –ADD R0,R1）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5399cba63467fb5d837fe1e49c0adb02.png"></p>
<p>xdc：</p>
<pre><code>#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk]
set_property IOSTANDARD LVCMOS18    [get_ports clk]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;data_in[7]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]
</code></pre>
<h4 id="1-实验结果分析"><a href="#1-实验结果分析" class="headerlink" title="1.实验结果分析"></a>1.实验结果分析</h4><h5 id="模块工作顺序分析"><a href="#模块工作顺序分析" class="headerlink" title="&lt;1&gt;模块工作顺序分析"></a>&lt;1&gt;<strong>模块工作顺序分析</strong></h5><pre><code>    各个模块工作的逻辑顺序如上时钟时序图所示，每条指令执行则可分为m0~3四个阶段。在m0阶段首先由PC发送地址至ROM，然后ROM输出该地址的指令或数据，传送至IR，IR经过简单处理后继续传送至UC，UC产生各个模块的控制信号。在m1~3阶段，依据微程序产生3次控制信号，实现相应指令功能（注意ALU、RN、IO时钟不同，后面有相关解释）。
</code></pre>
<h5 id="​​​指令执行过程分析"><a href="#​​​指令执行过程分析" class="headerlink" title="&lt;2&gt;​​​指令执行过程分析"></a>&lt;2&gt;​​​<strong>指令执行过程分析</strong></h5><ul>
<li><strong><strong>以ADD加法为例：</strong></strong></li>
</ul>
<p><strong><strong>MOV Ri,IO：</strong></strong></p>
<pre><code>    m1~3——执行38H MOV Ri,IO：在m1使能IO相关信号使IO_IN-&gt;REG，在m2时，REG-&gt;DATA_BUS-&gt;Ri（IO的时钟先于RN，使数据在DATA_BUS刚好能传送至RN）
</code></pre>
<p><strong><strong>ADD R0,R1：</strong></strong></p>
<pre><code>    m1~3——执行08H ADD R0,R1：由于无法在计算出结果的同时将结果通过数据总线DATA_BUS传送至RN，所以在一条指令中，我的ADD指令只能实现计算功能，计算结果由ALU另行输出至result总线。在m1和m2分别实现RN-&gt;DATA_BUS-&gt;regA/B（其中regA/B为ALU内部缓冲器），在m3实现计算和UC地址回到00H操作。
</code></pre>
<p><strong><strong>以LED流水灯为例：</strong></strong></p>
<pre><code>    m0——取指令：PC-&gt;ROM-&gt;DATA_BUS-&gt;IR-&gt;UC，微指令为0x003119f37900H

    注意到ROM将地址信息输出到总线，IR接收并传递地址到UC，从而执行24H地址的微程序。
</code></pre>
<p><strong><strong>MOV Ri,#data：</strong></strong></p>
<pre><code>    m1~3——执行24H MOV Ri,#data：在m1将ROM中的立即数输出至
</code></pre>
<p>DATA_BUS，在m2传输至Ri之中，在m3阶段UC地址回到00H准备进入下一条指令，即取值公操作。</p>
<p><strong><strong>MOV IO,Ri：</strong></strong></p>
<pre><code>    m1~3——执行34H MOV IO,Ri：在m1将Ri-&gt;DATA_BUS，在m2，DATA_BUS-&gt;REG-&gt;IO_OUT（REG是IO内暂存器，由于UC控制信号不包含RI_EN和RO_EN，一直使能，即DATA_BUS&lt;-&gt;IO直接完成），在m3阶段UC地址回到00H准备进入下一条指令，即取值公操作。
</code></pre>
<p><strong><strong>JMP addr12</strong></strong><strong><strong>：</strong></strong></p>
<pre><code>    m1~3——执行04H JMP addr12：在m1、m2依次将立即数加载至IR中，对应LD_IR2和LD_IR3分别有效，IR将新地址传送至PC。
</code></pre>
<ul>
<li><strong><strong>以ADD加法为例：</strong></strong></li>
</ul>
<p><strong><strong>MOV Ri,IO：</strong></strong></p>
<pre><code>    m1~3——执行38H MOV Ri,IO：在m1使能IO相关信号使IO_IN-&gt;REG，在m2时，REG-&gt;DATA_BUS-&gt;Ri（IO的时钟先于RN，使数据在DATA_BUS刚好能传送至RN）
</code></pre>
<p><strong><strong>ADD R0,R1：</strong></strong></p>
<pre><code>    m1~3——执行08H ADD R0,R1：由于无法在计算出结果的同时将结果通过数据总线DATA_BUS传送至RN，所以在一条指令中，我的ADD指令只能实现计算功能，计算结果由ALU另行输出至result总线。在m1和m2分别实现RN-&gt;DATA_BUS-&gt;regA/B（其中regA/B为ALU内部缓冲器），在m3实现计算和UC地址回到00H操作。
</code></pre>
<h4 id="2-其他"><a href="#2-其他" class="headerlink" title="2.其他"></a>2.其他</h4><h5 id="SOC-模块集成设计经验"><a href="#SOC-模块集成设计经验" class="headerlink" title="&lt;1&gt;SOC****模块集成设计经验"></a>&lt;1&gt;<strong>SOC****模块集成设计经验</strong></h5><pre><code>    在集成各个组成模块时，为避免总线冲突以及方便调试，采用各个模块依次添加测试的方法。

    首先测试PC、ROM、IR、UC组成的系统，要求取指令时4个模块的运行顺序为：PC发送ROM地址-&gt;ROM输出指令/数据-&gt;IR传送指令-&gt;UC解析执行微程序。随后依次加入IO、RN、ALU、RAM模块进行调试（按照指令执行逻辑顺序）。
</code></pre>
<h5 id="SOC集成关键"><a href="#SOC集成关键" class="headerlink" title="&lt;2&gt;SOC集成关键"></a>&lt;2&gt;<strong>SOC集成关键</strong></h5><p>在集成各个模块时，关键在于：</p>
<ul>
<li><p>清楚模块工作逻辑顺序</p>
<pre><code>需清楚知晓各个模块工作先后关系，理清数据/控制/地址信号流的传递顺序，以避免读写顺序出错，出现写未读到的情况。
</code></pre>
</li>
<li><p>避免总线冲突</p>
<pre><code>主要是DATA_BUS数据总线使用的原子性，各模块严格按照时钟时序进行输出，在允许输出时输入/出数据到数据总线，其他时刻不要忘记将数据总线置高阻态。
</code></pre>
</li>
<li><p>考虑信号的建立、保持</p>
<pre><code>在课程参考资料中，ALU、IO、RN的时钟都是nclk2，但是对于任意一条微指令，如果涉及到上述3个模块的协作,如将RN中数据传送至ALU中缓存器regA，由于时钟相同，且都在上升沿工作，则在同一时刻，RN中数据传输到数据总线，上一时刻数据总线的数值传送至regA，并不能实现RN-&gt;DATA_BUS-&gt;regA这一连贯操作。

解决方法在于错开操作时间，即RN-&gt;DATA_BUS先于DATA_BUS-&gt;regA，需要修改模块时钟，故出现了上面仿真图中的时钟。
</code></pre>
</li>
</ul>
<p>&lt;3&gt;反思与改进</p>
<ul>
<li><p>对数据不能在总线上连续传递的思考</p>
<pre><code>考虑上面“考虑信号的建立、保持”部分产生的问题，问题产生的原因在于组合逻辑电路和时序逻辑电路的区别，如果将信号的触发条件由时钟的上升沿改为高电平（类似于使能信号），则将时序逻辑转变为组合逻辑，可能解决上述问题，使得ALU、IO、RN等模块的时钟可以都是nclk2。
</code></pre>
</li>
<li><p>ADD指令的改进</p>
<pre><code>上述实现的ADD指令在有限的m1~3阶段内计算完结果无法实现结果存储至RN（在上面ADD指令时序图可观测到计算结果曾短时间内输出到数据总线DATA_BUS上），仅一个指令周期无法实现，可以扩展成两个，即在第二个指令周期的m0~3阶段实现指令存储至RN。
</code></pre>
</li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/999503810dc63f0f906be47e3bbaca66.png"></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/139143519">https://blog.csdn.net/qq_32971095/article/details/139143519</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88%E7%94%B5%E6%9C%BA%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%882%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88%E7%94%B5%E6%9C%BA%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%882%EF%BC%89/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:44" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>907</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id=""><a href="#" class="headerlink" title=""></a></h2><hr>
<h2 id="图片来源：B站唐老师讲电赛"><a href="#图片来源：B站唐老师讲电赛" class="headerlink" title="_  图片来源：B站唐老师讲电赛_"></a><strong>_  图片来源：B站唐老师讲电赛_</strong></h2><p><strong>目录</strong></p>
<p><a href="about:blank#%C2%A0%E5%9B%BE%E7%89%87%E6%9D%A5%E6%BA%90%EF%BC%9AB%E7%AB%99%E5%94%90%E8%80%81%E5%B8%88%E8%AE%B2%E7%94%B5%E8%B5%9B"><br>图片来源：B站唐老师讲电赛</a></p>
<p><a href="about:blank#%E4%B8%80.%E7%94%B5%E6%9C%BA%E9%83%A8%E5%88%86%E7%BB%93%E6%9E%84">一.电机部分结构</a></p>
<p><a href="about:blank#%E4%BA%8C.%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%A4%BA%E4%BE%8B">二.步进电机示例</a></p>
<p><a href="about:blank#%E4%B8%89.%E4%BC%BA%E6%9C%8D%E7%94%B5%E6%9C%BA%E7%A4%BA%E4%BE%8B">三.伺服电机示例</a></p>
<p><a href="about:blank#%E5%9B%9B.%E6%88%91%E4%BB%AC%E7%9A%84%E6%96%B9%E6%A1%88">四.我们的方案</a></p>
<hr>
<h2 id="一-电机部分结构"><a href="#一-电机部分结构" class="headerlink" title="一.电机部分结构"></a>一.电机部分结构</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/bcfec2f6ed3a3e801301c91dfeb4307d.jpeg"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b68a6432253fb37113bcd87a78d6af13.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/99f4e23df848c63b9a836035426fe043.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5483b488abe59c6b56599034cee91db9.png"><img src="https://i-blog.csdnimg.cn/blog_migrate/36766f56d5dbe1c3b71e1d2f8cc63d56.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f23bb2de689dbeadc754dd5f58a19811.png"><img src="https://i-blog.csdnimg.cn/blog_migrate/f2fe3b27147efcb57b0964d81171b5b5.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4547084918f7ca3e14a1a6aaf1c3ea0c.png"></p>
<h2 id="二-步进电机示例"><a href="#二-步进电机示例" class="headerlink" title="二.步进电机示例"></a>二.步进电机示例</h2><p>1.驱动器：L298N（CSDN搜索使用方法）；控制器：stm32；电源暂时用12V直流源</p>
<p>2.控制：全速模式：in1、in2一低一高控制正反转，全低不转。</p>
<p>pwm控制模式：使能端连接单片机IO口，通过产生pwm波占空比控制速度（相当于有效电压控制）</p>
<p>3.编码器：将编码器产生脉冲当做外部时钟传入单片机定时器，定时读取并清零</p>
<p>4.涉及知识：定时器（内部定时器产生pwm波，外部作为编码计数）</p>
<p>5.示例代码：</p>
<p>可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_65683639/article/details/130562162" title="直流减速编码电机的使用（STM32f103c8t6）L298N电机驱动模块_stm32f103c8t6控制直流电机_阿昕同学的博客-CSDN博客">直流减速编码电机的使用（STM32f103c8t6）L298N电机驱动模块_stm32f103c8t6控制直流电机_阿昕同学的博客-<br>CSDN博客</a></p>
<h2 id="三-伺服电机示例"><a href="#三-伺服电机示例" class="headerlink" title="三.伺服电机示例"></a>三.伺服电机示例</h2><p>MG995型伺服电机：</p>
<p>1.结构：可参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/he__yuan/article/details/79195435?spm=1001.2014.3001.5506" title="MG995舵机工作原理及基于STM32的驱动源代码_斜杠青年&#x2F;的博客-CSDN博客">MG995舵机工作原理及基于STM32的驱动源代码_斜杠青年&#x2F;的博客-<br>CSDN博客</a></p>
<p>2.控制：通过PWM波占空比控制</p>
<p>固定20ms周期pwm波通过定时器输出  </p>
<p>TIM1_PWM_Init(199,7199);        &#x2F;&#x2F;(7200<em>200)&#x2F;72000000&#x3D;0.02&#x3D;20ms；（分频</em>周期数）</p>
<p>占空比通过函数TIM_SetCompare1（TIM1,num）控制，其中num是低电平占周期数</p>
<p>0.5ms对应195，2.5ms对应175</p>
<p>四.具体器件</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/79abef952376244b07db4ca4c37604b6.png"></p>
<h2 id="四-我们的方案"><a href="#四-我们的方案" class="headerlink" title="四.我们的方案"></a>四.我们的方案</h2><p>后轮电机：MG513直流减速电机（霍尔编码器）</p>
<p>前轮转向电机（采用阿克曼转向结构）：舵机MG995</p>
<p>机械臂电机：舵机MG995</p>
<p>后轮电机驱动：l298n电机驱动模块</p>
<p>舵机驱动：pca9685 PWM伺服驱动器模块</p>
<p>超声波测距：cs100a超声波模块</p>
<p>蓝牙：JDY-31蓝牙模块</p>
<p>显示屏：SSD1306 OLED IIC显示屏</p>
<p>稳压芯片：lm2596可调稳压模块*2（12V-5V-3.3V）</p>
<p>电池：12V3A锂电池（最大电流6A）</p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/131503991">https://blog.csdn.net/qq_32971095/article/details/131503991</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88PCB%E8%AE%BE%E8%AE%A1%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%884%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88PCB%E8%AE%BE%E8%AE%A1%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%884%EF%BC%89/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:40" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>540</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>学习来源：B站唐老师讲电赛——PCB设计极速入门，立创EDA+ALTIUM DESIGNER 10.0<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Zg41127BV/?spm_id_from=333.999.0.0&vd_source=01cde8042a76495bf513aa4407a56cd6" title="PCB设计极速入门，立创EDA+ALTIUM DESIGNER 10.0_哔哩哔哩_bilibili">PCB设计极速入门，立创EDA+ALTIUM<br>DESIGNER<br>10.0_哔哩哔哩_bilibili</a></p>
<p>一.设计过程</p>
<p>使用嘉立创EDA加Altium Designer联合设计</p>
<p>1.嘉立创EDA：原理图绘制；器件选型；PCB生成；</p>
<p>ICEDA操作：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f20d7d97b76a22bfbc89dc11ba4cd542.png"></p>
<p>生成的pcd文件和原理图-导出-Altium Designer文件；转至 Altium Designer操作</p>
<p>2.Altium Designer：基础操作；使用规则（右键-设计-规则-desgin rules右键-导入规则-类型全选-<br>寻找规则文件）；字体大小调节（任意字右键-查找相似对象-text height-same-应用-修改text height）；shift s-DSD-<br>shift s-清除（右下角）；注意各个板层（顶层、底层；顶层走不通打过孔底层走；过孔尽量不经过焊盘）</p>
<p>调整好后新建PCB工程-右键添加现有文件-保存工程</p>
<p>走线（TAB键调出参数）</p>
<p>覆铜（放置多边形平面）</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/42fa1ac446e75661bc31d493a6a28d3c.png"></p>
<p> 打过孔</p>
<p>注意事项：芯片电源引脚加电容滤纹波</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c5d70666df4ea8e0417e843702022b96.png"></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/131583041">https://blog.csdn.net/qq_32971095/article/details/131583041</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88jetson%20nano%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%883%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%B0%8F%E8%BD%A6%EF%BC%88jetson%20nano%E9%83%A8%E5%88%86%EF%BC%89%E2%80%94%E2%80%94%E7%94%B5%E8%B5%9B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%883%EF%BC%89/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:31:46" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>28k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>26 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E9%9B%B6.%E5%89%8D%E8%A8%80">零.前言</a></p>
<p><a href="about:blank#1.jetson%20nano%E8%B4%AD%E4%B9%B0%E5%95%86%E5%AE%B6%E5%8F%8A%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81">1.jetson<br>nano购买商家及技术支持</a></p>
<p><a href="about:blank#2.%E7%9B%B8%E5%85%B3%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">2.相关环境配置</a></p>
<p><a href="about:blank#3.%E5%81%9A%E5%A5%BD%E7%B3%BB%E7%BB%9F%E5%A4%87%E4%BB%BD">3.做好系统备份</a></p>
<p><a href="about:blank#%E4%B8%80.vscode%E8%BF%9C%E7%A8%8Bssh%E6%93%8D%E4%BD%9C%EF%BC%88%E5%B1%80%E5%9F%9F%E7%BD%91%E8%BF%9E%E6%8E%A5%EF%BC%89">一.vscode远程ssh操作</a></p>
<p><a href="about:blank#%3C1%3E%E5%B1%80%E5%9F%9F%E7%BD%91%E8%BF%9E%E6%8E%A5">&lt;1&gt;局域网连接</a></p>
<p><a href="about:blank#%3C2%3E%E7%94%B5%E8%84%91%E7%9B%B4%E8%BF%9E">&lt;2&gt;电脑直连</a></p>
<p><a href="about:blank#%3C3%3E%E7%94%B5%E8%84%91%E7%9B%B4%E8%BF%9E%2BVNC%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2">&lt;3&gt;电脑直连+VNC远程桌面</a></p>
<p><a href="about:blank#%E4%BA%8C.%E6%9D%BF%E8%BD%BD%E6%91%84%E5%83%8F%E5%A4%B4%E6%95%99%E7%A8%8B%EF%BC%9A">二.板载摄像头教程：</a></p>
<p><a href="about:blank#%E4%B8%89.%E8%BF%90%E8%A1%8C%E4%BE%8B%E7%A8%8B">三.运行例程</a></p>
<p><a href="about:blank#%E5%9B%9B.GPIO%E4%BD%BF%E7%94%A8">四.GPIO使用</a></p>
<p><a href="about:blank#GPIO%E5%BA%93%E7%9A%84API%E7%94%A8%E6%B3%95">GPIO库的API用法</a></p>
<p><a href="about:blank#1.%E5%AF%BC%E5%85%A5%E5%BA%93">1.导入库</a></p>
<p><a href="about:blank#2.%E5%BC%95%E8%84%9A%E7%BC%96%E5%8F%B7">2.引脚编号</a></p>
<p><a href="about:blank#3.%E8%AD%A6%E5%91%8A">3.警告</a></p>
<p><a href="about:blank#4.%E8%AE%BE%E7%BD%AE%E9%80%9A%E9%81%93">4.设置通道</a></p>
<p><a href="about:blank#5.%E8%BE%93%E5%85%A5">5.输入</a></p>
<p><a href="about:blank#6.%E8%BE%93%E5%87%BA">6.输出</a></p>
<p><a href="about:blank#set%20first%20channel%20to%20HIGH%20and%20rest%20to%20LOW">set first channel to HIGH and rest to<br>LOW</a></p>
<p><a href="about:blank#7.%E6%B8%85%E7%90%86">7.清理</a></p>
<p><a href="about:blank#8.jetson%E6%A8%A1%E5%9D%97%E4%BF%A1%E6%81%AF%E5%92%8C%E5%BA%93%E7%89%88%E6%9C%AC">8.jetson模块信息和库版本</a></p>
<p><a href="about:blank#9.%E4%B8%AD%E6%96%AD">9.中断</a></p>
<p><a href="about:blank#wait_for_edge%EF%BC%88%EF%BC%89%E5%87%BD%E6%95%B0">wait_for_edge（）函数</a></p>
<p><a href="about:blank#timeout%20is%20in%20milliseconds">timeout is in milliseconds</a></p>
<p><a href="about:blank#event_detected%EF%BC%88%EF%BC%89%E5%87%BD%E6%95%B0">event_detected（）函数</a></p>
<p><a href="about:blank#set%20rising%20edge%20detection%20on%20the%20channel">set rising edge detection on the<br>channel</a></p>
<p><a href="about:blank#%E5%BD%93%E6%A3%80%E6%B5%8B%E5%88%B0%E8%BE%B9%E7%BC%98%E6%97%B6%E8%BF%90%E8%A1%8C%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0">当检测到边缘时运行回调函数</a></p>
<p><a href="about:blank#define%20callback%20function">define callback function</a></p>
<p><a href="about:blank#add%20rising%20edge%20detection">add rising edge detection</a></p>
<p><a href="about:blank#bouncetime%20set%20in%20milliseconds">bouncetime set in<br>milliseconds</a></p>
<p><a href="about:blank#10.%E6%A3%80%E6%9F%A5GPIO%E9%80%9A%E9%81%93%E7%9A%84%E5%8A%9F%E8%83%BD">10.检查GPIO通道的功能</a></p>
<p><a href="about:blank#11.%20PWM">11. PWM</a></p>
<p><a href="about:blank#%E4%BA%94.%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1">五.串口通信</a></p>
<p><a href="about:blank#%3C1%3EUART">&lt;1&gt;UART</a></p>
<p><a href="about:blank#1.python%E4%BB%A3%E7%A0%81%EF%BC%9AJetsonHacksNano%2FUARTDemo%3A%20UART%20Demo%20Code%20%28github.com%29">1.python代码：JetsonHacksNano&#x2F;UARTDemo: UART Demo Code<br>(github.com)</a></p>
<p><a href="about:blank#3%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项：如果使用USB转TTL模块电脑和nano进行通信注意一下几点</a></p>
<p><a href="about:blank#2.C%2B%2B%E4%BB%A3%E7%A0%81%EF%BC%9AUart%20c%2B%2B%20class%20for%20Nvidia%20Jetson%20Nano">2.C++代码：Uart c++ class for Nvidia Jetson<br>Nano</a></p>
<p><a href="about:blank#%E4%BA%94.%E5%9C%A8jetson%20nano%E4%B8%8A%E4%BD%BF%E7%94%A8OpenCV">六.在jetson<br>nano上使用OpenCV</a></p>
<p><a href="about:blank#%E4%B8%83.jetson%20nano%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%E7%A8%8B%E5%BA%8F">七.jetson<br>nano开机自启动程序</a></p>
<p><a href="about:blank#%E5%85%AB.%E5%AE%9E%E6%88%98%E7%A8%8B%E5%BA%8F">八.实战程序</a></p>
<p><a href="about:blank#1.jetson%20nano%E4%B8%8A%E8%BF%9B%E8%A1%8C%E9%9C%8D%E5%A4%AB%E5%9C%86%E6%A3%80%E6%B5%8B%E5%B9%B6%E5%B0%86%E5%9C%86%E5%BF%83%E5%9D%90%E6%A0%87%E9%80%9A%E8%BF%87uart%E4%BC%A0%E7%BB%99stm32">1.jetson<br>nano上进行霍夫圆检测并将圆心坐标通过uart传给stm32</a></p>
<hr>
<h2 id="零-前言"><a href="#零-前言" class="headerlink" title="零.前言"></a>零.前言</h2><h5 id="1-jetson-nano购买商家及技术支持"><a href="#1-jetson-nano购买商家及技术支持" class="headerlink" title="1.jetson nano购买商家及技术支持"></a><strong>1.jetson nano购买商家及技术支持</strong></h5><p>***<strong>选购亚博，支持相关开源资料，资料网址：<a target="_blank" rel="noopener" href="https://www.yahboom.com/study/jetson-nano" title="JETSON NANO B01
(yahboom.com)">JETSON NANO B01<br>(yahboom.com)</a></strong></p>
<p>***<strong>常见问题及解答：<a target="_blank" rel="noopener" href="https://www.yuque.com/yahboomtechnology/yahboom_support/kgdd5m#NLt6t" title="Jetson nano A01&#x2F;B01 (yuque.com)">Jetson nano A01&#x2F;B01<br>(yuque.com)</a></strong></p>
<h5 id="2-相关环境配置"><a href="#2-相关环境配置" class="headerlink" title="2.相关环境配置"></a>2.相关环境配置</h5><p>&lt;1&gt;亚博已经在SD卡中将环境配好，插上即可直接使用</p>
<p>&lt;2&gt;***<strong>自行烧录镜像，配置环境</strong> ：</p>
<p>下载之前要格式化SD卡或者U盘，具体操作见“jetson—主板—2.Jetson Nano B01基础教程”，然后烧录镜像文件：</p>
<p>亚博资料里的 “jetson—主板—附录—镜像” 包含**<code>已安装：</code>**</p>
<p><strong><code>CUDA10.2、CUDNNv8、tensorRT、opencv4.1.1、python2、python3、tensorflow2.3、jetpack4.6.1、yolov5、jetson- inference包（包括相关模型）、jetson-gpio库、安装pytorch1.8和torchvesion0.9、安装node v15.0.1、npm7.2.3，jupyter，已开启VNC服务，还有其他课程中所用到的模块。</code></strong></p>
<p>以及Swap空间配置，Jtop安装，只需要TF&#x2F;U盘扩容即可</p>
<p>减少自行配置的麻烦。</p>
<p>如果要从零开始自己配置，“jetson—主板—2.Jetson Nano B01基础教程” 和“4.系统基础设置教程”中包括了大部分操作，甚至包括空环境下载</p>
<h5 id="3-做好系统备份"><a href="#3-做好系统备份" class="headerlink" title="3.做好系统备份"></a>3.做好系统备份</h5><p>如果只是使用亚博官方提供的版本库，可以只用 “jetson—主板—附录—镜像”<br>中的镜像文件作为备份。如果自行配置了其他环境，建议备份系统，可在“jetson—主板—4.系统基础设置教程” 找到具体操作。</p>
<h2 id="一-vscode远程ssh操作"><a href="#一-vscode远程ssh操作" class="headerlink" title="一.vscode远程ssh操作"></a>一.vscode远程ssh操作</h2><h3 id="局域网连接"><a href="#局域网连接" class="headerlink" title="&lt;1&gt;局域网连接"></a>&lt;1&gt;局域网连接</h3><p>1.将jetson连接至路由器——电脑使用该路由wifi——打开VS Code——下载ssh-<br>remote插件——jetson上终端ifconfig查ip——vscode按格式输入：ssh<br>jetson@IP地址——输入密码登录（原始默认用户名为jetson，密码为yahboom）</p>
<p>2.crtl+o选择要打开的文件或侧栏资源管理器选择，文件可在主机写好直接拖入jetson；终端写入代码并操作</p>
<h3 id="电脑直连"><a href="#电脑直连" class="headerlink" title="&lt;2&gt;电脑直连"></a>&lt;2&gt;电脑直连</h3><p>参考：<a target="_blank" rel="noopener" href="https://blog.51cto.com/u_15906550/5921556#:~:text=Jetson,Nano%E2%80%94%E2%80%94%E9%80%9A%E8%BF%87%E7%BD%91%E7%BA%BF%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0%E6%9C%ACssh%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9CjetsonnanoSD%E5%8D%A1%E6%88%90%E5%8A%9F%E7%83%A7%E5%BD%95%E5%B9%B6%E5%AE%8C%E6%88%90%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%B0%86Jetsonnano%E5%92%8C%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%A8%E7%BD%91%E7%BA%BF%E8%BF%9B%E8%A1%8C%E8%BF%9E%E6%8E%A5%E6%9C%89%E7%BA%BF%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E9%85%8D%E7%BD%AE%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E7%BB%99%E6%9C%89%E7%BA%BF%E7%BD%91%E7%BB%9C%E5%8F%B3%E5%87%BBwlan%EF%BC%8C%E9%80%89%E6%8B%A9%E5%85%B1%E4%BA%AB%E6%89%BE%E5%88%B0IP%E5%B9%B6%E8%BF%9B%E8%A1%8C%E8%BF%9E%E6%8E%A5%E6%89%93%E5%BC%80cmd%EF%BC%9Aarp-a%E8%BF%9E%E6%8E%A5ssh%E5%8D%B3%E5%8F%AF%E3%80%82" title="Jetson Nano——通过网线实现笔记本ssh远程连接">Jetson<br>Nano——通过网线实现笔记本ssh远程连接</a></p>
<h3 id="电脑直连-VNC远程桌面"><a href="#电脑直连-VNC远程桌面" class="headerlink" title="&lt;3&gt;电脑直连+VNC远程桌面"></a>&lt;3&gt;电脑直连+VNC远程桌面</h3><p>jetson nano上设置：[Jetson nano 通过 vnc<br>实现远程桌面控制（已在nano实现）](<a target="_blank" rel="noopener" href="https://blog.csdn.net/manbushuizhong/article/details/122121251?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171299147716800184169928%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=171299147716800184169928&biz_id=0&utm_medium=distribute.pc_search_result.none-">https://blog.csdn.net/manbushuizhong/article/details/122121251?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522171299147716800184169928%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=171299147716800184169928&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-</a><br>task-blog-2<del>all</del>top_positive~default-1-122121251-null-<br>null.142%5Ev100%5Epc_search_result_base9&amp;utm_term&#x3D;jetson%20nano%20vnc&amp;spm&#x3D;1018.2226.3001.4187<br>“Jetson nano 通过 vnc 实现远程桌面控制（已在nano实现）”)</p>
<p>下载VNC Viewer软件并连接（端口号参考&lt;2&gt;），效果如下：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a3014171eef4ef195b7a33d15e0845bc.png"></p>
<p> 如果无法连接检查接口是否插好，如果成功会有一个不同于端口地址的地址：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/938609aaeb57355774c771bab4569295.png"></p>
<p>如果vnc server显示窗口过小，打开终端输入以下命令调整分辨率：</p>
<pre><code>xrandr --fb 1920x1080
</code></pre>
<h2 id="二-板载摄像头教程："><a href="#二-板载摄像头教程：" class="headerlink" title="二.板载摄像头教程："></a>二.板载摄像头教程：</h2><p><strong>获取摄像头相关参数：[linux查看摄像头分辨率参数](<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44942126/article/details/115110762#:~:text=sudo%20apt%20install%20v4l-utils%2F%2F%E5%AE%89%E8%A3%85v4l2%E5%B7%A5%E5%85%B7%E5%8C%85%20sudo%20v4l2-ctl%20">https://blog.csdn.net/weixin_44942126/article/details/115110762#:~:text=sudo%20apt%20install%20v4l-utils%2F%2F%E5%AE%89%E8%A3%85v4l2%E5%B7%A5%E5%85%B7%E5%8C%85%20sudo%20v4l2-ctl%20</a><br>–list-<br>devices%2F%2F%E9%80%9A%E8%BF%87v4l2%E6%9F%A5%E7%9C%8B%E6%91%84%E5%83%8F%E5%A4%B4%E8%AE%BE%E5%A4%87%20%2F%2F%E5%BD%93%E5%90%8C%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%A4%9A%E4%B8%AA%E6%91%84%E5%83%8F%E5%A4%B4%E6%97%B6%EF%BC%8C%E6%8C%87%E5%AE%9A%E6%91%84%E5%83%8F%E5%A4%B4%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95,sudo%20rmmod%20uvcvideo%2F%2F%E7%A7%BB%E9%99%A4%E6%A8%A1%E5%9D%97%20sudo%20modprobe%20uvcvideo%20nodrop%3D1%20timeout%3D5000<br>“linux查看摄像头分辨率参数”)</strong></p>
<pre><code>Driver Info (not using libv4l2):
        Driver name   : tegra-video
        Card type     : vi-output, imx219 8-0010
        Bus info      : platform:54080000.vi:4
        Driver version: 4.9.255
        Capabilities  : 0x84200001
                Video Capture
                Streaming
                Extended Pix Format
                Device Capabilities
        Device Caps   : 0x04200001
                Video Capture
                Streaming
                Extended Pix Format
Priority: 2
Video input : 0 (Camera 4: ok)
Format Video Capture:
        Width/Height      : 3264/2464
        Pixel Format      : &#39;RG10&#39;
        Field             : None
        Bytes per Line    : 6528
        Size Image        : 16084992
        Colorspace        : sRGB
        Transfer Function : Default (maps to sRGB)
        YCbCr/HSV Encoding: Default (maps to ITU-R 601)
        Quantization      : Default (maps to Full Range)
        Flags             : 

Camera Controls

                     group_hold 0x009a2003 (bool)   : default=0 value=0 flags=execute-on-write
                    sensor_mode 0x009a2008 (int64)  : min=0 max=0 step=0 default=0 value=0 flags=slider
                           gain 0x009a2009 (int64)  : min=0 max=0 step=0 default=0 value=16 flags=slider
                       exposure 0x009a200a (int64)  : min=0 max=0 step=0 default=0 value=13 flags=slider
                     frame_rate 0x009a200b (int64)  : min=0 max=0 step=0 default=0 value=2000000 flags=slider
                    bypass_mode 0x009a2064 (intmenu): min=0 max=1 default=0 value=0
                override_enable 0x009a2065 (intmenu): min=0 max=1 default=0 value=0
                   height_align 0x009a2066 (int)    : min=1 max=16 step=1 default=1 value=1
                     size_align 0x009a2067 (intmenu): min=0 max=2 default=0 value=0
               write_isp_format 0x009a2068 (bool)   : default=0 value=0
       sensor_signal_properties 0x009a2069 (u32)    : min=0 max=0 step=0 default=0 flags=read-only, has-payload
        sensor_image_properties 0x009a206a (u32)    : min=0 max=0 step=0 default=0 flags=read-only, has-payload
      sensor_control_properties 0x009a206b (u32)    : min=0 max=0 step=0 default=0 flags=read-only, has-payload
              sensor_dv_timings 0x009a206c (u32)    : min=0 max=0 step=0 default=0 flags=read-only, has-payload
               low_latency_mode 0x009a206d (bool)   : default=0 value=0
               preferred_stride 0x009a206e (int)    : min=0 max=65535 step=1 default=0 value=0
                   sensor_modes 0x009a2082 (int)    : min=0 max=30 step=1 default=30 value=6 flags=read-only
</code></pre>
<p><strong>注意jetson nano要连接显示屏</strong></p>
<p>jetson@yahboom:&#x2F;home$ <strong>nvgstcapture-1.0  **                              **<br>&#x2F;&#x2F;打开摄像头命令</strong></p>
<p><strong>响应：</strong><br>Encoder null, cannot set bitrate!<br>Encoder Profile &#x3D; High<br>Supported resolutions in case of ARGUS Camera                      <strong>&#x2F;&#x2F;设置分辨率</strong><br>  (2) : 640x480<br>  (3) : 1280x720<br>  (4) : 1920x1080<br>  (5) : 2104x1560<br>  (6) : 2592x1944<br>  (7) : 2616x1472<br>  (8) : 3840x2160<br>  (9) : 3896x2192<br>  (10): 4208x3120<br>  (11): 5632x3168<br>  (12): 5632x4224</p>
<p>Runtime ARGUS Camera Commands:</p>
<p>  <strong>Help : ‘h’<br>  Quit : ‘q’</strong><br>  Set Capture Mode:<br>      mo:<val><br>          (1): image<br>          (2): video<br>  Get Capture Mode:<br>      gmo<br>  Set sensor orientation:<br>      so:<val><br>          (0): none<br>          (1): Rotate counter-clockwise 90 degrees<br>          (2): Rotate 180 degrees<br>          (3): Rotate clockwise 90 degrees<br>  Get sensor orientation:<br>      gso<br>  Set sensor mode:<br>      smo:<val> e.g., smo:1<br>  Get sensor mode:<br>      gsmo<br>  Set Whitebalance Mode:<br><strong>&#x2F;&#x2F;更改相机参数（曝光、饱和度等等）</strong><br>      wb:<val><br>          (0): off<br>          (1): auto<br>          (2): incandescent<br>          (3): fluorescent<br>          (4): warm-fluorescent<br>          (5): daylight<br>          (6): cloudy-daylight<br>          (7): twilight<br>          (8): shade<br>          (9): manual<br>  Get Whitebalance Mode:<br>      gwb<br>  Set Saturation (0 to 2):<br>      st:<val> e.g., st:1.25<br>  Get Saturation:<br>      gst<br>  Set Exposure Compensation (-2 to 2):<br>      ec:<val> e.g., ec:-2<br>  Get Exposure Compensation:<br>      gec<br>  Set Auto Whitebalance Lock:<br>      awbl:<val> e.g., awbl:0<br>  Get Auto Whitebalance Lock:<br>      awbl<br>  Set Auto Exposure Lock:<br>      ael:<val> e.g., ael:0<br>  Get Auto Exposure Lock:<br>      gael<br>  Set TNR Mode:<br>      tnrm:<val> e.g., tnrm:1<br>          (0): OFF<br>          (1): FAST<br>          (2): HIGH QUALITY<br>  Get TNR Mode:<br>      gtnrm<br>  Set TNR Strength (-1 to 1):<br>      tnrs:<val> e.g., tnrs:0.5<br>  Get TNR Strength:<br>      gtnrs<br>  Set EE Mode:<br>      eem:<val> e.g., eem:1<br>          (0): OFF<br>          (1): FAST<br>          (2): HIGH QUALITY<br>  Get EE Mode:<br>      geem<br>  Set EE Strength (-1 to 1):<br>      ees:<val> e.g., ees:0.5<br>  Get EE Strength:<br>      gees<br>  Set Auto Exposure Anti-Banding (0 to 3):<br>      aeab:<val> e.g., aeab:2<br>          (0): OFF<br>          (1): MODE AUTO<br>          (2): MODE 50HZ<br>          (3): MODE 60HZ<br>  Get Auto Exposure Anti-Banding:<br>      gaeab<br>  Set Gain Range:<br>      gr:<val><space><val> e.g., gr:1 16<br>  Get Gain Range:<br>      ggr<br>  Set Exposure Time Range:<br>      etr:<val><space><val> e.g., etr:34000 35000<br>  Get Exposure Time Range:<br>      getr<br>  Set ISP Digital Gain Range:<br>      dgr:<val><space><val> e.g., dgr:2 152<br>  Get ISP Digital Gain Range:<br>      gdgr<br>  <strong>Capture: enter ‘j’ OR<br>           followed by a timer (e.g., jx5000, capture after 5 seconds) OR<br>           followed by multishot count (e.g., j:6, capture 6 images)<br>           timer&#x2F;multihot values are optional, capture defaults to single shot with timer&#x3D;0s<br>  Start Recording : enter ‘1’<br>  Stop Recording  : enter ‘0’</strong><br>  Video <strong>snapshot</strong>  : enter ‘2’ (While recording video)<br>  Get Preview Resolution:<br>      gpcr<br>  Get Image Capture Resolution:<br>      gicr<br>  Get Video Capture Resolution:<br>      gvcr</p>
<p>Runtime encoder configuration options:</p>
<p>  Set Encoding Bit-rate(in bytes):<br>      br:<val> e.g., br:4000000<br>  Get Encoding Bit-rate(in bytes):<br>      gbr<br>  Set Encoding Profile(only for H.264):<br>      ep:<val> e.g., ep:1<br>          (0): Baseline<br>          (1): Main<br>          (2): High<br>  Get Encoding Profile(only for H.264):<br>      gep<br>  Force IDR Frame on video Encoder(only for H.264):<br>      Enter ‘f’ </p>
<p>bitrate &#x3D; 4000000<br>Encoder Profile &#x3D; High<br>Encoder control-rate &#x3D; 1<br>Encoder EnableTwopassCBR &#x3D; 0<br>Opening in BLOCKING MODE</p>
<p>摘自亚博教程：命令</p>
<ol>
<li>--prev_res 预览视屏的分辨率，高度和宽度，用的是CSI摄像头的话范围是 2 to 12 (5632x4224)</li>
</ol>
<p>e.g.,  nvgstcapture-1.0 –prev-res&#x3D;3</p>
<ol>
<li>--cus-prev-res 自定义预览分辨率，宽度和高度，仅支持CSI摄像头</li>
</ol>
<p>e.g., nvgstcapture-1.0 –cus-prev-res&#x3D;1920x1080</p>
<p>多个命令同时使用的话用！隔开</p>
<p>想关掉摄像头的额话，直接在终端输入q再按回车</p>
<p>想捕获图片的话，在终端输入j再按回车，图片将保存当前目录下</p>
<p><strong>关键参数的调整</strong> ：<a target="_blank" rel="noopener" href="https://mc.dfrobot.com.cn/thread-309615-1-1.html" title="NVIDIA Jetson Nano 2GB
系列文章（9）：调节 CSI 图像质量">NVIDIA Jetson Nano 2GB 系列文章（9）：调节 CSI<br>图像质量</a></p>
<h2 id="三-运行例程"><a href="#三-运行例程" class="headerlink" title="三.运行例程"></a>三.运行例程</h2><ul>
<li><p>MIPI CSI cameras (<code>csi://0</code>)</p>
</li>
<li><p>V4L2 cameras (<code>/dev/video0</code>)</p>
</li>
<li><p>RTP&#x2F;RTSP streams (<code>rtsp://username:password@ip:port</code>)</p>
<p>在&#x2F;home&#x2F;jetson&#x2F;jetson-inference&#x2F;build&#x2F;aarch64&#x2F;bin 中打开终端</p>
<p>输入示例(c++)(python 加.py即可)<br>.&#x2F;imagenet images&#x2F;orange_0.jpg images&#x2F;test&#x2F;output_0.jpg<br>.&#x2F;imagenet csi:&#x2F;&#x2F;0                           &#x2F;&#x2F;图像分类推理<br>.&#x2F;detectnet csi:&#x2F;&#x2F;0                          &#x2F;&#x2F;目标检测推理<br>.&#x2F;segnet –network&#x3D;<model> csi:&#x2F;&#x2F;0           &#x2F;&#x2F;语义分割<br>.&#x2F;posenet &#x2F;dev&#x2F;video0                        &#x2F;&#x2F;姿态估计<br>.&#x2F;posenet –network&#x3D;resnet18-hand csi:&#x2F;&#x2F;0    &#x2F;&#x2F;手部姿态<br>.&#x2F;actionnet csi:&#x2F;&#x2F;0                          &#x2F;&#x2F;动作识别<br>.&#x2F;backgroundnet csi:&#x2F;&#x2F;0                      &#x2F;&#x2F;背景去除<br>.&#x2F;depthnet csi:&#x2F;&#x2F;0                           &#x2F;&#x2F;单眼深度</p>
</li>
</ul>
<h2 id="四-GPIO使用"><a href="#四-GPIO使用" class="headerlink" title="四.GPIO使用"></a>四.GPIO使用</h2><p><strong>Python版使用说明</strong> ：<a target="_blank" rel="noopener" href="https://github.com/NVIDIA/jetson-gpio" title="NVIDIA&#x2F;jetson-gpio: A
Python library that enables the use of Jetson&#39;s GPIOs">NVIDIA&#x2F;jetson-gpio: A Python library that enables the use of<br>Jetson’s GPIOs</a></p>
<p><strong>C++版使用说明</strong> ：<a target="_blank" rel="noopener" href="https://github.com/pjueon/JetsonGPIO" title="pjueon&#x2F;JetsonGPIO: A C++
library that enables the use of Jetson&#39;s GPIOs">pjueon&#x2F;JetsonGPIO: A C++ library that enables the use of<br>Jetson’s GPIOs</a></p>
<h4 id="GPIO库的API用法"><a href="#GPIO库的API用法" class="headerlink" title="GPIO库的API用法"></a>GPIO库的API用法</h4><p>Jetson GPIO库提供了RPi.GPIO库提供的所有公共API。下面讨论每种API的用法：</p>
<h5 id="1-导入库"><a href="#1-导入库" class="headerlink" title="1.导入库"></a>1.导入库</h5><p>要导入Jetson.GPIO模块，请使用：</p>
<p>import Jetson.GPIO as GPIO</p>
<p>通过这种方式，您可以在应用程序的其余部分中将该模块称为GPIO。模块也可以使用RPi的名称导入。GPIO代替了Jetson。GPIO用于使用RPi库的现有代码。</p>
<h5 id="2-引脚编号"><a href="#2-引脚编号" class="headerlink" title="2.引脚编号"></a>2.引脚编号</h5><p>Jetson<br>GPIO库提供了四种给IO引脚编号的方法。前两个对应于RPi.GPIO库提供的模式，即BOARD和BCM，分别引用40引脚GPIO接头连接器的引脚号和Broadcom<br>SoC GPIO编号。其余两种模式CVM和TEGRA_SOC使用字符串代替数字，而数字分别对应于CVM CVB连接器和Tegra SoC上的信号名称。</p>
<p>要指定您正在使用哪种模式（强制性），请使用以下函数调用：</p>
<p>GPIO.setmode(GPIO.BOARD)# or</p>
<p>GPIO.setmode(GPIO.BCM)# or</p>
<p>GPIO.setmode(GPIO.CVM)# or</p>
<p>GPIO.setmode(GPIO.TEGRA_SOC)</p>
<p>要检查已设置的模式，可以调用：</p>
<p>mode &#x3D; GPIO.getmode()</p>
<p>该模式必须为GPIO.BOARD，GPIO.BCM，GPIO.CVM，GPIO.TEGRA_SOC或无。</p>
<p>可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/cynophile/article/details/99310678" title="Jetson Nano GPIO使用、四种模式以及串口解释">Jetson Nano<br>GPIO使用、四种模式以及串口解释</a></p>
<h5 id="3-警告"><a href="#3-警告" class="headerlink" title="3.警告"></a>3.警告</h5><p>您尝试使用的GPIO可能已在当前应用程序外部使用。在这种情况下，如果使用的GPIO配置为除默认方向（输入）以外的任何值，Jetson<br>GPIO库将向您发出警告。如果在设置模式和通道之前尝试清理，它也会警告您。要禁用警告，请使用：</p>
<p>GPIO.setwarnings(False)</p>
<h5 id="4-设置通道"><a href="#4-设置通道" class="headerlink" title="4.设置通道"></a>4.设置通道</h5><p>在用作输入或输出之前，必须先设置GPIO通道。要将通道配置为输入，请调用：</p>
<p>GPIO.setup(channel, GPIO.IN)</p>
<p>要将通道设置为输出，请调用：</p>
<p>GPIO.setup(channel, GPIO.OUT)</p>
<p>也可以为输出通道指定一个初始值：</p>
<p>GPIO.setup(channel, GPIO.OUT, initial&#x3D;GPIO.HIGH)</p>
<p>将一个通道设置为输出时，也可以一次设置多个通道：</p>
<p>channels &#x3D; [18, 12, 13]</p>
<p>GPIO.setup(channels, GPIO.OUT)</p>
<h5 id="5-输入"><a href="#5-输入" class="headerlink" title="5.输入"></a>5.输入</h5><p>要读取通道的值，请使用：</p>
<p>GPIO.input(channel)</p>
<p>这将返回GPIO.LOW或GPIO.HIGH。</p>
<h5 id="6-输出"><a href="#6-输出" class="headerlink" title="6.输出"></a>6.输出</h5><p>要设置配置为输出的引脚的值，请使用：</p>
<p>GPIO.output(channel, state)</p>
<p>状态可以是GPIO.LOW或GPIO.HIGH。</p>
<p>您还可以输出到频道列表或元组：</p>
<p>channels &#x3D; [18, 12, 13] # or use tuples</p>
<p>GPIO.output(channels, GPIO.HIGH) # or GPIO.LOW</p>
<h6 id="set-first-channel-to-HIGH-and-rest-to-LOW"><a href="#set-first-channel-to-HIGH-and-rest-to-LOW" class="headerlink" title="set first channel to HIGH and rest to LOW"></a>set first channel to HIGH and rest to LOW</h6><p>GPIO.output(channel, (GPIO.LOW, GPIO.HIGH, GPIO.HIGH))</p>
<h5 id="7-清理"><a href="#7-清理" class="headerlink" title="7.清理"></a>7.清理</h5><p>在程序结束时，最好清理通道，以便将所有引脚设置为默认状态。要清理所有使用的通道，请使用：</p>
<p>GPIO.cleanup()</p>
<p>如果您不想清除所有通道，也可以清除单个通道或通道列表或元组：</p>
<p>GPIO.cleanup(chan1) # cleanup only chan1</p>
<p>GPIO.cleanup([chan1, chan2]) # cleanup only chan1 and chan2</p>
<p>GPIO.cleanup((chan1, chan2)) # does the same operation as previous statement</p>
<h5 id="8-jetson模块信息和库版本"><a href="#8-jetson模块信息和库版本" class="headerlink" title="8.jetson模块信息和库版本"></a>8.jetson模块信息和库版本</h5><p>要获取有关Jetson模块的信息，请使用&#x2F;阅读：</p>
<p>GPIO.JETSON_INFO</p>
<p>这为Python字典提供了以下键：P1_REVISION，RAM，REVISION，TYPE，MANUFACTURER和PROCESSOR。字典中的所有值都是字符串，但P1_REVISION是整数。</p>
<p>要获取有关库版本的信息，请使用&#x2F;阅读：</p>
<p>GPIO.VERSION</p>
<p>这提供了XYZ版本格式的字符串。</p>
<h5 id="9-中断"><a href="#9-中断" class="headerlink" title="9.中断"></a>9.中断</h5><p>除了繁忙的轮询外，该库还提供了三种监视输入事件的方法：</p>
<h6 id="wait-for-edge（）函数"><a href="#wait-for-edge（）函数" class="headerlink" title="wait_for_edge（）函数"></a>wait_for_edge（）函数</h6><p>该函数阻塞调用线程，直到检测到提供的边缘为止。该函数可以如下调用：</p>
<p>GPIO.wait_for_edge(channel, GPIO.RISING)</p>
<p>第二个参数指定要检测的边缘，可以是GPIO.RISING，GPIO.FALLING或GPIO.BOTH。如果只想将等待时间限制为指定的时间，则可以选择设置超时：</p>
<h6 id="timeout-is-in-milliseconds"><a href="#timeout-is-in-milliseconds" class="headerlink" title="timeout is in milliseconds"></a>timeout is in milliseconds</h6><p>GPIO.wait_for_edge(channel, GPIO.RISING, timeout&#x3D;500)</p>
<p>该函数返回检测到边缘的通道；如果发生超时，则返回无。</p>
<h6 id="event-detected（）函数"><a href="#event-detected（）函数" class="headerlink" title="event_detected（）函数"></a>event_detected（）函数</h6><p>此功能可用于定期检查自上次通话以来是否发生了事件。该函数可以如下设置和调用：</p>
<h6 id="set-rising-edge-detection-on-the-channel"><a href="#set-rising-edge-detection-on-the-channel" class="headerlink" title="set rising edge detection on the channel"></a>set rising edge detection on the channel</h6><p>GPIO.add_event_detect(channel, GPIO.RISING)</p>
<p>run_other_code()</p>
<p>if GPIO.event_detected(channel):</p>
<p>do_something()</p>
<p>和以前一样，您可以检测GPIO.RISING，GPIO.FALLING或GPIO.BOTH的事件。</p>
<h6 id="当检测到边缘时运行回调函数"><a href="#当检测到边缘时运行回调函数" class="headerlink" title="当检测到边缘时运行回调函数"></a>当检测到边缘时运行回调函数</h6><p>此功能可用于为回调函数运行第二个线程。因此，响应边缘，回调函数可以与主程序并发运行。可以按以下方式使用此功能：</p>
<h6 id="define-callback-function"><a href="#define-callback-function" class="headerlink" title="define callback function"></a>define callback function</h6><p>def callback_fn(channel):</p>
<p>print(“Callback called from channel %s” % channel)</p>
<h6 id="add-rising-edge-detection"><a href="#add-rising-edge-detection" class="headerlink" title="add rising edge detection"></a>add rising edge detection</h6><p>GPIO.add_event_detect(channel, GPIO.RISING, callback&#x3D;callback_fn)</p>
<p>如果需要，还可以添加多个回调：</p>
<p>def callback_one(channel):</p>
<p>print(“First Callback”)</p>
<p>def callback_two(channel):</p>
<p>print(“Second Callback”)</p>
<p>GPIO.add_event_detect(channel, GPIO.RISING)</p>
<p>GPIO.add_event_callback(channel, callback_one)</p>
<p>GPIO.add_event_callback(channel, callback_two)</p>
<p>在这种情况下，这两个回调是顺序运行的，而不是同时运行，因为只有线程运行所有回调函数。</p>
<p>为了通过将多个事件折叠为一个事件来防止多次调用回调函数，可以选择设置反跳时间：</p>
<h6 id="bouncetime-set-in-milliseconds"><a href="#bouncetime-set-in-milliseconds" class="headerlink" title="bouncetime set in milliseconds"></a>bouncetime set in milliseconds</h6><p>GPIO.add_event_detect(channel, GPIO.RISING,<br>callback&#x3D;callback_fn,bouncetime&#x3D;200)</p>
<p>如果不再需要边缘检测，可以按以下步骤将其删除：</p>
<p>GPIO.remove_event_detect(channel)</p>
<h5 id="10-检查GPIO通道的功能"><a href="#10-检查GPIO通道的功能" class="headerlink" title="10.检查GPIO通道的功能"></a>10.检查GPIO通道的功能</h5><p>此功能使您可以检查提供的GPIO通道的功能：</p>
<p>GPIO.gpio_function(channel)</p>
<p>该函数返回GPIO.IN或GPIO.OUT。</p>
<h5 id="11-PWM"><a href="#11-PWM" class="headerlink" title="11. PWM"></a>11. PWM</h5><p>请参阅samples&#x2F;simple_pwm.py有关如何使用PWM通道的详细信息。</p>
<p>Jetson.GPIO库仅在附带硬件PWM控制器的引脚上支持PWM。与RPi.GPIO库不同，Jetson.GPIO库不实现软件仿真的PWM。Jetson<br>Nano支持2个PWM通道，而Jetson AGX Xavier支持3个PWM通道。Jetson TX1和TX2不支持任何PWM通道。</p>
<p>系统引脚复用器必须配置为将硬件PWM控制器连接到相关引脚。如果未配置pinmux，则PWM信号将不会到达引脚！Jetson.GPIO库不会动态修改pinmux配置来实现此目的。阅读L4T文档以获取有关如何配置pinmux的详细信息</p>
<p>完整英文版说明见: <a target="_blank" rel="noopener" href="https://github.com/NVIDIA/jetson-gpio">https://github.com/NVIDIA/jetson-gpio</a></p>
<h2 id="五-串口通信"><a href="#五-串口通信" class="headerlink" title="五.串口通信"></a>五.串口通信</h2><h5 id="UART"><a href="#UART" class="headerlink" title="&lt;1&gt;UART"></a>&lt;1&gt;UART</h5><h6 id="1-python代码-：-JetsonHacksNano-UARTDemo-UART-Demo-Code"><a href="#1-python代码-：-JetsonHacksNano-UARTDemo-UART-Demo-Code" class="headerlink" title="1.python代码 ：[JetsonHacksNano&#x2F;UARTDemo: UART Demo Code"></a><strong>1.python代码</strong> ：[JetsonHacksNano&#x2F;UARTDemo: UART Demo Code</h6><p>(github.com)](<a target="_blank" rel="noopener" href="https://github.com/JetsonHacksNano/UARTDemo">https://github.com/JetsonHacksNano/UARTDemo</a><br>“JetsonHacksNano&#x2F;UARTDemo: UART Demo Code (github.com)“)</p>
<p>jetson nano的串口的TXD和RXD引脚分别对应物理引脚8,10</p>
<p>开启串口权限，注意这个权限关机后就也被关闭，下次需要重新开启</p>
<pre><code>sudo chmod 777 /dev/ttyTHS1
</code></pre>
<p>如果要永久打开，可参考：<a target="_blank" rel="noopener" href="https://codeleading.com/article/76115811693/" title="永久修改jetson
nano上电启动串口权限">永久修改jetson<br>nano上电启动串口权限</a></p>
<h5 id="注意事项：如果使用USB转TTL模块电脑和nano进行通信注意一下几点"><a href="#注意事项：如果使用USB转TTL模块电脑和nano进行通信注意一下几点" class="headerlink" title="注意事项：如果使用USB转TTL模块电脑和nano进行通信注意一下几点"></a>注意事项：<strong>如果使用USB转TTL模块电脑和nano进行通信注意一下几点</strong></h5><pre><code>    1.杜邦线不可太长，太长会乱码

    2.出现只能收不能发的情况是电压不足导致的，把usb转ttl模块的5V口和nano的5V进行连接

    3.如果线合理，但出现乱码，波特率、奇偶校验、停止位检查是否一致

    4.其它情况：[串口收不到数据或者收到错误数据 串口乱码总结_串口没有数据](https://blog.csdn.net/lxj362343/article/details/89646731 &quot;串口收不到数据或者收到错误数据 串口乱码总结_串口没有数据&quot;)
</code></pre>
<h6 id="2-C-代码：-Uart-c-class-for-Nvidia-Jetson"><a href="#2-C-代码：-Uart-c-class-for-Nvidia-Jetson" class="headerlink" title="2.C++代码：[Uart c++ class for Nvidia Jetson"></a>2.C++代码：[Uart c++ class for Nvidia Jetson</h6><p>Nano](<a target="_blank" rel="noopener" href="https://github.com/MathieuBahin/JetsonNanoUart/tree/master">https://github.com/MathieuBahin/JetsonNanoUart/tree/master</a> “Uart c++<br>class for Nvidia Jetson Nano”)</p>
<p>在四中的C++版GPIO库中并未包括uart相关内容，但是利用jetson nano设备中的</p>
<pre><code>/dev/ttyTHS1
</code></pre>
<p>进行系统调用，可实现串口通信。</p>
<p>但github上的C++ uart代码比较复杂，且只适用于特点场景，笔者修改了部分内容如下：</p>
<pre><code>//uart.h
#ifndef _UART_H
#define _UART_H


// Define Constants
const char *uart_target = &quot;/dev/ttyTHS1&quot;;
#define     NSERIAL_CHAR   256
#define     VMINX          1
#define     BAUDRATE       B115200


class Uart &#123;
private:
  /* data */
  int fid;
public:
  char serial_message[NSERIAL_CHAR];


  Uart ();
  void sendUart(char *msg);
  void readUart();
  void closeUart();

&#125;;
#endif



/************************************/
/* @auteur Mathieu Bahin            */
/* @date_création mars 2020         */
/* @version 1.0                     */
/* @email bahin.mathieu@gmail.com   */
/************************************/

#include &quot;uart.h&quot;
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;       // Used for UART
#include &lt;sys/fcntl.h&gt;    // Used for UART
#include &lt;termios.h&gt;      // Used for UART
#include &lt;string.h&gt;

using namespace std;

Uart :: Uart ()&#123;
  int ii, jj, kk;

  // SETUP SERIAL WORLD

  struct termios  port_options;   // Create the structure

  tcgetattr(fid, &amp;port_options);	// Get the current attributes of the Serial port


  //------------------------------------------------
  //  OPEN THE UART
  //------------------------------------------------
  // The flags (defined in fcntl.h):
  //	Access modes (use 1 of these):
  //		O_RDONLY - Open for reading only.
  //		O_RDWR   - Open for reading and writing.
  //		O_WRONLY - Open for writing only.
  //	    O_NDELAY / O_NONBLOCK (same function)
  //               - Enables nonblocking mode. When set read requests on the file can return immediately with a failure status
  //                 if there is no input immediately available (instead of blocking). Likewise, write requests can also return
  //				   immediately with a failure status if the output can&#39;t be written immediately.
  //                 Caution: VMIN and VTIME flags are ignored if O_NONBLOCK flag is set.
  //	    O_NOCTTY - When set and path identifies a terminal device, open() shall not cause the terminal device to become the controlling terminal for the process.fid = open(&quot;/dev/ttyTHS1&quot;, O_RDWR | O_NOCTTY | O_NDELAY);		//Open in non blocking read/write mode

  fid = open(uart_target, O_RDWR | O_NOCTTY );

  tcflush(fid, TCIFLUSH);
  tcflush(fid, TCIOFLUSH);

  if (fid == -1)
  &#123;
    printf(&quot;**Error - Unable to open UART**.  \n=&gt;Ensure it is not in use by another application\n=&gt;Ensure proper privilages are granted to accsess /dev/.. by run as a sudo\n&quot;);
  &#125;

  //------------------------------------------------
  // CONFIGURE THE UART
  //------------------------------------------------
  // flags defined in /usr/include/termios.h - see http://pubs.opengroup.org/onlinepubs/007908799/xsh/termios.h.html
  //	Baud rate:
  //         - B1200, B2400, B4800, B9600, B19200, B38400, B57600, B115200,
  //           B230400, B460800, B500000, B576000, B921600, B1000000, B1152000,
  //           B1500000, B2000000, B2500000, B3000000, B3500000, B4000000
  //	CSIZE: - CS5, CS6, CS7, CS8
  //	CLOCAL - Ignore modem status lines
  //	CREAD  - Enable receiver
  //	IGNPAR = Ignore characters with parity errors
  //	ICRNL  - Map CR to NL on input (Use for ASCII comms where you want to auto correct end of line characters - don&#39;t use for bianry comms!)
  //	PARENB - Parity enable
  //	PARODD - Odd parity (else even)

//*******************************begin::uart参数设置************************************
  port_options.c_cflag &amp;= ~PARENB;            // Disables the Parity Enable bit(PARENB),So No Parity
  port_options.c_cflag &amp;= ~CSTOPB;            // CSTOPB = 2 Stop bits,here it is cleared so 1 Stop bit
  port_options.c_cflag &amp;= ~CSIZE;	            // Clears the mask for setting the data size
  port_options.c_cflag |=  CS8;               // Set the data bits = 8
  port_options.c_cflag &amp;= ~CRTSCTS;           // No Hardware flow Control
  port_options.c_cflag |=  CREAD | CLOCAL;                  // Enable receiver,Ignore Modem Control lines
  port_options.c_iflag &amp;= ~(IXON | IXOFF | IXANY);          // Disable XON/XOFF flow control both input &amp; output
  port_options.c_iflag &amp;= ~(ICANON | ECHO | ECHOE | ISIG);  // Non Cannonical mode
  port_options.c_oflag &amp;= ~OPOST;                           // No Output Processing

  port_options.c_lflag = 0;               //  enable raw input instead of canonical,

  port_options.c_cc[VMIN]  = VMINX;       // Read at least 1 character
  port_options.c_cc[VTIME] = 0;           // Wait indefinetly

  cfsetispeed(&amp;port_options,BAUDRATE);    // Set Read  Speed
  cfsetospeed(&amp;port_options,BAUDRATE);    // Set Write Speed

//********************************end::uart参数设置*************************************

  // Set the attributes to the termios structure
  int att = tcsetattr(fid, TCSANOW, &amp;port_options);

  if (att != 0 )
  &#123;
    printf(&quot;\nERROR in Setting port attributes&quot;);
  &#125;
  else
  &#123;
    printf(&quot;\nSERIAL Port Good to Go.\n&quot;);
  &#125;

  // Flush Buffers
  tcflush(fid, TCIFLUSH);
  tcflush(fid, TCIOFLUSH);
&#125;

void Uart :: sendUart(char *msg)&#123;
  //--------------------------------------------------------------
  // TRANSMITTING BYTES
  //--------------------------------------------------------------
  char tx_buffer[256]=&#123;0&#125;;

  for (int i = 0; msg[i]!=&#39;\0&#39;; i++) &#123;
    tx_buffer[i] = msg[i];
  &#125;
  printf(&quot;%s\n&quot;,tx_buffer);

  if (fid != -1)
  &#123;
    int count = write(fid, &amp;tx_buffer[0], strlen((const char*)tx_buffer));		//Filestream, bytes to write, number of bytes to write

    printf(&quot;Count = %d\n&quot;, count);

    if (count &lt; 0)  printf(&quot;UART TX error\n&quot;);
  &#125;

&#125;

void Uart :: readUart()&#123;

  //--------------------------------------------------------------
  // RECEIVING BYTES - AND BUILD MESSAGE RECEIVED
  //--------------------------------------------------------------
  unsigned char rx_buffer[VMINX];
  bool          pickup = true;
  int ii;
  int           rx_length;
  int           nread = 0;

  //更新缓存
  tcflush(fid, TCIOFLUSH);
  //清空接收区
  for (ii=0; ii&lt;NSERIAL_CHAR; ii++)  serial_message[ii]=&#39;\0&#39;;

  while (pickup &amp;&amp; fid != -1)
  &#123;
    rx_length = read(fid, (void*)rx_buffer, VMINX);   // Filestream, buffer to store in, number of bytes to read (max)

    if (rx_length&gt;=0)
    &#123;
      if (nread&lt;=NSERIAL_CHAR-1)&#123;
        serial_message[nread] = rx_buffer[0];   // Build message 1 character at a time
      &#125;

      if (rx_buffer[0]==&#39;$&#39;)   pickup=false;    // # symbol is terminator 自定协议规定以$结尾
    &#125;

    nread++;
  &#125;

&#125;

void Uart :: closeUart()&#123;
  //-------------------------------------------
  //  CLOSE THE SERIAL PORT
  //-------------------------------------------
  close(fid);
&#125;

//*******************************begin::测试程序************************************
int main(int argc, char *argv[]) &#123;
  Uart u;
  int i;
  char m[256]=&quot;hello world!&quot;;
  u.sendUart(&quot;%s&quot;,&quot;hello world!\r\n&quot;);
  u.sendUart(m);
   
  while (1)
  &#123;
    u.readUart();
    if(strlen(u.serial_message)!=0)
    &#123;
      for(i=0;u.serial_message[i]!=&#39;$&#39;;i++)    //自定协议规定以$结尾
      &#123;
        printf(&quot;%c &quot;,u.serial_message[i]);
      &#125;
    &#125;
    printf(&quot;\n&quot;);    
  &#125;
  u.closeUart();

  return 0;
&#125;
//********************************end::测试程序*************************************
</code></pre>
<p><strong>其中删去了大部分不必要片段，并加入了Uart_Printf()函数，用法同printf()</strong></p>
<p>测试结果：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6af7567db40ef98ffaec08066206ca83.png"></p>
<p>&lt;2&gt;IIC</p>
<h2 id="六-在jetson-nano上使用OpenCV"><a href="#六-在jetson-nano上使用OpenCV" class="headerlink" title="六.在jetson nano上使用OpenCV"></a>六.在jetson nano上使用OpenCV</h2><p>&lt;1&gt;<strong>python打开摄像头：参考[通过OpenCV调用CSI和USB摄像头](<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_56548850/article/details/123967404?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169070226116800188569163%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169070226116800188569163&biz_id=0&utm_medium=distribute.pc_search_result.none-">https://blog.csdn.net/qq_56548850/article/details/123967404?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169070226116800188569163%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169070226116800188569163&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-</a><br>task-blog-2<del>all</del>sobaiduend~default-2-123967404-null-<br>null.142%5Ev91%5Einsert_down28v1,239%5Ev12%5Econtrol2&amp;utm_term&#x3D;jetsonnano%E8%B0%83%E7%94%A8usb%E6%91%84%E5%83%8F%E5%A4%B4&amp;spm&#x3D;1018.2226.3001.4187<br>“通过OpenCV调用CSI和USB摄像头”)</strong></p>
<p><strong>C++打开，示例如下：</strong></p>
<pre><code>//适用于jetson nano上的模版
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;opencv2/opencv.hpp&gt;
#include &lt;opencv2/core.hpp&gt;
#include &lt;opencv2/highgui.hpp&gt;
#include &lt;opencv2/imgproc.hpp&gt;
#include &lt;opencv2/objdetect.hpp&gt;
#include &lt;opencv2/imgproc/types_c.h&gt;
#include &lt;opencv2/videoio.hpp&gt;

using namespace std;
using namespace cv;

string gstreamer_pipeline(int capture_width, int capture_height, int display_width, int display_height, int framerate, int flip_method)
&#123;
    return &quot;nvarguscamerasrc ! video/x-raw(memory:NVMM), width=(int)&quot; + to_string(capture_width) + &quot;, height=(int)&quot; +
        to_string(capture_height) + &quot;, format=(string)NV12, framerate=(fraction)&quot; + to_string(framerate) +
        &quot;/1 ! nvvidconv flip-method=&quot; + to_string(flip_method) + &quot; ! video/x-raw, width=(int)&quot; + to_string(display_width) + &quot;, height=(int)&quot; +
        to_string(display_height) + &quot;, format=(string)BGRx ! videoconvert ! video/x-raw, format=(string)BGR ! appsink&quot;;
&#125;

int main()
&#123;
    int capture_width = 1280;
    int capture_height = 720;
    int display_width = 1280;
    int display_height = 720;
    int framerate = 60;
    int flip_method = 0;

    //创建管道
    string pipeline = gstreamer_pipeline(capture_width,
        capture_height,
        display_width,
        display_height,
        framerate,
        flip_method);
    std::cout &lt;&lt; &quot;使用gstreamer管道: \n\t&quot; &lt;&lt; pipeline &lt;&lt; &quot;\n&quot;;

    //管道与视频流绑定
    VideoCapture cap(pipeline, CAP_GSTREAMER);

    //创建显示窗口
    namedWindow(&quot;CSI Camera&quot;, WINDOW_AUTOSIZE);
    Mat img;

    //逐帧显示
    while (true)
    &#123;
        cap.read(img);
        imshow(&quot;CSI Camera&quot;, img);

        if (waitKey(10) == 27)break;
    &#125;

    cap.release();
    destroyAllWindows();
&#125;
</code></pre>
<p>&lt;2&gt;使用官方自带的4.1.1版本OpenCV</p>
<p>自带的OpenCV文件夹在**&#x2F;usr&#x2F;share&#x2F;opencv4** 中，**~&#x2F;sample&#x2F;cpp  **内含众多示例代码</p>
<p>运行示例代码时使用g++编译，命令为：</p>
<pre><code>g++ name.cpp -o name `pkg-config --cflags --libs opencv4`
</code></pre>
<p>命令行输入如下命令即可运行：</p>
<pre><code>./name parameters
</code></pre>
<p>其中name为编写的程序名，parameters程序具体需要的参数</p>
<p>因为官方镜像所有的环境都是配好的，g++编译时加入<code>pkg-config --cflags --libs opencv4</code>就可运行。想要下载全新版本自己配置并了解其中的原理可以参考下面的资料</p>
<p>&lt;3&gt;自己配置其他版本OpenCV参考资料</p>
<p> 1.jetson nano上开发环境配置及使用QT(C++)或VsCode编写运行(Python)<a target="_blank" rel="noopener" href="https://blog.csdn.net/qianbin3200896/article/details/103760640?spm=1001.2014.3001.5506#t6" title="Jetson Nano 从入门到实战（案例：Opencv配置、人脸检测、二维码检测）">Jetson Nano<br>从入门到实战（案例：Opencv配置、人脸检测、二维码检测）</a></p>
<p>2.使用CMake编译链接(C++)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43717839/article/details/128032486?spm=1001.2014.3001.5506" title="【C++】Cmake使用教程（看这一篇就够了）_c++ cmake_隐居的遮天恶鬼的博客-CSDN博客">【C++】Cmake使用教程（看这一篇就够了）_c++ cmake_隐居的遮天恶鬼的博客-<br>CSDN博客</a></p>
<p>3.使用g++命令(C++)</p>
<p>4.配置最新版或其他版本OpenCV：<a target="_blank" rel="noopener" href="https://blog.csdn.net/s15810751918/article/details/107705387?spm=1001.2014.3001.5506" title="linux下编译安装opencv生成opencv.pc_浓茶淡酒的博客-CSDN博客">linux下编译安装opencv生成opencv.pc_浓茶淡酒的博客-<br>CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47665864/article/details/128945476?spm=1001.2014.3001.5506" title="如何在Linux上安装OpenCV_linux 安装opencv_lvzt的博客-CSDN博客">如何在Linux上安装OpenCV_linux 安装opencv_lvzt的博客-<br>CSDN博客</a></p>
<h2 id="七-jetson-nano开机自启动程序"><a href="#七-jetson-nano开机自启动程序" class="headerlink" title="七.jetson nano开机自启动程序"></a>七.jetson nano开机自启动程序</h2><p>步骤：</p>
<p>1.打开文件：</p>
<pre><code>/usr/bin/yoyo.sh
</code></pre>
<p>2.写入命令（开机自动执行的命令），例如：</p>
<pre><code>cd /home/jetson/test/circle_control
./circle
</code></pre>
<p>注：终端路径转至&#x2F;home&#x2F;jetson&#x2F;test&#x2F;circle_control，执行.&#x2F;circle文件</p>
<p>3.终端执行:</p>
<pre><code>sudo systemctl daemon-reload
sudo systemctl enable start.service
sudo reboot
</code></pre>
<h2 id="八-实战程序"><a href="#八-实战程序" class="headerlink" title="八.实战程序"></a>八.实战程序</h2><h5 id="1-jetson-nano上进行霍夫圆检测并将圆心坐标通过uart传给stm32"><a href="#1-jetson-nano上进行霍夫圆检测并将圆心坐标通过uart传给stm32" class="headerlink" title="1.jetson nano上进行霍夫圆检测并将圆心坐标通过uart传给stm32"></a>1.jetson nano上进行霍夫圆检测并将圆心坐标通过uart传给stm32</h5><pre><code>//*************circle.cpp**************
#include &quot;opencv2/opencv.hpp&quot;
#include &quot;opencv2/highgui.hpp&quot;
#include &lt;iostream&gt;
using namespace cv;

//begin::uart部分************************************************************************
#include &quot;uart.h&quot;
#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
#include &lt;unistd.h&gt;       // Used for UART
#include &lt;sys/fcntl.h&gt;    // Used for UART
#include &lt;termios.h&gt;      // Used for UART
#include &lt;string.h&gt;

using namespace std;

Uart :: Uart ()&#123;
  int ii, jj, kk;
  struct termios  port_options;   // Create the structure

  tcgetattr(fid, &amp;port_options);	// Get the current attributes of the Serial port
  fid = open(uart_target, O_RDWR | O_NOCTTY );
  tcflush(fid, TCIFLUSH);
  tcflush(fid, TCIOFLUSH);
  if (fid == -1)
  &#123;
    printf(&quot;**Error - Unable to open UART**.  \n=&gt;Ensure it is not in use by another application\n=&gt;Ensure proper privilages are granted to accsess /dev/.. by run as a sudo\n&quot;);
  &#125;
  port_options.c_cflag &amp;= ~PARENB;            // Disables the Parity Enable bit(PARENB),So No Parity
  port_options.c_cflag &amp;= ~CSTOPB;            // CSTOPB = 2 Stop bits,here it is cleared so 1 Stop bit
  port_options.c_cflag &amp;= ~CSIZE;	            // Clears the mask for setting the data size
  port_options.c_cflag |=  CS8;               // Set the data bits = 8
  port_options.c_cflag &amp;= ~CRTSCTS;           // No Hardware flow Control
  port_options.c_cflag |=  CREAD | CLOCAL;                  // Enable receiver,Ignore Modem Control lines
  port_options.c_iflag &amp;= ~(IXON | IXOFF | IXANY);          // Disable XON/XOFF flow control both input &amp; output
  port_options.c_iflag &amp;= ~(ICANON | ECHO | ECHOE | ISIG);  // Non Cannonical mode
  port_options.c_oflag &amp;= ~OPOST;                           // No Output Processing

  port_options.c_lflag = 0;               //  enable raw input instead of canonical,

  port_options.c_cc[VMIN]  = VMINX;       // Read at least 1 character
  port_options.c_cc[VTIME] = 0;           // Wait indefinetly

  cfsetispeed(&amp;port_options,BAUDRATE);    // Set Read  Speed
  cfsetospeed(&amp;port_options,BAUDRATE);    // Set Write Speed

  // Set the attributes to the termios structure
  int att = tcsetattr(fid, TCSANOW, &amp;port_options);

  if (att != 0 )
  &#123;
    printf(&quot;\nERROR in Setting port attributes&quot;);
  &#125;
  else
  &#123;
    printf(&quot;\nSERIAL Port Good to Go.\n&quot;);
  &#125;

  // Flush Buffers
  tcflush(fid, TCIFLUSH);
  tcflush(fid, TCIOFLUSH);
&#125;

void Uart :: sendUart(char *msg)&#123;
  //--------------------------------------------------------------
  // TRANSMITTING BYTES
  //--------------------------------------------------------------
  char tx_buffer[256]=&#123;0&#125;;

  for (int i = 0; msg[i]!=&#39;\0&#39;; i++) &#123;
    tx_buffer[i] = msg[i];
  &#125;
  printf(&quot;%s\n&quot;,tx_buffer);

  if (fid != -1)
  &#123;
    int count = write(fid, &amp;tx_buffer[0], strlen((const char*)tx_buffer));		//Filestream, bytes to write, number of bytes to write

    printf(&quot;Count = %d\n&quot;, count);

    if (count &lt; 0)  printf(&quot;UART TX error\n&quot;);
  &#125;

&#125;

void Uart :: readUart()&#123;

  //--------------------------------------------------------------
  // RECEIVING BYTES - AND BUILD MESSAGE RECEIVED
  //--------------------------------------------------------------
  unsigned char rx_buffer[VMINX];
  bool          pickup = true;
  int ii;
  int           rx_length;
  int           nread = 0;

  //更新缓存
  tcflush(fid, TCIOFLUSH);
  //清空接收区
  for (ii=0; ii&lt;NSERIAL_CHAR; ii++)  serial_message[ii]=&#39;\0&#39;;

  while (pickup &amp;&amp; fid != -1)
  &#123;
    rx_length = read(fid, (void*)rx_buffer, VMINX);   // Filestream, buffer to store in, number of bytes to read (max)

    if (rx_length&gt;=0)
    &#123;
      if (nread&lt;=NSERIAL_CHAR-1)&#123;
        serial_message[nread] = rx_buffer[0];   // Build message 1 character at a time
      &#125;

      if (rx_buffer[0]==&#39;$&#39;)   pickup=false;    // # symbol is terminator 自定协议规定以$结尾
    &#125;

    nread++;
  &#125;

&#125;

int Uart :: fputc(int ch, FILE *f)
&#123;
	write(fid, &amp;ch, 1);
	return ch;
&#125;

void Uart :: Uart_Printf(char *format, ...)
&#123;
	char String[256];
	va_list arg;
	va_start(arg, format);
	vsprintf(String, format, arg);
	va_end(arg);
	sendUart(String);
&#125;

void Uart :: closeUart()&#123;
  //-------------------------------------------
  //  CLOSE THE SERIAL PORT
  //-------------------------------------------
  close(fid);
&#125;
//end::uart部分**************************************************************************

const char* windowname=&quot;win&quot;;
int max_r=100;
int min_r=60;
int min_d=80;
int t_hold=25;
int param1=100;
int param2=20;
const int t_max=255;
const int r_max=1000;
const int d_max=100;
const int p1_max=200;
const int p2_max=200;


int main()
&#123;
  VideoCapture capture(0);
  Mat image;
	Mat matCanny;
  Mat BinImg;
  Mat matDst;
  Uart u;

  void on_Trackbar_1(int, void*);
  void on_Trackbar_2(int, void*);
  void on_Trackbar_3(int, void*);
  void on_Trackbar_4(int, void*);
  void on_Trackbar_5(int, void*);
  void on_Trackbar_6(int, void*);
  namedWindow(windowname,0);
  setWindowProperty(windowname, WND_PROP_ASPECT_RATIO , WINDOW_FREERATIO);
  resizeWindow(windowname, 400, 300);
  moveWindow(windowname, 0, 0);
  createTrackbar(&quot;t_hold&quot;,windowname, &amp;t_hold, t_max, on_Trackbar_3);
  createTrackbar(&quot;max_r&quot;,windowname, &amp;max_r, r_max, on_Trackbar_1);
  createTrackbar(&quot;min_r&quot;,windowname, &amp;min_r, r_max, on_Trackbar_2);
  createTrackbar(&quot;min_d&quot;,windowname, &amp;min_d, d_max, on_Trackbar_6);
  createTrackbar(&quot;p_1&quot;,windowname, &amp;param1, p1_max, on_Trackbar_4);
  createTrackbar(&quot;p_2&quot;,windowname, &amp;param2, p2_max, on_Trackbar_5);

	while (capture.isOpened())
	&#123;
		capture &gt;&gt; image;
		if (image.empty())break;
    cvtColor(image, matDst, COLOR_BGR2GRAY);
		threshold(matDst, BinImg, t_hold, 255, THRESH_BINARY_INV|THRESH_OTSU);
    Canny(BinImg, matCanny, 100, 300, 3, false);		//canny算子
        
		std::vector&lt;Vec3f&gt; circles;
		HoughCircles(matCanny, circles, HOUGH_GRADIENT, 1, min_d, param1, param2, min_r, max_r);
		//在原图中画出圆心和圆  
		for (size_t i = 0; i &lt; circles.size(); i++) &#123;
			//提取出圆心坐标  
			Point center(round(circles[i][0]), round(circles[i][1]));
			//提取出圆半径  
			int radius = round(circles[i][2]);
			//圆心  
			circle(image, center, 3, Scalar(255,0,0), -1, 4, 0);
			//圆  
			circle(image, center, radius, Scalar(255,0,0), 3, 4, 0);
		&#125;

    printf(&quot;x:%d\ny:%d\n&quot;,(int)round(circles[0][0]),(int)round(circles[0][1]));
    u.Uart_Printf(&quot;#x%dy%d$&quot;,(int)round(circles[0][0]),(int)round(circles[0][1]));

    imshow(&quot;matCanny&quot;, matCanny);
    imshow(&quot;BinImg&quot;, BinImg);
		imshow(windowname, image);
		if (waitKey(1) == 27)break;
	&#125;

  u.closeUart();
  return 0;

&#125;

void on_Trackbar_1(int, void*)
&#123;
    ;
&#125;

void on_Trackbar_2(int, void*)
&#123;
    ;
&#125;
void on_Trackbar_3(int, void*)
&#123;
    ;
&#125;
void on_Trackbar_4(int, void*)
&#123;
    ;
&#125;
void on_Trackbar_5(int, void*)
&#123;
    ;
&#125;
void on_Trackbar_6(int, void*)
&#123;
    ;
&#125;
</code></pre>
<p>使用说明：</p>
<p>使用前打开串口权限；程序使用usb摄像头；要将uart.h包含到该文件（circle.cpp）同目录下；</p>
<p>该目录下打开终端输入：<br>进行编译产生可执行文件</p>
<pre><code>g++ circle.cpp -o circle `pkg-config --cflags --libs opencv4`
</code></pre>
<p>该目录下打开终端输入：<br>即可运行</p>
<pre><code>./circle
</code></pre>
<p>注：霍夫圆检测不太稳定，会显示core出错，重启即可，也可以在启动时调节各个参数使稳定</p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/131511658">https://blog.csdn.net/qq_32971095/article/details/131511658</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/08/%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1%E2%80%94%E2%80%94Matlab%E5%AE%9E%E7%8E%B0%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%EF%BC%9C1%EF%BC%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/08/%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1%E2%80%94%E2%80%94Matlab%E5%AE%9E%E7%8E%B0%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%EF%BC%9C1%EF%BC%9E/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-08 11:46:35 / 修改时间：09:30:54" itemprop="dateCreated datePublished" datetime="2025-02-08T11:46:35+08:00">2025-02-08</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9">一.实验内容</a></p>
<p><a href="about:blank#%E4%BA%8C.%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90">二.代码分析</a></p>
<p><a href="about:blank#1.%E4%BF%A1%E5%8F%B7%E4%BA%A7%E7%94%9F%E9%83%A8%E5%88%86">1.信号产生部分</a></p>
<p><a href="about:blank#2.%E5%88%A9%E7%94%A8%E5%82%85%E7%AB%8B%E5%8F%B6%E7%BA%A7%E6%95%B0%E5%B1%95%E5%BC%80%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%87%AA%E7%94%B1%E7%94%9F%E6%88%90%E6%89%80%E9%9C%80%E7%9A%84x%28t%29">2.利用傅立叶级数展开的方法，自由生成所需的x(t)</a></p>
<p><a href="about:blank#3.%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E4%B8%8D%E5%90%8C%E7%9A%84%E9%87%87%E6%A0%B7%E9%97%B4%E9%9A%94T%EF%BC%88%E5%88%86%E5%88%AB%E9%80%89T%3E%E6%88%96%3C1%2F2fc%EF%BC%89%EF%BC%8C%E4%BB%8Ex%28t%29%E8%8E%B7%E5%BE%97%E7%9B%B8%E5%BA%94%E7%9A%84x%28n%29">3.通过选择不同的采样间隔T（分别选T&gt;或&lt;1&#x2F;2fc），从x(t)获得相应的x(n)</a></p>
<p><a href="about:blank#3.%E5%AF%B9%E8%8E%B7%E5%BE%97%E7%9A%84%E4%B8%8D%E5%90%8Cx%28n%29%E5%88%86%E5%88%AB%E4%BD%9C%E5%82%85%E7%AB%8B%E5%8F%B6%E5%8F%98%E6%8D%A2%EF%BC%8C%E5%88%86%E6%9E%90%E5%85%B6%E9%A2%91%E7%8E%87%E5%93%8D%E5%BA%94%E7%89%B9%E6%80%A7%EF%BC%88%E7%BB%99%E5%87%BA%E5%B9%85%E9%A2%91%E4%B8%8E%E7%9B%B8%E9%A2%91%E7%89%B9%E6%80%A7%E6%9B%B2%E7%BA%BF%EF%BC%89">3.对获得的不同x(n)分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）</a></p>
<p><a href="about:blank#4.%E5%88%A9%E7%94%A8%E5%B7%B4%E7%89%B9%E6%B2%83%E6%80%9D%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8">4.利用巴特沃思滤波器设计数字滤波器</a></p>
<p><a href="about:blank#%3C1%3E%E4%BD%8E%E9%80%9A%E6%BB%A4%E6%B3%A2%E5%99%A8">&lt;1&gt;低通滤波器</a></p>
<p><a href="about:blank#%3C2%3E%E9%AB%98%E9%80%9A%E6%BB%A4%E6%B3%A2%E5%99%A8">&lt;2&gt;高通滤波器</a></p>
<p><a href="about:blank#%3C3%3E%E7%BB%98%E5%9B%BE">&lt;3&gt;绘图</a></p>
<p><a href="about:blank#5.%E5%88%A9%E7%94%A8%E7%AA%97%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E6%B3%95%E6%88%96%E9%A2%91%E7%8E%87%E9%87%87%E6%A0%B7%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8">5.利用窗函数设计法或频率采样法设计数字滤波器</a></p>
<p><a href="about:blank#%3C1%3E%E9%AB%98%E9%80%9A%E6%BB%A4%E6%B3%A2%E5%99%A8">&lt;1&gt;高通滤波器</a></p>
<p><a href="about:blank#%3C2%3E%E4%BD%8E%E9%80%9A%E6%BB%A4%E6%B3%A2%E5%99%A8">&lt;2&gt;低通滤波器</a></p>
<p><a href="about:blank#%3C3%3E%E7%BB%98%E5%9B%BE">&lt;3&gt;绘图</a></p>
<p><a href="about:blank#%E4%B8%89.%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">三.实验结果</a></p>
<hr>
<h2 id="一-实验内容"><a href="#一-实验内容" class="headerlink" title="一.实验内容"></a>一.实验内容</h2><p>1．利用傅立叶级数展开的方法，自由生成所需的x(t)；</p>
<p>2．通过选择不同的采样间隔T（分别选T&gt;或&lt;1&#x2F;2fc），从x(t)获得相应的x(n)（作出x(n)图形）；</p>
<p>3．对获得的不同x(n)分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）；</p>
<p>4．利用巴特沃思、切比雪夫或椭圆滤波器设计数字滤波器（滤波特性自定），要求通过改变滤波器参数或特性（低通、高通、带通或带阻）设计至少两种数字滤波器，分析所设计滤波器（画出频率特性曲线），并对上述给出的不同x(n)分别进行滤波（画出滤波结果），然后加以讨论；</p>
<p>5．利用窗函数设计法或频率采样法设计数字滤波器（滤波特性自定），要求通过改变滤波器参数或特性（低通、高通、带通或带阻等）设计至少两种数字滤波器，分析所设计滤波器（画出频率特性曲线），并对上述给出的不同x(n)分别进行滤波（画出滤波结果），然后加以讨论。</p>
<h2 id="二-代码分析"><a href="#二-代码分析" class="headerlink" title="二.代码分析"></a>二.代码分析</h2><h5 id="1-信号产生部分"><a href="#1-信号产生部分" class="headerlink" title="1.信号产生部分"></a>1.信号产生部分</h5><pre><code>function [signal]=signal_xt(t_length,T,f,A,u)
%%  函数描述
%   功能：利用傅立叶级数展开的方法，自由生成所需的x(t)（不含直流量）；
%   输入参数：产生序列的长度t_length；采样间隔T；f(t)的基波频率f；傅立叶级数展开的各项幅值和相位。故最高频率为fc=length(A)*f
%   使用举例：signal=signal_xt(3,0.01,1,[1,2,3,4],[0,1,0,1])
%%  t,y初始化并计算
t=0:T:t_length-T;
t_num=t_length/T;
signal=zeros(1,t_num);
max=0;
min=0;
for i=1:t_num  
    for k=1:length(A)
        %   计算函数值
        signal(i)= signal(i) + A(k)*cos(2*pi*k*t(i)*f+u(k));
        %   最大最小值记录
        if max&lt;signal(i)
            max=signal(i);
        end
        if min&gt;signal(i)
            min=signal(i);
        end
    end
end
%%  结果展示
figure;
subplot(2,1,1);
plot(t,signal);
%   x，y轴范围限制及标题
axis([0-0.1,t_length+0.1,min-0.5,max+0.5])
title(&#39;x(t)&#39;); 
xlabel(&#39;t&#39;);
ylabel(&#39;x(t)&#39;); 
grid on

subplot(2,1,2);
stem(t,signal,&quot;.&quot;);
%   x，y轴范围限制及标题
axis([0-0.1,t_length+0.1,min-0.5,max+0.5])
title(&#39;x(t)&#39;); 
xlabel(&#39;t&#39;);
ylabel(&#39;x(t)&#39;); 
grid on
</code></pre>
<p>function [signal]&#x3D;signal_xt(t_length,T,f,A,u)<br>%%  函数描述<br>%   功能：利用傅立叶级数展开的方法，自由生成所需的x(t)（不含直流量）；<br>%   输入参数：产生序列的长度t_length；采样间隔T；f(t)的基波频率f；傅立叶级数展开的各项幅值和相位。故最高频率为fc&#x3D;length(A)*f<br>%   使用举例：signal&#x3D;signal_xt(3,0.01,1,[1,2,3,4],[0,1,0,1])</p>
<h5 id="2-利用傅立叶级数展开的方法，自由生成所需的x-t"><a href="#2-利用傅立叶级数展开的方法，自由生成所需的x-t" class="headerlink" title="2.利用傅立叶级数展开的方法，自由生成所需的x(t)"></a>2.利用傅立叶级数展开的方法，自由生成所需的x(t)</h5><pre><code>%%  利用傅立叶级数展开的方法，自由生成所需的x(t)，即signal_origin；
t_length=1;     %生成长度
f=1;            %基础频率
A=[3,1,1,3];    %各项幅度
u=[-1,0,1,0];   %各项相位
signal_origin=signal_xt(t_length,0.01,f,A,u);
fc=f*length(A);
</code></pre>
<h5 id="3-通过选择不同的采样间隔T（分别选T-或"><a href="#3-通过选择不同的采样间隔T（分别选T-或" class="headerlink" title="3.通过选择不同的采样间隔T（分别选T&gt;或&lt;1&#x2F;2fc），从x(t)获得相应的x(n)"></a>3.通过选择不同的采样间隔T（分别选T&gt;或&lt;1&#x2F;2fc），从x(t)获得相应的x(n)</h5><pre><code>%%  通过选择不同的采样间隔T（分别选T&gt;或&lt;1/2fc），从x(t)获得相应的x(n)；
T=[1/(2*fc+1),1/fc,1/(4*fc)];
N=zeros(1,length(T));
for i=1:length(T)
    N(i)=1/T(i);
end
x1=signal_xt(t_length,T(1),f,A,u);
x2=signal_xt(t_length,T(2),f,A,u);
x3=signal_xt(t_length,T(3),f,A,u);
</code></pre>
<p>选取频率分别为2fc+1、fc、4fc</p>
<h5 id="3-对获得的不同x-n-分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）"><a href="#3-对获得的不同x-n-分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）" class="headerlink" title="3.对获得的不同x(n)分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）"></a>3.对获得的不同x(n)分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）</h5><pre><code>%%  对获得的不同x(n)分别作傅立叶变换，分析其频率响应特性（给出幅频与相频特性曲线）；
X1=fft(x1,N(1));
X2=fft(x2,N(2));
X3=fft(x3,N(3));

%   绘制
figure;
%   幅值绘制
subplot(2,3,1);
stem(0:N(1)-1,abs(X1),&#39;.&#39;);
title(&quot;X1&quot;);
grid on

subplot(2,3,2);
stem(0:N(2)-1,abs(X2),&#39;.&#39;);
title(&quot;X2&quot;);
grid on

subplot(2,3,3);
stem(0:N(3)-1,abs(X3),&#39;.&#39;);
title(&quot;X3&quot;);
grid on

%   相位绘制
subplot(2,3,4);
stem(0:N(1)-1,angle(X1),&#39;.&#39;);
title(&quot;X1&quot;);
grid on

subplot(2,3,5);
stem(0:N(2)-1,angle(X2),&#39;.&#39;);
title(&quot;X2&quot;);
grid on

subplot(2,3,6);
stem(0:N(3)-1,angle(X3),&#39;.&#39;);
title(&quot;X3&quot;);
grid on
</code></pre>
<p>使用 fft 函数进行 DFT，注意结果频率响应是复数，使用abs函数得其幅值，angle函数得其相位。</p>
<h5 id="4-利用巴特沃思滤波器设计数字滤波器"><a href="#4-利用巴特沃思滤波器设计数字滤波器" class="headerlink" title="4.利用巴特沃思滤波器设计数字滤波器"></a>4.利用巴特沃思滤波器设计数字滤波器</h5><h6 id="低通滤波器"><a href="#低通滤波器" class="headerlink" title="&lt;1&gt;低通滤波器"></a>&lt;1&gt;低通滤波器</h6><pre><code>%   设置低通滤波器参数
wp=0.35;    %通带边界频率
ws=0.7;     %阻带截止频率
Rp=3;
As=15;
%   计算滤波器阶数N和3dB截止频率wc
[Nc,wc]=buttord(wp,ws,Rp,As,&#39;s&#39;);
%   计算滤波器系统函数分子分母多项式系数
[Bz,Az]=butter(Nc,wc,&#39;low&#39;);
wk=64;
Hk=freqz(Bz,Az,wk);
</code></pre>
<p>参数设置及函数使用参考课本《数字信号处理》</p>
<h6 id="高通滤波器"><a href="#高通滤波器" class="headerlink" title="&lt;2&gt;高通滤波器"></a>&lt;2&gt;高通滤波器</h6><pre><code>%   设置高通滤波器参数
wp=0.75;
ws=0.5;
rp=3;
rs=15;
[Nc,wc]=buttord(wp,ws,rp,rs,&#39;s&#39;);
[Bz,Az]=butter(Nc,wc,&#39;high&#39;);
wk=64; 
Hk=freqz(Bz,Az,wk);
</code></pre>
<h6 id="绘图"><a href="#绘图" class="headerlink" title="&lt;3&gt;绘图"></a>&lt;3&gt;绘图</h6><pre><code>%   绘图
figure;
subplot(2,3,1);
stem(0:1/63:1,abs(Hk),&#39;.&#39;);
xlabel(&#39;频率&#39;);
ylabel(&#39;滤波器幅度/dB&#39;);
grid on

%   滤波后结果
m1=filter(Bz,Az,x1);
m2=filter(Bz,Az,x2);
m3=filter(Bz,Az,x3);
Y1=fft(m1,N(1));
Y2=fft(m2,N(2));
Y3=fft(m3,N(3));
%   绘图
subplot(2,3,4);
stem(0:N(1)-1,abs(Y1),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
subplot(2,3,5);
stem(0:N(2)-1,abs(Y2),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
subplot(2,3,6);
stem(0:N(3)-1,abs(Y3),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
</code></pre>
<h5 id="5-利用窗函数设计法或频率采样法设计数字滤波器"><a href="#5-利用窗函数设计法或频率采样法设计数字滤波器" class="headerlink" title="5.利用窗函数设计法或频率采样法设计数字滤波器"></a>5.利用窗函数设计法或频率采样法设计数字滤波器</h5><h6 id="高通滤波器-1"><a href="#高通滤波器-1" class="headerlink" title="&lt;1&gt;高通滤波器"></a>&lt;1&gt;高通滤波器</h6><pre><code>%   设置高通滤波器参数
wp=pi/2;
ws=pi/4;
Bt=wp-ws;   %过渡带宽度
N0=ceil(6.2*pi/Bt); %汉宁窗计算所需h(n)长度N0
Nn=N0+mod(N0+1,2);  %确保h(n)长度为奇数
wc=(wp+ws)/2/pi;    %理想高通滤波器通带截止频率
hn=fir1(Nn-1,wc,&#39;HIGH&#39;,hanning(Nn));
%   高通滤波器频率响应
Hk=fft(hn,length(hn));
</code></pre>
<h6 id="低通滤波器-1"><a href="#低通滤波器-1" class="headerlink" title="&lt;2&gt;低通滤波器"></a>&lt;2&gt;低通滤波器</h6><pre><code>%   设置低通滤波器参数
wp=pi/4;
ws=pi/2;
Bt=abs(wp-ws);   %过渡带宽度
N0=ceil(6.2*pi/Bt); %汉宁窗计算所需h(n)长度N0
Nn=N0+mod(N0+1,2);  %确保h(n)长度为奇数
wc=(wp+ws)/2/pi;    %理想高通滤波器通带截止频率
hn=fir1(Nn-1,wc,&#39;LOW&#39;,hanning(Nn));
%   低通滤波器频率响应
Hk=fft(hn,length(hn));
</code></pre>
<h6 id="绘图-1"><a href="#绘图-1" class="headerlink" title="&lt;3&gt;绘图"></a>&lt;3&gt;绘图</h6><pre><code>%   滤波结果
y1=conv(hn,x1);
y2=conv(hn,x2);
y3=conv(hn,x3);
n1=length(y1);
n2=length(y2);
n3=length(y3);
Y1=fft(y1,n1);
Y2=fft(y2,n2);
Y3=fft(y3,n3);
%   绘图
figure;
subplot(2,3,1);
stem(0:Nn-1,hn,&#39;.&#39;);
xlabel(&#39;n&#39;);
ylabel(&#39;h(n)&#39;);
grid on
subplot(2,3,2);
stem(0:Nn-1,abs(Hk),&#39;.&#39;);
xlabel(&#39;k&#39;);
ylabel(&#39;H(k)&#39;);
grid on
subplot(2,3,4);
stem(0:n1-1,abs(Y1),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
subplot(2,3,5);
stem(0:n2-1,abs(Y2),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
subplot(2,3,6);
stem(0:n3-1,abs(Y3),&#39;.&#39;);
title(&#39;滤波后Y频率特性&#39;);
grid on
</code></pre>
<h2 id="三-实验结果"><a href="#三-实验结果" class="headerlink" title="三.实验结果"></a>三.实验结果</h2><p><img src="https://i-blog.csdnimg.cn/blog_migrate/e404226ec441727c6370000e1fe978b0.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4d098f58a0b1f335d62fc631ac9bf1b8.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/aaf3e4f6a8465e5e2a158ebfd1c1b9cf.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3fc4cd9d29dc56cd60409b4c12728d90.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c551894f0d504e9663311db49f1e796b.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d1539ef72b30697b76fb425b6b10928a.png"></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/134966834">https://blog.csdn.net/qq_32971095/article/details/134966834</a>，如有侵权，请联系删除。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="John Doe"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xidianswq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xidianswq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/3209507800@qq.com" title="E-Mail → 3209507800@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/qq_32971095" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_32971095" rel="noopener" target="_blank"><i class="fab fa-csdn fa-fw"></i>CSDN</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Sat Feb 08 2025 08:00:00 GMT+0800 (中国标准时间) – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SWQ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">698k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">10:35</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  















  

  

</body>
</html>
