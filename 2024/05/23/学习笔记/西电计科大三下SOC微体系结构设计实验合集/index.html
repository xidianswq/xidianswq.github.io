<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Zhi Mang Xing:300,300italic,400,400italic,700,700italic|Ma Shan Zheng:300,300italic,400,400italic,700,700italic|Source Code Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@200..900&family=Permanent+Marker&family=Satisfy&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Zhi+Mang+Xing&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xidianswq.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#e6c35c","save":"manual"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="目录">
<meta property="og:type" content="article">
<meta property="og:title" content="西电计科大三下SOC微体系结构设计实验合集">
<meta property="og:url" content="https://xidianswq.github.io/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="Switch">
<meta property="og:description" content="目录">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/fbc0bb7faf453566ef923063e4d002fb.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ce6fd932b35130aa5e27c5aed20ea4d1.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/c7d8f4a915fe5bd8c1ead81f14b23a98.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/80cc88d89b55bfa5281ac1e8bd0b69bc.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/d9b23c4e7c365f7e9bd09cd34b890dbe.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b8ebdee3a1727312ec82f82a48997c04.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/48f312e41997369070448630c369ef88.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b2b81a5e7b42395fba8c9fb656d835fd.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/a2c62b9b632c261aa03fc7767147d496.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/4c1acafbbcf9f2fcb9878c936a3f2244.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/311aeef9dede913202b7df632c3aa302.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/a99a9296939596a5890faf5f0a592e12.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/36a731b3be24e70c8626b6c8ffc27d7b.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ca1179f853bd18943bce21382adae2c2.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/36f7c7ddcdd765b4f80b09904c236f2c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/3579eeb2efc9ed74282411d3cc4a7c43.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/19d7c0eaa963aceabd7b7c37f2e266a9.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/bb48954106bbd0bf39a333bc9517b390.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/8445a0d3d348041fe6fd9b83e6bbab68.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/9b9e9bdcb11e643277242864ba0880d9.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/366b42fa88d3bab2b3d92539815238d9.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/43bde231cdd8555e9e66b22f437d9014.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b0f5ae5f7d65bf36add50df2465e24d2.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/450ff7787e4fbc15befc93420b279e3f.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/4ca7b953040d5420bd324dcceae3363c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/de38a24f3d908b663a479d455c4f613d.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/7c0424c57486f62ce1df707bbc1d0f14.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/3df769d2ac5eb7d9b1a2a850829c1e56.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/29292e122740addc20eb4a530ec67bd0.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ef02d5402b0594182dafe67debe07644.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/63008edd2b3325b6e6ef2c8e700998d8.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/direct/e135b733d411449797e2018f91c18b99.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/cfdc1dbc85d346b9c3541e7e13e4fd2f.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b870e7e63c2438527c9603091d047576.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/5bd3c1b7d51ed7ee02fd3b42b4c4ba89.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/0f9cfb770135c8cd06409fe765cdb265.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/595f539ee9983cb3ad064110256b9d3d.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/deb8630114a8896456e6eea801735970.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/08792675191fd507e190b166618ace0c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b48d14803e3b211bfb14f2d81f5dc40a.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/5399cba63467fb5d837fe1e49c0adb02.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/999503810dc63f0f906be47e3bbaca66.png">
<meta property="article:published_time" content="2024-05-23T03:46:02.000Z">
<meta property="article:modified_time" content="2025-02-09T06:23:46.100Z">
<meta property="article:author" content="SWQ">
<meta property="article:tag" content="fpga开发">
<meta property="article:tag" content="作业解答">
<meta property="article:tag" content="cpu">
<meta property="article:tag" content="vhdl">
<meta property="article:tag" content="soc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i-blog.csdnimg.cn/blog_migrate/fbc0bb7faf453566ef923063e4d002fb.png">

<link rel="canonical" href="https://xidianswq.github.io/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>西电计科大三下SOC微体系结构设计实验合集 | Switch</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/rss2.xml" title="Switch" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script>
    (function() {
      var storageKey = 'switch_homepage__access_granted';
      var docEl = document.documentElement;
      var guardEnabled = true;
      var configuredPassword = '';
      
        
        
          configuredPassword = 'siwuqiang';
        
      

      if (!guardEnabled || !configuredPassword) {
        docEl.classList.add('content-unlocked');
        window.__SITE_PASSWORD_GUARD__ = {
          storageKey: storageKey,
          enabled: false,
          password: ''
        };
        return;
      }

      try {
        if (window.localStorage && localStorage.getItem(storageKey) === '1') {
          docEl.classList.add('content-unlocked');
        } else {
          docEl.classList.add('content-locked');
        }
      } catch (err) {
        docEl.classList.add('content-locked');
      }
      window.__SITE_PASSWORD_GUARD__ = {
        storageKey: storageKey,
        enabled: true,
        password: configuredPassword
      };
    })();
  </script>
  <div id="password-protect" class="password-protect" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="password-modal">
      <h2 class="password-title"></h2>
      <p class="password-subtitle">Please Enter MY NAME</p>
      <label class="password-label" for="site-password-input">访问密码</label>
      <input id="site-password-input" class="password-input" type="password" autocomplete="current-password" placeholder="请输入密码" />
      <button id="site-password-submit" class="password-submit" type="button">确认</button>
      <p id="site-password-error" class="password-error" aria-live="assertive"></p>
    </div>
  </div>
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Switch</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to My Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">6</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">43</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">213</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xidianswq.github.io/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="SWQ">
      <meta itemprop="description" content="舟遥遥以轻扬，风飘飘而吹衣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Switch">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          西电计科大三下SOC微体系结构设计实验合集
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar" color=f6416c></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-05-23 11:46:02" itemprop="dateCreated datePublished" datetime="2024-05-23T11:46:02+08:00">2024-05-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          
            <span id="/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/" class="post-meta-item leancloud_visitors" data-flag-title="西电计科大三下SOC微体系结构设计实验合集" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/05/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%A5%BF%E7%94%B5%E8%AE%A1%E7%A7%91%E5%A4%A7%E4%B8%89%E4%B8%8BSOC%E5%BE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E9%AA%8C%E5%90%88%E9%9B%86/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>165k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2:30</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%BA%8C.%E7%BA%BF%E4%B8%8B%E5%AE%9E%E9%AA%8C">二.线下实验</a></p>
<p><a href="about:blank#%E7%AE%A1%E8%84%9A%E7%BB%91%E5%AE%9A%E6%A8%A1%E7%89%88">管脚绑定模版</a></p>
<p><a href="about:blank#%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9D%97%E6%A8%A1%E7%89%88">通用模块模版</a></p>
<p><a href="about:blank#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项</a></p>
<p><a href="about:blank#1.%E8%B7%91%E9%A9%AC%E7%81%AF%E6%8E%A7%E5%88%B6%E8%AE%BE%E8%AE%A1">1.跑马灯控制设计</a></p>
<p><a href="about:blank#2.8%20%E4%BD%8D%E5%B9%B6%E8%A1%8C%E5%85%A8%E5%8A%A0%E5%99%A8%E8%AE%BE%E8%AE%A1%2B%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">2.8
位并行全加器设计+数码管显示程序设计</a></p>
<p><a href="about:blank#3.%E9%98%B5%E5%88%97%E4%B9%98%E6%B3%95%E5%99%A8%E8%AE%BE%E8%AE%A1">3.阵列乘法器设计</a></p>
<p><a href="about:blank#4.%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%20FIFO%20%E7%9A%84%E8%AE%BE%E8%AE%A1">4.先进先出 FIFO
的设计</a></p>
<p><a href="about:blank#5.PC%20%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8%E8%AE%BE%E8%AE%A1">5.PC
程序计数器设计</a></p>
<p><a href="about:blank#6.%E7%A8%8B%E5%BA%8F%E5%AD%98%E5%82%A8%E5%99%A8%20ROM%20%E8%AE%BE%E8%AE%A1">6.程序存储器 ROM
设计</a></p>
<p><a href="about:blank#7.%E5%8A%A0%E5%87%8F%E4%BA%A4%E6%9B%BF%E9%99%A4%E6%B3%95%E5%99%A8">7.加减交替除法器</a></p>
<p><a href="about:blank#8.%E6%8C%87%E4%BB%A4%E5%AD%98%E5%82%A8%E5%99%A8%20IR%20%E8%AE%BE%E8%AE%A1">8.指令存储器 IR
设计</a></p>
<p><a href="about:blank#9.%E5%AF%84%E5%AD%98%E5%99%A8%20RN%20%E8%AE%BE%E8%AE%A1">9.寄存器 RN
设计</a></p>
<p><a href="about:blank#10.ALU%E7%AE%97%E6%9C%AF%E9%80%BB%E8%BE%91%E5%8D%95%E5%85%83%E8%AE%BE%E8%AE%A1">10.ALU算术逻辑单元设计</a></p>
<p><a href="about:blank#11.%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%99%A8%20RAM%20%E8%AE%BE%E8%AE%A1">11.数据存储器 RAM
设计</a></p>
<p><a href="about:blank#12.%E5%A0%86%E6%A0%88%E6%8C%87%E9%92%88%20SP%20%E8%AE%BE%E8%AE%A1">12.堆栈指针 SP
设计</a></p>
<p><a href="about:blank#13.%E9%87%87%E7%94%A8%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80%E8%AF%AD%E8%A8%80%E8%AE%BE%E8%AE%A1%20IO%20%E6%A8%A1%E5%9D%97">13.采用硬件描述语言语言设计 IO
模块</a></p>
<p><a href="about:blank#14.%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1">14.微控制器设计</a></p>
<p><a href="about:blank#15.8%20%E4%BD%8D%20SOC%20%E7%BB%BC%E5%90%88%E8%AE%BE%E8%AE%A1">15.8 位 SOC
综合设计</a></p>
<p><a href="about:blank#1.%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90">1.实验结果分析</a></p>
<p><a href="about:blank#%3C1%3E%E6%A8%A1%E5%9D%97%E5%B7%A5%E4%BD%9C%E9%A1%BA%E5%BA%8F%E5%88%86%E6%9E%90">&lt;1&gt;模块工作顺序分析</a></p>
<p><a href="about:blank#%3C2%3E%E2%80%8B%E2%80%8B%E2%80%8B%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90">&lt;2&gt;​​​指令执行过程分析</a></p>
<p><a href="about:blank#2.%E5%85%B6%E4%BB%96">2.其他</a></p>
<p><a href="about:blank#%3C1%3ESOC%E6%A8%A1%E5%9D%97%E9%9B%86%E6%88%90%E8%AE%BE%E8%AE%A1%E7%BB%8F%E9%AA%8C">&lt;1&gt;SOC模块集成设计经验</a></p>
<p><a href="about:blank#%3C2%3E%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8BSOC%E9%9B%86%E6%88%90%E5%85%B3%E9%94%AE">&lt;2&gt;SOC集成关键</a></p>
<hr>
<h2 id="二-线下实验"><a href="#二-线下实验" class="headerlink" title="二.线下实验"></a>二.线下实验</h2><h3 id="管脚绑定模版"><a href="#管脚绑定模版" class="headerlink" title="管脚绑定模版"></a>管脚绑定模版</h3><p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    #———————————————————————————-
    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]</p>
<pre><code>#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;a_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;a_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;a_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;a_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;a_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;a_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;a_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;a_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;a_in[7]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;b_in[7]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;b_in[0]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;b_in[1]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;b_in[2]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;b_in[3]&#125;]
set_property PACKAGE_PIN A13        [get_ports &#123;b_in[4]&#125;]
set_property PACKAGE_PIN A12        [get_ports &#123;b_in[5]&#125;]
set_property PACKAGE_PIN D8         [get_ports &#123;b_in[6]&#125;]
set_property PACKAGE_PIN D9         [get_ports &#123;b_in[7]&#125;]

#SW16~23
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;c_in[7]&#125;]
set_property PACKAGE_PIN F8         [get_ports &#123;c_in[0]&#125;]
set_property PACKAGE_PIN F9         [get_ports &#123;c_in[1]&#125;]
set_property PACKAGE_PIN H11        [get_ports &#123;c_in[2]&#125;]
set_property PACKAGE_PIN H12        [get_ports &#123;c_in[3]&#125;]
set_property PACKAGE_PIN G14        [get_ports &#123;c_in[4]&#125;]
set_property PACKAGE_PIN J10        [get_ports &#123;c_in[5]&#125;]
set_property PACKAGE_PIN H14        [get_ports &#123;c_in[6]&#125;]
set_property PACKAGE_PIN J11        [get_ports &#123;c_in[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports key_in]
set_property IOSTANDARD LVCMOS18    [get_ports key_in]
set_property PACKAGE_PIN H9         [get_ports wr]
set_property IOSTANDARD LVCMOS18    [get_ports wr]
set_property PACKAGE_PIN H8         [get_ports rd]
set_property IOSTANDARD LVCMOS18    [get_ports rd]
set_property PACKAGE_PIN G10        [get_ports a]
set_property IOSTANDARD LVCMOS18    [get_ports a]
set_property PACKAGE_PIN G9         [get_ports b]
set_property IOSTANDARD LVCMOS18    [get_ports b]
set_property PACKAGE_PIN J13        [get_ports c]
set_property IOSTANDARD LVCMOS18    [get_ports c]
set_property PACKAGE_PIN H13        [get_ports d]
set_property IOSTANDARD LVCMOS18    [get_ports d]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

#led15
set_property PACKAGE_PIN L20        [get_ports empty]
set_property IOSTANDARD LVCMOS33    [get_ports empty]
#led11
set_property PACKAGE_PIN J20        [get_ports full]
set_property IOSTANDARD LVCMOS33    [get_ports full]
</code></pre>
<h3 id="通用模块模版"><a href="#通用模块模版" class="headerlink" title="通用模块模版"></a>通用模块模版</h3><p>时钟分频：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity clk_div is
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end clk_div;

architecture Behavioral of clk_div is

begin

process(rst,clk_in)
variable count:integer:=0;
begin
    if(rst=&#39;1&#39;)then count:=0; 
    elsif(clk_in=&#39;1&#39;and clk_in&#39;event)then 
        count:=count+1;
        if(count&lt;=DIV_NUM/2)then
            clk_out&lt;=&#39;1&#39;;
        elsif(count&gt;DIV_NUM/2 and count&lt;DIV_NUM)then
            clk_out&lt;=&#39;0&#39;;
        elsif(count&gt;=DIV_NUM)then
            count:=0;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>按键消抖：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity key_stroke is
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end key_stroke;

architecture Behavioral of key_stroke is

type states is(s0,s1,s2,s3);
signal state:states;

begin

process(reset,clk,key_in)
variable count_num:integer:=3*CLK_FRE/1000;--delay 3ms
variable count:integer:=0;
    begin
        if reset=&#39;0&#39;then
            state&lt;=s0;
            count:=0;
            output&lt;=&#39;0&#39;;
        elsif(clk=&#39;1&#39;and clk&#39;event)then
            case state is
                when s0=&gt;if(key_in=&#39;1&#39;)then count:=0;output&lt;=&#39;0&#39;;state&lt;=s1;end if;
                when s1=&gt;
                    count:=count+1;
                    if (count&gt;=count_num) then state&lt;=s2; end if;
                when s2=&gt;
                    if(key_in=&#39;1&#39;)then output&lt;=&#39;1&#39;;state&lt;=s3;
                    --if(key_in=&#39;1&#39;)then output&lt;=&#39;1&#39;;state&lt;=s0;--one clk cycle
                    elsif(key_in=&#39;0&#39;)then state&lt;=s0;
                    end if;
                when s3=&gt;if(key_in=&#39;0&#39;)then state&lt;=s0;end if;                                                                   
            end case;               
        end if;     
end process;

end Behavioral;
</code></pre>
<p> 数码管显示：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity seg_dis is
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );

end seg_dis;

architecture Behavioral of seg_dis is

signal data_in_line: std_logic_vector(3 downto 0);

type states is(s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15);
signal state,next_state:states;

begin   

process(rst,clk)
begin 
    if(rst=&#39;1&#39;)then state&lt;=s0;
    elsif(clk=&#39;1&#39;and clk&#39;event)then 
        state&lt;=next_state;
    end if;
end process;
</code></pre>
<p>​<br>    process(state)
    begin
        case state is
        when s0 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000000001”;   data_in_line&lt;&#x3D;data_in_A(3 downto 0);   next_state&lt;&#x3D;s1;
        when s1 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000000010”;   data_in_line&lt;&#x3D;data_in_A(7 downto 4);   next_state&lt;&#x3D;s2;
        when s2 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000000100”;   data_in_line&lt;&#x3D;data_in_A(11 downto 8);  next_state&lt;&#x3D;s3;
        when s3 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000001000”;   data_in_line&lt;&#x3D;data_in_A(15 downto 12); next_state&lt;&#x3D;s4;<br>        when s4 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000010000”;   data_in_line&lt;&#x3D;data_in_B(3 downto 0);   next_state&lt;&#x3D;s5;
        when s5 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000000100000”;   data_in_line&lt;&#x3D;data_in_B(7 downto 4);   next_state&lt;&#x3D;s6;
        when s6 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000001000000”;   data_in_line&lt;&#x3D;data_in_B(11 downto 8);  next_state&lt;&#x3D;s7;
        when s7 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000010000000”;   data_in_line&lt;&#x3D;data_in_B(15 downto 12); next_state&lt;&#x3D;s8;<br>        when s8 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000000100000000”;   data_in_line&lt;&#x3D;data_in_C(3 downto 0);   next_state&lt;&#x3D;s9;
        when s9 &#x3D;&gt;  seg_dig&lt;&#x3D;not”0000001000000000”;   data_in_line&lt;&#x3D;data_in_C(7 downto 4);   next_state&lt;&#x3D;s10;
        when s10&#x3D;&gt;  seg_dig&lt;&#x3D;not”0000010000000000”;   data_in_line&lt;&#x3D;data_in_C(11 downto 8);  next_state&lt;&#x3D;s11;
        when s11&#x3D;&gt;  seg_dig&lt;&#x3D;not”0000100000000000”;   data_in_line&lt;&#x3D;data_in_C(15 downto 12); next_state&lt;&#x3D;s12;
        when s12&#x3D;&gt;  seg_dig&lt;&#x3D;not”0001000000000000”;   data_in_line&lt;&#x3D;data_in_D(3 downto 0);   next_state&lt;&#x3D;s13;
        when s13&#x3D;&gt;  seg_dig&lt;&#x3D;not”0010000000000000”;   data_in_line&lt;&#x3D;data_in_D(7 downto 4);   next_state&lt;&#x3D;s14;
        when s14&#x3D;&gt;  seg_dig&lt;&#x3D;not”0100000000000000”;   data_in_line&lt;&#x3D;data_in_D(11 downto 8);  next_state&lt;&#x3D;s15;
        when s15&#x3D;&gt;  seg_dig&lt;&#x3D;not”1000000000000000”;   data_in_line&lt;&#x3D;data_in_D(15 downto 12); next_state&lt;&#x3D;s0;
        when others&#x3D;&gt;next_state&lt;&#x3D;s0;
        end case;
    end process;</p>
<pre><code>process(data_in_line)
begin
    case data_in_line is
        when &quot;0000&quot;=&gt;seg_data&lt;=not&quot;00111111&quot;;
        when &quot;0001&quot;=&gt;seg_data&lt;=not&quot;00000110&quot;;
        when &quot;0010&quot;=&gt;seg_data&lt;=not&quot;01011011&quot;;
        when &quot;0011&quot;=&gt;seg_data&lt;=not&quot;01001111&quot;;
        when &quot;0100&quot;=&gt;seg_data&lt;=not&quot;01100110&quot;;
        when &quot;0101&quot;=&gt;seg_data&lt;=not&quot;01101101&quot;;
        when &quot;0110&quot;=&gt;seg_data&lt;=not&quot;01111101&quot;;
        when &quot;0111&quot;=&gt;seg_data&lt;=not&quot;00000111&quot;;
        when &quot;1000&quot;=&gt;seg_data&lt;=not&quot;01111111&quot;;
        when &quot;1001&quot;=&gt;seg_data&lt;=not&quot;01101111&quot;;
        when &quot;1010&quot;=&gt;seg_data&lt;=not&quot;01110111&quot;;
        when &quot;1011&quot;=&gt;seg_data&lt;=not&quot;01111100&quot;;
        when &quot;1100&quot;=&gt;seg_data&lt;=not&quot;00111001&quot;;
        when &quot;1101&quot;=&gt;seg_data&lt;=not&quot;01011110&quot;;
        when &quot;1110&quot;=&gt;seg_data&lt;=not&quot;01111001&quot;;
        when &quot;1111&quot;=&gt;seg_data&lt;=not&quot;01110001&quot;;
        when others=&gt;seg_data&lt;=not&quot;11111111&quot;;
    end case;
end process;

end Behavioral;
</code></pre>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a><strong>注意事项</strong></h3><p>1.器件型号：xc7k160tfbg676-2</p>
<p>2.输入一般cmos18 输出cmos33</p>
<p>3.输入数码管的时钟需分频</p>
<p>4.按键加消抖</p>
<p>5.程序的运行结合.xdc文件进行理解</p>
<h3 id="1-跑马灯控制设计"><a href="#1-跑马灯控制设计" class="headerlink" title="1.跑马灯控制设计"></a>1.跑马灯控制设计</h3><pre><code>    功能叙述：初始情况下 Y0=‘1’，其它为‘0’。然后，在 en 为高电平的情况下，在时钟信 号 clk 的下降沿进行移位。当 dir=‘1’时，每来一个时钟信号，循环左移一位，当 dir=‘0’时， 每来一个时钟，循环右移一位。 另外，移位控制时钟可以选择为按键，即每按键一次相当于一个时钟信号，系统可以在 按键和系统分频时钟之间进行选择。
</code></pre>
<p>资源使用：</p>
<p>1）用 LED0~LED7 作为跑马灯输出显示，LED7 为高位，LED0 为低位；</p>
<p>2）SW0 为循环方向控制；</p>
<p>3）SW1 为工作允许 EN 控制端；</p>
<p>4）计数时钟频率为 1Hz，通过对 50Mhz 系统时钟分频得到；</p>
<p>5）扩展：可以由按键来控制循环（按键为 BTN_SOUTH），即每按一次 BTN_SOUTH, 则完成一次移位。通过 SW2 选择移位控制时钟沿。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/fbc0bb7faf453566ef923063e4d002fb.png"></p>
<p>源文件：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity run_led is
    Port(
        en,dir,sel,clk,con:in std_logic;
        y:out std_logic_vector(7 downto 0)
    );
end run_led;

architecture Behavioral of run_led is
signal input:std_logic;
signal clk_div:std_logic;
begin

process(clk)
variable clk_cnt:integer:=0;
variable clk_cnt_2:integer:=0;
begin 
    if(clk=&#39;1&#39;and clk&#39;event)then 
        clk_cnt_2:=clk_cnt_2+1;
        if(clk_cnt_2&gt;=10000)then 
        clk_cnt:=clk_cnt+1;
        clk_cnt_2:=0;
        end if;
        if(clk_cnt&lt;5000)then clk_div&lt;=&#39;1&#39;;
        elsif(clk_cnt&gt;=5000)then clk_div&lt;=&#39;0&#39;;
        end if;
        if(clk_cnt&gt;=10000)then clk_cnt:=0;
        end if; 
    end if;
end process;

process(clk,en,clk_div,con,sel)
    begin
        if(en=&#39;1&#39;)then
            if(sel=&#39;0&#39;)then input&lt;=clk_div;
            elsif(sel=&#39;1&#39;)then input&lt;=con;
            end if;
        elsif(en=&#39;0&#39;)then input&lt;=&#39;0&#39;;
        end if;
end process;

process(input,dir)
variable count:integer:=0;
begin
if(input=&#39;1&#39;and input&#39;event)then 
    if(dir=&#39;1&#39;)then
        count:=count+1;
        if(count&gt;7)then count:=0;end if;
    elsif(dir=&#39;0&#39;)then 
        count:=count-1;
        if(count&lt;0)then count:=7;end if;
    end if;  
        
    if(count=0)then y&lt;=&quot;00000001&quot;;
    elsif(count=1)then y&lt;=&quot;00000010&quot;;
    elsif(count=2)then y&lt;=&quot;00000100&quot;;
    elsif(count=3)then y&lt;=&quot;00001000&quot;;
    elsif(count=4)then y&lt;=&quot;00010000&quot;;
    elsif(count=5)then y&lt;=&quot;00100000&quot;;
    elsif(count=6)then y&lt;=&quot;01000000&quot;;
    elsif(count=7)then y&lt;=&quot;10000000&quot;;
    else y&lt;=&quot;11111111&quot;;
    end if;
    
end if;       
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<p>​<br>    entity run_led_tb is
    end run_led_tb;</p>
<pre><code>architecture Behavioral of run_led_tb is
component run_led
    Port(
        en,dir,sel,clk,con:in std_logic;
        y:out std_logic_vector(7 downto 0)
    );
end component;

SIGNAL en,dir,sel,clk,con: std_logic;
SIGNAL y: std_logic_vector(7 downto 0);

begin
run_led_inst:run_led port map(en=&gt;en,dir=&gt;dir,sel=&gt;sel,clk=&gt;clk,con=&gt;con,y=&gt;y); 

clock:process
begin 
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

key:process
begin 
    con&lt;=&#39;1&#39;;
    wait for 25ns;
    con&lt;=&#39;0&#39;;
    wait for 25ns;
end process;

test:process
begin
    en&lt;=&#39;0&#39;;
    sel&lt;=&#39;1&#39;;
    dir&lt;=&#39;1&#39;;
    wait for 25ns;
    en&lt;=&#39;1&#39;;
    wait;

end process;
</code></pre>
<p>​<br>    end Behavioral;</p>
<p>xdc:</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    #———————————————————————————-
    set_property PACKAGE_PIN C9 [get_ports dir]
    set_property PACKAGE_PIN AF12 [get_ports con]
    set_property PACKAGE_PIN B9 [get_ports en]
    set_property PACKAGE_PIN E10 [get_ports clk]
    set_property PACKAGE_PIN G11 [get_ports sel]
    set_property PACKAGE_PIN G16 [get_ports {y[0]}]
    set_property PACKAGE_PIN H16 [get_ports {y[1]}]
    set_property PACKAGE_PIN D16 [get_ports {y[2]}]
    set_property PACKAGE_PIN D15 [get_ports {y[3]}]
    set_property PACKAGE_PIN C18 [get_ports {y[4]}]
    set_property PACKAGE_PIN C17 [get_ports {y[5]}]
    set_property PACKAGE_PIN B19 [get_ports {y[6]}]
    set_property PACKAGE_PIN C19 [get_ports {y[7]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[4]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[5]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[0]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[6]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[1]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[7]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[2]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {y[3]}]</p>
<pre><code>set_property DRIVE 12 [get_ports &#123;y[4]&#125;]
set_property DRIVE 12 [get_ports &#123;y[5]&#125;]
set_property DRIVE 12 [get_ports &#123;y[0]&#125;]
set_property DRIVE 12 [get_ports &#123;y[6]&#125;]
set_property DRIVE 12 [get_ports &#123;y[1]&#125;]
set_property DRIVE 12 [get_ports &#123;y[7]&#125;]
set_property DRIVE 12 [get_ports &#123;y[2]&#125;]
set_property DRIVE 12 [get_ports &#123;y[3]&#125;]

set_property IOSTANDARD LVCMOS18 [get_ports dir]
set_property IOSTANDARD LVCMOS18 [get_ports con]
set_property IOSTANDARD LVCMOS18 [get_ports en]
set_property IOSTANDARD LVCMOS18 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports sel]
</code></pre>
<p>​<br>​    </p>
<h3 id="2-8-位并行全加器设计-数码管显示程序设计"><a href="#2-8-位并行全加器设计-数码管显示程序设计" class="headerlink" title="2.8 位并行全加器设计+数码管显示程序设计"></a>2.8 位并行全加器设计+数码管显示程序设计</h3><p><strong>注：数码管部分未使用优化代码</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ce6fd932b35130aa5e27c5aed20ea4d1.png"></p>
<pre><code>    其中 a_in，b_in：数据输入，使用板上开关（SW0~SW15）； sum_out：运算结果输出，使用 LED 显示运算结果。
</code></pre>
<p>（1）用硬件描述语言实现 16 个七段数码管扫描显示模块</p>
<pre><code>    七段数码管扫描显示模块电路如图所示，主要包括顶层的数码管扫描显示模块，以及输入数据向七段数码管进行译码的模块。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c7d8f4a915fe5bd8c1ead81f14b23a98.png"></p>
<pre><code>    该模块实现数码管扫描显示功能，扩展板上的 16 个数码管四个一组，分为 A，B，C，D 四组。模块管脚说明如下：clk 为系统的时钟输入，rst 信号为复位信号，data_in_A(15:0)为 A 组四个数码管的输入显示值，其中，data_in_A(3:0)对应于第一个数码管的输入显示值； data_in_A(7:4)对应第二个数码管的输入显示值；data_in_A(11:8）对应第三个数码管的输入显 示值；data_in_A(15:12)对应第四个数码管的输入显示值，其它各组与 A 组分配一致； data_in_B(15:0)为 B 组四个数码管的输入显示值；data_in_C(15:0)为 C 组四个数码管的输入显 示值；data_in_D(15:0)为 D 组四个数码管的输入显示值；seg_sel(3:0)为数码管选择编码输出 信号，seg_data(7:0)为数码管显示数据输出。 
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/80cc88d89b55bfa5281ac1e8bd0b69bc.png"></p>
<pre><code>    该模块实现将输入的 4 为二进制数转换为数码管显示的数据；其中，data_in(3:0)为输入 值，seg_data(7:0)为数码管编码的输出值。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;
    entity adder is
        Port (
            clk,rst:in std_logic;
            a,b:in std_logic_vector(7 downto 0);
            c:in std_logic;</p>
<pre><code>        c_out:out std_logic;
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
     );
end adder;

architecture Behavioral of adder is

component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;
component decoder4_16
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end component;

signal clk_out_line:std_logic;
signal sum_line:std_logic_vector(16 downto 0);
signal data_line:std_logic_vector(15 downto 0);
signal c_line:std_logic;
signal sel_out_line:std_logic_vector(3 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(clk,clk_out_line);
seg_dis_inst:seg_dis port map(rst,clk_out_line,data_line,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,sel_out_line,seg_data);
decoder4_16_inst:decoder4_16 port map(sel_out_line,sel_out);

process(a,b,c)
begin  
    sum_line&lt;=(&quot;00000000&quot;&amp;a)+(&quot;00000000&quot;&amp;b)+(&quot;0000000000000000&quot;&amp;c);
    data_line&lt;=sum_line(15 downto 0);
    c_out&lt;=sum_line(16);
end process;
</code></pre>
<p>​<br>    end Behavioral;</p>
<p>模块：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity decoder4_16 is
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end decoder4_16;

architecture Behavioral of decoder4_16 is

begin

process(sel_in)
begin
    case sel_in is
    when &quot;0000&quot;=&gt;sel_out&lt;=not&quot;0000000000000001&quot;;
    when &quot;0001&quot;=&gt;sel_out&lt;=not&quot;0000000000000010&quot;;
    when &quot;0010&quot;=&gt;sel_out&lt;=not&quot;0000000000000100&quot;;
    when &quot;0011&quot;=&gt;sel_out&lt;=not&quot;0000000000001000&quot;;
    when &quot;0100&quot;=&gt;sel_out&lt;=not&quot;0000000000010000&quot;;
    when &quot;0101&quot;=&gt;sel_out&lt;=not&quot;0000000000100000&quot;;
    when &quot;0110&quot;=&gt;sel_out&lt;=not&quot;0000000001000000&quot;;
    when &quot;0111&quot;=&gt;sel_out&lt;=not&quot;0000000010000000&quot;;
    when &quot;1000&quot;=&gt;sel_out&lt;=not&quot;0000000100000000&quot;;
    when &quot;1001&quot;=&gt;sel_out&lt;=not&quot;0000001000000000&quot;;
    when &quot;1010&quot;=&gt;sel_out&lt;=not&quot;0000010000000000&quot;;
    when &quot;1011&quot;=&gt;sel_out&lt;=not&quot;0000100000000000&quot;;
    when &quot;1100&quot;=&gt;sel_out&lt;=not&quot;0001000000000000&quot;;
    when &quot;1101&quot;=&gt;sel_out&lt;=not&quot;0010000000000000&quot;;
    when &quot;1110&quot;=&gt;sel_out&lt;=not&quot;0100000000000000&quot;;
    when &quot;1111&quot;=&gt;sel_out&lt;=not&quot;1000000000000000&quot;;
    when others=&gt;sel_out&lt;=not&quot;1111111111111111&quot;;
    end case;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity seg_dis is
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );

end seg_dis;

architecture Behavioral of seg_dis is
component data2seg
    port(
        data_in:in std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;

signal data_in_line: std_logic_vector(3 downto 0);

type states is(s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15);
signal state,next_state:states;

begin   

data2seg_inst:data2seg port map(data_in_line,seg_data);

process(rst,clk)
begin 
    if(rst=&#39;1&#39;)then state&lt;=s0;
    elsif(clk=&#39;1&#39;and clk&#39;event)then
        state&lt;=next_state;
    end if;
end process;
</code></pre>
<p>​<br>    process(state)
    begin
        case state is
        when s0&#x3D;&gt;
            seg_sel&lt;&#x3D;”0000”;
            data_in_line&lt;&#x3D;data_in_A(3 downto 0);
            next_state&lt;&#x3D;s1;
        when s1&#x3D;&gt;
            seg_sel&lt;&#x3D;”0001”;
            data_in_line&lt;&#x3D;data_in_A(7 downto 4);
            next_state&lt;&#x3D;s2;
        when s2&#x3D;&gt;
            seg_sel&lt;&#x3D;”0010”;
            data_in_line&lt;&#x3D;data_in_A(11 downto 8);
            next_state&lt;&#x3D;s3;
        when s3&#x3D;&gt;
            seg_sel&lt;&#x3D;”0011”;
            data_in_line&lt;&#x3D;data_in_A(15 downto 12);
            next_state&lt;&#x3D;s4;</p>
<pre><code>    when s4=&gt;seg_sel&lt;=&quot;0100&quot;;data_in_line&lt;=data_in_B(3 downto 0);next_state&lt;=s5;
    when s5=&gt;seg_sel&lt;=&quot;0101&quot;;data_in_line&lt;=data_in_B(7 downto 4);next_state&lt;=s6;
    when s6=&gt;seg_sel&lt;=&quot;0110&quot;;data_in_line&lt;=data_in_B(11 downto 8);next_state&lt;=s7;
    when s7=&gt;seg_sel&lt;=&quot;0111&quot;;data_in_line&lt;=data_in_B(15 downto 12);next_state&lt;=s8;
    
    when s8=&gt;seg_sel&lt;=&quot;1000&quot;;data_in_line&lt;=data_in_C(3 downto 0);next_state&lt;=s9;
    when s9=&gt;seg_sel&lt;=&quot;1001&quot;;data_in_line&lt;=data_in_C(7 downto 4);next_state&lt;=s10;
    when s10=&gt;seg_sel&lt;=&quot;1010&quot;;data_in_line&lt;=data_in_C(11 downto 8);next_state&lt;=s11;
    when s11=&gt;seg_sel&lt;=&quot;1011&quot;;data_in_line&lt;=data_in_C(15 downto 12);next_state&lt;=s12;
    
    when s12=&gt;seg_sel&lt;=&quot;1100&quot;;data_in_line&lt;=data_in_D(3 downto 0);next_state&lt;=s13;
    when s13=&gt;seg_sel&lt;=&quot;1101&quot;;data_in_line&lt;=data_in_D(7 downto 4);next_state&lt;=s14;
    when s14=&gt;seg_sel&lt;=&quot;1110&quot;;data_in_line&lt;=data_in_D(11 downto 8);next_state&lt;=s15;
    when s15=&gt;seg_sel&lt;=&quot;1111&quot;;data_in_line&lt;=data_in_D(15 downto 12);next_state&lt;=s0;
    
    when others=&gt;state&lt;=next_state;
    end case;
end process;

end Behavioral;
</code></pre>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity data2seg is
    port(
        data_in:in std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );

end data2seg;

architecture Behavioral of data2seg is
begin 
process(data_in)
begin
    case data_in is
        when &quot;0000&quot;=&gt;seg_data&lt;=not&quot;00111111&quot;;
        when &quot;0001&quot;=&gt;seg_data&lt;=not&quot;00000110&quot;;
        when &quot;0010&quot;=&gt;seg_data&lt;=not&quot;01011011&quot;;
        when &quot;0011&quot;=&gt;seg_data&lt;=not&quot;01001111&quot;;
        when &quot;0100&quot;=&gt;seg_data&lt;=not&quot;01100110&quot;;
        when &quot;0101&quot;=&gt;seg_data&lt;=not&quot;00110111&quot;;
        when &quot;0110&quot;=&gt;seg_data&lt;=not&quot;01111101&quot;;
        when &quot;0111&quot;=&gt;seg_data&lt;=not&quot;00000111&quot;;
        when &quot;1000&quot;=&gt;seg_data&lt;=not&quot;01111111&quot;;
        when &quot;1001&quot;=&gt;seg_data&lt;=not&quot;01101111&quot;;
        when &quot;1010&quot;=&gt;seg_data&lt;=not&quot;01110111&quot;;
        when &quot;1011&quot;=&gt;seg_data&lt;=not&quot;01111100&quot;;
        when &quot;1100&quot;=&gt;seg_data&lt;=not&quot;00111000&quot;;
        when &quot;1101&quot;=&gt;seg_data&lt;=not&quot;01011110&quot;;
        when &quot;1110&quot;=&gt;seg_data&lt;=not&quot;01111001&quot;;
        when &quot;1111&quot;=&gt;seg_data&lt;=not&quot;01110001&quot;;
        when others=&gt;seg_data&lt;=not&quot;11111111&quot;;
    end case;
        
end process;
end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity adder_tb is
--  Port ( );
end adder_tb;

architecture Behavioral of adder_tb is
component adder
    Port (
        clk,rst:in std_logic;
        a,b:in std_logic_vector(7 downto 0);
        c:in std_logic;
        c_out:out std_logic;
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
     );
end component;
signal clk,rst :std_logic;
signal a,b     :std_logic_vector(7 downto 0);
signal c       :std_logic;
signal c_out   : std_logic;
signal sel_out : std_logic_vector(15 downto 0);
signal seg_data: std_logic_vector(7 downto 0);

begin
adder_inst:adder port map(clk,rst,a,b,c,c_out,sel_out,seg_data);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

restart:process
begin
    rst&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait;
end process;

test:process
begin
    a&lt;=&quot;00100010&quot;;
    b&lt;=&quot;01000100&quot;;
    c&lt;=&#39;1&#39;;
    wait for 100ns;
    
    a&lt;=&quot;11111111&quot;;
    b&lt;=&quot;11111111&quot;;
    c&lt;=&#39;1&#39;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<p>​<br>    set_property PACKAGE_PIN E26 [get_ports {seg_data[7]}]
    set_property PACKAGE_PIN J26 [get_ports {seg_data[6]}]
    set_property PACKAGE_PIN H26 [get_ports {seg_data[5]}]
    set_property PACKAGE_PIN H21 [get_ports {seg_data[4]}]
    set_property PACKAGE_PIN G21 [get_ports {seg_data[3]}]
    set_property PACKAGE_PIN H23 [get_ports {seg_data[2]}]
    set_property PACKAGE_PIN H24 [get_ports {seg_data[1]}]
    set_property PACKAGE_PIN J21 [get_ports {seg_data[0]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[7]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[6]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[5]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[4]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[3]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[2]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[1]}]
    set_property IOSTANDARD LVCMOS33 [get_ports {seg_data[0]}]</p>
<pre><code>set_property PACKAGE_PIN E10 [get_ports clk]
set_property PACKAGE_PIN C9 [get_ports &#123;a[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;a[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;a[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;a[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;a[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;a[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;a[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;a[7]&#125;]

set_property PACKAGE_PIN B10 [get_ports &#123;b[0]&#125;]
set_property PACKAGE_PIN A10 [get_ports &#123;b[1]&#125;]
set_property PACKAGE_PIN B15 [get_ports &#123;b[2]&#125;]
set_property PACKAGE_PIN A15 [get_ports &#123;b[3]&#125;]
set_property PACKAGE_PIN A13 [get_ports &#123;b[4]&#125;]
set_property PACKAGE_PIN A12 [get_ports &#123;b[5]&#125;]
set_property PACKAGE_PIN D8 [get_ports &#123;b[6]&#125;]
set_property PACKAGE_PIN D9 [get_ports &#123;b[7]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b[7]&#125;]

set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a[7]&#125;]
</code></pre>
<p>​<br>    set_property IOSTANDARD LVCMOS18 [get_ports clk]
    set_property IOSTANDARD LVCMOS18 [get_ports rst]
    set_property IOSTANDARD LVCMOS33 [get_ports c_out]
    set_property IOSTANDARD LVCMOS18 [get_ports c]</p>
<pre><code>set_property PACKAGE_PIN J14 [get_ports c]
set_property PACKAGE_PIN G16 [get_ports c_out]
set_property PACKAGE_PIN J8 [get_ports rst]

#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[0]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[1]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[2]&#125;]
#set_property IOSTANDARD LVCMOS18 [get_ports &#123;sel_in[3]&#125;]

#set_property PACKAGE_PIN F8 [get_ports &#123;sel_in[0]&#125;]
#set_property PACKAGE_PIN F9 [get_ports &#123;sel_in[1]&#125;]
#set_property PACKAGE_PIN H11 [get_ports &#123;sel_in[2]&#125;]
#set_property PACKAGE_PIN H12 [get_ports &#123;sel_in[3]&#125;]

set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[10]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[15]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[12]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[13]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[8]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[11]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[14]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;sel_out[9]&#125;]
set_property PACKAGE_PIN A23 [get_ports &#123;sel_out[15]&#125;]
set_property PACKAGE_PIN A24 [get_ports &#123;sel_out[14]&#125;]
set_property PACKAGE_PIN D26 [get_ports &#123;sel_out[13]&#125;]
set_property PACKAGE_PIN C26 [get_ports &#123;sel_out[12]&#125;]
set_property PACKAGE_PIN A20 [get_ports &#123;sel_out[11]&#125;]
set_property PACKAGE_PIN J25 [get_ports &#123;sel_out[10]&#125;]
set_property PACKAGE_PIN J24 [get_ports &#123;sel_out[9]&#125;]
set_property PACKAGE_PIN H22 [get_ports &#123;sel_out[8]&#125;]
set_property PACKAGE_PIN K21 [get_ports &#123;sel_out[7]&#125;]
set_property PACKAGE_PIN L23 [get_ports &#123;sel_out[6]&#125;]
set_property PACKAGE_PIN B25 [get_ports &#123;sel_out[5]&#125;]
set_property PACKAGE_PIN B26 [get_ports &#123;sel_out[4]&#125;]
set_property PACKAGE_PIN C24 [get_ports &#123;sel_out[3]&#125;]
set_property PACKAGE_PIN D21 [get_ports &#123;sel_out[2]&#125;]
set_property PACKAGE_PIN C22 [get_ports &#123;sel_out[1]&#125;]
set_property PACKAGE_PIN B20 [get_ports &#123;sel_out[0]&#125;]
</code></pre>
<h3 id="3-阵列乘法器设计"><a href="#3-阵列乘法器设计" class="headerlink" title="3.阵列乘法器设计"></a>3.阵列乘法器设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/d9b23c4e7c365f7e9bd09cd34b890dbe.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b8ebdee3a1727312ec82f82a48997c04.png"></p>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier_seg is
    Port (
        rst,clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end array_multiplier_seg;

architecture Behavioral of array_multiplier_seg is

component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component array_multiplier
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        seg_sel:out std_logic_vector(3 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;
component decoder4_16
    Port (
        sel_in:in std_logic_vector(3 downto 0);
        sel_out:out std_logic_vector(15 downto 0)
     );
end component;

signal clk_out_line:std_logic;
signal sum_out_line:std_logic_vector(15 downto 0);
signal seg_dig_line:std_logic_vector(3 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(clk,clk_out_line);
array_multiplier_inst:array_multiplier port map(clk_out_line,a_in,b_in,sum_out_line);
seg_dis_inst:seg_dis port map(rst,clk_out_line,sum_out_line,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,&quot;0000000000000000&quot;,seg_dig_line,seg_data);
decoder4_16_inst:decoder4_16 port map(seg_dig_line,seg_dig);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/48f312e41997369070448630c369ef88.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier is
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end array_multiplier;

architecture Behavioral of array_multiplier is
component array_multiplier_top
    Port (
        a_in:in std_logic;
        b_in:in std_logic_vector(7 downto 0);
        s:out std_logic_vector(7 downto 0)
     );
end component;
component array_multiplier_unit
    Port (
        x_in:in std_logic;
        y_in:in std_logic_vector(7 downto 0);
        c_in:in std_logic_vector(6 downto 0);
        z_in:in std_logic_vector(7 downto 0);
        c_out:out std_logic_vector(6 downto 0);
        z_out:out std_logic_vector(7 downto 0)
     );
end component;
component array_multiplier_low
    Port (
        z_in,c_in:in std_logic_vector(6 downto 0);
        s_out:out std_logic_vector(7 downto 0)
     );
end component;

signal z_in0:std_logic_vector(7 downto 0);
signal z_in1:std_logic_vector(7 downto 0);
signal z_in2:std_logic_vector(7 downto 0);
signal z_in3:std_logic_vector(7 downto 0);
signal z_in4:std_logic_vector(7 downto 0);
signal z_in5:std_logic_vector(7 downto 0);
signal z_in6:std_logic_vector(7 downto 0);
signal z_in7:std_logic_vector(7 downto 0);
signal c_in1:std_logic_vector(6 downto 0);
signal c_in2:std_logic_vector(6 downto 0);
signal c_in3:std_logic_vector(6 downto 0);
signal c_in4:std_logic_vector(6 downto 0);
signal c_in5:std_logic_vector(6 downto 0);
signal c_in6:std_logic_vector(6 downto 0);
signal c_in7:std_logic_vector(6 downto 0);

begin

array_multiplier_top_inst:array_multiplier_top port map(a_in(0),b_in,z_in0);
array_multiplier_unit_inst1:array_multiplier_unit port map(a_in(1),b_in,&quot;0000000&quot;,z_in0,c_in1,z_in1);
array_multiplier_unit_inst2:array_multiplier_unit port map(a_in(2),b_in,c_in1,z_in1,c_in2,z_in2);
array_multiplier_unit_inst3:array_multiplier_unit port map(a_in(3),b_in,c_in2,z_in2,c_in3,z_in3);
array_multiplier_unit_inst4:array_multiplier_unit port map(a_in(4),b_in,c_in3,z_in3,c_in4,z_in4);
array_multiplier_unit_inst5:array_multiplier_unit port map(a_in(5),b_in,c_in4,z_in4,c_in5,z_in5);
array_multiplier_unit_inst6:array_multiplier_unit port map(a_in(6),b_in,c_in5,z_in5,c_in6,z_in6);
array_multiplier_unit_inst7:array_multiplier_unit port map(a_in(7),b_in,c_in6,z_in6,c_in7,z_in7);
array_multiplier_low_inst:array_multiplier_low port map(z_in7(7 downto 1),c_in7,sum_out(15 downto 8));

process(clk,a_in,b_in)
begin
    sum_out(0)&lt;=z_in0(0);
    sum_out(1)&lt;=z_in1(0);
    sum_out(2)&lt;=z_in2(0);
    sum_out(3)&lt;=z_in3(0);
    sum_out(4)&lt;=z_in4(0);
    sum_out(5)&lt;=z_in5(0);
    sum_out(6)&lt;=z_in6(0);
    sum_out(7)&lt;=z_in7(0);
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b2b81a5e7b42395fba8c9fb656d835fd.png"></p>
<p>模块：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier_top is
    Port (
        a_in:in std_logic;
        b_in:in std_logic_vector(7 downto 0);
        s:out std_logic_vector(7 downto 0)
     );
end array_multiplier_top;

architecture Behavioral of array_multiplier_top is

begin

process(a_in,b_in)
begin
    for i in 0 to 7 loop
       s(i)&lt;=a_in and b_in(i); 
    end loop;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier_unit is
    Port (
        x_in:in std_logic;
        y_in:in std_logic_vector(7 downto 0);
        c_in:in std_logic_vector(6 downto 0);
        z_in:in std_logic_vector(7 downto 0);
        c_out:out std_logic_vector(6 downto 0);
        z_out:out std_logic_vector(7 downto 0)
     );
end array_multiplier_unit;

architecture Behavioral of array_multiplier_unit is
component adder_1bit
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end component;

signal a_line:std_logic_vector(7 downto 0);

begin

adder_1bit_inst1:adder_1bit port map(a_line(0),c_in(0),z_in(1),z_out(0),c_out(0));
adder_1bit_inst2:adder_1bit port map(a_line(1),c_in(1),z_in(2),z_out(1),c_out(1));
adder_1bit_inst3:adder_1bit port map(a_line(2),c_in(2),z_in(3),z_out(2),c_out(2));
adder_1bit_inst4:adder_1bit port map(a_line(3),c_in(3),z_in(4),z_out(3),c_out(3));
adder_1bit_inst5:adder_1bit port map(a_line(4),c_in(4),z_in(5),z_out(4),c_out(4));
adder_1bit_inst6:adder_1bit port map(a_line(5),c_in(5),z_in(6),z_out(5),c_out(5));
adder_1bit_inst7:adder_1bit port map(a_line(6),c_in(6),z_in(7),z_out(6),c_out(6));

process(x_in,y_in)
begin 
    z_out(7)&lt;=x_in and y_in(7);
    for i in 0 to 7 loop
       a_line(i)&lt;=x_in and y_in(i);
    end loop;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a2c62b9b632c261aa03fc7767147d496.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier_low is
    Port (
        z_in,c_in:in std_logic_vector(6 downto 0);
        s_out:out std_logic_vector(7 downto 0)
     );
end array_multiplier_low;

architecture Behavioral of array_multiplier_low is
component adder_1bit
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end component;

signal c_line:std_logic_vector(5 downto 0);

begin

adder_1bit_inst0:adder_1bit port map(z_in(0),c_in(0),&#39;0&#39;,s_out(0),c_line(0));
adder_1bit_inst1:adder_1bit port map(z_in(1),c_in(1),c_line(0),s_out(1),c_line(1));
adder_1bit_inst2:adder_1bit port map(z_in(2),c_in(2),c_line(1),s_out(2),c_line(2));
adder_1bit_inst3:adder_1bit port map(z_in(3),c_in(3),c_line(2),s_out(3),c_line(3));
adder_1bit_inst4:adder_1bit port map(z_in(4),c_in(4),c_line(3),s_out(4),c_line(4));
adder_1bit_inst5:adder_1bit port map(z_in(5),c_in(5),c_line(4),s_out(5),c_line(5));
adder_1bit_inst6:adder_1bit port map(z_in(6),c_in(6),c_line(5),s_out(6),s_out(7));

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity adder_1bit is
    Port (
        a,b,c_in:in std_logic;
        s,c_out:out std_logic
     );
end adder_1bit;

architecture Behavioral of adder_1bit is

begin

process(a,b,c_in)
begin
    s&lt;=a xor b xor c_in;
    c_out&lt;=(a and b)or((a xor b)and c_in);
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity array_multiplier_tb is
--  Port ( );
end array_multiplier_tb;

architecture Behavioral of array_multiplier_tb is
component array_multiplier_seg
    Port (
        rst,clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)
    );
end component;

signal rst,clk:std_logic;
signal a_in,b_in:std_logic_vector(7 downto 0);
signal seg_dig:std_logic_vector(15 downto 0);
signal seg_data:std_logic_vector(7 downto 0);
</code></pre>
<p>​<br>    begin</p>
<pre><code>array_multiplier_seg_inst:array_multiplier_seg port map(rst,clk,a_in,b_in,seg_dig,seg_data);

clock:process
begin 
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

restart:process
begin
    rst&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait;
end process;

test:process
begin
    a_in&lt;=&quot;10111101&quot;;
    b_in&lt;=&quot;11001010&quot;;
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4c1acafbbcf9f2fcb9878c936a3f2244.png"></p>
<p>xdc:</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    #———————————————————————————-
    #CLK_100M
    set_property PACKAGE_PIN E10 [get_ports clk]
    set_property IOSTANDARD LVCMOS18 [get_ports clk]</p>
<pre><code>#SW0~15
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;a_in[7]&#125;]
set_property PACKAGE_PIN C9 [get_ports &#123;a_in[0]&#125;]
set_property PACKAGE_PIN B9 [get_ports &#123;a_in[1]&#125;]
set_property PACKAGE_PIN G11 [get_ports &#123;a_in[2]&#125;]
set_property PACKAGE_PIN F10 [get_ports &#123;a_in[3]&#125;]
set_property PACKAGE_PIN D10 [get_ports &#123;a_in[4]&#125;]
set_property PACKAGE_PIN E11 [get_ports &#123;a_in[5]&#125;]
set_property PACKAGE_PIN D11 [get_ports &#123;a_in[6]&#125;]
set_property PACKAGE_PIN A14 [get_ports &#123;a_in[7]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[0]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[1]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[2]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[3]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[4]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[5]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[6]&#125;]
set_property IOSTANDARD LVCMOS18 [get_ports &#123;b_in[7]&#125;]
set_property PACKAGE_PIN B10 [get_ports &#123;b_in[0]&#125;]
set_property PACKAGE_PIN A10 [get_ports &#123;b_in[1]&#125;]
set_property PACKAGE_PIN B15 [get_ports &#123;b_in[2]&#125;]
set_property PACKAGE_PIN A15 [get_ports &#123;b_in[3]&#125;]
set_property PACKAGE_PIN A13 [get_ports &#123;b_in[4]&#125;]
set_property PACKAGE_PIN A12 [get_ports &#123;b_in[5]&#125;]
set_property PACKAGE_PIN D8 [get_ports &#123;b_in[6]&#125;]
set_property PACKAGE_PIN D9 [get_ports &#123;b_in[7]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23 [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24 [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26 [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26 [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20 [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25 [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24 [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22 [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21 [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23 [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25 [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26 [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24 [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21 [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22 [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20 [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26 [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26 [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26 [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21 [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21 [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23 [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24 [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21 [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;seg_data[0]&#125;]
</code></pre>
<p>​<br>    set_property PACKAGE_PIN J8 [get_ports rst]
    set_property IOSTANDARD LVCMOS18 [get_ports rst]</p>
<h3 id="4-先进先出-FIFO-的设计"><a href="#4-先进先出-FIFO-的设计" class="headerlink" title="4.先进先出 FIFO 的设计"></a>4.先进先出 FIFO 的设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/311aeef9dede913202b7df632c3aa302.png"></p>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    – Module Name: FIFO_ring_test - Behavioral
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity FIFO_ring_test is
generic(
    CLK_FRE:integer:=100000000;
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        key_in:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end FIFO_ring_test;

architecture Behavioral of FIFO_ring_test is

component key_stroke
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end component;
component FIFO_ring
generic(
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk,clk_rd,clk_wr:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal out_put:std_logic;

begin
key_stroke_inst:key_stroke generic map(CLK_FRE)port map(clk=&gt;clk,reset=&gt;rst,key_in=&gt;key_in,output=&gt;out_put);
FIFO_ring_inst:FIFO_ring generic map(cycle_max,depth,width)port map(rst=&gt;rst,clk=&gt;clk,clk_rd=&gt;out_put,clk_wr=&gt;out_put,wr=&gt;wr,rd=&gt;rd,data_in=&gt;data_in,full=&gt;full,empty=&gt;empty,data_out=&gt;data_out);

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    – Module Name: FIFO_ring - Behavioral
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity FIFO_ring is
generic(
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk,clk_rd,clk_wr:in std_logic;
        rst:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end FIFO_ring;

architecture Behavioral of FIFO_ring is
component duaram
generic(
    depth:positive:=3;
    width:positive:=8
);
Port(
    clka:in std_logic;
    wr:in std_logic;
    wr_en:in std_logic;
    addra:in std_logic_vector(depth-1 downto 0);
    datain:in std_logic_vector(width-1 downto 0);
    
    clkb:in std_logic;
    rd:in std_logic;
    rd_en:in std_logic;
    addrb:in std_logic_vector(depth-1 downto 0);
    dataout:out std_logic_vector(width-1 downto 0)
); 
end component;
component FIFO_ring_duaram_controller
generic(
    cycle_max:positive;--最大读写圈数
    depth:positive
);
Port(
    rst:in std_logic;
    clk,clka,clkb:in std_logic;
    wq:in std_logic;
    rq:in std_logic;
    full:out std_logic;
    empty:out std_logic;
    
    wr_pt:out std_logic_vector(depth-1 downto 0);
    rd_pt:out std_logic_vector(depth-1 downto 0)
);
end component;

signal rp_line:std_logic_vector(depth-1 downto 0);
signal wp_line:std_logic_vector(depth-1 downto 0);
signal empty_line:std_logic;
signal full_line:std_logic;

begin
duaram_inst:duaram generic map(depth,width)port map(clka=&gt;clk_wr,clkb=&gt;clk_rd,datain=&gt;data_in,dataout=&gt;data_out,addra=&gt;wp_line,addrb=&gt;rp_line,rd=&gt;rd,wr=&gt;wr,rd_en=&gt;empty_line,wr_en=&gt;full_line);
FIFO_ring_duaram_controller_inst:FIFO_ring_duaram_controller generic map(cycle_max,depth)port map(rst=&gt;rst,clk=&gt;clk,clkb=&gt;clk_rd,clka=&gt;clk_wr,wq=&gt;wr,rq=&gt;rd,full=&gt;full_line,empty=&gt;empty_line,wr_pt=&gt;wp_line,rd_pt=&gt;rp_line);

process(empty_line,full_line)
begin
    empty&lt;=empty_line;
    full&lt;=full_line;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a99a9296939596a5890faf5f0a592e12.png"></p>
<p>模块：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    – Module Name: FIFO_ring - Behavioral
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity duaram is
    generic(
        depth:positive;
        width:positive
    );
    Port(
        clka:in std_logic;
        wr:in std_logic;
        wr_en:in std_logic;
        addra:in std_logic_vector(depth-1 downto 0);
        datain:in std_logic_vector(width-1 downto 0);
        
        clkb:in std_logic;
        rd:in std_logic;
        rd_en:in std_logic;
        addrb:in std_logic_vector(depth-1 downto 0);
        dataout:out std_logic_vector(width-1 downto 0)
    );
end duaram;

architecture Behavioral of duaram is
type ram is array(2**depth-1 downto 0)of std_logic_vector(width-1 downto 0);
signal dualram:ram;
begin

    process(clka)
    begin
        if(clka&#39;event and clka=&#39;1&#39;)then
            if(wr=&#39;0&#39;and wr_en=&#39;0&#39;)then dualram(conv_integer(addra))&lt;=datain;end if;
        end if;
    end process;
    
    process(clkb)
    begin
        if(clkb&#39;event and clkb=&#39;1&#39;)then
            if(rd=&#39;0&#39;and rd_en=&#39;0&#39;)then dataout&lt;=dualram(conv_integer(addrb));end if;
        end if;
    end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    – Module Name: FIFO_ring_duaram_controller - Behavioral
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity FIFO_ring_duaram_controller is
generic(
    cycle_max:positive;--最大读写圈数
    depth:positive
);
Port(
    rst:in std_logic;
    clk,clka,clkb:in std_logic;
    wq:in std_logic;
    rq:in std_logic;
    full:out std_logic;
    empty:out std_logic;
    
    wr_pt:out std_logic_vector(depth-1 downto 0);
    rd_pt:out std_logic_vector(depth-1 downto 0)
);
end FIFO_ring_duaram_controller;

architecture Behavioral of FIFO_ring_duaram_controller is
signal wr_pt_t:std_logic_vector(depth+cycle_max-1 downto 0);
signal rd_pt_t:std_logic_vector(depth+cycle_max-1 downto 0);
signal full_line:std_logic;
signal empty_line:std_logic;
begin

--write_pointer
process(rst,clka)
begin
    if(rst=&#39;0&#39;)then
        wr_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clka&#39;event and clka=&#39;1&#39;)then
        if (wq=&#39;0&#39;and full_line=&#39;0&#39;)then wr_pt_t&lt;=wr_pt_t+1;end if;
    end if;     
end process;

--read_pointer
process(rst,clkb)
begin
    if(rst=&#39;0&#39;)then
        rd_pt_t&lt;=(others=&gt;&#39;0&#39;);
    elsif(clkb&#39;event and clkb=&#39;1&#39;)then
        if (rq=&#39;0&#39;and empty_line=&#39;0&#39;)then 
rd_pt_t&lt;=rd_pt_t+1;
end if;
    end if;
end process;

--judge_status
process(rst,clk)
begin
    if(rst=&#39;0&#39;)then empty_line&lt;=&#39;1&#39;;full_line&lt;=&#39;0&#39;;
    elsif(clk&#39;event and clk=&#39;1&#39;)then
        if(wr_pt_t=rd_pt_t)then empty_line&lt;=&#39;1&#39;;full_line&lt;=&#39;0&#39;;
        elsif(wr_pt_t=rd_pt_t+2**depth)then empty_line&lt;=&#39;0&#39;;full_line&lt;=&#39;1&#39;;
        else empty_line&lt;=&#39;0&#39;;full_line&lt;=&#39;0&#39;;
        end if;
    end if;  
end process;

process(wr_pt_t)
begin wr_pt&lt;=wr_pt_t(depth-1 downto 0);
end process;

process(rd_pt_t)
begin rd_pt&lt;=rd_pt_t(depth-1 downto 0);
end process;

process(empty_line)
begin empty&lt;=empty_line;
end process;

process(full_line)
begin full&lt;=full_line;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    – Module Name: FIFO_ring_tb - Behavioral
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity FIFO_ring_tb is
--  Port ( );
end FIFO_ring_tb;

architecture Behavioral of FIFO_ring_tb is

component FIFO_ring_test
generic(
    CLK_FRE:integer:=100000000;
    cycle_max:positive:=3;--最大读写圈数
    depth:positive:=3;
    width:positive:=8
);
    Port(
        clk:in std_logic;
        rst:in std_logic;
        key_in:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        wr:in std_logic;
        rd:in std_logic;
        
        empty:out std_logic;
        full:out std_logic;
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal clk:std_logic;
signal rst:std_logic;
signal key_in:std_logic;
signal data_in:std_logic_vector(7 downto 0);
signal wr:std_logic;
signal rd:std_logic;
signal empty:std_logic;
signal full:std_logic;
signal data_out:std_logic_vector(7 downto 0);

begin

FIFO_ring_test_inst:FIFO_ring_test generic map(100000000,3,8)port map(clk,rst,key_in,data_in,wr,rd,empty,full,data_out);

clock:process
begin
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
end process;

reset:process
begin
    rst&lt;=&#39;0&#39;;
    wait for 25ns;
    rst&lt;=&#39;1&#39;;
    wait;
end process;

test:process
begin
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;1&#39;;
    data_in&lt;=&quot;00000000&quot;;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;0&#39;;
    data_in&lt;=&quot;00000001&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00000010&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00000100&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00001000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00010000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00100000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;01000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;10000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;11111111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;00001111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=&quot;11110000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wr&lt;=&#39;1&#39;;
    rd&lt;=&#39;0&#39;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    rd&lt;=&#39;1&#39;;
    wr&lt;=&#39;0&#39;;
    data_in&lt;=not&quot;00000001&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00000010&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00000100&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00001000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00010000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00100000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;01000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;10000000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;11111111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;00001111&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    data_in&lt;=not&quot;11110000&quot;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wr&lt;=&#39;1&#39;;
    rd&lt;=&#39;0&#39;;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    wait for 4ms;
    key_in&lt;=&#39;1&#39;;
    wait for 4ms;
    key_in&lt;=&#39;0&#39;;
    wait for 4ms;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/36a731b3be24e70c8626b6c8ffc27d7b.png"></p>
<p>xdc：</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    #———————————————————————————-
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[0]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[1]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[2]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[3]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[4]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[5]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[6]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {data_in[7]}]
    set_property PACKAGE_PIN C9 [get_ports {data_in[0]}]
    set_property PACKAGE_PIN B9 [get_ports {data_in[1]}]
    set_property PACKAGE_PIN G11 [get_ports {data_in[2]}]
    set_property PACKAGE_PIN F10 [get_ports {data_in[3]}]
    set_property PACKAGE_PIN D10 [get_ports {data_in[4]}]
    set_property PACKAGE_PIN E11 [get_ports {data_in[5]}]
    set_property PACKAGE_PIN D11 [get_ports {data_in[6]}]
    set_property PACKAGE_PIN A14 [get_ports {data_in[7]}]</p>
<pre><code>set_property PACKAGE_PIN E10 [get_ports clk]
set_property IOSTANDARD LVCMOS18 [get_ports clk]

#sw31
set_property PACKAGE_PIN J8 [get_ports rst]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
#sw30
set_property PACKAGE_PIN J14 [get_ports key_in]
set_property IOSTANDARD LVCMOS18 [get_ports key_in]
#sw29
set_property PACKAGE_PIN H9 [get_ports wr]
set_property IOSTANDARD LVCMOS18 [get_ports wr]
#sw28
set_property PACKAGE_PIN H8 [get_ports rd]
set_property IOSTANDARD LVCMOS18 [get_ports rd]
#led15
set_property PACKAGE_PIN L20 [get_ports empty]
set_property IOSTANDARD LVCMOS33 [get_ports empty]
#led11
set_property PACKAGE_PIN J20 [get_ports full]
set_property IOSTANDARD LVCMOS33 [get_ports full]
#led0-7
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]
</code></pre>
<h3 id="5-PC-程序计数器设计"><a href="#5-PC-程序计数器设计" class="headerlink" title="5.PC 程序计数器设计"></a>5.PC 程序计数器设计</h3><p> PC 功能分析 加 1 功能、更新地址功能、PC 数值送到数据总线</p>
<p> PC 功能实现</p>
<p>1）全局异步复位功能</p>
<pre><code>     ADDR&lt;=“000000000000”;

     数据总线高阻态;
</code></pre>
<p>2）加 1 功能</p>
<pre><code>     clk_PC 上升沿有效;

     M_PC 高电平有效，PC+1=&gt;ADDR;
</code></pre>
<p>3）地址更新功能</p>
<pre><code>     clk_PC 上升沿有效，nLD_PC 低电平有效，新的 PC=&gt;ADDR；

     PC 数值送到数据总线，nPCH 和 nPCL 低电平有效，注意分两次输出到总线上，先高 8 位后低 8 位。
</code></pre>
<p><strong>注：自行添加按键消抖模块</strong></p>
<p>源码：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity pc is
    Port (        
        rst,clk_PC,M_PC,nLD_PC:in std_logic;
        PC_in:in std_logic_vector(11 downto 0);
        
        DATA_BUS:inout std_logic_vector(7 downto 0);
        
        nPCH,nPCL:out std_logic
     );
end pc;

architecture Behavioral of pc is

signal pc_count:std_logic_vector(11 downto 0);
signal ADDR:std_logic_vector(11 downto 0);
</code></pre>
<p>​<br>    begin</p>
<pre><code>process(rst,clk_PC)
variable addr_count:integer:=0;
begin
    if(rst=&#39;1&#39;)then 
        pc_count&lt;=PC_in;
        ADDR&lt;=pc_count;
        DATA_BUS&lt;=&quot;XXXXXXXX&quot;;
        nPCH&lt;=&#39;1&#39;;nPCL&lt;=&#39;1&#39;;

    elsif(clk_PC=&#39;1&#39;and clk_PC&#39;event)then
        if(addr_count=0)then pc_count&lt;=pc_count+1;end if;
        if(M_PC=&#39;1&#39;)then ADDR&lt;=pc_count;end if;
        if(nLD_PC=&#39;0&#39;)then 
            if(addr_count=0)then DATA_BUS&lt;=&quot;0000&quot;&amp; ADDR(11 downto 8);addr_count:=addr_count+1;nPCH&lt;=&#39;0&#39;;nPCL&lt;=&#39;1&#39;;
            elsif(addr_count=1)then DATA_BUS&lt;=ADDR(7 downto 0);addr_count:=addr_count-1;nPCH&lt;=&#39;1&#39;;nPCL&lt;=&#39;0&#39;;
            end if;
        end if;
    end if;
end process;
</code></pre>
<p>​<br>​<br>    end Behavioral;</p>
<p>xdc:</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    #———————————————————————————-
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[0]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[1]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[2]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[3]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[4]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[5]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[6]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[7]}]
    set_property PACKAGE_PIN C9         [get_ports {PC_in[0]}]
    set_property PACKAGE_PIN B9         [get_ports {PC_in[1]}]
    set_property PACKAGE_PIN G11        [get_ports {PC_in[2]}]
    set_property PACKAGE_PIN F10        [get_ports {PC_in[3]}]
    set_property PACKAGE_PIN D10        [get_ports {PC_in[4]}]
    set_property PACKAGE_PIN E11        [get_ports {PC_in[5]}]
    set_property PACKAGE_PIN D11        [get_ports {PC_in[6]}]
    set_property PACKAGE_PIN A14        [get_ports {PC_in[7]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[8]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[9]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[10]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {PC_in[11]}]
    set_property PACKAGE_PIN B10        [get_ports {PC_in[8]}]
    set_property PACKAGE_PIN A10        [get_ports {PC_in[9]}]
    set_property PACKAGE_PIN B15        [get_ports {PC_in[10]}]
    set_property PACKAGE_PIN A15        [get_ports {PC_in[11]}]</p>
<p>​<br>    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[0]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[1]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[2]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[3]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[4]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[5]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[6]}]
    set_property IOSTANDARD LVCMOS33 		[get_ports {DATA_BUS[7]}]
    set_property PACKAGE_PIN G16			[get_ports {DATA_BUS[0]}]
    set_property PACKAGE_PIN H16 			[get_ports {DATA_BUS[1]}]
    set_property PACKAGE_PIN D16 			[get_ports {DATA_BUS[2]}]
    set_property PACKAGE_PIN D15 			[get_ports {DATA_BUS[3]}]
    set_property PACKAGE_PIN C18 			[get_ports {DATA_BUS[4]}]
    set_property PACKAGE_PIN C17 			[get_ports {DATA_BUS[5]}]
    set_property PACKAGE_PIN B19 			[get_ports {DATA_BUS[6]}]
    set_property PACKAGE_PIN C19 			[get_ports {DATA_BUS[7]}]</p>
<pre><code>#sw31
set_property PACKAGE_PIN J8 [get_ports rst]
set_property IOSTANDARD LVCMOS18 [get_ports rst]
#sw30
set_property CLOCK_DEDICATED_ROUTE FALSE [get_nets clk_PC]
set_property PACKAGE_PIN J14 [get_ports clk_PC]
set_property IOSTANDARD LVCMOS18 [get_ports clk_PC]
#sw29
set_property PACKAGE_PIN H9 [get_ports M_PC]
set_property IOSTANDARD LVCMOS18 [get_ports M_PC]
#sw28
set_property PACKAGE_PIN H8 [get_ports nLD_PC]
set_property IOSTANDARD LVCMOS18 [get_ports nLD_PC]

#led15
set_property PACKAGE_PIN L20 [get_ports nPCH]
set_property IOSTANDARD LVCMOS33 [get_ports nPCH]
#led11
set_property PACKAGE_PIN J20 [get_ports nPCL]
set_property IOSTANDARD LVCMOS33 [get_ports nPCL]
</code></pre>
<h3 id="6-程序存储器-ROM-设计"><a href="#6-程序存储器-ROM-设计" class="headerlink" title="6.程序存储器 ROM 设计"></a>6.程序存储器 ROM 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/ca1179f853bd18943bce21382adae2c2.png"></p>
<p>源码：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_unsigned.ALL;
    use IEEE.STD_LOGIC_textio.ALL;
    use std.textio.all;</p>
<pre><code>entity ROM is
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end ROM;

architecture Behavioral of ROM is
type matrix is array (integer range&lt;&gt;)of std_logic_vector(width-1 downto 0);
signal rom:matrix(0 to 2**depth-1);

procedure load_rom (signal data_word:out matrix)is
file romfile:text open read_mode is &quot;romfile.dat&quot;;
variable lbuf:line;
variable i:integer:=0;
variable fdata:std_logic_vector(7 downto 0);
begin
    while(not endfile(romfile)and i&lt;2**depth)loop
        readline(romfile,lbuf);
        read(lbuf,fdata);
        data_word(i)&lt;=fdata;
        i:=i+1;
    end loop;
end procedure;

begin

load_rom(rom);

process(clk_ROM)
begin
    if(clk_ROM=&#39;1&#39;and clk_ROM&#39;event)then        
        if(ROM_EN=&#39;0&#39;and M_ROM=&#39;1&#39;)then
            DATA_BUS&lt;=rom(conv_integer(addr));
        else DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;        
        
end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 13:02:24
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity ROM_tb is
--  Port ( );
end ROM_tb;

architecture Behavioral of ROM_tb is
component ROM
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal rst:std_logic;
signal clk_ROM,M_ROM,ROM_EN:std_logic;
signal addr:std_logic_vector(11 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);

begin

ROM_inst:ROM generic map(12,8)port map(clk_ROM,M_ROM,ROM_EN,addr,DATA_BUS);

clock:process
begin
    clk_ROM&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_ROM&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    M_ROM&lt;=&#39;0&#39;;
    ROM_EN&lt;=&#39;1&#39;;
    addr&lt;=(others=&gt;&#39;0&#39;);
    wait for 25ns;
    M_ROM&lt;=&#39;1&#39;;
    wait for 25ns;
    ROM_EN&lt;=&#39;0&#39;;
    
    wait for 5ns;
    addr&lt;=&quot;000000000000&quot;;
    wait for 20ns;  
    wait for 5ns;
    addr&lt;=&quot;000000000001&quot;;
    wait for 20ns;
    wait for 5ns;
    addr&lt;=&quot;000000000010&quot;;
    wait for 20ns;
    wait for 5ns;
    addr&lt;=&quot;000000000011&quot;;
    wait for 20ns;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p>xdc:</p>
<p>​<br>    set_property IOSTANDARD LVCMOS18 [get_ports {addr[0]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[1]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[2]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[3]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[4]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[5]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[6]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[7]}]
    set_property PACKAGE_PIN C9 [get_ports {addr[0]}]
    set_property PACKAGE_PIN B9 [get_ports {addr[1]}]
    set_property PACKAGE_PIN G11 [get_ports {addr[2]}]
    set_property PACKAGE_PIN F10 [get_ports {addr[3]}]
    set_property PACKAGE_PIN D10 [get_ports {addr[4]}]
    set_property PACKAGE_PIN E11 [get_ports {addr[5]}]
    set_property PACKAGE_PIN D11 [get_ports {addr[6]}]
    set_property PACKAGE_PIN A14 [get_ports {addr[7]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[8]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[9]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[10]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {addr[11]}]
    set_property PACKAGE_PIN B10 [get_ports {addr[8]}]
    set_property PACKAGE_PIN A10 [get_ports {addr[9]}]
    set_property PACKAGE_PIN B15 [get_ports {addr[10]}]
    set_property PACKAGE_PIN A15 [get_ports {addr[11]}]</p>
<pre><code>set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN G16 [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN H16 [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN D16 [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN D15 [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN C18 [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN C17 [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN B19 [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN C19 [get_ports &#123;DATA_BUS[7]&#125;]

#sw30
set_property PACKAGE_PIN J14 [get_ports ROM_EN]
set_property IOSTANDARD LVCMOS18 [get_ports ROM_EN]

#sw31
set_property PACKAGE_PIN J8 [get_ports M_ROM]
set_property IOSTANDARD LVCMOS18 [get_ports M_ROM]

set_property PACKAGE_PIN E10 [get_ports clk_ROM]
set_property IOSTANDARD LVCMOS18 [get_ports clk_ROM]
</code></pre>
<h3 id="7-加减交替除法器"><a href="#7-加减交替除法器" class="headerlink" title="7.加减交替除法器"></a>7.加减交替除法器</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/36f7c7ddcdd765b4f80b09904c236f2c.png"></p>
<p>原码加减交替除法器的运算法则：</p>
<p>1）除法运算前，应满足条件：X*&lt;Y*,且 Y*≠0,否则，按溢出或非法除数处理；</p>
<p>2）符号位不参与运算，单独处理：qf&#x3D; xf xor yf ;</p>
<p>3）部分余数采用单符号位或双符号位；</p>
<p>4）每步部分余数运算规则：</p>
<pre><code>    ①若余数 R≥0, 则商上 1，左移一次，减除数；

    ②若余数 R＜0, 则商上 0，左移一次，加除数。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity divider_origin_test is
    Port(
        rst,clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end divider_origin_test;

architecture Behavioral of divider_origin_test is
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;

signal clk_line:std_logic;
signal s,r:std_logic_vector(7 downto 0);
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(rst,clk,clk_line);
seg_dis_inst:seg_dis port map(rst,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
divider_origin_inst:divider_origin port map(clk,start,ain,bin,done,s,r);

process(s,r,ain,bin)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;s;
    data_in_B&lt;=&quot;00000000&quot;&amp;r;
    data_in_C&lt;=&quot;00000000&quot;&amp;bin;
    data_in_D&lt;=ain;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3579eeb2efc9ed74282411d3cc4a7c43.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity divider_origin is
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end divider_origin;

architecture Behavioral of divider_origin is

component divider_origin_ctrl
    Port (
        clk,start:in std_logic;
        clkout,rstall,done:out std_logic
     );
end component;
component divider_origin_16bitreg
    Port (
        clk,rst:in std_logic;
        ain:in std_logic_vector(15 downto 0);
        d:in std_logic_vector(8 downto 0);
        c_out:out std_logic;
        q:out std_logic_vector(15 downto 0)
     );
end component;
component divider_origin_selector
    Port (
        clk,rst:in std_logic;
        a0:in std_logic;
        din:in std_logic_vector(7 downto 0);
        cout:out std_logic;
        dout:out std_logic_vector(7 downto 0)
     );
end component;
component divider_origin_8bitadder
    Port (
        clk,rst:in std_logic;
        cina,cinb:in std_logic;
        ain,bin:in std_logic_vector(7 downto 0);
        sout:out std_logic_vector(8 downto 0)
     );
end component;

signal clk_line:std_logic;
signal rst_line:std_logic;
signal cina_line,cinb_line:std_logic;
signal bin_line:std_logic_vector(7 downto 0);
signal sout_line:std_logic_vector(8 downto 0);
signal q_line:std_logic_vector(15 downto 0);

begin
divider_origin_ctrl_inst:divider_origin_ctrl port map(clk=&gt;clk,start=&gt;start,clkout=&gt;clk_line,rstall=&gt;rst_line,done=&gt;done);
divider_origin_16bitreg_inst:divider_origin_16bitreg port map(clk=&gt;clk_line,rst=&gt;rst_line,ain=&gt;ain,d=&gt;sout_line,c_out=&gt;cina_line,q=&gt;q_line);
divider_origin_selector_inst:divider_origin_selector port map(clk=&gt;clk_line,rst=&gt;rst_line,a0=&gt;q_line(0),din=&gt;bin,cout=&gt;cinb_line,dout=&gt;bin_line);
divider_origin_8bitadder_inst:divider_origin_8bitadder port map(clk=&gt;clk_line,rst=&gt;rst_line,cina=&gt;cina_line,cinb=&gt;cinb_line,ain=&gt;q_line(15 downto 8),bin=&gt;bin_line,sout=&gt;sout_line);

process(q_line)
begin
    s&lt;=q_line(7 downto 0);--&amp;not sout_line(8);
    r&lt;=cina_line&amp;q_line(15 downto 9);
    --r&lt;=q_line(15 downto 8);
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/19d7c0eaa963aceabd7b7c37f2e266a9.png"></p>
<p>模块：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;
    entity divider_origin_ctrl is
        Port (
            clk,start:in std_logic;
            clkout,rstall,done:out std_logic
         );
    end divider_origin_ctrl;</p>
<pre><code>architecture Behavioral of divider_origin_ctrl is

signal cnt4b:std_logic_vector(3 downto 0);

begin

process(clk,start)
begin
    rstall&lt;=start;
    if(start=&#39;1&#39;)then cnt4b&lt;=&quot;0000&quot;;
    elsif clk&#39;event and clk=&#39;1&#39;then if cnt4b&lt;=7 then cnt4b&lt;=cnt4b+1;end if;
    end if;
end process;

process(clk,cnt4b,start)
begin
    if (start=&#39;1&#39;)then
        clkout&lt;=&#39;0&#39;;done&lt;=&#39;0&#39;; 
    elsif(start=&#39;0&#39;)then    
        if cnt4b&lt;=7 then clkout&lt;=clk;
        else clkout&lt;=&#39;0&#39;;done&lt;=&#39;1&#39;;
        end if; 
    end if;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;
    entity divider_origin_16bitreg is
        Port (
            clk,rst:in std_logic;
            ain:in std_logic_vector(15 downto 0);
            d:in std_logic_vector(8 downto 0);
            c_out:out std_logic;
            q:out std_logic_vector(15 downto 0)
         );
    end divider_origin_16bitreg;</p>
<pre><code>architecture Behavioral of divider_origin_16bitreg is

begin

process(clk,rst)
variable sr16b:std_logic_vector(15 downto 0);
begin
    if rst=&#39;1&#39;then
        sr16b:=ain;
        c_out&lt;=sr16b(15);--发送符号位
        sr16b(15 downto 1):=sr16b(14 downto 0);--左移一位
        sr16b(0):=&#39;0&#39;;--上0
    elsif(clk=&#39;1&#39;and clk&#39;event)then  
        sr16b(15 downto 8):=d(7 downto 0);
        c_out&lt;=sr16b(15);--发送符号位
        sr16b(15 downto 1):=sr16b(14 downto 0);--左移一位
        sr16b(0):=not d(8);    --上商取反符号位
    end if;   
    q&lt;=sr16b;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;
    entity divider_origin_selector is
        Port (
            clk,rst:in std_logic;
            a0:in std_logic;
            din:in std_logic_vector(7 downto 0);
            cout:out std_logic;
            dout:out std_logic_vector(7 downto 0)
         );
    end divider_origin_selector;</p>
<pre><code>architecture Behavioral of divider_origin_selector is

signal complement_x_negative:std_logic_vector(7 downto 0);

begin

process(din)
begin
    complement_x_negative&lt;=(not din)+1;
end process;

process(clk,rst,a0,din)

begin
    if(rst=&#39;1&#39;)then dout&lt;=complement_x_negative;cout&lt;=&#39;1&#39;;
    elsif(clk&#39;event and clk=&#39;0&#39;)then
        if(a0=&#39;1&#39;)then dout&lt;=complement_x_negative;cout&lt;=&#39;1&#39;;--输出加数和其符号位
        else dout&lt;=din;cout&lt;=&#39;0&#39;;
        end if;
    end if;    
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;
    entity divider_origin_8bitadder is
        Port (
            clk,rst:in std_logic;
            cina,cinb:in std_logic;
            ain,bin:in std_logic_vector(7 downto 0);
            sout:out std_logic_vector(8 downto 0)
         );
    end divider_origin_8bitadder;</p>
<pre><code>architecture Behavioral of divider_origin_8bitadder is
begin

process(rst,clk,ain,bin,cina,cinb)
begin
    if(rst=&#39;1&#39;)then sout&lt;=(cina &amp; ain)+(cinb &amp; bin);
    elsif(clk=&#39;0&#39;)then
        sout&lt;=(cina &amp; ain)+(cinb &amp; bin);
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;18 19:49:35
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity divider_origin_tb is
--  Port ( );
end divider_origin_tb;

architecture Behavioral of divider_origin_tb is
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;
signal clk,start: std_logic;
signal ain: std_logic_vector(15 downto 0);
signal bin: std_logic_vector(7 downto 0);
signal done: std_logic;
signal s,r: std_logic_vector(7 downto 0);
begin
divider_origin_inst:divider_origin port map(clk,start,ain,bin,done,s,r);

clock_gen:process
begin  
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    --09 0d
    ain&lt;=x&quot;008B&quot;;
    bin&lt;=x&quot;0E&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --00 ff
    ain&lt;=x&quot;0001&quot;;
    bin&lt;=x&quot;02&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --01 33
    ain&lt;=x&quot;00AB&quot;;
    bin&lt;=x&quot;78&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    --ad 27
    ain&lt;=x&quot;ABCD&quot;;
    bin&lt;=x&quot;FE&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
   
    --01 01
    ain&lt;=x&quot;0100&quot;;
    bin&lt;=x&quot;FF&quot;;
    wait for 25ns;
    start&lt;=&#39;1&#39;;
    wait for 25ns;
    start&lt;=&#39;0&#39;;    
    wait for 100ns;
    
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/bb48954106bbd0bf39a333bc9517b390.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/8445a0d3d348041fe6fd9b83e6bbab68.png"></p>
<p>xdc:</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    #———————————————————————————-
    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]
    #SW0<del>15
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[0]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[1]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[2]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[3]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[4]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[5]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[6]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[7]}]
    set_property PACKAGE_PIN C9         [get_ports {ain[0]}]
    set_property PACKAGE_PIN B9         [get_ports {ain[1]}]
    set_property PACKAGE_PIN G11        [get_ports {ain[2]}]
    set_property PACKAGE_PIN F10        [get_ports {ain[3]}]
    set_property PACKAGE_PIN D10        [get_ports {ain[4]}]
    set_property PACKAGE_PIN E11        [get_ports {ain[5]}]
    set_property PACKAGE_PIN D11        [get_ports {ain[6]}]
    set_property PACKAGE_PIN A14        [get_ports {ain[7]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[8]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[9]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[10]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[11]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[12]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[13]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[14]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {ain[15]}]
    set_property PACKAGE_PIN B10        [get_ports {ain[8]}]
    set_property PACKAGE_PIN A10        [get_ports {ain[9]}]
    set_property PACKAGE_PIN B15        [get_ports {ain[10]}]
    set_property PACKAGE_PIN A15        [get_ports {ain[11]}]
    set_property PACKAGE_PIN A13        [get_ports {ain[12]}]
    set_property PACKAGE_PIN A12        [get_ports {ain[13]}]
    set_property PACKAGE_PIN D8         [get_ports {ain[14]}]
    set_property PACKAGE_PIN D9         [get_ports {ain[15]}]
    #SW16</del>SW23
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[0]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[1]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[2]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[3]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[4]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[5]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[6]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {bin[7]}]
    set_property PACKAGE_PIN F8         [get_ports {bin[0]}]
    set_property PACKAGE_PIN F9         [get_ports {bin[1]}]
    set_property PACKAGE_PIN H11        [get_ports {bin[2]}]
    set_property PACKAGE_PIN H12        [get_ports {bin[3]}]
    set_property PACKAGE_PIN G14        [get_ports {bin[4]}]
    set_property PACKAGE_PIN J10        [get_ports {bin[5]}]
    set_property PACKAGE_PIN H14        [get_ports {bin[6]}]
    set_property PACKAGE_PIN J11        [get_ports {bin[7]}]</p>
<p>​<br>    #SEG_DIG1~16
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[15]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[14]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[13]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[12]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[11]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[10]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[9]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[8]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[7]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[6]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[5]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[4]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[3]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[2]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[1]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[0]}]
    set_property PACKAGE_PIN A23        [get_ports {seg_dig[15]}]
    set_property PACKAGE_PIN A24        [get_ports {seg_dig[14]}]
    set_property PACKAGE_PIN D26        [get_ports {seg_dig[13]}]
    set_property PACKAGE_PIN C26        [get_ports {seg_dig[12]}]
    set_property PACKAGE_PIN A20        [get_ports {seg_dig[11]}]
    set_property PACKAGE_PIN J25        [get_ports {seg_dig[10]}]
    set_property PACKAGE_PIN J24        [get_ports {seg_dig[9]}]
    set_property PACKAGE_PIN H22        [get_ports {seg_dig[8]}]
    set_property PACKAGE_PIN K21        [get_ports {seg_dig[7]}]
    set_property PACKAGE_PIN L23        [get_ports {seg_dig[6]}]
    set_property PACKAGE_PIN B25        [get_ports {seg_dig[5]}]
    set_property PACKAGE_PIN B26        [get_ports {seg_dig[4]}]
    set_property PACKAGE_PIN C24        [get_ports {seg_dig[3]}]
    set_property PACKAGE_PIN D21        [get_ports {seg_dig[2]}]
    set_property PACKAGE_PIN C22        [get_ports {seg_dig[1]}]
    set_property PACKAGE_PIN B20        [get_ports {seg_dig[0]}]</p>
<pre><code>#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports start]
set_property IOSTANDARD LVCMOS18    [get_ports start]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports done]
set_property PACKAGE_PIN G16			[get_ports done]
</code></pre>
<h3 id="8-指令存储器-IR-设计"><a href="#8-指令存储器-IR-设计" class="headerlink" title="8.指令存储器 IR 设计"></a>8.指令存储器 IR 设计</h3><p> IR 功能分析</p>
<pre><code>     传送指令编码到微控制器

     生成 PC 的新地址

     生成 RAM 的读写地址
</code></pre>
<p> IR 功能实现</p>
<pre><code>     传送指令编码到微控制器

            clk_IR 上升沿有效，LD_IR1 高电平有效， data-&gt;IR。

     寄存器地址操作 Data[0]-&gt; RS；Data[1]-&gt;RD；

     生成 PC 的新地址

            clk_IR 上升沿有效，LD_IR2 高电平有效，data[3..0]-&gt;PC[11..8];

            clk_IR 上升沿有效，LD_IR3 高电平有效，data[7..0]-&gt;PC[7..0]。

     生成 RAM 的读写地址

            clk_IR 上升沿有效，LD_IR3 高电平有效 data[7..0]-&gt;PC[7..0];

            nARen 低电平有效， PC[6..0]-&gt;AR[6..0]。
</code></pre>
<p>源码：  </p>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;20 10:29:36
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity IR_test is
    port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end IR_test;

architecture Behavioral of IR_test is
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        sel_out:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line: std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal DATA_BUS_line :std_logic_vector(7 downto 0);
signal IR_line_line       :std_logic_vector(7 downto 0);--传送指令到指令寄存器
signal PC_out_line   :std_logic_vector(11 downto 0);--PC地址总线
signal AR_line       :std_logic_vector(6 downto 0);

begin

clk_div_inst:clk_div generic map(10000)port map(rst,clk_IR,clk_line);
sig_dis_inst:seg_dis port map(rst,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
IR_inst:IR port map(rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen,DATA_BUS_line,IR_line_line,RS,RD,PC_out_line,AR_line);

process(DATA_BUS_line,IR_line_line,PC_out_line,AR_line)
begin
        data_in_A&lt;=&quot;00000000&quot;&amp;DATA_BUS_line;
        data_in_B&lt;=&quot;00000000&quot;&amp;IR_line_line;
        data_in_C&lt;=&quot;0000&quot;&amp;PC_out_line;
        data_in_D&lt;=&quot;000000000&quot;&amp;AR_line;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9b9e9bdcb11e643277242864ba0880d9.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;20 10:29:36
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity IR is
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end IR;

architecture Behavioral of IR is

begin

process(rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen)
begin
    if(rst=&#39;1&#39;)then
        IR_out&lt;=(others=&gt;&#39;0&#39;);
        PC_out&lt;=(others=&gt;&#39;0&#39;);
        RS&lt;=&#39;0&#39;;RD&lt;=&#39;0&#39;;
    elsif(clk_IR=&#39;1&#39; and clk_IR&#39;event)then
        if(LD_IR1=&#39;1&#39;)then IR_out&lt;=DATA_BUS;end if;
        RS&lt;=DATA_BUS(0);RD&lt;=DATA_BUS(1);
        if(LD_IR2=&#39;1&#39;)then PC_out(11 downto 8)&lt;=DATA_BUS(3 downto 0);
        elsif(LD_IR3=&#39;1&#39;)then 
            PC_out(7 downto 0)&lt;=DATA_BUS(7 downto 0);
            if(nARen=&#39;0&#39;)then AR&lt;=DATA_BUS(6 downto 0);end if;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;20 10:29:36
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity IR_tb is
--  Port ( );
end IR_tb;

architecture Behavioral of IR_tb is
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;

signal rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen,RS,RD: std_logic;
signal DATA_BUS :std_logic_vector(7 downto 0);
signal IR_line       :std_logic_vector(7 downto 0);--传送指令到指令寄存器
signal PC_out   :std_logic_vector(11 downto 0);--PC地址总线
signal AR       :std_logic_vector(6 downto 0);

begin

IR_inst:IR port map(rst=&gt;rst,clk_IR=&gt;clk_IR,LD_IR1=&gt;LD_IR1,LD_IR2=&gt;LD_IR2,LD_IR3=&gt;LD_IR3,nARen=&gt;nARen,DATA_BUS=&gt;DATA_BUS,IR_out=&gt;IR_line,RS=&gt;RS,RD=&gt;RD,PC_out=&gt;PC_out,AR=&gt;AR);

clock:process
begin
    clk_IR&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_IR&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    rst&lt;=&#39;1&#39;;
    --DATA_BUS&lt;=x&quot;EE&quot;;
    DATA_BUS&lt;=&quot;11111111&quot;;
    LD_IR1&lt;=&#39;1&#39;;
    LD_IR2&lt;=&#39;0&#39;;
    LD_IR3&lt;=&#39;0&#39;;
    nARen&lt;=&#39;1&#39;;
    wait for 25ns;
    rst&lt;=&#39;0&#39;;
    wait for 20ns;
    DATA_BUS&lt;=x&quot;FA&quot;;
    LD_IR1&lt;=&#39;0&#39;;
    LD_IR2&lt;=&#39;1&#39;;
    LD_IR3&lt;=&#39;0&#39;;
    nARen&lt;=&#39;1&#39;;
    wait for 20ns;
    DATA_BUS&lt;=x&quot;BC&quot;;
    LD_IR1&lt;=&#39;0&#39;;
    LD_IR2&lt;=&#39;0&#39;;
    LD_IR3&lt;=&#39;1&#39;;
    nARen&lt;=&#39;0&#39;;   
    wait;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/366b42fa88d3bab2b3d92539815238d9.png"></p>
<p>xdc：</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    #———————————————————————————-
    #SEG_DIG1~16
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[15]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[14]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[13]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[12]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[11]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[10]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[9]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[8]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[7]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[6]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[5]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[4]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[3]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[2]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[1]}]
    set_property IOSTANDARD LVCMOS33    [get_ports {seg_dig[0]}]
    set_property PACKAGE_PIN A23        [get_ports {seg_dig[15]}]
    set_property PACKAGE_PIN A24        [get_ports {seg_dig[14]}]
    set_property PACKAGE_PIN D26        [get_ports {seg_dig[13]}]
    set_property PACKAGE_PIN C26        [get_ports {seg_dig[12]}]
    set_property PACKAGE_PIN A20        [get_ports {seg_dig[11]}]
    set_property PACKAGE_PIN J25        [get_ports {seg_dig[10]}]
    set_property PACKAGE_PIN J24        [get_ports {seg_dig[9]}]
    set_property PACKAGE_PIN H22        [get_ports {seg_dig[8]}]
    set_property PACKAGE_PIN K21        [get_ports {seg_dig[7]}]
    set_property PACKAGE_PIN L23        [get_ports {seg_dig[6]}]
    set_property PACKAGE_PIN B25        [get_ports {seg_dig[5]}]
    set_property PACKAGE_PIN B26        [get_ports {seg_dig[4]}]
    set_property PACKAGE_PIN C24        [get_ports {seg_dig[3]}]
    set_property PACKAGE_PIN D21        [get_ports {seg_dig[2]}]
    set_property PACKAGE_PIN C22        [get_ports {seg_dig[1]}]
    set_property PACKAGE_PIN B20        [get_ports {seg_dig[0]}]</p>
<pre><code>#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports rst]
set_property IOSTANDARD LVCMOS18    [get_ports rst]
set_property PACKAGE_PIN J14        [get_ports LD_IR1]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR1]
set_property PACKAGE_PIN H9         [get_ports LD_IR2]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR2]
set_property PACKAGE_PIN H8         [get_ports LD_IR3]
set_property IOSTANDARD LVCMOS18    [get_ports LD_IR3]
set_property PACKAGE_PIN G10        [get_ports nARen]
set_property IOSTANDARD LVCMOS18    [get_ports nARen]

#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk_IR]
set_property IOSTANDARD LVCMOS18    [get_ports clk_IR]

#LED0~1
set_property IOSTANDARD LVCMOS33 		[get_ports RS]
set_property IOSTANDARD LVCMOS33 		[get_ports RD]
set_property PACKAGE_PIN G16			[get_ports RS]
set_property PACKAGE_PIN H16 			[get_ports RD]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;data_in[7]&#125;]
</code></pre>
<h3 id="9-寄存器-RN-设计"><a href="#9-寄存器-RN-设计" class="headerlink" title="9.寄存器 RN 设计"></a>9.寄存器 RN 设计</h3><p>RN 功能分析：</p>
<p> 数据锁存功能</p>
<p> 读写功能</p>
<pre><code>     读寄存器操作

            clk_RN 上升沿有效，Ri_EN 低电平有效，读信号 RDRi 高电平有效，选择 RS 寄存器， 输出 data[7..0]。

     写寄存器操作

            clk_RN 上升沿有效，Ri_EN 低电平有效，写信号 WRRi 高电平有效，选择 RD 寄存器， data[7..0] RD 。
</code></pre>
<p>源码：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;20 17:36:21
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity RN is
    generic(
        depth:integer:=1
    );
    Port(
        clk_RN,Ri_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic_vector(depth-1 downto 0);
        data_in:in std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
        --DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end RN;

architecture Behavioral of RN is
type RN is array(2**depth-1 downto 0)of std_logic_vector(7 downto 0);
signal RN_in:RN;

begin

process(clk_RN)
begin
    if(Ri_EN=&#39;1&#39;)then data_out&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_RN=&#39;1&#39;and clk_RN&#39;event)then
        if(RDRi=&#39;1&#39;)then data_out&lt;=RN_in(conv_integer(RS));
        elsif(WRRi=&#39;1&#39;)then RN_in(conv_integer(RD))&lt;=data_in;
        else data_out&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench:</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;22 09:34:26
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity RN_tb is
--  Port ( );
end RN_tb;

architecture Behavioral of RN_tb is
component RN
    generic(
        depth:integer:=1
    );
    Port(
        clk_RN,Ri_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic_vector(depth-1 downto 0);
        data_in:in std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
        --DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_RN,Ri_EN,RDRi,WRRi:std_logic;
signal RS,RD:std_logic_vector(0 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
signal data_in:std_logic_vector(7 downto 0);
signal data_out:std_logic_vector(7 downto 0);

begin

RN_inst:RN generic map(1)port map(clk_RN,Ri_EN,RDRi,WRRi,RS,RD,data_in,data_out);
--RN_inst:RN generic map(1)port map(clk_RN,Ri_EN,RDRi,WRRi,RS,RD,DATA_BUS);

clock:process
begin
    clk_RN&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_RN&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    Ri_EN&lt;=&#39;1&#39;;
    wait for 25ns;
    Ri_EN&lt;=&#39;0&#39;;
    
    RDRi&lt;=&#39;0&#39;;
    WRRi&lt;=&#39;1&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;0&quot;;
    data_in&lt;=x&quot;FF&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;0&#39;;
    WRRi&lt;=&#39;1&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;1&quot;;
    data_in&lt;=x&quot;EE&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;1&#39;;
    WRRi&lt;=&#39;0&#39;;
    RS&lt;=&quot;0&quot;;
    RD&lt;=&quot;0&quot;;
    wait for 25ns;
    
    RDRi&lt;=&#39;1&#39;;
    WRRi&lt;=&#39;0&#39;;
    RS&lt;=&quot;1&quot;;
    RD&lt;=&quot;0&quot;;
       
    wait for 25ns;
    Ri_EN&lt;=&#39;1&#39;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>xdc:</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    #———————————————————————————-
    #SW0~15
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[0]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[1]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[2]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[3]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[4]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[5]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[6]}]
    set_property IOSTANDARD LVCMOS18    [get_ports {data_in[7]}]
    set_property PACKAGE_PIN C9         [get_ports {data_in[0]}]
    set_property PACKAGE_PIN B9         [get_ports {data_in[1]}]
    set_property PACKAGE_PIN G11        [get_ports {data_in[2]}]
    set_property PACKAGE_PIN F10        [get_ports {data_in[3]}]
    set_property PACKAGE_PIN D10        [get_ports {data_in[4]}]
    set_property PACKAGE_PIN E11        [get_ports {data_in[5]}]
    set_property PACKAGE_PIN D11        [get_ports {data_in[6]}]
    set_property PACKAGE_PIN A14        [get_ports {data_in[7]}]</p>
<pre><code>#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

#CLK_100M
set_property PACKAGE_PIN E10        [get_ports clk_RN]
set_property IOSTANDARD LVCMOS18    [get_ports clk_RN]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports Ri_EN]
set_property IOSTANDARD LVCMOS18    [get_ports Ri_EN]
set_property PACKAGE_PIN J14        [get_ports RDRi]
set_property IOSTANDARD LVCMOS18    [get_ports RDRi]
set_property PACKAGE_PIN H9         [get_ports WRRi]
set_property IOSTANDARD LVCMOS18    [get_ports WRRi]
set_property PACKAGE_PIN H8         [get_ports &#123;RS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;RS[0]&#125;]
set_property PACKAGE_PIN G10        [get_ports &#123;RD[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;RD[0]&#125;]
</code></pre>
<h3 id="10-ALU算术逻辑单元设计"><a href="#10-ALU算术逻辑单元设计" class="headerlink" title="10.ALU算术逻辑单元设计"></a>10.ALU算术逻辑单元设计</h3><p>算术逻辑单元（ALU）:执行各种算术和逻辑运算。</p>
<p> 算术运算操作 :加、减、乘、除</p>
<p> 逻辑运算操作:与、或、非、异或</p>
<p> ALU 输入:操作数以及来自控制单元的控制命令</p>
<p> ALU 输出:运算结果，以及状态信息</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/43bde231cdd8555e9e66b22f437d9014.png"></p>
<p>源码：</p>
<p>顶层;</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;23 12:35:51
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    USE IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity ALU_test is
    port(
        clk : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end ALU_test;

architecture Behavioral of ALU_test is
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
component ALU 
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal nclk2,clk_line:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal regA_out,regB_out,result_out:std_logic_vector(7 downto 0);

signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志

begin
clock_inst:clock port map(clk=&gt;clk,rst=&gt;nreset,nclk2=&gt;nclk2);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
ALU_inst:ALU port map(clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,regA_out,regB_out,result_out,DATA_BUS,AC,CY,ZN,OV);

process(DATA_BUS,AC,CY,ZN,OV,regA_out,regB_out,result_out)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;DATA_BUS;
    data_in_B&lt;=&quot;000&quot;&amp; AC &amp; &quot;000&quot; &amp; CY &amp; &quot;000&quot; &amp; ZN &amp; &quot;000&quot; &amp; OV;
    data_in_C&lt;=regA_out&amp;regB_out;
    data_in_D&lt;=result_out&amp;&quot;00000000&quot;;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;22 11:58:10
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    USE IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity ALU is
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end ALU;

architecture Behavioral of ALU is
component array_multiplier
    Port (
        clk:in std_logic;
        a_in,b_in:in std_logic_vector(7 downto 0);
        sum_out:out std_logic_vector(15 downto 0)
    );
end component;
component divider_origin
    Port(
        clk,start:in std_logic;
        ain:in std_logic_vector(15 downto 0);--除数(要求除数大于被除数！)
        bin:in std_logic_vector(7 downto 0);--被除数
        done:out std_logic;

        s,r:out std_logic_vector(7 downto 0)
    );
end component;

signal regA:std_logic_vector(8 downto 0);
signal regB:std_logic_vector(8 downto 0);
signal result:std_logic_vector(8 downto 0);
signal PSW_reg:std_logic_vector(7 downto 0);        --pws(0):CY psw(1):ZN

signal AC_signal :std_logic;
signal CY_signal :std_logic;
signal ZN_signal :std_logic;
signal OV_signal :std_logic;

signal multiplier_out:std_logic_vector(15 downto 0);
signal start,done:std_logic;
signal divider_ina:std_logic_vector(15 downto 0);
signal divider_r:std_logic_vector(7 downto 0);

begin
array_multiplier_inst:array_multiplier port map(clk_ALU,regA(7 downto 0),regB(7 downto 0),multiplier_out);
--divider_origin_inst:divider_origin port map(clk,start,divider_ina,DATA_BUS,done,result(7 downto 0),divider_r);

process(clk_ALU,nreset) 
variable count:integer:=0;
begin
    if(nreset = &#39;1&#39;)then
        start&lt;=&#39;1&#39;;   
        regA &lt;= &quot;000000000&quot;;
        regA &lt;= &quot;000000000&quot;;
        result &lt;= &quot;000000000&quot;;
        DATA_BUS &lt;= &quot;ZZZZZZZZ&quot;;
        AC&lt;= &#39;0&#39;;CY&lt;= &#39;0&#39;;ZN&lt;= &#39;0&#39;;OV&lt;= &#39;0&#39;;
        
    elsif(clk_ALU&#39;event and clk_ALU = &#39;1&#39;)then
        if(M_A=&#39;1&#39;and M_B=&#39;0&#39;)then     --锁存到A
            regA(7 downto 0) &lt;= DATA_BUS;
            regA(8) &lt;= &#39;0&#39;;
        elsif(M_A=&#39;0&#39;and M_B=&#39;1&#39;)then     --锁存到B 
            regB(7 downto 0) &lt;= DATA_BUS;
            regB(8) &lt;= &#39;0&#39;;
            
        elsif(nALU_EN = &#39;0&#39;)then
            case S is
                when &quot;00000&quot; =&gt;         --直传
                    result &lt;= regA;
                    CY_signal &lt;= result(8);
                when &quot;00001&quot; =&gt;         --加法
                    result &lt;= regA+regB+C0;
                    CY_signal &lt;= result(8);
                when &quot;00010&quot; =&gt;         --减法
                    result &lt;= regA - regB;
                    CY_signal &lt;= result(8);
                    if(regA&lt;regB)then OV_signal&lt;=&#39;1&#39;;end if; 
                when &quot;00100&quot; =&gt;         --乘法
                    result(7 downto 0) &lt;= multiplier_out(7 downto 0);
                    CY_signal &lt;= regA(8)xor regB(8);
                    if(regA*regB&gt;x&quot;FF&quot;)then OV_signal&lt;=&#39;1&#39;;end if; 
                when &quot;01000&quot; =&gt;         --除法
                    case count is
                        when 0=&gt;
                            divider_ina&lt;=regA(7 downto 0)&amp;regB(7 downto 0);
                            start&lt;=&#39;0&#39;;
                            count:=count+1;
                        when others=&gt;null;
                    end case;
                    CY_signal &lt;= regA(8)xor regB(8);
                    
                when &quot;10000&quot; =&gt;         --清零
                    regA &lt;= &quot;000000000&quot;;
                    result &lt;= regA;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10001&quot; =&gt;         --与
                    result &lt;= regA and regB;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10010&quot; =&gt;         --或
                    result &lt;= regA or regB;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;10100&quot; =&gt;         --A取非
                    result &lt;= not regA;
                    CY_signal &lt;= &#39;0&#39;;
                when &quot;11000&quot; =&gt;         --异或
                    result &lt;= regA xor regB;
                    CY_signal &lt;= &#39;0&#39;;
                when others =&gt;
                    result &lt;= &quot;000000000&quot;;
            end case;
            
            case F_in is 
                when &quot;00&quot; =&gt; DATA_BUS&lt;= result(7 downto 0);--直接传送
                when &quot;01&quot; =&gt; DATA_BUS&lt;= result(8 downto 1);--带C右移
                when &quot;10&quot; =&gt; DATA_BUS&lt;= result(6 downto 0)&amp;CY_signal;--循环左移
                when &quot;11&quot; =&gt; DATA_BUS&lt;= result(6 downto 0)&amp;&#39;0&#39;;--逻辑左移
                when others =&gt; DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
            end case;
            
            CY &lt;= CY_signal;
            if(result=&quot;000000000&quot;)then ZN_signal&lt;=&#39;1&#39;;else ZN_signal&lt;=&#39;0&#39;;end if;
            ZN&lt;=ZN_signal;
            
        elsif(nPSW_EN = &#39;0&#39;)then
            PSW_reg(0) &lt;= CY_signal;
            PSW_reg(1) &lt;= ZN_signal;
            DATA_BUS&lt;= PSW_reg;
        else
            DATA_BUS &lt;= &quot;ZZZZZZZZ&quot;;
        end if;
        
    end if;
end process;

process(regA,regB,result)
begin
    regA_out&lt;=regA(7 downto 0);
    regB_out&lt;=regB(7 downto 0);
    result_out&lt;=result(7 downto 0);
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;23 13:34:13
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity ALU_tb is
--  Port ( );
end ALU_tb;

architecture Behavioral of ALU_tb is
component ALU
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0:std_logic;

signal S :std_logic_vector(4 downto 0);
signal F_in :std_logic_vector(1 downto 0);     
signal DATA_BUS:std_logic_vector(7 downto 0);   
signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志

begin
ALU_inst:ALU port map(clk,nclk2,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,DATA_BUS,AC,CY,ZN,OV);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

clock_nclk2:process
begin
    nclk2&lt;=&#39;0&#39;;
    wait for 10ns;
    nclk2&lt;=&#39;1&#39;;
    wait for 10ns;
end process;

test:process
begin
    nreset&lt;=&#39;1&#39;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;0&#39;;
    M_F&lt;=&#39;0&#39;;
    nALU_EN&lt;=&#39;1&#39;;
    nPSW_EN&lt;=&#39;1&#39;;
    C0&lt;=&#39;0&#39;;
    S&lt;=&quot;10010&quot;;
    F_in&lt;=&quot;00&quot;;
    wait for 25ns;
    
    nreset&lt;=&#39;0&#39;;
    DATA_BUS&lt;=X&quot;04&quot;;
    M_A&lt;=&#39;1&#39;;
    M_B&lt;=&#39;0&#39;;
    wait for 25ns;
    DATA_BUS&lt;=X&quot;02&quot;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;1&#39;;
    wait for 25ns;
--    DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    M_A&lt;=&#39;0&#39;;
    M_B&lt;=&#39;0&#39;;
    nALU_EN&lt;=&#39;0&#39;;
    wait for 50ns;
    
    nALU_EN&lt;=&#39;1&#39;;
    nPSW_EN&lt;=&#39;0&#39;;
    wait;
    
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    #———————————————————————————-
    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]</p>
<pre><code>#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;DATA_BUS[7]&#125;]

#sw31~23
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports nALU_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nALU_EN]
set_property PACKAGE_PIN H9         [get_ports nPSW_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nPSW_EN]
set_property PACKAGE_PIN H8         [get_ports M_A]
set_property IOSTANDARD LVCMOS18    [get_ports M_A]
set_property PACKAGE_PIN G10        [get_ports M_B]
set_property IOSTANDARD LVCMOS18    [get_ports M_B]
set_property PACKAGE_PIN G9         [get_ports M_F]
set_property IOSTANDARD LVCMOS18    [get_ports M_F]
set_property PACKAGE_PIN J13        [get_ports C0]
set_property IOSTANDARD LVCMOS18    [get_ports C0]

#SW16~20
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;S[4]&#125;]
set_property PACKAGE_PIN F8         [get_ports &#123;S[0]&#125;]
set_property PACKAGE_PIN F9         [get_ports &#123;S[1]&#125;]
set_property PACKAGE_PIN H11        [get_ports &#123;S[2]&#125;]
set_property PACKAGE_PIN H12        [get_ports &#123;S[3]&#125;]
set_property PACKAGE_PIN G14        [get_ports &#123;S[4]&#125;]

#SW22~23
set_property IOSTANDARD LVCMOS18    [get_ports &#123;F_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;F_in[1]&#125;]
set_property PACKAGE_PIN H14        [get_ports &#123;F_in[0]&#125;]
set_property PACKAGE_PIN J11        [get_ports &#123;F_in[1]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]
</code></pre>
<h3 id="11-数据存储器-RAM-设计"><a href="#11-数据存储器-RAM-设计" class="headerlink" title="11.数据存储器 RAM 设计"></a>11.数据存储器 RAM 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/b0f5ae5f7d65bf36add50df2465e24d2.png"></p>
<p>高电平写操作有效，低电平读有效。其中 clk_RAM&#x3D;nclk1 &amp; W1，在组建 CPU 模块时使用。</p>
<p>1）读数据操作：clk_RAM 上升沿有效，RAM_CS 高电平，wr_nRD 低电平，nRAM_EN 低 电平，[AR] -&gt; data 。</p>
<p>2）写数据操作：clk_RAM 上升沿有效，RAM_CS 高电平，wr_nRD 高电平有效，data-&gt;[AR]。</p>
<p>源码：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity RAM is
    generic(
        depth:integer:=7;
        width:integer:=8
        );
    port( 
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        --DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
        data_in:in STD_LOGIC_VECTOR (width-1 downto 0);
        data_out:out STD_LOGIC_VECTOR (width-1 downto 0)
        );
end RAM;

architecture Behavioral of RAM is

type ram_array is array(0 to 2**depth) of STD_LOGIC_VECTOR (width-1 downto 0);
signal index : integer range 0 to 2**depth;
signal SRAM:ram_array;

begin

process (n_reset,clk_RAM) 
begin
    index&lt;=conv_integer(AR);
    if(n_reset=&#39;1&#39;)  then 
        --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
        data_out&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_RAM&#39;event and clk_RAM=&#39;1&#39;) then
        if(RAM_CS=&#39;1&#39;)then
            if(Wr_nRD=&#39;1&#39;)then
                --SRAM(index)&lt;=DATA_BUS;
                SRAM(index)&lt;=data_in;
            elsif(nRAM_EN=&#39;0&#39;)then
                --DATA_BUS&lt;=SRAM(index);
                data_out&lt;=SRAM(index);
            else
                --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
                data_out&lt;=(others=&gt;&#39;Z&#39;);
            end if;
        else 
            --DATA_BUS&lt;=(others=&gt;&#39;Z&#39;);
            data_out&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity RAM_tb is
--  Port ( );
end RAM_tb;

architecture Behavioral of RAM_tb is
component RAM
    generic(
        depth:positive:=7;
        width:positive:=8
    );
    Port (
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
        --data_in:in STD_LOGIC_VECTOR (width-1 downto 0);
        --data_out:out STD_LOGIC_VECTOR (width-1 downto 0))
    );
end component;

signal clk_RAM,n_reset,RAM_CS,nRAM_EN,Wr_nRD:std_logic;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
signal data_in,data_out:std_logic_vector(7 downto 0);

begin

RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;n_reset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,DATA_BUS=&gt;DATA_BUS);
--RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;n_reset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,data_in=&gt;data_in,data_out=&gt;data_out);

clock:process
begin
    clk_RAM&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_RAM&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    n_reset&lt;=&#39;1&#39;;
    wait for 25ns;
    n_reset&lt;=&#39;0&#39;;
    
    RAM_CS&lt;=&#39;1&#39;;
    nRAM_EN&lt;=&#39;1&#39;;
    Wr_nRD&lt;=&#39;1&#39;;
    AR&lt;=&quot;0000000&quot;;
    wait for 25ns;
    DATA_BUS&lt;=x&quot;FF&quot;;
    wait for 25ns;
    AR&lt;=&quot;0000001&quot;;
    wait for 25ns;
    DATA_BUS&lt;=x&quot;EE&quot;;
    wait for 25ns;
    
    nRAM_EN&lt;=&#39;0&#39;;
    Wr_nRD&lt;=&#39;0&#39;;
    AR&lt;=&quot;0000000&quot;;
    wait for 25ns;
    AR&lt;=&quot;0000001&quot;;
    
    wait;

end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;23 21:55:51
    #———————————————————————————-
    #sw0~6
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[0]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[1]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[2]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[3]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[4]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[5]}]
    set_property IOSTANDARD LVCMOS18 [get_ports {AR[6]}]
    set_property PACKAGE_PIN C9 [get_ports {AR[0]}]
    set_property PACKAGE_PIN B9 [get_ports {AR[1]}]
    set_property PACKAGE_PIN G11 [get_ports {AR[2]}]
    set_property PACKAGE_PIN F10 [get_ports {AR[3]}]
    set_property PACKAGE_PIN D10 [get_ports {AR[4]}]
    set_property PACKAGE_PIN E11 [get_ports {AR[5]}]
    set_property PACKAGE_PIN D11 [get_ports {AR[6]}]</p>
<pre><code>#LED
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[0]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[1]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[2]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[3]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[4]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[5]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[6]&#125;]
#set_property IOSTANDARD LVCMOS33 [get_ports &#123;DATA_BUS[7]&#125;]
#set_property PACKAGE_PIN G16 [get_ports &#123;DATA_BUS[0]&#125;]
#set_property PACKAGE_PIN H16 [get_ports &#123;DATA_BUS[1]&#125;]
#set_property PACKAGE_PIN D16 [get_ports &#123;DATA_BUS[2]&#125;]
#set_property PACKAGE_PIN D15 [get_ports &#123;DATA_BUS[3]&#125;]
#set_property PACKAGE_PIN C18 [get_ports &#123;DATA_BUS[4]&#125;]
#set_property PACKAGE_PIN C17 [get_ports &#123;DATA_BUS[5]&#125;]
#set_property PACKAGE_PIN B19 [get_ports &#123;DATA_BUS[6]&#125;]
#set_property PACKAGE_PIN C19 [get_ports &#123;DATA_BUS[7]&#125;]

#sw31
set_property PACKAGE_PIN J8 [get_ports n_reset]
set_property IOSTANDARD LVCMOS18 [get_ports n_reset]

#sw30~28
set_property PACKAGE_PIN J14 [get_ports RAM_CS]
set_property IOSTANDARD LVCMOS18 [get_ports RAM_CS]
set_property PACKAGE_PIN H9         [get_ports nRAM_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nRAM_EN]
set_property PACKAGE_PIN H8         [get_ports Wr_nRD]
set_property IOSTANDARD LVCMOS18    [get_ports Wr_nRD]

#clk
set_property PACKAGE_PIN E10 [get_ports clk_RAM]
set_property IOSTANDARD LVCMOS18 [get_ports clk_RAM]

#LED
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[6]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;data_out[7]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;data_out[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;data_out[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;data_out[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;data_out[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;data_out[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;data_out[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;data_out[6]&#125;]
set_property PACKAGE_PIN C19 			[get_ports &#123;data_out[7]&#125;]

set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN B10        [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN A10        [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN B15        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN A15        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN A13        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN A12        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D8         [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN D9         [get_ports &#123;data_in[7]&#125;]
</code></pre>
<h3 id="12-堆栈指针-SP-设计"><a href="#12-堆栈指针-SP-设计" class="headerlink" title="12.堆栈指针 SP 设计"></a>12.堆栈指针 SP 设计</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/450ff7787e4fbc15befc93420b279e3f.png"></p>
<p>其中 clk_SP&#x3D;nclk2，在组建 CPU 模块时使用。</p>
<p>1）数据存储功能：clk_SP 上升沿有效，SP_CS 高电平，nSP_EN 高电平，data-&gt;SP。</p>
<p>2）加 1 功能：clk_SP 上升沿有效，SP_CS 高电平，SP_UP 高电平，nSP_EN 低电平有效，SP+1-&gt;SP,SP-&gt;AR。</p>
<p>3）减 1 功能：clk_SP 上升沿有效，SP_CS 高电平，SP_DN 高电平，nSP_EN 低电平有效， SP-1-&gt;SP,SP-&gt;AR。</p>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 13:45:37
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity SP_test is
    Port(
        clk:in std_logic;       --时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        key_in:in std_logic;    --按键时钟
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end SP_test;

architecture Behavioral of SP_test is
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;
component key_stroke
    generic(CLK_FRE:integer:=100000000);
    Port (
        clk:in std_logic;
        reset:in std_logic;
        key_in:in std_logic;
        output:out std_logic           
    );
end component;

signal clk_line:STD_LOGIC;

begin

key_stroke_inst:key_stroke generic map(100000000)port map(clk,nreset,key_in,clk_line);
SP_inst:SP PORT MAP(clk_line,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);
</code></pre>
<p>​<br>    end Behavioral;</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4ca7b953040d5420bd324dcceae3363c.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 10:52:17
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.STD_LOGIC_UNSIGNED.ALL;</p>
<pre><code>entity SP is
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end SP;

architecture Behavioral of SP is

signal SP_p:std_logic_vector(6 downto 0);--指向RAM地址

begin

process(clk_SP,nreset)
begin   
    if(nreset=&#39;0&#39;)then AR&lt;=(others=&gt;&#39;Z&#39;);
    elsif(clk_SP=&#39;1&#39;and clk_SP&#39;event)then
        if(SP_CS=&#39;1&#39;)then
            if(nSP_EN=&#39;1&#39;)then 
                --SP_p&lt;=data_in;
                SP_p&lt;=DATA_BUS(6 downto 0);
            else
                if(SP_UP=&#39;1&#39;and SP_DN=&#39;0&#39;)then SP_p&lt;=SP_p+1;
                elsif(SP_UP=&#39;0&#39;and SP_DN=&#39;1&#39;)then SP_p&lt;=SP_p-1;
                end if;
                --data_out&lt;=SP_p;
                AR&lt;=SP_p;
            end if;
        else AR&lt;=(others=&gt;&#39;Z&#39;);
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 13:29:19
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity SP_tb is
--  Port ( );
end SP_tb;

architecture Behavioral of SP_tb is
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        --data_in:in std_logic_vector(7 downto 0);
        --data_out:out std_logic_vector(7 downto 0)
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;

signal clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN:STD_LOGIC;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);

begin

SP_inst:SP PORT MAP(clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);

clock:process
begin
    clk_SP&lt;=&#39;1&#39;;
    wait for 5ns;
    clk_SP&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

test:process
begin
    nreset&lt;=&#39;0&#39;;
    SP_CS&lt;=&#39;1&#39;;
    SP_UP&lt;=&#39;0&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;1&#39;;
    DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    wait for 25ns;
    
    DATA_BUS&lt;=x&quot;0F&quot;;
    nreset&lt;=&#39;1&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;1&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;1&#39;;
    SP_DN&lt;=&#39;0&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    SP_UP&lt;=&#39;0&#39;;
    SP_DN&lt;=&#39;1&#39;;
    nSP_EN&lt;=&#39;0&#39;;
    wait for 25ns;
    
    wait;
    
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<p>​<br>    #clk
    set_property PACKAGE_PIN E10 [get_ports clk]
    set_property IOSTANDARD LVCMOS18 [get_ports clk]</p>
<pre><code>#sw31~28
set_property PACKAGE_PIN J8 [get_ports nreset]
set_property IOSTANDARD LVCMOS18 [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports SP_CS]
set_property IOSTANDARD LVCMOS18    [get_ports SP_CS]
set_property PACKAGE_PIN H9         [get_ports key_in]
set_property IOSTANDARD LVCMOS18    [get_ports key_in]
set_property PACKAGE_PIN H8         [get_ports nSP_EN]
set_property IOSTANDARD LVCMOS18    [get_ports nSP_EN]
set_property PACKAGE_PIN G10        [get_ports SP_UP ]
set_property IOSTANDARD LVCMOS18    [get_ports SP_UP ]
set_property PACKAGE_PIN G9         [get_ports SP_DN ]
set_property IOSTANDARD LVCMOS18    [get_ports SP_DN ]

#LED0~6
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[0]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[1]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[2]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[3]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[4]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[5]&#125;]
set_property IOSTANDARD LVCMOS33 		[get_ports &#123;AR[6]&#125;]
set_property PACKAGE_PIN G16			[get_ports &#123;AR[0]&#125;]
set_property PACKAGE_PIN H16 			[get_ports &#123;AR[1]&#125;]
set_property PACKAGE_PIN D16 			[get_ports &#123;AR[2]&#125;]
set_property PACKAGE_PIN D15 			[get_ports &#123;AR[3]&#125;]
set_property PACKAGE_PIN C18 			[get_ports &#123;AR[4]&#125;]
set_property PACKAGE_PIN C17 			[get_ports &#123;AR[5]&#125;]
set_property PACKAGE_PIN B19 			[get_ports &#123;AR[6]&#125;]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;DATA_BUS[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;DATA_BUS[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;DATA_BUS[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;DATA_BUS[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;DATA_BUS[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;DATA_BUS[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;DATA_BUS[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;DATA_BUS[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;DATA_BUS[7]&#125;]
</code></pre>
<h3 id="13-采用硬件描述语言语言设计-IO-模块"><a href="#13-采用硬件描述语言语言设计-IO-模块" class="headerlink" title="13.采用硬件描述语言语言设计 IO 模块"></a>13.采用硬件描述语言语言设计 IO 模块</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/de38a24f3d908b663a479d455c4f613d.png"></p>
<p>其中 clk_P0&#x3D;nclk2，在组建 CPU 模块时使用。</p>
<p>1）输入锁存：</p>
<pre><code>    clk_PO 上升沿有效，P0_CS 高电平，P0_IEN 低电平，

    P0_IN-&gt; 暂存器，RIEN 低电平， 暂存器 -&gt;数据总线（data）。
</code></pre>
<p>2）输出锁存：</p>
<pre><code>    clk_PO 上升沿有效，P0_CS 高电平，P0_OEN 低电平，

    数据总线（data）-&gt;暂存器，ROEN 低电平，暂存器 -&gt;P0_OUT。
</code></pre>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 14:37:22
    ———————————————————————————-</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity IO_test is
    Port(
        clk:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end IO_test;

architecture Behavioral of IO_test is

component IO
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line,rst_seg:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0); 
signal IO_out,DATA_BUS:std_logic_vector(7 downto 0);

begin

IO_inst:IO port map(clk,nreset,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN,IO_in,IO_out,DATA_BUS);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);

process(IO_in,IO_out,DATA_BUS)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;IO_in;
    data_in_B&lt;=&quot;00000000&quot;&amp;DATA_BUS;
    data_in_C&lt;=&quot;00000000&quot;&amp;IO_out;
    data_in_D&lt;=&quot;0000000000000000&quot;;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7c0424c57486f62ce1df707bbc1d0f14.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: 
    – Create Date: 2024&#x2F;04&#x2F;24 14:06:31
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity IO is
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end IO;

architecture Behavioral of IO is
signal reg:std_logic_vector(7 downto 0);
begin

process(nreset,clk_IO)
begin
    if(nreset=&#39;0&#39;)then IO_out&lt;=&quot;ZZZZZZZZ&quot;;DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
    elsif(clk_IO=&#39;1&#39;and clk_IO&#39;event)then
        if(IO_CS=&#39;1&#39;)then
            if(IO_IEN=&#39;0&#39;)then 
                reg&lt;=IO_in;
                if(RI_EN=&#39;0&#39;)then DATA_BUS&lt;=reg;end if;
            elsif(IO_OEN=&#39;0&#39;)then 
                reg&lt;=DATA_BUS;
                if(RO_EN=&#39;0&#39;)then IO_out&lt;=reg;END IF;
            end if; 
        else IO_out&lt;=&quot;ZZZZZZZZ&quot;;DATA_BUS&lt;=&quot;ZZZZZZZZ&quot;;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>xdc：</p>
<p>​<br>    #———————————————————————————-
    #– Engineer: switch_swq
    #– Create Date: 2024&#x2F;04&#x2F;24 15:50:00
    #———————————————————————————-
    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]</p>
<pre><code>#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IO_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;IO_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;IO_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;IO_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;IO_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;IO_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;IO_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;IO_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;IO_in[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14        [get_ports IO_CS]
set_property IOSTANDARD LVCMOS18    [get_ports IO_CS]
set_property PACKAGE_PIN H9         [get_ports IO_IEN]
set_property IOSTANDARD LVCMOS18    [get_ports IO_IEN]
set_property PACKAGE_PIN H8         [get_ports IO_OEN]
set_property IOSTANDARD LVCMOS18    [get_ports IO_OEN]
set_property PACKAGE_PIN G10        [get_ports RI_EN]
set_property IOSTANDARD LVCMOS18    [get_ports RI_EN]
set_property PACKAGE_PIN G9         [get_ports RO_EN]
set_property IOSTANDARD LVCMOS18    [get_ports RO_EN]
</code></pre>
<p>​<br>​    </p>
<h3 id="14-微控制器设计"><a href="#14-微控制器设计" class="headerlink" title="14.微控制器设计"></a>14.微控制器设计</h3><p>微程序控制器基本原理：</p>
<pre><code>    1)将指令分解为基本的微命令序列，把操作控制信号编制成微指令，存放到控制存储器 (CM)。

    2)运行时，从控存中取出微指令，产生指令运行所需的操作控制信号。
</code></pre>
<p>微程序控制器基本结构：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/3df769d2ac5eb7d9b1a2a850829c1e56.png"></p>
<p> 控制存储器 CM –存放微程序</p>
<p> 微指令寄存器 µIR –存放现行微指令</p>
<p> 微地址形成电路–提供下一条微地址</p>
<p> 微地址寄存器 µAR–存放现在微地址</p>
<p>控制信号设计：</p>
<pre><code>    • 39 条控制信号（39 位编码）

    • 27 条指令（5 位编码）-&gt;8 位微地址
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/29292e122740addc20eb4a530ec67bd0.png"></p>
<p>其中 clk_MC&#x3D;clk2 &amp; W0，在组建 CPU 模块时使用。</p>
<p>源码：</p>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;25 16:09:02
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity uC_test is
    Port(
        clk:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        seg_dig : out std_logic_vector(15 downto 0);
        seg_data : out std_logic_vector(7 downto 0)
    );
end uC_test;

architecture Behavioral of uC_test is
component uC
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end component;
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;

signal clk_line,clk_line2,clk_uC,clk2,w0:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0); 
signal CM_line:std_logic_vector(47 downto 8);

begin

uC_inst:uC port map(clk_uC,nreset,M_uA,IR,CMROM_CS,CM_line);
clock_inst:clock port map(clk=&gt;clk_line2,rst=&gt;nreset,clk2=&gt;clk2,w0=&gt;w0);
clk_div_inst:clk_div generic map(10000)port map(nreset,clk,clk_line);
clk_div_inst2:clk_div generic map(10000000)port map(nreset,clk,clk_line2);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);

process(clk2,w0)
begin
    clk_uC&lt;=clk2 and w0;
end process;

process(IR,CM_line)
begin
    data_in_A&lt;=&quot;0000000000&quot;&amp;IR;
    data_in_B&lt;=CM_line(15 downto 8)&amp;&quot;00000000&quot;;
    data_in_C&lt;=CM_line(31 downto 16);
    data_in_D&lt;=CM_line(47 downto 32);
end process;

end Behavioral;
</code></pre>
<p>​    </p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ef02d5402b0594182dafe67debe07644.png"></p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 16:22:50
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity uC is
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end uC;

architecture Behavioral of uC is
component uC_uA
    Port(
        clk:in std_logic;
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;
        IR:in std_logic_vector(7 downto 2);     --IR操作码信息
        uA_in:in std_logic_vector(7 downto 0);  --uIR传送的微地址
        
        uA_out:out std_logic_vector(7 downto 0) --下一条微指令的地址
    );
end component;
component uC_uAR
    Port(
        clk:in std_logic;
        nreset: in std_logic;
        uAR_in:in std_logic_vector(7 downto 0);  --uA传送的微地址
        
        uAR_out:out std_logic_vector(7 downto 0) --送至uCM的地址
    );
end component;
component uC_CM
    generic(
        width:integer := 48;    --位宽
        depth:integer := 8      --深度
    );
    port(
        clk:in std_logic;
        addr:in std_logic_vector(depth-1 downto 0);     ----uC_ROM地址
        CMROM_CS:in std_logic;  --uC_ROM输出使能
        
        data_out:out std_logic_vector(width-1 downto 0) --uC_ROM输出
    );
end component;
component uC_uIR
  Port (
    clk:in std_logic;
    CM:in std_logic_vector(47 downto 0);
    
    uA:out std_logic_vector(7 downto 0);
    uI:out std_logic_vector(47 downto 8)
  );
end component;

signal uA_in,uA_out,uAR_out:std_logic_vector(7 downto 0); 
signal CM_line:std_logic_vector(47 downto 0);

begin

uC_uA_inst:uC_uA port map(clk_uC,nreset,M_uA,IR,uA_in,uA_out);
uC_uAR_inst:uC_uAR port map(clk_uC,nreset,uA_out,uAR_out);
uC_uCM_inst:uC_CM generic map(48,8)port map(clk_uC,uAR_out,CMROM_CS,CM_line);
uC_uIR_inst:uC_uIR port map(clk_uC,CM_line,uA_in,CM);

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/63008edd2b3325b6e6ef2c8e700998d8.png"></p>
<p><img src="https://img-blog.csdnimg.cn/direct/e135b733d411449797e2018f91c18b99.png"></p>
<p>  模块：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 16:22:50
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;
    use IEEE.std_logic_unsigned.all;
    use IEEE.std_logic_textio.all;
    use STD.textio.all;</p>
<pre><code>entity uC_CM is
    generic(
        width:integer := 48;    --位宽
        depth:integer := 8      --深度
    );
    port(
        clk:in std_logic;
        addr:in std_logic_vector(depth-1 downto 0);     ----uC_ROM地址
        CMROM_CS:in std_logic;  --uC_ROM输出使能
        
        data_out:out std_logic_vector(width-1 downto 0) --uC_ROM输出
    );
end uC_CM;

architecture Behavioral of uC_CM is

type matrix is array(integer range&lt;&gt;) of std_logic_vector(width-1 downto 0);
signal uC_ROM : matrix(0 to 2**depth-1);

procedure load_rom(signal data_word:out matrix) is 
    file romfile:text open read_mode is &quot;uC_ROM.txt&quot;;
    variable lbuf:line;
    variable i:integer := 0; --循环变量
    variable fdata:std_logic_vector(width-1 downto 0);
begin
    while(not endfile(romfile) and i&lt;2**depth) loop
        readline(romfile,lbuf); -- 逐行读数据
        read(lbuf,fdata); -- 将行数据保存到变量fdata
        data_word(i)&lt;=fdata; -- 将fdata保存到内存信号量中
        i := i+1;
    end loop;
end procedure;

begin

load_rom(uC_ROM);
data_out &lt;= uC_ROM(conv_integer(addr)) when CMROM_CS=&#39;1&#39;else(others=&gt;&#39;0&#39;);

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 16:22:50
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity uC_uA is
    Port(
        clk:in std_logic;
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;
        IR:in std_logic_vector(7 downto 2);     --IR操作码信息
        uA_in:in std_logic_vector(7 downto 0);  --uIR传送的微地址
        
        uA_out:out std_logic_vector(7 downto 0) --下一条微指令的地址
    );
end uC_uA;

architecture Behavioral of uC_uA is

begin

process(clk,nreset)
begin
    if(nreset=&#39;0&#39;)then uA_out&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk=&#39;1&#39;and clk&#39;event)then
        if(M_uA=&#39;1&#39;)then uA_out&lt;=IR&amp;&quot;00&quot;;
        else uA_out&lt;=uA_in;
        end if;
    end if;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 16:22:50
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity uC_uAR is
    Port(
        clk:in std_logic;
        nreset: in std_logic;
        uAR_in:in std_logic_vector(7 downto 0);  --uA传送的微地址
        
        uAR_out:out std_logic_vector(7 downto 0) --送至uCM的地址
    );
end uC_uAR;

architecture Behavioral of uC_uAR is

begin

process(clk,nreset)
begin
    if(nreset=&#39;0&#39;)then uAR_out&lt;=(others=&gt;&#39;0&#39;);
    elsif(clk=&#39;1&#39;and clk&#39;event)then uAR_out&lt;=uAR_in;
    end if;
end process;

end Behavioral;
</code></pre>
<p>​<br>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;24 16:22:50
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity uC_uIR is
  Port (
    clk:in std_logic;
    CM:in std_logic_vector(47 downto 0);
    
    uA:out std_logic_vector(7 downto 0);
    uI:out std_logic_vector(47 downto 8)
  );
end uC_uIR;

architecture Behavioral of uC_uIR is

begin

uA&lt;=CM(7 downto 0);
uI&lt;=CM(47 downto 8);

end Behavioral;
</code></pre>
<p> uC_ROM.txt：</p>
<p>​<br>    100000000000000000000000000000000000000000000001
    010000000000000000000000000000000000000000000010
    001000000000000000000000000000000000000000000011
    000100000000000000000000000000000000000000000100
    000010000000000000000000000000000000000000000101
    000001000000000000000000000000000000000000000110
    000000100000000000000000000000000000000000000111
    000000010000000000000000000000000000000000000000</p>
<p>xdc：</p>
<p>​<br>    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]</p>
<pre><code>#SW0~15
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;IR[7]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;IR[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;IR[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;IR[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;IR[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;IR[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;IR[7]&#125;]

#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]
set_property PACKAGE_PIN J14         [get_ports CMROM_CS]
set_property IOSTANDARD LVCMOS18    [get_ports CMROM_CS]
set_property PACKAGE_PIN H9        [get_ports M_uA]
set_property IOSTANDARD LVCMOS18    [get_ports M_uA]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]
</code></pre>
<h3 id="15-8-位-SOC-综合设计"><a href="#15-8-位-SOC-综合设计" class="headerlink" title="15.8 位 SOC 综合设计"></a>15.8 位 SOC 综合设计</h3><p>根据以上所设计的功能模块连接成完整的 8 位 SOC 结构。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/cfdc1dbc85d346b9c3541e7e13e4fd2f.png"></p>
<p>模块修改记录：</p>
<p>​<br>    SOC:
    修改PC&#x2F;ROM
    *修改各模块时钟
    修改各模块总线输出时机提高片选及使能优先级，并加入到敏感检测列表
    修改uC使能：M_uA和CMROM_CS低电平有效（根据指令知）
    uC输入输出冲突，同时输入输出控制信号
    修改微指令34H：IO_CS位
    修改微指令38H：IO_CS位
    修改微指令24H：Ri_EN错误
    修改微指令8AH：M_PC位
    修改微指令65H： RDRi位
    PC不再产生nPCL和nPCH信号并修改PC模块
    ADD微程序增加一条微指令</p>
<p>源码：</p>
<p>顶层测试：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;27 20:08:24
    ———————————————————————————-</p>
<p>​<br>    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity CPU_test is
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end CPU_test;

architecture Behavioral of CPU_test is
component CPU
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
    );
end component;
component clk_div
    generic(
        DIV_NUM:integer:=10000
    );
    Port (
        rst:in std_logic;
        clk_in:in std_logic;
        clk_out:out std_logic
    );
end component;
component seg_dis
    port(
        rst,clk:in std_logic;
        data_in_A,data_in_B,data_in_C,data_in_D:in std_logic_vector(15 downto 0);
        
        seg_dig:out std_logic_vector(15 downto 0);
        seg_data:out std_logic_vector(7 downto 0)--管脚连接顺序：dp,g,f,e,d,c,b,a
    );
end component;
signal clk_line:std_logic;
signal data_in_A,data_in_B,data_in_C,data_in_D:std_logic_vector(15 downto 0);
signal regA_out,regB_out,result_out,data_out:std_logic_vector(7 downto 0);
begin
clk_div_inst:clk_div generic map(1000000)port map(nreset,clk,clk_line);
seg_dis_inst:seg_dis port map(nreset,clk_line,data_in_A,data_in_B,data_in_C,data_in_D,seg_dig,seg_data);
CPU_inst:CPU generic map(100000000)port map(clk_line,nreset,data_in,regA_out,regB_out,result_out,data_out);

process(regA_out,regB_out,result_out,data_out)
begin
    data_in_A&lt;=&quot;00000000&quot;&amp;result_out;
    data_in_B&lt;=&quot;00000000&quot;&amp;regB_out;
    data_in_C&lt;=&quot;00000000&quot;&amp;regA_out;
    data_in_D&lt;=&quot;00000000&quot;&amp;data_out;
end process;

end Behavioral;
</code></pre>
<p>顶层：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;25 17:50:57
    ———————————————————————————-
    library IEEE;
    use IEEE.STD_LOGIC_1164.ALL;</p>
<pre><code>entity CPU is
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        data_out:out std_logic_vector(7 downto 0)
    );
end CPU;

architecture Behavioral of CPU is
signal clk1,nclk1:std_logic;   --clk
signal clk2,nclk2:std_logic;   --clk二分频
signal w0,w1,w2,w3:std_logic;   --节拍信号
component clock
    Port(
        clk,rst:in std_logic;
        clk1,nclk1:out std_logic;   --clk
        clk2,nclk2:out std_logic;   --clk二分频
        w0,w1,w2,w3:out std_logic   --节拍信号
    );
end component;

signal clk_uC,M_uA,CMROM_CS:std_logic;
signal IR_line:std_logic_vector(7 downto 0);
signal CTR_BUS:std_logic_vector(47 downto 8);
component uC
    Port(
        clk_uC:in std_logic;    --微程序控制器时钟信号
        nreset:in std_logic;    --复位信号
        M_uA:in std_logic;      --微地址控制信号
        IR:in std_logic_vector(7 downto 2); --IR操作码信息
        CMROM_CS:in std_logic;  --控制存储器选通信号
        
        CM:out std_logic_vector(47 downto 8)    --控制信号输出
    );
end component;

signal clk_SP,SP_CS,SP_UP,SP_DN,nSP_EN:STD_LOGIC;
signal AR:std_logic_vector(6 downto 0);
signal DATA_BUS:std_logic_vector(7 downto 0);
component SP
    Port(
        clk_SP:in std_logic;    --SP时钟信号
        nreset:in std_logic;    --复位信号                
        SP_CS:in std_logic;     --SP选择信号
        SP_UP:in std_logic;     --SP+1控制
        SP_DN:in std_logic;     --SP-1控制
        nSP_EN:in std_logic;    --SP输出使能
        
        AR:out std_logic_vector(6 downto 0);--SP指向RAM地址
        DATA_BUS:inout std_logic_vector(7 downto 0)   --数据总线
    );
end component;

signal clk_IO,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN:std_logic;
signal IO_in,IO_out:std_logic_vector(7 downto 0);
component IO
    Port(
        clk_IO:in std_logic;    --IO时钟信号
        nreset:in std_logic;    --IO复位信号
        IO_CS:in std_logic;     --IO选择信号
        IO_IEN:in std_logic;    --IO输入使能
        IO_OEN:in std_logic;    --IO输出使能
        RI_EN:in std_logic;     --IO缓存器输入使能
        RO_EN:in std_logic;     --IO缓存器输出使能
        IO_in:in std_logic_vector(7 downto 0);          --IO输入
        
        IO_out:out std_logic_vector(7 downto 0);        --IO输出
        DATA_BUS:inout std_logic_vector(7 downto 0)    --数据总线
    );
end component;

signal clk_RAM,RAM_CS,nRAM_EN,Wr_nRD:std_logic;
component RAM
    generic(
        depth:positive:=7;
        width:positive:=8
    );
    Port (
        clk_RAM:in STD_LOGIC;       --RAM时钟信号
        n_reset:in STD_LOGIC;       --RAM选择信号
        RAM_CS:in STD_LOGIC;        --RAM片选信号
        nRAM_EN:in STD_LOGIC;       --RAM输出使能
        Wr_nRD :in STD_LOGIC;       --RAM读写信号
        AR:in STD_LOGIC_VECTOR (depth-1 downto 0);  --RAM地址信号
        
        DATA_BUS: inout STD_LOGIC_VECTOR (width-1 downto 0) --数据总线
    );
end component;

signal clk_ALU,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0:std_logic;
signal S :std_logic_vector(4 downto 0);
signal F_in :std_logic_vector(1 downto 0);    
--signal regA_out,regB_out,result_out:std_logic_vector(7 downto 0);
signal AC : std_logic;     --半进位标志
signal CY : std_logic;     --进位标志
signal ZN : std_logic;     --零标志
signal OV : std_logic;      --溢出标志
component ALU 
    port(
        clk,clk_ALU : in std_logic; --全局时钟和ALU时钟
        nreset : in std_logic;      --全局复位信号
        M_A,M_B : in std_logic;     --暂存器控制信号
        M_F : in std_logic;         --程序状态字控制信号
        nALU_EN : in std_logic;     --alu运算结果输出使能
        nPSW_EN : in std_logic;     --psw输出使能
        C0 : in std_logic;          --进位输入
        S : in std_logic_vector(4 downto 0);        --运算类型和操作选择，M为最高位S(4),其余在低四位
        F_in : in std_logic_vector(1 downto 0);     --移位功能选择
        
        regA_out,regB_out,result_out:out std_logic_vector(7 downto 0);
        DATA_BUS : inout std_logic_vector(7 downto 0);  --数据总线
        AC : out std_logic;     --半进位标志
        CY : out std_logic;     --进位标志
        ZN : out std_logic;     --零标志
        OV : out std_logic      --溢出标志
    );
end component;

signal clk_RN,Rn_CS,nRi_EN,RDRi,WRRi:std_logic;
signal RS,RD:std_logic;
component RN
    Port(
        clk_RN,Rn_CS,nRi_EN,RDRi,WRRi:in std_logic;
        RS,RD:in std_logic;

        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen: std_logic;
signal IR_AR       :std_logic_vector(6 downto 0);
component IR
    Port (
        rst,clk_IR,LD_IR1,LD_IR2,LD_IR3,nARen:in std_logic;
        DATA_BUS:in std_logic_vector(7 downto 0);
        
        IR_out:out std_logic_vector(7 downto 0);--传送指令到指令寄存器
        RS,RD:out std_logic;--传送操作寄存器（寄存器地址）
        PC_out:out std_logic_vector(11 downto 0);--PC地址总线
        AR:out std_logic_vector(6 downto 0)
    );
end component;

signal clk_ROM,M_ROM,ROM_EN:std_logic;
signal ROM_PC:std_logic_vector(11 downto 0);
component ROM
    generic(
        depth:positive:=12;
        width:positive:=8
    );
    Port (
        clk_ROM,M_ROM,ROM_EN:in std_logic;
        addr:in std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
    );
end component;

signal clk_PC,M_PC,nLD_PC,nPCH,nPCL:std_logic;
signal PC_in:std_logic_vector(11 downto 0):=(others=&gt;&#39;0&#39;);
component pc
    Port (        
        rst,clk_PC,M_PC,nLD_PC:in std_logic;
        nPCH,nPCL:in std_logic;
        PC_in:in std_logic_vector(11 downto 0);
        
        PC_out:out std_logic_vector(11 downto 0);
        DATA_BUS:inout std_logic_vector(7 downto 0)
     );
end component;

signal test_line:std_logic_vector(7 downto 0);

begin

clock_inst:clock port map(clk,nreset,clk1,nclk1,clk2,nclk2,w0,w1,w2,w3);
PC_inst:PC port map(nreset,clk_PC,M_PC,nLD_PC,nPCH,nPCL,PC_in,ROM_PC,DATA_BUS);
ROM_inst:ROM generic map(12,8)port map(clk_ROM,M_ROM,ROM_EN,ROM_PC,DATA_BUS);
uC_inst:uC port map(clk_uC,nreset,M_uA,IR_line(7 downto 2),CMROM_CS,CTR_BUS);
IR_inst:IR port map(rst=&gt;nreset,clk_IR=&gt;clk_IR,LD_IR1=&gt;LD_IR1,LD_IR2=&gt;LD_IR2,LD_IR3=&gt;LD_IR3,nARen=&gt;nARen,DATA_BUS=&gt;DATA_BUS,IR_out=&gt;IR_line,RS=&gt;RS,RD=&gt;RD,PC_out=&gt;PC_in,AR=&gt;AR(6 downto 0));
RAM_inst:RAM generic map(7,8)port map(clk_RAM=&gt;clk_RAM,n_reset=&gt;nreset,RAM_CS=&gt;RAM_CS,nRAM_EN=&gt;nRAM_EN,Wr_nRD=&gt;Wr_nRD,AR=&gt;AR,DATA_BUS=&gt;DATA_BUS);
IO_inst:IO port map(clk_IO,nreset,IO_CS,IO_IEN,IO_OEN,RI_EN,RO_EN,data_in,data_out,DATA_BUS);
--SP_inst:SP PORT MAP(clk_SP,nreset,SP_CS,SP_UP,SP_DN,nSP_EN,AR,DATA_BUS);
ALU_inst:ALU port map(clk,clk_ALU,nreset,m_A,m_B,m_F,nALU_EN,nPSW_EN,C0,S,F_in,regA_out,regB_out,result_out,DATA_BUS,AC,CY,ZN,OV);
RN_inst:RN port map(clk_RN,Rn_CS,nRi_EN,RDRi,WRRi,RS,RD,DATA_BUS);

clk_PC&lt;=clk1 and clk2;
clk_ROM&lt;=nclk1 and clk2;
clk_IR&lt;=clk1 and nclk2;
clk_uC&lt;=nclk1 and nclk2;
clk_RN&lt;=clk1 and nclk2;
clk_ALU&lt;=nclk1 and nclk2;
--clk_IO&lt;=clk2;--（LED程序使用）
clk_IO&lt;=nclk1 and clk2;--（ADD程序使用）
clk_RAM&lt;=nclk1 and w1;
clk_SP&lt;=clk1 and clk2 and w1;

M_A &lt;= CTR_BUS(47);
M_B &lt;= CTR_BUS(46);
M_F &lt;= CTR_BUS(45);
S(4) &lt;= CTR_BUS(44);
S(3) &lt;= CTR_BUS(43);
S(2) &lt;= CTR_BUS(42);
S(1) &lt;= CTR_BUS(41);
S(0) &lt;= CTR_BUS(40);
F_in(1) &lt;= CTR_BUS(39);
F_in(0) &lt;= CTR_BUS(38);
nALU_EN &lt;= CTR_BUS(37);
nPSW_EN &lt;= CTR_BUS(36);
C0 &lt;= CTR_BUS(35);
RAM_CS &lt;= CTR_BUS(34);
Wr_nRD &lt;= CTR_BUS(33); 
nRAM_EN &lt;= CTR_BUS(32);
Rn_CS &lt;= CTR_BUS(31);
RDRi &lt;= CTR_BUS(30);
WRRi &lt;= CTR_BUS(29);
nRi_EN &lt;= CTR_BUS(28);
LD_IR1 &lt;= CTR_BUS(27);
LD_IR2 &lt;= CTR_BUS(26);
LD_IR3 &lt;= CTR_BUS(25);
nAREN &lt;= CTR_BUS(24);
M_PC &lt;= CTR_BUS(23);
nLD_PC &lt;= CTR_BUS(22); 
nPCH &lt;= CTR_BUS(21); 
nPCL &lt;= CTR_BUS(20); 
SP_UP &lt;= CTR_BUS(19);
SP_DN &lt;= CTR_BUS(18);
SP_CS &lt;= CTR_BUS(17); 
nSP_EN &lt;= CTR_BUS(16); 
IO_CS &lt;= CTR_BUS(15);
IO_IEN &lt;= CTR_BUS(14);
IO_OEN &lt;= CTR_BUS(13);
RI_EN&lt;=&#39;0&#39;;
RO_EN&lt;=&#39;0&#39;;
-- &lt;= CTR_BUS(12);
M_ROM &lt;= CTR_BUS(11);
ROM_EN &lt;= CTR_BUS(10);
M_uA &lt;= CTR_BUS(9);
CMROM_CS &lt;= CTR_BUS(8);

process(nPCH,nPCL)
begin
    if(nPCH=&#39;0&#39;)then PC_in(11 downto 8)&lt;=DATA_BUS(3 downto 0);
    elsif(nPCL=&#39;0&#39;)then PC_in(7 downto 0)&lt;=DATA_BUS;
    end if;
end process;

end Behavioral;
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b870e7e63c2438527c9603091d047576.png"></p>
<p>时钟：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5bd3c1b7d51ed7ee02fd3b42b4c4ba89.png"></p>
<p>ADD微程序：</p>
<p>​<br>    00111000 –IR:38H MOV Ri,IO
    00111011 –IR:38H MOV Ri,IO
    00001000 –ADD R0,R1
    00000100 –JMP addr12
    00000000 –addr1:00H
    00000000 –addr2:00H</p>
<p>LED微程序：</p>
<p>​<br>    00100100 –IR:24H MOV Ri,#data
    00000001 –data:01H
    00110100 –IR:34H MOV IO,Ri
    00100100 –IR:24H
    00000010 –data:02H
    00110100 –IR:34H
    00100100 –IR:24H
    00000100 –data:04H
    00110100 –IR:34H
    00100100 –IR:24H
    00001000 –data:08H
    00110100 –IR:34H
    00100100 –IR:24H
    00010000 –data:10H
    00110100 –IR:34H
    00100100 –IR:24H
    00100000 –data:20H
    00110100 –IR:34H
    00100100 –IR:24H
    01000000 –data:40H
    00110100 –IR:34H
    00100100 –IR:24H
    10000000 –data:80H
    00110100 –IR:34H
    00000100 –JMP addr12
    00000000 –addr:00H
    00000000 –addr:00H
    00000000</p>
<p> 程序：</p>
<p>​<br>    000000000011000100011001111100110111100100000000		–00H
    000000000000000000000000000000000000000000000000		–01H
    000000000000000000000000000000000000000000000000		–02H
    000000000000000000000000000000000000000000000000		–03H
    000000000011000100010101111100110111101100000101		–04H JMP addr12
    000000000011000100010011111100110111101100000110		–05H
    000000000011000100010001101100110111011100000000		–06H
    000000000000000000000000000000000000000000000000		–07H
    010000000011000101000001011100110111011100001001		–08H ADD Ri,Rj
    100000000011000101000001011100110111011100001010		–09H
    001000010001000100110001011100110111011100000000		–0AH
    000000000001000100100001111100110111011100000000		–0BH
    000000000000000000000000000000000000000000000000		–0CH
    000000000000000000000000000000000000000000000000		–0DH
    000000000000000000000000000000000000000000000000		–0EH
    000000000000000000000000000000000000000000000000		–0FH
    000000000000000000000000000000000000000000000000		–10H
    000000000000000000000000000000000000000000000000		–11H
    000000000000000000000000000000000000000000000000		–12H
    000000000000000000000000000000000000000000000000		–13H
    000000000000000000000000000000000000000000000000		–14H
    000000000000000000000000000000000000000000000000		–15H
    000000000000000000000000000000000000000000000000		–16H
    000000000000000000000000000000000000000000000000		–17H
    000000000000000000000000000000000000000000000000		–18H
    000000000000000000000000000000000000000000000000		–19H
    000000000000000000000000000000000000000000000000		–1AH
    000000000000000000000000000000000000000000000000		–1BH
    000000000000000000000000000000000000000000000000		–1CH
    000000000000000000000000000000000000000000000000		–1DH
    000000000000000000000000000000000000000000000000		–1EH
    000000000000000000000000000000000000000000000000		–1FH
    000000000000000000000000000000000000000000000000		–20H
    000000000000000000000000000000000000000000000000		–21H
    000000000000000000000000000000000000000000000000		–22H
    000000000000000000000000000000000000000000000000		–23H
    000000000011000100100001111100110111101100100101		–24H MOV Ri,#data <em><strong>修改</strong></em>
    000000000011000100010001011100110111011100100110		–25H
    000000000011000100010001011100110111011100000000		–26H
    000000000000000000000000000000000000000000000000		–27H
    000000000011000101100001011100110111011100101001		–28H
    000000000011000101100001011100110111011100101010		–29H
    000000000011000100010001011100110111011100000000		–2AH
    000000000000000000000000000000000000000000000000		–2BH
    000000000011000100010010111100110111101100101101		–2CH
    000000000011010000100000011100110111011100101110		–2DH
    000000000011000100010001011100110111011100000000		–2EH
    000000000000000000000000000000000000000000000000		–2FH
    000000000011000100010010111100110111101100110001		–30H
    000000000011011101000000011100110111011100110010		–31H
    000000000011000100010001011100110111011100000000		–32H
    000000000000000000000000000000000000000000000000		–33H
    000000000011000101000001011100111101011100110101		–34H MOV IO,Ri
    000000000011000100010001011100110101011100110110		–35H 
    000000000011000100010001011100110111011100000000		–36H
    000000000000000000000000000000000000000000000000		–37H
    000000000011000100010001011100111011011100111001		–38H MOV Ri,IO
    000000000011000100100001011100111001011100111010		–39H
    000000000011000100010001011100110111011100000000		–3AH
    000000000000000000000000000000000000000000000000		–3BH
    000000000011000100010001111100010111101100111101		–3CH
    000000000011000100010001011100110111011100111110		–3DH
    000000000011000100010001011100110111011100000000		–3EH
    000000000000000000000000000000000000000000000000		–3FH
    010000010011000101000001011100110111011101000001		–40H
    000000000011000101100001011100110111011101000010		–41H
    100000000011000111000001011100110111011101000011		–42H
    001000010001000100110001111100110111011101000100		–43H
    000000000011000100010001011100110111011100000000		–44H
    000000000000000000000000000000000000000000000000		–45H</p>
<p>testbench：</p>
<p>​<br>    ———————————————————————————-
    – Engineer: switch_swq
    – Create Date: 2024&#x2F;04&#x2F;26 08:47:54
    ———————————————————————————-</p>
<pre><code>library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity CPU_tb is

end CPU_tb;

architecture Behavioral of CPU_tb is
component CPU
    generic(
        CLK_FRE:integer:=100000000
    );
    Port(
        clk:in std_logic;
        nreset:in std_logic;
        data_in:in std_logic_vector(7 downto 0);
        
        data_out:out std_logic_vector(7 downto 0)
    );
end component;

signal clk,nreset:std_logic;
signal data_in,data_out:std_logic_vector(7 downto 0);

begin

CPU_inst:CPU generic map(100000000)port map(clk,nreset,data_in,data_out);

clock:process
begin
    clk&lt;=&#39;1&#39;;
    wait for 5ns;
    clk&lt;=&#39;0&#39;;
    wait for 5ns;
end process;

reset:process
begin
    nreset&lt;=&#39;0&#39;;
    wait for 15ns;
    nreset&lt;=&#39;1&#39;;
    wait;
end process;

test:process
begin
    data_in&lt;=x&quot;FF&quot;;
    wait;
end process;

end Behavioral;
</code></pre>
<p>LED结果：</p>
<p>整体：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0f9cfb770135c8cd06409fe765cdb265.png"></p>
<p>取数（00100100 –IR:24H MOV Ri,#data 00000001 –data:01H）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/595f539ee9983cb3ad064110256b9d3d.png"></p>
<p>IO输出（00110100 –IR:34H MOV IO,Ri）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/deb8630114a8896456e6eea801735970.png"></p>
<p>ADD结果：</p>
<p>整体：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/08792675191fd507e190b166618ace0c.png"></p>
<p>IO输入（00111000 –IR:38H MOV Ri,IO）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b48d14803e3b211bfb14f2d81f5dc40a.png"></p>
<p>加法（00001000 –ADD R0,R1）：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5399cba63467fb5d837fe1e49c0adb02.png"></p>
<p>xdc：</p>
<p>​<br>    #CLK_100M
    set_property PACKAGE_PIN E10        [get_ports clk]
    set_property IOSTANDARD LVCMOS18    [get_ports clk]</p>
<pre><code>#sw31~24
set_property PACKAGE_PIN J8         [get_ports nreset]
set_property IOSTANDARD LVCMOS18    [get_ports nreset]

#SW0~7
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[0]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[1]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[2]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[3]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[4]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[5]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[6]&#125;]
set_property IOSTANDARD LVCMOS18    [get_ports &#123;data_in[7]&#125;]
set_property PACKAGE_PIN C9         [get_ports &#123;data_in[0]&#125;]
set_property PACKAGE_PIN B9         [get_ports &#123;data_in[1]&#125;]
set_property PACKAGE_PIN G11        [get_ports &#123;data_in[2]&#125;]
set_property PACKAGE_PIN F10        [get_ports &#123;data_in[3]&#125;]
set_property PACKAGE_PIN D10        [get_ports &#123;data_in[4]&#125;]
set_property PACKAGE_PIN E11        [get_ports &#123;data_in[5]&#125;]
set_property PACKAGE_PIN D11        [get_ports &#123;data_in[6]&#125;]
set_property PACKAGE_PIN A14        [get_ports &#123;data_in[7]&#125;]

#SEG_DIG1~16
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[15]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[14]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[13]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[12]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[11]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[10]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[9]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[8]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_dig[0]&#125;]
set_property PACKAGE_PIN A23        [get_ports &#123;seg_dig[15]&#125;]
set_property PACKAGE_PIN A24        [get_ports &#123;seg_dig[14]&#125;]
set_property PACKAGE_PIN D26        [get_ports &#123;seg_dig[13]&#125;]
set_property PACKAGE_PIN C26        [get_ports &#123;seg_dig[12]&#125;]
set_property PACKAGE_PIN A20        [get_ports &#123;seg_dig[11]&#125;]
set_property PACKAGE_PIN J25        [get_ports &#123;seg_dig[10]&#125;]
set_property PACKAGE_PIN J24        [get_ports &#123;seg_dig[9]&#125;]
set_property PACKAGE_PIN H22        [get_ports &#123;seg_dig[8]&#125;]
set_property PACKAGE_PIN K21        [get_ports &#123;seg_dig[7]&#125;]
set_property PACKAGE_PIN L23        [get_ports &#123;seg_dig[6]&#125;]
set_property PACKAGE_PIN B25        [get_ports &#123;seg_dig[5]&#125;]
set_property PACKAGE_PIN B26        [get_ports &#123;seg_dig[4]&#125;]
set_property PACKAGE_PIN C24        [get_ports &#123;seg_dig[3]&#125;]
set_property PACKAGE_PIN D21        [get_ports &#123;seg_dig[2]&#125;]
set_property PACKAGE_PIN C22        [get_ports &#123;seg_dig[1]&#125;]
set_property PACKAGE_PIN B20        [get_ports &#123;seg_dig[0]&#125;]

#seg_data
set_property PACKAGE_PIN E26        [get_ports &#123;seg_data[7]&#125;]
set_property PACKAGE_PIN J26        [get_ports &#123;seg_data[6]&#125;]
set_property PACKAGE_PIN H26        [get_ports &#123;seg_data[5]&#125;]
set_property PACKAGE_PIN H21        [get_ports &#123;seg_data[4]&#125;]
set_property PACKAGE_PIN G21        [get_ports &#123;seg_data[3]&#125;]
set_property PACKAGE_PIN H23        [get_ports &#123;seg_data[2]&#125;]
set_property PACKAGE_PIN H24        [get_ports &#123;seg_data[1]&#125;]
set_property PACKAGE_PIN J21        [get_ports &#123;seg_data[0]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[7]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[6]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[5]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[4]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[3]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[2]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[1]&#125;]
set_property IOSTANDARD LVCMOS33    [get_ports &#123;seg_data[0]&#125;]
</code></pre>
<h4 id="1-实验结果分析"><a href="#1-实验结果分析" class="headerlink" title="1.实验结果分析"></a>1.实验结果分析</h4><h5 id="模块工作顺序分析"><a href="#模块工作顺序分析" class="headerlink" title="&lt;1&gt;模块工作顺序分析"></a>&lt;1&gt;<strong>模块工作顺序分析</strong></h5><pre><code>    各个模块工作的逻辑顺序如上时钟时序图所示，每条指令执行则可分为m0~3四个阶段。在m0阶段首先由PC发送地址至ROM，然后ROM输出该地址的指令或数据，传送至IR，IR经过简单处理后继续传送至UC，UC产生各个模块的控制信号。在m1~3阶段，依据微程序产生3次控制信号，实现相应指令功能（注意ALU、RN、IO时钟不同，后面有相关解释）。
</code></pre>
<h5 id="​​​指令执行过程分析"><a href="#​​​指令执行过程分析" class="headerlink" title="&lt;2&gt;​​​指令执行过程分析"></a>&lt;2&gt;​​​<strong>指令执行过程分析</strong></h5><ul>
<li><strong><strong>以ADD加法为例：</strong></strong></li>
</ul>
<p><strong><strong>MOV Ri,IO：</strong></strong></p>
<pre><code>    m1~3——执行38H MOV Ri,IO：在m1使能IO相关信号使IO_IN-&gt;REG，在m2时，REG-&gt;DATA_BUS-&gt;Ri（IO的时钟先于RN，使数据在DATA_BUS刚好能传送至RN）
</code></pre>
<p><strong><strong>ADD R0,R1：</strong></strong></p>
<pre><code>    m1~3——执行08H ADD R0,R1：由于无法在计算出结果的同时将结果通过数据总线DATA_BUS传送至RN，所以在一条指令中，我的ADD指令只能实现计算功能，计算结果由ALU另行输出至result总线。在m1和m2分别实现RN-&gt;DATA_BUS-&gt;regA/B（其中regA/B为ALU内部缓冲器），在m3实现计算和UC地址回到00H操作。
</code></pre>
<p><strong><strong>以LED流水灯为例：</strong></strong></p>
<pre><code>    m0——取指令：PC-&gt;ROM-&gt;DATA_BUS-&gt;IR-&gt;UC，微指令为0x003119f37900H

    注意到ROM将地址信息输出到总线，IR接收并传递地址到UC，从而执行24H地址的微程序。
</code></pre>
<p><strong><strong>MOV Ri,#data：</strong></strong></p>
<pre><code>    m1~3——执行24H MOV Ri,#data：在m1将ROM中的立即数输出至
</code></pre>
<p>DATA_BUS，在m2传输至Ri之中，在m3阶段UC地址回到00H准备进入下一条指令，即取值公操作。</p>
<p><strong><strong>MOV IO,Ri：</strong></strong></p>
<pre><code>    m1~3——执行34H MOV IO,Ri：在m1将Ri-&gt;DATA_BUS，在m2，DATA_BUS-&gt;REG-&gt;IO_OUT（REG是IO内暂存器，由于UC控制信号不包含RI_EN和RO_EN，一直使能，即DATA_BUS&lt;-&gt;IO直接完成），在m3阶段UC地址回到00H准备进入下一条指令，即取值公操作。
</code></pre>
<p><strong><strong>JMP addr12</strong></strong><strong><strong>：</strong></strong></p>
<pre><code>    m1~3——执行04H JMP addr12：在m1、m2依次将立即数加载至IR中，对应LD_IR2和LD_IR3分别有效，IR将新地址传送至PC。
</code></pre>
<ul>
<li><strong><strong>以ADD加法为例：</strong></strong></li>
</ul>
<p><strong><strong>MOV Ri,IO：</strong></strong></p>
<pre><code>    m1~3——执行38H MOV Ri,IO：在m1使能IO相关信号使IO_IN-&gt;REG，在m2时，REG-&gt;DATA_BUS-&gt;Ri（IO的时钟先于RN，使数据在DATA_BUS刚好能传送至RN）
</code></pre>
<p><strong><strong>ADD R0,R1：</strong></strong></p>
<pre><code>    m1~3——执行08H ADD R0,R1：由于无法在计算出结果的同时将结果通过数据总线DATA_BUS传送至RN，所以在一条指令中，我的ADD指令只能实现计算功能，计算结果由ALU另行输出至result总线。在m1和m2分别实现RN-&gt;DATA_BUS-&gt;regA/B（其中regA/B为ALU内部缓冲器），在m3实现计算和UC地址回到00H操作。
</code></pre>
<h4 id="2-其他"><a href="#2-其他" class="headerlink" title="2.其他"></a>2.其他</h4><h5 id="SOC-模块集成设计经验"><a href="#SOC-模块集成设计经验" class="headerlink" title="&lt;1&gt;SOC****模块集成设计经验"></a>&lt;1&gt;<strong>SOC****模块集成设计经验</strong></h5><pre><code>    在集成各个组成模块时，为避免总线冲突以及方便调试，采用各个模块依次添加测试的方法。

    首先测试PC、ROM、IR、UC组成的系统，要求取指令时4个模块的运行顺序为：PC发送ROM地址-&gt;ROM输出指令/数据-&gt;IR传送指令-&gt;UC解析执行微程序。随后依次加入IO、RN、ALU、RAM模块进行调试（按照指令执行逻辑顺序）。
</code></pre>
<h5 id="SOC集成关键"><a href="#SOC集成关键" class="headerlink" title="&lt;2&gt;SOC集成关键"></a>&lt;2&gt;<strong>SOC集成关键</strong></h5><p>在集成各个模块时，关键在于：</p>
<ul>
<li><p>清楚模块工作逻辑顺序</p>
<pre><code>需清楚知晓各个模块工作先后关系，理清数据/控制/地址信号流的传递顺序，以避免读写顺序出错，出现写未读到的情况。
</code></pre>
</li>
<li><p>避免总线冲突</p>
<pre><code>主要是DATA_BUS数据总线使用的原子性，各模块严格按照时钟时序进行输出，在允许输出时输入/出数据到数据总线，其他时刻不要忘记将数据总线置高阻态。
</code></pre>
</li>
<li><p>考虑信号的建立、保持</p>
<pre><code>在课程参考资料中，ALU、IO、RN的时钟都是nclk2，但是对于任意一条微指令，如果涉及到上述3个模块的协作,如将RN中数据传送至ALU中缓存器regA，由于时钟相同，且都在上升沿工作，则在同一时刻，RN中数据传输到数据总线，上一时刻数据总线的数值传送至regA，并不能实现RN-&gt;DATA_BUS-&gt;regA这一连贯操作。

解决方法在于错开操作时间，即RN-&gt;DATA_BUS先于DATA_BUS-&gt;regA，需要修改模块时钟，故出现了上面仿真图中的时钟。
</code></pre>
</li>
</ul>
<p>&lt;3&gt;反思与改进</p>
<ul>
<li><p>对数据不能在总线上连续传递的思考</p>
<pre><code>考虑上面“考虑信号的建立、保持”部分产生的问题，问题产生的原因在于组合逻辑电路和时序逻辑电路的区别，如果将信号的触发条件由时钟的上升沿改为高电平（类似于使能信号），则将时序逻辑转变为组合逻辑，可能解决上述问题，使得ALU、IO、RN等模块的时钟可以都是nclk2。
</code></pre>
</li>
<li><p>ADD指令的改进</p>
<pre><code>上述实现的ADD指令在有限的m1~3阶段内计算完结果无法实现结果存储至RN（在上面ADD指令时序图可观测到计算结果曾短时间内输出到数据总线DATA_BUS上），仅一个指令周期无法实现，可以扩展成两个，即在第二个指令周期的m0~3阶段实现指令存储至RN。
</code></pre>
</li>
</ul>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/999503810dc63f0f906be47e3bbaca66.png"></p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/139143519">https://blog.csdn.net/qq_32971095/article/details/139143519</a>，如有侵权，请联系删除。</p>

    </div>

    
    
    

    
      <div>
        
<div>
    
        <div style="text-align:center;color: #ccc;font-size:24px;">
            <center><i>> --------------- THE END -------------- <</i></center>
        </div>
    
</div>
      </div>
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/fpga%E5%BC%80%E5%8F%91/" rel="tag"># fpga开发</a>
              <a href="/tags/%E4%BD%9C%E4%B8%9A%E8%A7%A3%E7%AD%94/" rel="tag"># 作业解答</a>
              <a href="/tags/cpu/" rel="tag"># cpu</a>
              <a href="/tags/vhdl/" rel="tag"># vhdl</a>
              <a href="/tags/soc/" rel="tag"># soc</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/04/14/%E9%9A%8F%E7%AC%94/%E6%80%9D%E8%80%83/%E4%BA%BA%E5%BF%83%E4%B8%8D%E8%B6%B3%E8%9B%87%E5%90%9E%E8%B1%A1/" rel="prev" title="人心不足蛇吞象">
      <i class="fa fa-chevron-left"></i> 人心不足蛇吞象
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/05/25/%E9%9A%8F%E7%AC%94/%E5%A4%A7%E5%AD%A6/%E5%86%99%E5%AE%8C%E6%8A%A5%E5%91%8A%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6%E4%B9%8B%E5%90%8E/" rel="next" title="写完报告发送邮件之后">
      写完报告发送邮件之后 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-%E7%BA%BF%E4%B8%8B%E5%AE%9E%E9%AA%8C"><span class="nav-number">1.</span> <span class="nav-text">二.线下实验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E8%84%9A%E7%BB%91%E5%AE%9A%E6%A8%A1%E7%89%88"><span class="nav-number">1.1.</span> <span class="nav-text">管脚绑定模版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%A8%A1%E5%9D%97%E6%A8%A1%E7%89%88"><span class="nav-number">1.2.</span> <span class="nav-text">通用模块模版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">1.3.</span> <span class="nav-text">注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%B7%91%E9%A9%AC%E7%81%AF%E6%8E%A7%E5%88%B6%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.4.</span> <span class="nav-text">1.跑马灯控制设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-%E4%BD%8D%E5%B9%B6%E8%A1%8C%E5%85%A8%E5%8A%A0%E5%99%A8%E8%AE%BE%E8%AE%A1-%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.5.</span> <span class="nav-text">2.8 位并行全加器设计+数码管显示程序设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B5%E5%88%97%E4%B9%98%E6%B3%95%E5%99%A8%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.6.</span> <span class="nav-text">3.阵列乘法器设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA-FIFO-%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.7.</span> <span class="nav-text">4.先进先出 FIFO 的设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-PC-%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.8.</span> <span class="nav-text">5.PC 程序计数器设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E7%A8%8B%E5%BA%8F%E5%AD%98%E5%82%A8%E5%99%A8-ROM-%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.9.</span> <span class="nav-text">6.程序存储器 ROM 设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E5%8A%A0%E5%87%8F%E4%BA%A4%E6%9B%BF%E9%99%A4%E6%B3%95%E5%99%A8"><span class="nav-number">1.10.</span> <span class="nav-text">7.加减交替除法器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E6%8C%87%E4%BB%A4%E5%AD%98%E5%82%A8%E5%99%A8-IR-%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.11.</span> <span class="nav-text">8.指令存储器 IR 设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-%E5%AF%84%E5%AD%98%E5%99%A8-RN-%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.12.</span> <span class="nav-text">9.寄存器 RN 设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-ALU%E7%AE%97%E6%9C%AF%E9%80%BB%E8%BE%91%E5%8D%95%E5%85%83%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.13.</span> <span class="nav-text">10.ALU算术逻辑单元设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%99%A8-RAM-%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.14.</span> <span class="nav-text">11.数据存储器 RAM 设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-%E5%A0%86%E6%A0%88%E6%8C%87%E9%92%88-SP-%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.15.</span> <span class="nav-text">12.堆栈指针 SP 设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-%E9%87%87%E7%94%A8%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80%E8%AF%AD%E8%A8%80%E8%AE%BE%E8%AE%A1-IO-%E6%A8%A1%E5%9D%97"><span class="nav-number">1.16.</span> <span class="nav-text">13.采用硬件描述语言语言设计 IO 模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.17.</span> <span class="nav-text">14.微控制器设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-8-%E4%BD%8D-SOC-%E7%BB%BC%E5%90%88%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.18.</span> <span class="nav-text">15.8 位 SOC 综合设计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90"><span class="nav-number">1.18.1.</span> <span class="nav-text">1.实验结果分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E5%B7%A5%E4%BD%9C%E9%A1%BA%E5%BA%8F%E5%88%86%E6%9E%90"><span class="nav-number">1.18.1.1.</span> <span class="nav-text">&lt;1&gt;模块工作顺序分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%80%8B%E2%80%8B%E2%80%8B%E6%8C%87%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-number">1.18.1.2.</span> <span class="nav-text">&lt;2&gt;​​​指令执行过程分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%85%B6%E4%BB%96"><span class="nav-number">1.18.2.</span> <span class="nav-text">2.其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SOC-%E6%A8%A1%E5%9D%97%E9%9B%86%E6%88%90%E8%AE%BE%E8%AE%A1%E7%BB%8F%E9%AA%8C"><span class="nav-number">1.18.2.1.</span> <span class="nav-text">&lt;1&gt;SOC****模块集成设计经验</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SOC%E9%9B%86%E6%88%90%E5%85%B3%E9%94%AE"><span class="nav-number">1.18.2.2.</span> <span class="nav-text">&lt;2&gt;SOC集成关键</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SWQ"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">SWQ</p>
  <div class="site-description" itemprop="description">舟遥遥以轻扬，风飘飘而吹衣</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">213</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xidianswq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xidianswq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/qq_32971095" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_32971095" rel="noopener" target="_blank"><i class="fa fa-link fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qm.qq.com/q/fJkfzkochO" title="QQ → https:&#x2F;&#x2F;qm.qq.com&#x2F;q&#x2F;fJkfzkochO" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
      <span class="links-of-author-item">
        <a href="/3209507800@qq.com" title="E-Mail → 3209507800@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/348651384" title="bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;348651384" rel="noopener" target="_blank"><i class="fa fa-tv fa-fw"></i>bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/profiles/76561199188319035/" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;profiles&#x2F;76561199188319035&#x2F;" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://c6.y.qq.com/base/fcgi-bin/u?__=sZVdegbNTeC3" title="Music → https:&#x2F;&#x2F;c6.y.qq.com&#x2F;base&#x2F;fcgi-bin&#x2F;u?__&#x3D;sZVdegbNTeC3" rel="noopener" target="_blank"><i class="fa fa-music fa-fw"></i>Music</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1309889000&auto=1&height=66"></iframe>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021-8 ~ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SWQ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">22:06</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

<script src="/js/floating-history.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'H2FYHQwVGaUkawg5DkrA6d6M-gzGzoHsz',
      appKey     : 'zndS0u9Qj7qj8CqnJINs2MGT',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : 'https://h2fyhqwv.lc-cn-n1-shared.com'
    });
  }, window.Valine);
});
</script>


  <script async src="/js/cursor/fireworks.js"></script>


<script>
  (function() {
    var guard = window.__SITE_PASSWORD_GUARD__;
    var overlay = document.getElementById('password-protect');
    var input = document.getElementById('site-password-input');
    var submit = document.getElementById('site-password-submit');
    var errorEl = document.getElementById('site-password-error');

    if (!guard || guard.enabled === false || !guard.password) {
      if (overlay) {
        overlay.setAttribute('aria-hidden', 'true');
        if (typeof overlay.remove === 'function') {
          overlay.remove();
        } else {
          overlay.style.display = 'none';
        }
      }
      return;
    }

    var PASSWORD = String(guard.password || '');
    var storageKey = guard.storageKey;
    var docEl = document.documentElement;

    if (!overlay || !input || !submit || !errorEl) {
      return;
    }

    var unlocked = docEl.classList.contains('content-unlocked');
    overlay.setAttribute('aria-hidden', unlocked ? 'true' : 'false');

    if (unlocked) {
      return;
    }

    function showError(message) {
      errorEl.textContent = message || '';
    }

    function unlockSite() {
      docEl.classList.remove('content-locked');
      docEl.classList.add('content-unlocked');
      overlay.setAttribute('aria-hidden', 'true');
      showError('');
      try {
        window.localStorage && localStorage.setItem(storageKey, '1');
      } catch (err) {
        // Ignore storage failures.
      }
      if (typeof overlay.remove === 'function') {
        overlay.remove();
      } else {
        overlay.style.display = 'none';
      }
    }

    function validatePassword() {
      var value = (input.value || '').trim();
      if (!value) {
        showError('请输入密码');
        input.focus();
        return;
      }
      if (value.toLowerCase() === PASSWORD.toLowerCase()) {
        unlockSite();
      } else {
        showError('密码错误，请重试');
        input.value = '';
        input.focus();
      }
    }

    submit.addEventListener('click', validatePassword);
    input.addEventListener('keydown', function(event) {
      if (event.key === 'Enter') {
        event.preventDefault();
        validatePassword();
      }
    });
    input.addEventListener('input', function() {
      if (errorEl.textContent) {
        showError('');
      }
    });

    setTimeout(function() {
      input.focus();
    }, 100);
  })();
</script>
</body>
</html>
