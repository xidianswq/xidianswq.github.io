<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://googlefonts.cn//css?family=Zhi Mang Xing:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="目录 一.TFT_LCD液晶屏驱动设计 &lt;1&gt;简介 （1）HV同步模式 （2）DE同步模式 （3）整体设计 （4）TFT_LCD显示时序控制模块 &lt;2&gt;程序设计 （1）tft_ctrl时序控制模块 （2）tft_pic图像数据生成模块 （3）顶层模块 二.TFT_LCD液晶屏字符显示  前置学习：基础设计四——FPGA学习笔记＜5＞ 参考书目：《野火FPGA Verilog">
<meta property="og:type" content="article">
<meta property="og:title" content="基础设计五（LCD液晶屏）——FPGA学习笔记＜6＞">
<meta property="og:url" content="http://example.com/2023/09/22/%E5%9F%BA%E7%A1%80%E8%AE%BE%E8%AE%A1%E4%BA%94%EF%BC%88LCD%E6%B6%B2%E6%99%B6%E5%B1%8F%EF%BC%89%E2%80%94%E2%80%94FPGA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9C6%EF%BC%9E/index.html">
<meta property="og:site_name" content="Switch">
<meta property="og:description" content="目录 一.TFT_LCD液晶屏驱动设计 &lt;1&gt;简介 （1）HV同步模式 （2）DE同步模式 （3）整体设计 （4）TFT_LCD显示时序控制模块 &lt;2&gt;程序设计 （1）tft_ctrl时序控制模块 （2）tft_pic图像数据生成模块 （3）顶层模块 二.TFT_LCD液晶屏字符显示  前置学习：基础设计四——FPGA学习笔记＜5＞ 参考书目：《野火FPGA Verilog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/04aad9b1d62ffc8693a9159fb2d578e2.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ee839d4f5ecd6d1c464881b3eab8c9c8.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/b65511792bc354ef74f41f3eab264275.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/85f0ba7e67fa5041c85a60eb8f1c4b9b.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/a3bc25151b07fb4648b1983e0db34119.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/579146b7878cc098a77520661a25946a.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/0a9b704cd1bbef34a9ecc533fad44b6a.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/5df55d88953d7318baf258bb3c1bf1e1.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/1d9aa3aacb3968321f308fffdf71b364.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/645cd28fbf833e74cfc1158207c39f1d.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/cd6c4b16e73cda79cdd0afbd07e55fab.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/22580f39319a512293811631cfebc085.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/e499e6c45177b382ec604cfeb1deb1b7.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/e57208bdc5c5038da15c114148fd918c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/f64e56c6d4b2cd677cd62e5c1be2d54c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/2630498c7621e301628c2bc304db7555.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/fa324114eb35f5f9a972e8acd3dc394d.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/609d72183797781aa1c69af398211a21.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/c1e2fbf4f6bc0fd18607c3d53df7d87f.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/6e497f9c789be6e30f8f2d095897aeef.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/d168edbc88ab3e3d9e0d0242a1119154.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/0997f4cd9124ba9a8c00f4b586e9d227.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/657603b593b0d744497cd255c77a7f32.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/d58f5808c61fc77af64e60a14708137c.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/1ff106cc7206516eb925a0af0c62929b.png">
<meta property="article:published_time" content="2023-09-22T08:14:34.000Z">
<meta property="article:modified_time" content="2025-02-08T03:45:06.164Z">
<meta property="article:author" content="SWQ">
<meta property="article:tag" content="None">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i-blog.csdnimg.cn/blog_migrate/04aad9b1d62ffc8693a9159fb2d578e2.png">

<link rel="canonical" href="http://example.com/2023/09/22/%E5%9F%BA%E7%A1%80%E8%AE%BE%E8%AE%A1%E4%BA%94%EF%BC%88LCD%E6%B6%B2%E6%99%B6%E5%B1%8F%EF%BC%89%E2%80%94%E2%80%94FPGA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9C6%EF%BC%9E/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>基础设计五（LCD液晶屏）——FPGA学习笔记＜6＞ | Switch</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Switch</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">27</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">41</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/22/%E5%9F%BA%E7%A1%80%E8%AE%BE%E8%AE%A1%E4%BA%94%EF%BC%88LCD%E6%B6%B2%E6%99%B6%E5%B1%8F%EF%BC%89%E2%80%94%E2%80%94FPGA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9C6%EF%BC%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="SWQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Switch">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          基础设计五（LCD液晶屏）——FPGA学习笔记＜6＞
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-22 16:14:34" itemprop="dateCreated datePublished" datetime="2023-09-22T16:14:34+08:00">2023-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-08 11:45:06" itemprop="dateModified" datetime="2025-02-08T11:45:06+08:00">2025-02-08</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>21k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>19 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>目录</strong></p>
<p><a href="about:blank#%E4%B8%80.TFT_LCD%20%E6%B6%B2%E6%99%B6%E5%B1%8F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1">一.TFT_LCD<br>液晶屏驱动设计</a></p>
<p><a href="about:blank#%3C1%3E%E7%AE%80%E4%BB%8B">&lt;1&gt;简介</a></p>
<p><a href="about:blank#%EF%BC%881%EF%BC%89HV%20%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F">（1）HV<br>同步模式</a></p>
<p><a href="about:blank#%EF%BC%882%EF%BC%89DE%20%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F">（2）DE<br>同步模式</a></p>
<p><a href="about:blank#%EF%BC%883%EF%BC%89%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1">（3）整体设计</a></p>
<p><a href="about:blank#%EF%BC%884%EF%BC%89TFT_LCD%20%E6%98%BE%E7%A4%BA%E6%97%B6%E5%BA%8F%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9D%97">（4）TFT_LCD<br>显示时序控制模块</a></p>
<p><a href="about:blank#%3C2%3E%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">&lt;2&gt;程序设计</a></p>
<p><a href="about:blank#%EF%BC%881%EF%BC%89tft_ctrl%20%E6%97%B6%E5%BA%8F%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9D%97">（1）tft_ctrl<br>时序控制模块</a></p>
<p><a href="about:blank#%EF%BC%882%EF%BC%89tft_pic%C2%A0%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E6%A8%A1%E5%9D%97">（2）tft_pic<br>图像数据生成模块</a></p>
<p><a href="about:blank#%EF%BC%883%EF%BC%89%E9%A1%B6%E5%B1%82%E6%A8%A1%E5%9D%97">（3）顶层模块</a></p>
<p><a href="about:blank#%E4%BA%8C.TFT_LCD%20%E6%B6%B2%E6%99%B6%E5%B1%8F%E5%AD%97%E7%AC%A6%E6%98%BE%E7%A4%BA">二.TFT_LCD<br>液晶屏字符显示</a></p>
<hr>
<p>前置学习：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/132993678?spm=1001.2014.3001.5501" title="基础设计四——FPGA学习笔记＜5＞">基础设计四——FPGA学习笔记＜5＞</a></p>
<p>参考书目：《<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%87%8E%E7%81%AB&spm=1001.2101.3001.7020" title="野火">野火</a><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=FPGA&spm=1001.2101.3001.7020" title="FPGA">FPGA</a> Verilog 开发实战指南》</p>
<h2 id="一-TFT-LCD-液晶屏驱动设计"><a href="#一-TFT-LCD-液晶屏驱动设计" class="headerlink" title="一.TFT_LCD 液晶屏驱动设计"></a>一.TFT_LCD 液晶屏驱动设计</h2><h3 id="简介"><a href="#简介" class="headerlink" title="&lt;1&gt;简介"></a>&lt;1&gt;简介</h3><p>液晶是一种介于固体和液体之间的特殊物质，它是一种有机化合物，常态下呈液态， 但是它的分子排列却和固体晶体一样非常规则，因此取名液晶。如果给液晶施加电场，会<br>改变它的分子排列，从而改变光线的传播方向，配合偏振光片，它就具有控制光线透过率<br>的作用，再配合彩色滤光片，改变加给液晶电压大小，就能改变某一颜色透光量的多少。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/04aad9b1d62ffc8693a9159fb2d578e2.png"></p>
<p>​</p>
<pre><code>    ​常见的 LCD 按物理结构分为四种：扭曲向列型（TN－Twisted NemaTIc）、超扭曲向列型（ STN － Super TN ） 、 双层超扭曲向列型 （ DSTN － Dual Scan Tortuosity Nomograph）、薄膜晶体管型（TFT－Thin Film Transistor）。

    TN－LCD、STN－LCD 和 DSYN－LCD 的基本显示原理都相同，只是液 晶分子的扭曲角度不同而已。而 TFT－LCD 则采用与 TN 系列 LCD 截然不同的显示方式。 TFT-LCD 全称 Thin Film Transistor-Liquid Crystal Display，译为薄膜晶体管液晶显示器。其中 TFT 就是 Thin Film Transistor 的简称，指的是薄膜晶体管（矩阵），可以“主动 的”对屏幕上的各个独立的像素进行控制，这也就是所谓的主动矩阵 TFT（active matrix TFT）的来历。图像产生的基本原理很简单：**显示屏由许多可以发出任意颜色的光线的像素组成** ，只要控制各个像素显示相应的颜色就能达到目的了。在 TFT LCD 中一般采用背光 技术，为了能精确地控制每一个像素的颜色和亮度就需要**在每一个像素之后安装一个类似百叶窗的半导体开关** ，以此做到完全的单独的控制一个像素点，液晶材料被夹在 TFT 玻璃层和颜色过滤层之间，通过改变刺激液晶的电压值就可以控制最后出现的光线强度与色彩。

    RGB 接口 TFT-LCD 时序 对于 RGB 接口 TFT-LCD 显示屏，它的图像显示的同步模式有两种，分别为 HV 同步模式、DE 同步模式。不同的同步模式对应不同的时序。
</code></pre>
<h4 id="（1）HV-同步模式"><a href="#（1）HV-同步模式" class="headerlink" title="（1）HV 同步模式"></a>（1）HV 同步模式</h4><pre><code>    HV 同步模式下，图像的显示只需要行同步信号(hsync)和场同步信号(vsync)来确定显示时序。此时，RGB 接口的 TFT-LCD 液晶显示屏的显示时序和 VGA 时序标准类似。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ee839d4f5ecd6d1c464881b3eab8c9c8.png">​</p>
<pre><code>    如图 30-3 所示，图中 RGB 代表图像信息，HSync 表示行同步信号，HSync 自上一个上升沿起到下一个上升沿止为一个完整周期，我们称之为**行扫描周期** ，一个完整的行扫描周期，包含 4 部分：**同步、后沿、有效图像、前沿** ，**基本单位为 pixel** ，即一个像素时钟周期。 在一个完整的行扫描周期中，RGB 图像信息在 HSync 行同步信号的同步下**完成一行图像的显示** ，RGB 图像信息在有效图像阶段，图像信息有效，其他阶段图像信息无效； HSync 行同步信号在同步阶段，维持高电平，其他阶段均保持低电平，在下一个行扫描周期的同步阶段，HSync 行扫描信号拉高，其他阶段拉低，周而复始。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b65511792bc354ef74f41f3eab264275.png">​</p>
<pre><code>    如图 30-4 所示，图中 RGB 代表图像信息，VSync 表示场同步信号，VSync 自上一个上升沿起到下一个上升沿止为一个完整周期，我们称之为**场扫描周期** ，一个完整的行扫描周期，包含 4 部分：**同步、后沿、有效图像、前沿** ，基本单位为一个完整的**行扫描周期** 。 在一个完整的行扫描周期中，RGB 图像信息在 VSync 行同步信号的同步下**完成一帧图像的显示** ，RGB 图像信息在有效图像阶段，图像信息有效，其他阶段图像信息无效； VSync 行同步信号在同步阶段，维持高电平，其他阶段均保持低电平，在下一个行扫描周 期的同步阶段，VSync 行扫描信号拉高，其他阶段拉低，周而复始。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/85f0ba7e67fa5041c85a60eb8f1c4b9b.png">​</p>
<pre><code>    图中的红色区域表示在一个完整的行扫描周期中，RGB 图像信息只在此区域有效；黄 色区域表示在一个完整的场扫描周期中，RGB 图像信息只在此区域有效，两者相交的橙色区域，就是 RGB 接口 TFT-LCD 显示屏的图像显示区域。
</code></pre>
<h4 id="（2）DE-同步模式"><a href="#（2）DE-同步模式" class="headerlink" title="（2）DE 同步模式"></a>（2）DE 同步模式</h4><pre><code>    DE 同步模式下，图像的显示只需要数据使能信号确定显示时序，不需要行场同步信号。DE 同步模式下的 TFT 图像显示时序图如下。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/a3bc25151b07fb4648b1983e0db34119.png"></p>
<pre><code>    由图可知，当数据使能信号为高电平时，表示 TFT 显示屏扫描到了有效显示区域，此时输入到 TFT 显示屏的图像信息能够显示出来；当数据使能信号为低电平时，表示 TFT 显 示屏未扫描到有效显示区域。         

    对于两种不同的同步模式， DE 同步模式一般使用在大尺寸屏幕，小尺寸屏幕多使用 HV 同步模式。HV 同步模式地出现早于 DE 同步模式，当今的大部分显示屏均支持 HV 和 DE 两种同步模式。

    RGB 接口 TFT-LCD 分辨率 不同的分辨率的 TFT-LCD 显示屏在时序上是相似的，只是存在一些参数上的差异，**下面列举了部分分辨率的时序参数** ，刷新频率均为 60Hz
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/579146b7878cc098a77520661a25946a.png">**<br>**</p>
<h4 id="（3）整体设计"><a href="#（3）整体设计" class="headerlink" title="（3）整体设计"></a>（3）整体设计</h4><pre><code>    设计编写 RGB 接口 TFT-LCD 液晶显示屏驱动，在 4.3 寸(480*272) TFT-LCD 显示屏上 横向依次显示等宽多色彩条，显示颜色自左向右依次为红、橙、黄、绿、青、蓝、紫、 黑、白、灰，图像像素格式为 RGB565，帧率为 60Hz。
</code></pre>
<p>注：本章节后文中涉及到的相关参数均与 <strong>4.3 寸(480*272)</strong> TFT-LCD 显示屏的的相关参数相对应，事先告知，后续不再声明。</p>
<p>升腾 mini 开发板 TFT_LCD 接口部分原理图：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0a9b704cd1bbef34a9ecc533fad44b6a.png"></p>
<p>注：在本实验工程中，输出信号中包含 <strong>HV 同步模式下需要的行、场同步信号 (hsync、vsync)和 DE 同步模式下的 tft_de 信号</strong><br>，各信号正确输出。读者<strong>若想要使用 HV 同 步模式进行图像显示，可在代码中注释掉 tft_de 信号；若想要使用 DE 同步模式进行图像<br>显示，可带代码中注释掉行、场同步信号。</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/5df55d88953d7318baf258bb3c1bf1e1.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1d9aa3aacb3968321f308fffdf71b364.png"></p>
<pre><code>    TFT 彩条显示工程的工作流程。
</code></pre>
<p>(1) 系统上电后，板卡传入系统时钟(sys_clk)和复位信号(sys_rst_n)到顶层模块；</p>
<p>(2) 系统时钟直接传入时钟生成模块(clk_gen)，分频产生 TFT 显示屏工作时钟 (clk_in)，作为图像数据生成模块(tft_pic)和 TFT<br>时序控制模块(tft_ctrl)的工作时 钟；</p>
<p>(3) 图像数据生成模块<strong>以 TFT<br>显示时序控制模块传入的像素点坐标(pix_x,pix_y)为约束条件，生成待显示彩条图像的色彩信息(pix_data)</strong> ；</p>
<p>(4) 图像数据生成模块生成的彩条图像色彩信息传入 TFT 时序控制模块，在模块内部使用使能信号滤除掉非图像显示有效区域的图像数据，产生 RGB 色彩信息<br>(rgb_tft)，在行、场同步信号(hsync、vsync)或数据使能信号(tft_de)的同步作用下，将 RGB 色彩信息扫描显示到 TFT<br>显示屏，显示出彩条图像。</p>
<h4 id="（4）TFT-LCD-显示时序控制模块"><a href="#（4）TFT-LCD-显示时序控制模块" class="headerlink" title="（4）TFT_LCD 显示时序控制模块"></a>（4）TFT_LCD 显示时序控制模块</h4><p><img src="https://i-blog.csdnimg.cn/blog_migrate/645cd28fbf833e74cfc1158207c39f1d.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/cd6c4b16e73cda79cdd0afbd07e55fab.png"></p>
<pre><code>    data_in 为彩条图像 像素点色彩信息，由图像数据生成模块产生并传入，在 TFT_LCD 显示器有效图像显示区域赋值给信号 RGB 图像色彩信息(rgb_tft_16b)。

    输出信号(pix_x,pix_y)为 TFT_LCD 有效显示区域像素点坐标，由 TFT_LCD 时序控制模块生并传入图像数据生成模块；hsync、vsync 为 TFT_LCD 行、场同步信号 ，通过 TFT_LCD 接口传输给 TFT_LCD 显示屏；rgb_tft_16b 为显示器要显示的图像色彩信息，传输给 TFT_LCD 显示器；tft_bl 为 TFT 显示屏背光信号；tft_clk 为 TFT 显示屏工作时钟； tft_de 为 TFT 显示使能信号。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/22580f39319a512293811631cfebc085.png"></p>
<p>**<br>第一部分**：行同步信号(hsync)、场同步信号(vsync)。由时序图可知，<strong>行同步信号为周期性信号，信号变化周期为完整的行扫描周期</strong><br>，信号在同步阶段保持高电平，在其他阶段保持低电平，那么如何实现行同步信号的周期性变化呢？ 我们想到了前文学过的计数器，因为一个完整行扫描周期为 <strong>525<br>个像素时钟周期 (480*272@60，见前表格)</strong> ，我们可以利用计数器以像素时钟周期进行计数，每一个像素时钟周期自加 1，计数范围为<br>0-524，共计数 525 次，与完整行扫描周期数相吻合。<strong>只要在行同步阶段(计数范围 0-40)赋值 hsync<br>信号为高电平，其他阶段为低电平，就可以实现符合时序要求的行同步信号 hsync</strong> 。根据此设计思路，声明并绘制行扫描周期计数器 cnt_h、行同步信号<br>hsync 信号波形如下：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e499e6c45177b382ec604cfeb1deb1b7.png"></p>
<pre><code>    同理，参考行同步信号波形的绘制思路，我们可以进行场同步信号波形的绘制。不过要注意的是，**场扫描周期单位不是像素时钟周期，而是完整的行扫描周期** ，所以要**添加场扫描周期计数器对行扫描周期进行计数（再525分频）** ，声明并绘制场扫描周期计数器 cnt_v、场同步信号 vsync 信号波形如下：
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e57208bdc5c5038da15c114148fd918c.png"></p>
<pre><code>   **  第二部分**：图像显示有效信号(data_valid)波形绘制思路由上文可知，TFT 显示屏只有在有效的显示区域内送入图像数据，图像才会被正确显示。我们可以声明一个有效信号，在图像有效显示区域赋值高电平，在非图像有效显示区域赋值低电平，以此信号为约束条件，控制图像信号的正确输入，定义此信号为图像显示有效信号(rgb_valid)。 这里我们可以利用上一部分声明的 cnt_h、cnt_v 两个计数器，以其为约束条件，**当两个计数器计数到图像有效显示区域时，data_valid 赋值高电平** ，否则赋值低电平。绘制图像显示有效信号(data_valid)波形如下：
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/f64e56c6d4b2cd677cd62e5c1be2d54c.png"></p>
<p>**         第三部分**：图像信息请求信号(data_req)、TFT 显示屏有效显示区域像素点坐标<br>(pix_x,pix_y)波形绘制思路为了<strong>提高模块复用性</strong> ，我们将图像数据生成功能独立出来，设计为图像数据生成模块 <strong>tft_pic</strong><br>，虽然模块复用性提高，但这样就产生一个问题，怎样保证 data_in 传输的图像数据与 TFT 显示屏时序相吻合呢？</p>
<pre><code>    结合之前学习的知识，我们知道只有在 TFT 显示屏有效显示区域，data_in 传输的图像数据才会传输给 TFT 显示屏，那么我们可以**只在 TFT 显示屏有效显示区域对 data_in 进行赋值** ，如何实现这一想法呢？

    我们可以使用 cnt_h、cnt_v 信号来确定 TFT 显示屏有效显示区域，将有效显示区域使用坐标法表示，针对不同坐标点**对 data_in 进行赋值** ，所以我们声明 TFT 显示屏有效显示区域像素点坐标(pix_x,pix_y)。

    上面两个问题解决了，新的问题又来了，TFT 显示屏有效显示区域为 480*272，如何 使像素点坐标(pix_x,pix_y)实现(0,0) – (480,272)的坐标计数？ 读者可能会想到使用已经声明的图像显示有效信号(data_valid)，但在此处不能使用该信号。

    因为本次实验是 TFT 显示屏多色彩条的显示，**图像数据生成模块 tft_pic 需要以坐标 (pix_x,pix_y)为约束条件对 data_in 信号进行赋值，只能使用时序逻辑的赋值方式，那么 data_in 的赋值时刻会滞后条件满足时刻一个时钟周期，显示图像会出现问题** 。

    为了解决这一问题，我们需要声明新的图像数据请求信号 **data_req** ，该信号要**超前图像显示有效信号(data_valid)一个时钟周期，以抵消 data_in 时序逻辑赋值带来的问题** 。 综上所述，我们需要声明图像信息请求信号 data_req、TFT 显示屏有效显示区域像素点坐标(pix_x,pix_y)这三路信号来解决之前提到的若干问题。对于 data_req 信号的电平控制可参考 data_valid 信号的控制方式，以 cnt_h、cnt_v 信号为约束条件；坐标(pix_x,pix_y)则 以新声明的 data_req 信号为约束条件控制生成，三路信号绘制波形图如下：
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2630498c7621e301628c2bc304db7555.png"></p>
<pre><code>    **第四部分** ：RGB 色彩信息(rgb_tft_16b)波形绘制思路这一部分就比较简单了，TFT 显示屏图像显示是在行、场同步信号的作用下，将图像色彩信息以扫描显示的方式显示出来，所以 RGB 色彩信息必不可少，只要在有效显示区域写入正确图像数据即可。信号 rgb_tft_16b 绘制波形如下：
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/fa324114eb35f5f9a972e8acd3dc394d.png"></p>
<pre><code>    **第五部分** ： TFT 显示数据使能信号(tft_de)波形绘制思路数据使能信号为 DE 同步模式下的图像显示同步信号，只在有效图像显示区域为高电平，其他时刻为低电平。tft_de 信号的波形变化和 data_valid 信号相同，所以 tft_de 信号可 由 data_valid 信号使用组合逻辑进行赋值。数据使能信号(tft_de)波形如下图。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/609d72183797781aa1c69af398211a21.png"></p>
<pre><code>    **第六部分** ： TFT 显示屏工作时钟(tft_clk)、TFT 显示屏背光信号(tft_bl)波形绘制思路 TFT 显示屏与 VGA 显示器不同，TFT 显示屏的正常工作离不开时钟信号，而且输入 TFT 显示屏的时钟信号，要与行场信号或数据使能信号的同步时钟相同，否者会出现图像显示的错误。 TFT 显示屏的背光信号作用是控制显示屏背光，为高电平时打开显示器背光，低电平时关闭背光，在本实验工程使用复位信号 sys_rst_n 信号为背光信号赋值。 上述两信号波形图如下。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/c1e2fbf4f6bc0fd18607c3d53df7d87f.png"></p>
<pre><code>    本设计思路只做参考，并非唯一方法，读者可利用所学知识，按照自己思路进行设计。 
</code></pre>
<h3 id="程序设计"><a href="#程序设计" class="headerlink" title="&lt;2&gt;程序设计"></a>&lt;2&gt;程序设计</h3><h4 id="（1）tft-ctrl-时序控制模块"><a href="#（1）tft-ctrl-时序控制模块" class="headerlink" title="（1）tft_ctrl 时序控制模块"></a>（1）tft_ctrl 时序控制模块</h4><pre><code>module  tft_ctrl
(
    input   wire            clk_in      ,   //输入时钟
    input   wire            sys_rst_n   ,   //系统复位,低电平有效
    input   wire    [15:0]  data_in     ,   //待显示数据

    output  wire            data_req    ,   //数据请求信号
    output  wire    [10:0]  pix_x       ,   //输出TFT有效显示区域像素点X轴坐标
    output  wire    [10:0]  pix_y       ,   //输出TFT有效显示区域像素点Y轴坐标
    output  wire    [15:0]  rgb_tft_16b ,   //TFT显示数据
    output  wire    [23:0]  rgb_tft_24b ,   //TFT显示数据
    output  wire            hsync       ,   //TFT行同步信号
    output  wire            vsync       ,   //TFT场同步信号
    output  wire            tft_clk     ,   //TFT像素时钟
    output  wire            tft_de      ,   //TFT数据使能
    output  wire            tft_bl          //TFT背光信号
);

//********************************************************************//
//****************** Parameter and Internal Signal *******************//
//********************************************************************//

//parameter define  5寸、七寸屏
// parameter   H_SYNC      =   11&#39;d34  ,   //行同步
            // H_BACK      =   11&#39;d46  ,   //行时序后沿
            // H_LEFT      =   11&#39;d0   ,   //行时序左边框
            // H_VALID     =   11&#39;d800 ,   //行有效数据
            // H_RIGHT     =   11&#39;d0   ,   //行时序右边框
            // H_FRONT     =   11&#39;d210 ,   //行时序前沿
            // H_TOTAL     =   11&#39;d1090;   //行扫描周期
            
// parameter   V_SYNC      =   11&#39;d10  ,   //场同步
            // V_BACK      =   11&#39;d23  ,   //场时序后沿
            // V_TOP       =   11&#39;d0   ,   //场时序左边框
            // V_VALID     =   11&#39;d480 ,   //场有效数据
            // V_BOTTOM    =   11&#39;d0   ,   //场时序右边框
            // V_FRONT     =   11&#39;d22  ,   //场时序前沿
            // V_TOTAL     =   11&#39;d535 ;   //场扫描周期
//parameter define  4.3寸屏
parameter H_SYNC    =   10&#39;d41  ,   //行同步
          H_BACK    =   10&#39;d2   ,   //行时序后沿
          H_LEFT    =   11&#39;d0   ,   //行时序左边框
          H_VALID   =   10&#39;d480 ,   //行有效数据
          H_FRONT   =   10&#39;d2   ,   //行时序前沿
          H_RIGHT   =   11&#39;d0   ,   //行时序右边框
          H_TOTAL   =   10&#39;d525 ;   //行扫描周期
parameter V_SYNC    =   10&#39;d10  ,   //场同步
          V_BACK    =   10&#39;d2   ,   //场时序后沿
          V_TOP     =   11&#39;d0   ,   //场时序左边框
          V_VALID   =   10&#39;d272 ,   //场有效数据
          V_FRONT   =   10&#39;d2   ,   //场时序前沿
          V_BOTTOM  =   11&#39;d0   ,   //场时序右边框
          V_TOTAL   =   10&#39;d286 ;   //场扫描周期
                                                                                                                                            
parameter   H_PIXEL     =   11&#39;d480 ,   //水平方向有效图像像素个数
            V_PIXEL     =   11&#39;d272 ;   //垂直方向有效图像像素个数
parameter   H_BLACK     =   ((H_VALID - H_PIXEL) / 2),  //水平方向黑色边框宽度
            V_BLACK     =   ((V_VALID - V_PIXEL) / 2);  //垂直方向黑色边框宽度

//wire  define
wire            data_valid  ;   //有效显示区域标志
wire    [15:0]  data_out    ;   //输出有效图像数据
wire    [7:0]   rgb_r;
wire    [7:0]   rgb_g;
wire    [7:0]   rgb_b;

//reg   define
reg     [10:0]   cnt_h       ;   //行扫描计数器
reg     [10:0]   cnt_v       ;   //场扫描计数器

//********************************************************************//
//***************************** Main Code ****************************//
//********************************************************************//

//tft_clk,tft_de,tft_bl:TFT像素时钟、数据使能、背光信号
assign  tft_clk = clk_in    ;
assign  tft_de  = data_valid;
assign  tft_bl  = sys_rst_n ;

//cnt_h:行扫描计数器
always@(posedge clk_in or negedge sys_rst_n)
    if(sys_rst_n == 1&#39;b0)
        cnt_h   &lt;=  11&#39;d0;
    else    if(cnt_h == H_TOTAL - 1&#39;b1)
        cnt_h   &lt;=  11&#39;d0;
    else
        cnt_h   &lt;=  cnt_h + 10&#39;d1;

//cnt_v:场扫描计数器
always@(posedge clk_in or negedge sys_rst_n)
    if(sys_rst_n == 1&#39;b0)
        cnt_v   &lt;=  11&#39;d0;
    else    if(cnt_h == H_TOTAL - 1&#39;b1) 
    begin
        if(cnt_v == V_TOTAL - 1&#39;b1)
            cnt_v   &lt;=  11&#39;d0;
        else
            cnt_v   &lt;=  cnt_v + 10&#39;d1;
    end
    else 
        cnt_v   &lt;=  cnt_v;

//data_valid:有效显示区域标志
assign  data_valid = ((cnt_h &gt;= (H_SYNC + H_BACK + H_LEFT))
                    &amp;&amp; (cnt_h &lt; (H_SYNC + H_BACK + H_LEFT + H_VALID )))
                    &amp;&amp;((cnt_v &gt;= (V_SYNC + V_BACK + V_TOP))
                    &amp;&amp; (cnt_v &lt; (V_SYNC + V_BACK + V_TOP + V_VALID)));

//data_req:图像数据请求
assign  data_req = ((cnt_h &gt;= (H_SYNC + H_BACK + H_LEFT + H_BLACK - 1&#39;b1)) 
                    &amp;&amp; (cnt_h &lt; ((H_SYNC + H_BACK + H_LEFT + H_BLACK + H_PIXEL - 1&#39;b1))))
                    &amp;&amp;((cnt_v &gt;= ((V_SYNC + V_BACK + V_TOP + V_BLACK)))
                    &amp;&amp; (cnt_v &lt; ((V_SYNC + V_BACK + V_TOP + V_BLACK + V_PIXEL))));

assign  pix_x = (data_req == 1&#39;b1)
                ? (cnt_h - (H_SYNC + H_BACK + H_LEFT - 1&#39;b1)) : 11&#39;h3ff;
assign  pix_y = (data_req == 1&#39;b1)
                ? (cnt_v - (V_SYNC + V_BACK + V_TOP)) : 11&#39;h3ff;

//data_out:输出有效图像数据
assign  data_out = (data_req == 1&#39;b1) ? data_in : 16&#39;h0000;

//hsync,vsync,rgb_tft_16b:行、场同步信号、图像数据
assign  rgb_tft_16b = (data_valid == 1&#39;b0) ? 16&#39;hFFFF : data_out;
assign  hsync = (cnt_h  &lt;=  H_SYNC - 1&#39;d1) ? 1&#39;b1 : 1&#39;b0  ;
assign  vsync = (cnt_v  &lt;=  V_SYNC - 1&#39;d1) ? 1&#39;b1 : 1&#39;b0  ;

//rgb16 565转rgb24 888
assign rgb_r=&#123;rgb_tft_16b[15:11],3&#39;d0&#125;;
assign rgb_g=&#123;rgb_tft_16b[10:5],2&#39;d0&#125;;
assign rgb_b=&#123;rgb_tft_16b[4:0],3&#39;d0&#125;; 
assign rgb_tft_24b=&#123;rgb_r,rgb_g,rgb_b&#125;;

endmodule


    可以看出 **data_req 信号超前 data_valid 信号一个时钟周期** （这里H_BLACK=V_BLACK=0且 **data_req   多减了一个 1 **）；data_req 考虑了黑边框，**因为分辨率 480*272 对应行列有效周期 480 和 272 ，故黑边多少像素减去多少周期即可** ；另外 pix_x 和 pix_y 都已在此赋值。
</code></pre>
<h4 id="（2）tft-pic-图像数据生成模块"><a href="#（2）tft-pic-图像数据生成模块" class="headerlink" title="（2）tft_pic 图像数据生成模块"></a>（2）tft_pic 图像数据生成模块</h4><pre><code>    以 TFT 显示时序控制模块传入的图像有效显示区域像素点坐标(pix_x,pix_y)为约束条件，产生 TFT 彩条图像像素点色彩信息并回传给 TFT 显示时序控制模块。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6e497f9c789be6e30f8f2d095897aeef.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d168edbc88ab3e3d9e0d0242a1119154.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0997f4cd9124ba9a8c00f4b586e9d227.png"></p>
<pre><code>module  tft_pic
(
    input   wire            tft_clk_9m  ,   //输入工作时钟,频率9MHz
    input   wire            sys_rst_n   ,   //输入复位信号,低电平有效
    input   wire    [9:0]   pix_x       ,   //输入TFT有效显示区域像素点X轴坐标
    input   wire    [9:0]   pix_y       ,   //输入TFT有效显示区域像素点Y轴坐标

    output  reg     [15:0]  pix_data        //输出像素点色彩信息

);

//********************************************************************//
//****************** Parameter and Internal Signal *******************//
//********************************************************************//

parameter   H_VALID =   10&#39;d480 ,   //行有效数据
            V_VALID =   10&#39;d272 ;   //场有效数据

parameter   RED     =   16&#39;hF800,   //红色
            ORANGE  =   16&#39;hFC00,   //橙色
            YELLOW  =   16&#39;hFFE0,   //黄色
            GREEN   =   16&#39;h07E0,   //绿色
            CYAN    =   16&#39;h07FF,   //青色
            BLUE    =   16&#39;h001F,   //蓝色
            PURPPLE =   16&#39;hF81F,   //紫色
            BLACK   =   16&#39;h0000,   //黑色
            WHITE   =   16&#39;hFFFF,   //白色
            GRAY    =   16&#39;hD69A;   //灰色

//********************************************************************//
//***************************** Main Code ****************************//
//********************************************************************//

//pix_data:输出像素点色彩信息,根据当前像素点坐标指定当前像素点颜色数据
always@(posedge tft_clk_9m or negedge sys_rst_n)
    if(sys_rst_n == 1&#39;b0)
        pix_data    &lt;= 16&#39;d0;
    else    if((pix_x &gt;= 0) &amp;&amp; (pix_x &lt; (H_VALID/10)*1))
        pix_data    &lt;=  RED;
    else    if((pix_x &gt;= (H_VALID/10)*1) &amp;&amp; (pix_x &lt; (H_VALID/10)*2))
        pix_data    &lt;=  ORANGE;
    else    if((pix_x &gt;= (H_VALID/10)*2) &amp;&amp; (pix_x &lt; (H_VALID/10)*3))
        pix_data    &lt;=  YELLOW;
    else    if((pix_x &gt;= (H_VALID/10)*3) &amp;&amp; (pix_x &lt; (H_VALID/10)*4))
        pix_data    &lt;=  GREEN;
    else    if((pix_x &gt;= (H_VALID/10)*4) &amp;&amp; (pix_x &lt; (H_VALID/10)*5))
        pix_data    &lt;=  CYAN;
    else    if((pix_x &gt;= (H_VALID/10)*5) &amp;&amp; (pix_x &lt; (H_VALID/10)*6))
        pix_data    &lt;=  BLUE;
    else    if((pix_x &gt;= (H_VALID/10)*6) &amp;&amp; (pix_x &lt; (H_VALID/10)*7))
        pix_data    &lt;=  PURPPLE;
    else    if((pix_x &gt;= (H_VALID/10)*7) &amp;&amp; (pix_x &lt; (H_VALID/10)*8))
        pix_data    &lt;=  BLACK;
    else    if((pix_x &gt;= (H_VALID/10)*8) &amp;&amp; (pix_x &lt; (H_VALID/10)*9))
        pix_data    &lt;=  WHITE;
    else    if((pix_x &gt;= (H_VALID/10)*9) &amp;&amp; (pix_x &lt; H_VALID))
        pix_data    &lt;=  GRAY;
    else
        pix_data    &lt;=  BLACK;

endmodule


    每个时钟周期 tft_clk_9m 对 pix_data 赋值即可；由于 pix_data 由 pix_x、pix_y 的值确定，易知 **pix_data 滞后 pix_x、pix_y 信号一个时钟周期** 。
</code></pre>
<h4 id="（3）顶层模块"><a href="#（3）顶层模块" class="headerlink" title="（3）顶层模块"></a>（3）顶层模块</h4><pre><code>module  tft_colorbar
(
    input   wire            sys_clk     ,   //输入工作时钟,频率50MHz
    input   wire            sys_rst_n   ,   //输入复位信号,低电平有效

    output  wire    [15:0]  rgb_tft     ,   //输出像素信息
    output  wire            hsync       ,   //输出行同步信号
    output  wire            vsync       ,   //输出场同步信号
    output  wire            tft_clk     ,   //输出TFT时钟信号
    output  wire            tft_de      ,   //输出TFT使能信号
    output  wire            tft_bl          //输出背光信号
);

//********************************************************************//
//****************** Parameter and Internal Signal *******************//
//********************************************************************//

//wire  define
wire            tft_clk_9m  ;   //TFT工作时钟,频率9MHz
wire            locked      ;   //PLL locked信号
wire            rst_n       ;   //TFT模块复位信号
wire    [9:0]   pix_x       ;   //TFT有效显示区域X轴坐标
wire    [9:0]   pix_y       ;   //TFT有效显示区域Y轴坐标
wire    [15:0]  pix_data    ;   //TFT像素点色彩信息

//rst_n:TFT模块复位信号
assign  rst_n = (sys_rst_n &amp; locked);

//********************************************************************//
//*************************** Instantiation **************************//
//********************************************************************//

clk_wiz_0 clk_gen_inst
(
    .reset     (~sys_rst_n ),  //输入复位信号,高电平有效,1bit
    .clk_in1   (  sys_clk  ),  //输入50MHz晶振时钟,1bit
    .clk_out1  (tft_clk_9m ),  //输出TFT工作时钟,频率9Mhz,1bit

    .locked    (locked     )   //输出pll locked信号,1bit
);

//------------- tft_ctrl_inst -------------
tft_ctrl tft_ctrl_inst
(
    .clk_in     (tft_clk_9m ) ,   //输入时钟
    .sys_rst_n  (rst_n      ) ,   //系统复位,低电平有效
    .data_in    (pix_data   ) ,   //待显示数据
    .data_req   (           ) ,   //数据请求信号
    .pix_x      (pix_x      ) ,   //输出TFT有效显示区域像素点X轴坐标
    .pix_y      (pix_y      ) ,   //输出TFT有效显示区域像素点Y轴坐标
    .rgb_tft_16b(rgb_tft    ) ,   //TFT显示数据16bit
    .rgb_tft_24b(           ) ,   //TFT显示数据24bit
    .hsync      (hsync      ) ,   //TFT行同步信号
    .vsync      (vsync      ) ,   //TFT场同步信号
    .tft_clk    (tft_clk    ) ,   //TFT像素时钟
    .tft_de     (tft_de     ) ,   //TFT数据使能
    .tft_bl     (tft_bl     )     //TFT背光信号
);
//------------- tft_pic_inst -------------
tft_pic tft_pic_inst
(
    .tft_clk_9m  (tft_clk_9m),   //输入工作时钟,频率9MHz
    .sys_rst_n   (rst_n     ),   //输入复位信号,低电平有效
    .pix_x       (pix_x     ),   //输入TFT有效显示区域像素点X轴坐标
    .pix_y       (pix_y     ),   //输入TFT有效显示区域像素点Y轴坐标

    .pix_data    (pix_data  )    //输出像素点色彩信息

);

endmodule
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/657603b593b0d744497cd255c77a7f32.png"></p>
<h2 id="二-TFT-LCD-液晶屏字符显示"><a href="#二-TFT-LCD-液晶屏字符显示" class="headerlink" title="二.TFT_LCD 液晶屏字符显示"></a>二.TFT_LCD 液晶屏字符显示</h2><pre><code>    在 TFT 显示屏中心位置显示金色“野火科技”四个汉字，字符外的背景颜色为黑色。**每个汉字大小为 56*56，字模点阵为 64*64** ，TFT 显示屏显示模式为 480*270@60。
</code></pre>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d58f5808c61fc77af64e60a14708137c.png"></p>
<p>**         第一部分**：字符点阵显示区域坐标信号的设计与实现在上面小节中，我们利用<strong>取模软件</strong> 生成了要显示字符的字模，字模点阵的大小为<br><strong>256<em>64（64</em>4*64）</strong> ，那么如何利用字模点阵进行字符显示呢？ 首先确定字符<strong>有效显示区域</strong><br>，区域大小与字符点阵大小相同，显示区域的像素点与字模点阵中数据项一一对应，<strong>当字模点阵中的数据项数值为“1”时，赋值字符颜色给对应像素点；当字模点阵中的数据项数值为“0”时，赋值点阵背景颜色给对应像素点</strong><br>。 所以为了确定字符点阵显示区域，我们声明两个变量 char_x、char_y，两变量组成字 符点阵显示区域坐标，在字符点阵有效显示区域内，<strong>char_x<br>信号 0-255 循环计数，char_y 信号 0-63 循环计数</strong><br>，根据坐标(char_x,char_y)寻找字符点阵对应的数据项，根据数据项的数值，赋予对应坐标像素点颜色信息。char_x、char_y<br>信号波形具体见图。</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/1ff106cc7206516eb925a0af0c62929b.png"></p>
<pre><code>module  tft_pic
(
    input   wire            tft_clk_9m  ,   //输入工作时钟,频率9MHz
    input   wire            sys_rst_n   ,   //输入复位信号,低电平有效
    input   wire    [9:0]   pix_x       ,   //输入TFT有效显示区域像素点X轴坐标
    input   wire    [9:0]   pix_y       ,   //输入TFT有效显示区域像素点Y轴坐标

    output  reg     [15:0]  pix_data        //输出像素点色彩信息

);

//********************************************************************//
//****************** Parameter and Internal Signal *******************//
//********************************************************************//

parameter   H_VALID =   10&#39;d480 ,   //行有效数据
            V_VALID =   10&#39;d272 ;   //场有效数据

parameter   CHAR_B_H=   10&#39;d112 ,   //字符开始X轴坐标
            CHAR_B_V=   10&#39;d104 ;   //字符开始Y轴坐标

parameter   CHAR_W  =   10&#39;d256 ,   //字符宽度
            CHAR_H  =   10&#39;d64  ;   //字符高度

parameter   BLACK   =   16&#39;h0000,   //黑色
            GOLDEN  =   16&#39;hFEC0;   //金色

//wire  define
wire    [9:0]   char_x  ;   //字符显示X轴坐标
wire    [9:0]   char_y  ;   //字符显示Y轴坐标

//reg   define
reg     [255:0] char    [63:0]  ;   //字符数据

//********************************************************************//
//***************************** Main Code ****************************//
//********************************************************************//

//字符显示坐标
assign  char_x  =   (((pix_x &gt;= CHAR_B_H) &amp;&amp; (pix_x &lt; (CHAR_B_H + CHAR_W)))
                    &amp;&amp; ((pix_y &gt;= CHAR_B_V) &amp;&amp; (pix_y &lt; (CHAR_B_V + CHAR_H))))
                    ? (pix_x - CHAR_B_H) : 10&#39;h3FF;
assign  char_y  =   (((pix_x &gt;= CHAR_B_H) &amp;&amp; (pix_x &lt; (CHAR_B_H + CHAR_W)))
                    &amp;&amp; ((pix_y &gt;= CHAR_B_V) &amp;&amp; (pix_y &lt; (CHAR_B_V + CHAR_H))))
                    ? (pix_y - CHAR_B_V) : 10&#39;h3FF;

//char:字符数据
always@(posedge tft_clk_9m)
    begin
        char[0]     &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[1]     &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[2]     &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[3]     &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[4]     &lt;=  256&#39;h00000000003C0000000000000000000000000000000070000000000000000000;
        char[5]     &lt;=  256&#39;h0000000E003E00000000000000000000000000000000F0000000000000000000;
        char[6]     &lt;=  256&#39;h000000FF001F00000000000000000000000000000001F0000000000000400000;
        char[7]     &lt;=  256&#39;h000007FF000F00000000000000000000000010000001F8000000000000E00000;
        char[8]     &lt;=  256&#39;h00007FFE000F000000000000000000000003FE000001F8000000000000F00000;
        char[9]     &lt;=  256&#39;h0000FE7E003F00000000000000000000000FFF800001F80000003E0000F00000;
        char[10]    &lt;=  256&#39;h0000E07C01F8000000000000000000000007FF81F801FC0000003F0000F00000;
        char[11]    &lt;=  256&#39;h0000E0F80380000000000000000000000003FF80FE00780000003F0001E00000;
        char[12]    &lt;=  256&#39;h0000E0F80380000000000000000000000001FF80FF00780000003F0001E00000;
        char[13]    &lt;=  256&#39;h0780E1F003FC000000000000000000000000FF80FF80780000003E0001E00000;
        char[14]    &lt;=  256&#39;h07C0FFF003FE0000000000020000000000003F007F80780000003E0001E00000;
        char[15]    &lt;=  256&#39;h07E0FFE001FE0000000000070000000000000E007F00780000003C0001FF0000;
        char[16]    &lt;=  256&#39;h07F3FFE0000E00000000000700000000000000007E00F80000003C0001FF0000;
        char[17]    &lt;=  256&#39;h07F9FFC0000E00000000000F0000000000003E00CC01F80000007C0003FE0000;
        char[18]    &lt;=  256&#39;h03F9FFC0001C03E00000000F8000000000003F010001F80000007E0003F80000;
        char[19]    &lt;=  256&#39;h03F9FF8000781FF80000001F8000000000007F038001F8000000FF0007F00000;
        char[20]    &lt;=  256&#39;h03F9FF8001F07FF80000001F878000000000FE078001F8000000FF000FE00000;
        char[21]    &lt;=  256&#39;h03FDFF0007C3FFF00000003FFFC000000001FC07C001F8000001FF003FE00000;
        char[22]    &lt;=  256&#39;h03FDFF000F9F8FF00001C03FFFC000000007F807F001F8000007FE003FC00000;
        char[23]    &lt;=  256&#39;h03FFFE001FFF8FE00001E07FFFC00000001FF807FC01F800000FFC0003C00000;
        char[24]    &lt;=  256&#39;h01FFF0007FFF8FC00003E07FFC000000067FF007FE01FC00001FF80003800000;
        char[25]    &lt;=  256&#39;h01FFC000FFEF9F800003E0FE000000000FFFF003FC01FE00007FF00007800000;
        char[26]    &lt;=  256&#39;h01FF8001FF8F9F000007E0FE000000000FFFF041F803FC0000FFE00007800000;
        char[27]    &lt;=  256&#39;h01FF8007FC1F9E00001FE0FE000000000FFFF180F00FFC000001E00007000000;
        char[28]    &lt;=  256&#39;h00FF8007F01F3C00003FE1FC00000000007FF601E01FF8000001E000071C0000;
        char[29]    &lt;=  256&#39;h00FF8007C01FFC00003FE1FC00000000001FFC03C0FFF8000001E0000F3E0000;
        char[30]    &lt;=  256&#39;h00030002001FF800003FC3FC00000000003FF807C3FFF8000001E7800FFE0000;
        char[31]    &lt;=  256&#39;h00070000001FF000007FC3F800000000003FF80F9FFFF0000001FF000FFE0000;
        char[32]    &lt;=  256&#39;h0007F000001FE000007F83F800000000007FF01FFFC3F0000001FE000FFE0000;
        char[33]    &lt;=  256&#39;h001FF000001FC000003F83F00000000000FFF01FFE03F0000001FC001FFE0000;
        char[34]    &lt;=  256&#39;h007FE000001F8000003F07F00000000000FFE03FF003F0000003F8001F3E0000;
        char[35]    &lt;=  256&#39;h007FC000001F8000001807F00000000001FFE03F8003F0000003F0001F3C0000;
        char[36]    &lt;=  256&#39;h00078600001F000000000FF80000000003FFC07E0003F0000003F0001E3C0000;
        char[37]    &lt;=  256&#39;h000F1E00001F000000000FFC0000000007FFC0180003F0000007E003843C0000;
        char[38]    &lt;=  256&#39;h003FFC00001F800000001FDE0000000007FFC0000003F000000FF001E03C0000;
        char[39]    &lt;=  256&#39;h007FF800001F800000003FDF8000000007C7C0000003F00000FFF000F83C0000;
        char[40]    &lt;=  256&#39;h00FFF000001F800000007F9FF00000000787C0000003F00007FFF0007F3C0000;
        char[41]    &lt;=  256&#39;h01FFE000001F80000000FF0FFE0000000707C0000003F0001FF1F8003FFC0000;
        char[42]    &lt;=  256&#39;h03FF8000001F80000001FE0FFFE000000003C0000003F0003F81F8001FFC0000;
        char[43]    &lt;=  256&#39;h07FF0000003F80000003FC07FFFE0000000300000003F0003E01FC000FFE0000;
        char[44]    &lt;=  256&#39;h07FC0000003F80000007F803FFFFE000000000000003F0001F83FC0007FFF000;
        char[45]    &lt;=  256&#39;h07F80000003F8000000FF001FFFFFF80000000000003F0000FFFFC0003FFFF80;
        char[46]    &lt;=  256&#39;h03E00000007F8000001FC0007FFFFFC0000000000003F00003FFFE0007FFFFF0;
        char[47]    &lt;=  256&#39;h0000000000FF8000007F80001FFFFFE0000000000003F000007FFE003FBFFFF8;
        char[48]    &lt;=  256&#39;h0000000001FF800000FE000007FFFFE0000000000003E000000FFC03FE0FFFF8;
        char[49]    &lt;=  256&#39;h0000000007FF800001F8000001FFFFF0000000000003E0000000F8FFC003FFF8;
        char[50]    &lt;=  256&#39;h000000007FFF000003E00000001FFFC0000000000003C0000000000000007FF8;
        char[51]    &lt;=  256&#39;h00000007FFFE0000070000000001FFC0000000000003C0000000000000000FF0;
        char[52]    &lt;=  256&#39;h0000000200F800000000000000000F8000000000000300000000000000000060;
        char[53]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[54]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[55]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[56]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[57]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[58]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[59]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[60]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[61]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[62]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
        char[63]    &lt;=  256&#39;h0000000000000000000000000000000000000000000000000000000000000000;
    end

//pix_data:输出像素点色彩信息,根据当前像素点坐标指定当前像素点颜色数据
always@(posedge tft_clk_9m or negedge sys_rst_n)
    if(sys_rst_n == 1&#39;b0)
        pix_data    &lt;= BLACK;
    else    if(((pix_x &gt;= CHAR_B_H) &amp;&amp; (pix_x &lt; (CHAR_B_H + CHAR_W)))
                &amp;&amp; ((pix_y &gt;= CHAR_B_V) &amp;&amp; (pix_y &lt; (CHAR_B_V + CHAR_H))))
        begin
            if(char[char_y][10&#39;d255 - char_x] == 1&#39;b1)
                pix_data    &lt;=  GOLDEN;
            else
                pix_data    &lt;=  BLACK;
        end
    else
        pix_data    &lt;= BLACK;

endmodule
</code></pre>
<p>可知根据对应坐标的char二维数组值判定颜色。</p>
<p>本文转自 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32971095/article/details/133174030">https://blog.csdn.net/qq_32971095/article/details/133174030</a>，如有侵权，请联系删除。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/None/" rel="tag"># None</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/09/22/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" rel="prev" title="嵌入式学习路线">
      <i class="fa fa-chevron-left"></i> 嵌入式学习路线
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/09/24/Zynq%E7%AE%80%E4%BB%8B%E2%80%94%E2%80%94FPGA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9C7%EF%BC%9E/" rel="next" title="Zynq简介——FPGA学习笔记＜7＞">
      Zynq简介——FPGA学习笔记＜7＞ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-TFT-LCD-%E6%B6%B2%E6%99%B6%E5%B1%8F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.</span> <span class="nav-text">一.TFT_LCD 液晶屏驱动设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">&lt;1&gt;简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89HV-%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.1.1.</span> <span class="nav-text">（1）HV 同步模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89DE-%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.1.2.</span> <span class="nav-text">（2）DE 同步模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.1.3.</span> <span class="nav-text">（3）整体设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%884%EF%BC%89TFT-LCD-%E6%98%BE%E7%A4%BA%E6%97%B6%E5%BA%8F%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9D%97"><span class="nav-number">1.1.4.</span> <span class="nav-text">（4）TFT_LCD 显示时序控制模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.2.</span> <span class="nav-text">&lt;2&gt;程序设计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89tft-ctrl-%E6%97%B6%E5%BA%8F%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9D%97"><span class="nav-number">1.2.1.</span> <span class="nav-text">（1）tft_ctrl 时序控制模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89tft-pic-%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90%E6%A8%A1%E5%9D%97"><span class="nav-number">1.2.2.</span> <span class="nav-text">（2）tft_pic 图像数据生成模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E9%A1%B6%E5%B1%82%E6%A8%A1%E5%9D%97"><span class="nav-number">1.2.3.</span> <span class="nav-text">（3）顶层模块</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-TFT-LCD-%E6%B6%B2%E6%99%B6%E5%B1%8F%E5%AD%97%E7%AC%A6%E6%98%BE%E7%A4%BA"><span class="nav-number">2.</span> <span class="nav-text">二.TFT_LCD 液晶屏字符显示</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SWQ"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">SWQ</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xidianswq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xidianswq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/3209507800@qq.com" title="E-Mail → 3209507800@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/qq_32971095" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_32971095" rel="noopener" target="_blank"><i class="fa fa-link fa-fw"></i>CSDN</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Sat Feb 08 2025 08:00:00 GMT+0800 (中国标准时间) – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SWQ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">790k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">11:58</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  















  

  

</body>
</html>
