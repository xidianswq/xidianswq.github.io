<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Zhi Mang Xing:300,300italic,400,400italic,700,700italic|Ma Shan Zheng:300,300italic,400,400italic,700,700italic|Source Code Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@200..900&family=Permanent+Marker&family=Satisfy&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Zhi+Mang+Xing&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xidianswq.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#e6c35c","save":"manual"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Multi Level Parallelism">
<meta property="og:type" content="article">
<meta property="og:title" content="《计算机体系结构：量化研究方法》——大卫·帕特森">
<meta property="og:url" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/index.html">
<meta property="og:site_name" content="Switch">
<meta property="og:description" content="Multi Level Parallelism">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps1.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps2.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps3.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps4.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps5.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps6.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps7.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps8.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps9.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps10.jpg">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753003770249.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753004177316.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753017668788.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%8A%80%E6%9C%AF.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1761402684869.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/gshare%E9%A2%84%E6%B5%8B%E5%99%A8.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E7%AB%9E%E4%BA%89%E9%A2%84%E6%B5%8B%E5%99%A8.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E5%B8%A6%E6%A0%87%E7%AD%BE%E7%9A%84%E6%B7%B7%E5%90%88%E9%A2%84%E6%B5%8B%E5%99%A8.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E4%BD%BF%E7%94%A8Tomasulo%E7%AE%97%E6%B3%95%E7%9A%84RISC-V%E6%B5%AE%E7%82%B9%E5%8D%95%E5%85%83%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E5%9B%9B%E7%B1%BB%E6%8C%87%E4%BB%A4%E9%9B%86.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/ISA%E6%8C%89%E6%93%8D%E4%BD%9C%E6%95%B0%E4%B8%AA%E6%95%B0%E5%88%86%E7%B1%BB.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E5%88%86%E6%94%AF%E6%9D%A1%E4%BB%B6%E6%B1%82%E5%80%BC%E6%96%B9%E6%B3%95.png">
<meta property="og:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E7%9B%AE%E5%89%8D%E7%BC%96%E8%AF%91%E5%99%A8%E7%BB%93%E6%9E%84.png">
<meta property="article:published_time" content="2025-10-26T02:25:00.000Z">
<meta property="article:modified_time" content="2025-12-03T13:58:49.176Z">
<meta property="article:author" content="SWQ">
<meta property="article:tag" content="学习笔记">
<meta property="article:tag" content="计算机体系结构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps1.jpg">

<link rel="canonical" href="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>《计算机体系结构：量化研究方法》——大卫·帕特森 | Switch</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/rss2.xml" title="Switch" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <script>
    (function() {
      var storageKey = 'switch_homepage__access_granted';
      var docEl = document.documentElement;
      var guardEnabled = true;
      var configuredPassword = '';
      
        
        
          configuredPassword = 'siwuqiang';
        
      

      if (!guardEnabled || !configuredPassword) {
        docEl.classList.add('content-unlocked');
        window.__SITE_PASSWORD_GUARD__ = {
          storageKey: storageKey,
          enabled: false,
          password: ''
        };
        return;
      }

      try {
        if (window.localStorage && localStorage.getItem(storageKey) === '1') {
          docEl.classList.add('content-unlocked');
        } else {
          docEl.classList.add('content-locked');
        }
      } catch (err) {
        docEl.classList.add('content-locked');
      }
      window.__SITE_PASSWORD_GUARD__ = {
        storageKey: storageKey,
        enabled: true,
        password: configuredPassword
      };
    })();
  </script>
  <div id="password-protect" class="password-protect" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="password-modal">
      <h2 class="password-title"></h2>
      <p class="password-subtitle">Please Enter MY NAME</p>
      <label class="password-label" for="site-password-input">访问密码</label>
      <input id="site-password-input" class="password-input" type="password" autocomplete="current-password" placeholder="请输入密码" />
      <button id="site-password-submit" class="password-submit" type="button">确认</button>
      <p id="site-password-error" class="password-error" aria-live="assertive"></p>
    </div>
  </div>
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Switch</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Welcome to My Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">6</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">47</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">234</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xidianswq.github.io/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="SWQ">
      <meta itemprop="description" content="舟遥遥以轻扬，风飘飘而吹衣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Switch">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          《计算机体系结构：量化研究方法》——大卫·帕特森
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar" color=f6416c></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-10-26 10:25:00" itemprop="dateCreated datePublished" datetime="2025-10-26T10:25:00+08:00">2025-10-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
                </span>
            </span>

          
            <span id="/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/" class="post-meta-item leancloud_visitors" data-flag-title="《计算机体系结构：量化研究方法》——大卫·帕特森" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>Multi Level Parallelism</p>
</blockquote>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps1.jpg" alt="img"><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps2.jpg" alt="img"><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps3.jpg" alt="img"> </p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps4.jpg" alt="img"> </p>
<p>能量&#x3D;1&#x2F;2<em>负载电容</em>V^2</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps5.jpg" alt="img"> </p>
<p>Rules of Thumb：经验之谈</p>
<p>单点故障（英语：single point of failure，缩写SPOF）是指<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%B3%BB%E7%BB%9F/0?fromModule=lemma_inlink">系统</a>中一点失效，就会让整个系统无法运作的部件，换句话说，单点故障即会整体故障。</p>
<p>Formula：公式</p>
<p>Utilization:利用</p>
<p>Domain:领域</p>
<p>Warehouse Scale Computer：仓库级电脑</p>
<p>coherent multiprocessor：相干多处理器</p>
<p>the Board of Directors：董事会</p>
<p>a member of the faculty：全体教员中的一员</p>
<p>Equivalent:等同等效的</p>
<p>Demystify：阐明、启发</p>
<p>Conservative：保守的</p>
<p>Soar:急升，高达</p>
<p>Negligible：微不足道的</p>
<p>low-end：低档的；廉价的</p>
<p>Combination：组合，联合体</p>
<p>Dramatic：戏剧性的，夸张地，急剧的</p>
<p>Fourfold：四倍的&#x2F;地</p>
<p>Outperform：胜过，优于</p>
<p>“Like the scholars of the European Renaissance, computer architects must understand our own history, and then combine the lessons of that history with new techniques to remake the world.”</p>
<p>With the end of Dennard scaling a decade ago, and the recent slowdown of Moore’s Law due to a combination of physical limitations and economic factors, the sixth edition of the preeminent textbook for our field couldn’t be more timely.Here are some reasons.</p>
<p>First, because domain-specific architectures can provide equivalent performance and power benefits of three or more historical generations of Moore’s Law and Dennard scaling, they now can provide better implementations than may ever be possible with future scaling of general-purpose architectures. And with the diverse application space of computers today, there are many potential areas for architectural innovation with domain-specific architectures. Second, high-quality implementations of open-source architectures now have a much longer lifetime due to the slowdown in Moore’s Law. This gives them more opportunities for continued optimization and refinement, and hence makes them more attractive. Third, with the slowing of Moore’s Law, different technology components have been scaling heterogeneously. Furthermore, new technologies such as 2.5D stacking, new nonvolatile memories, and optical interconnects have been developed to provide more than Moore’s Law can supply alone. To use these new technologies and nonhomogeneous scaling effectively, fundamental design decisions need to be reexamined from first principles. Hence it is important for students, professors, and practitioners in the industry to be skilled in a wide range of both old and new architectural techniques. All told, I believe this is the most exciting time in computer architecture since the industrial exploitation of instruction-level parallelism in microprocessors 25 years ago.</p>
<p><em><strong>专用和通用结构DSAs的对比</strong></em></p>
<p>The RISC-based machines focused the attention of designers on two critical performance techniques, the exploitation of instruction-level parallelism (initially through pipelining and later through multiple instruction issue) and the use of caches (initially in simple forms and later using more sophisticated organizations and optimizations).</p>
<p>Inter将x86指令转换为类risc指令以提高性能，在pc机上转换带来的硬件开销可忽略，而低端应用如手机等则不行，促使产生另一种risc架构——arm。</p>
<h2 id="一、量化设计与研究基础"><a href="#一、量化设计与研究基础" class="headerlink" title="一、量化设计与研究基础"></a>一、量化设计与研究基础</h2><p>1、功率能耗趋势</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps6.jpg" alt="img"> </p>
<p>2、成本趋势</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps7.jpg" alt="img"> </p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps8.jpg" alt="img"> </p>
<p>3、可信任度</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps9.jpg" alt="img"> </p>
<p>4、性能度量</p>
<p>执行时间定义：挂钟时间（响应时间）、CPU时间</p>
<p>基准测试</p>
<p>5、<em><strong>计算机设计的量化原理</strong></em></p>
<p>充分利用并行性、局域性原理、优先优化主要部分、amdahl定律、</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/wps10.jpg" alt="img"> </p>
<h2 id="二、存储器结构层次设计"><a href="#二、存储器结构层次设计" class="headerlink" title="二、存储器结构层次设计"></a>二、存储器结构层次设计</h2><p>解决存储墙问题——多级缓存的拓展、更高级的填充和预取方案、编译器及程序员对局部性原理的理解、DRAM等新兴技术的应用；引入乱序流水线（并行机制）、</p>
<p>采用多级存储结构</p>
<p>处理器和DRAM存储器性能差距，带宽差距；多级缓存带来的功耗问题</p>
<p>缓存缺失问题：</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753003770249.png" alt="1753003770249"></p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753004177316.png" alt="1753004177316"></p>
<p>降低缺失率的方法（注意每种的缺点）：增大快、增大缓存、提高相关联程度、采用多级缓存、为读取缺失指定高于写入操作的优先级、在缓存索引期间避免地址转换</p>
<ul>
<li>存储技术和优化</li>
</ul>
<p>SRAM、DRAM、SDRAM（同步DRAM）、DDR、RAS、CAS、DIMM阵列、GDRAM、堆叠式DRAM（垂直堆叠3d、中介层堆叠2.5d）</p>
<p>闪存（读取速度比磁盘快300倍比DDR慢150倍，可替代其作外存但不能替代DRAM作主存）、相变存储器PCM</p>
<p>存储器可靠性——奇偶校验、ECC、Chipkill技术</p>
<ul>
<li>提高缓存性能：</li>
</ul>
<p>第一种优化:小而简单的第一级缓存,用以缩短命中时间、降低功率（使用较高相联度）</p>
<p>第二种优化：采用<strong>路预测</strong>以缩短命中时间</p>
<p>第三种优化：实现缓存访问的流水化，以提高缓存带宽（以及存储体的多体方式并行访问）</p>
<p>第四种优化：采用非阻塞缓存（nonblocking cahce，“缺失时仍命中”，降低缺失代价），支持多独立访问</p>
<p>编译器软件优化、合并写缓存区（减少对齐产生的浪费）、硬件预取、编译器预取</p>
<p>第五种优化：采用多种缓存以提高缓存带宽</p>
<p>…</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1753017668788.png" alt="1753017668788"></p>
<ul>
<li>虚拟存储器和虚拟机</li>
</ul>
<p>VMM及其指令集支持、自主取指单元、推测与存储器访问（前期预取缺失率换取后期实际缺失率，减少流水线停顿次数）</p>
<ul>
<li><p>ARM Cotex-A53及Intel Core i7 6700存储器层次结构实例</p>
<p>各级缓存缺失率及其影响的计算</p>
</li>
</ul>
<h2 id="三、指令级并行ILP及其应用"><a href="#三、指令级并行ILP及其应用" class="headerlink" title="三、指令级并行ILP及其应用"></a>三、指令级并行ILP及其应用</h2><h3 id="1、指令集并行概念及挑战"><a href="#1、指令集并行概念及挑战" class="headerlink" title="1、指令集并行概念及挑战"></a>1、指令集并行概念及挑战</h3><p>硬件动态实现和软件编译器静态实现；其局限性和向多核化发展</p>
<p>流水线CPI&#x3D;理想CPI+结构化&#x2F;数据冒险&#x2F;控制停顿</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%8A%80%E6%9C%AF.png" alt="1761097492462"></p>
<p>基本块（basic block，或称straight-line）、循环级并行（针对循环，硬件动态展开或编译器静态展开进行并行）</p>
<p>数据依赖（硬件解决的局限性，关键靠编译器检测依赖关系）【指令i生成的结果被指令j用到、依赖链】、名称依赖（写的顺序问题，寄存器重命名）和数据冒险</p>
<p>控制依赖（分支指令后的指令不能放前面来，之前的也不能拿进来）【控制依赖不不重要，重要的是保护<strong>异常行为</strong>（不得改变程序抛出异常的方式）和<strong>数据流</strong>（数据依赖）这两个特性】</p>
<p>可调换的程序执行顺序（破坏控制依赖而不影响两大特性）——判断控制指令到跳转位置之间指令的活性（结果是否被后续指令使用）</p>
<p>推测技术——解决两大特性中的依赖问题</p>
<h3 id="2、利用ILP的基本编译器技术"><a href="#2、利用ILP的基本编译器技术" class="headerlink" title="2、利用ILP的基本编译器技术"></a>2、利用ILP的基本编译器技术</h3><p>编译器调度和<strong>循环展开</strong>（利用流水线延迟，避免停顿，无结构冒险【假设功能单元被完全流水化和复制】）</p>
<p>具体策略：</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/1761402684869.png" alt="1761402684869"></p>
<p>限制循环展开的因素：寄存器紧缺；<strong>代码规模增大导致缓存缺失率上升</strong>；每次展开操作分摊的开销降低</p>
<h3 id="3、高级分支预测降低分支成本"><a href="#3、高级分支预测降低分支成本" class="headerlink" title="3、高级分支预测降低分支成本"></a>3、高级分支预测降低分支成本</h3><p>分支预测降低分支造成的性能损失</p>
<ul>
<li><p>局部预测器（毕设使用，两级表，分支地址索引）</p>
</li>
<li><p>相关分支预测器——2位预测器、相关预测器【(m,n)预测器】</p>
</li>
<li><p>(m,n)预测器，使用m个分支的全局历史（移位寄存器）在2^m个分支预测器中选择，每个是一个n位预测器。索引是分支地址的低位加全局分支部分位；一个(m,n)预测器的位数为——2^m * n * <strong>由分支地址选中的预测项的数目</strong></p>
</li>
<li><p>gshare预测器：对于简单预测效果较好，通常作为比较基准</p>
<img src="《计算机体系结构：量化研究方法》/gshare预测器.png" alt="gshare预测器" style="zoom:50%;" />
</li>
<li><p>竞争预测器——全局、局部预测器和选择器（也是一个2位预测器）组成</p>
<img src="《计算机体系结构：量化研究方法》/竞争预测器.png" alt="竞争预测器" style="zoom:50%;" />
</li>
<li><p>带标签的混合预测器</p>
<p>多个预测器，依次根据pc和不同长度的分支历史进行索引，每次索引与预测器中标签比对，不匹配则向下继续索引比对，直至选出一个独处于该分支的预测项。第一级由于无标签必被选中。</p>
<p>标签是为了防止多个分支索引至同一表项而发生相互覆盖，导致正确率下降</p>
<img src="《计算机体系结构：量化研究方法》/带标签的混合预测器.png" alt="带标签的混合预测器" style="zoom: 50%;" />

<ul>
<li>初始化方法——预测器包含有效位判断是否使用；根据预测方向（前向分支和后向分支）初始化</li>
</ul>
</li>
</ul>
<h3 id="4、动态调度"><a href="#4、动态调度" class="headerlink" title="4、动态调度"></a>4、动态调度</h3><ul>
<li><p>优点</p>
<p>可应对编译时依赖关系未知的情况（<strong>编译器的问题</strong>）；允许处理器容忍一些延迟（缓存缺失等，在解决缺失时执行其他代码）（<strong>存储延迟的问题</strong>）</p>
</li>
<li><p>思想</p>
<p>乱序执行（区别于顺序执行，其写回需按指令顺序）</p>
<p>分成两个阶段</p>
<ul>
<li>发射（issue）——<strong>指令译码，检查所有结构冒险</strong></li>
<li>读取操作数——<strong>等待数据冒险消失，读取操作数</strong></li>
</ul>
<p>需要<strong>有多个功能单元或流水化功能单元</strong>，或二者兼有</p>
</li>
<li><p>问题</p>
<ul>
<li><p>数据冒险的**RAW（真依赖）**问题</p>
</li>
<li><p>乱序执行可能会导致**WAR和WAW冒险（假依赖）——寄存器重命名（register renaming）**解决</p>
</li>
<li><p>导致<strong>异常处理</strong>变得复杂，造成非精确异常（处理器状态与严格按照顺序执行时的状态不一致，可能是异常指令前的指令未执行完或后的指令提前执行——采用推测解决）</p>
</li>
</ul>
</li>
<li><p>相关技术</p>
<ul>
<li><p>记分牌（scoreboarding）——操作数可用时再执行，避免RAW冒险</p>
<p>对寄存器进行有效的<strong>动态重命名</strong>来处理反依赖（WAR）和输出依赖（WAW）；可拓展，用来处理推测；足以支持简单处理器，但更复杂和更高性能需要推测技术；<u>可处理跨分支的重命名问题</u></p>
<ul>
<li><p>关键原则：1）动态确定指令何时可以执行；2）重命名寄存器以避免不必要的冒险（一个处理器中可能有数百个重命名寄存器）</p>
</li>
<li><p>保留站（reservation station）具体原理</p>
<p>为等待发射的指令缓冲操作数（操作数可用时马上提取并缓冲，使用时不从寄存器中获取）</p>
<p>发射指令时，将操作数中的寄存器名改为保留站名（指定保留站提供输入）</p>
<p>使用公共数据总线(Common Data Bus, <strong>CDB</strong>)，同时载入所有等待一个操作数的单元</p>
</li>
<li><p>保留站字段</p>
<p>Op操作类型、Qj和Qk为将生成源操作数的保留站编号、Vj和Vk源操作数的值、A地址信息、Busy状态、Qi存储到寄存器的保留站编号</p>
</li>
</ul>
</li>
<li><p><strong>Tomasulo算法</strong></p>
</li>
<li><p>推测技术</p>
</li>
</ul>
</li>
<li><p>具体示例（未画出控制逻辑，其中存储和载入缓冲区行为和保留站基本相同）</p>
<img src="《计算机体系结构：量化研究方法》/使用Tomasulo算法的RISC-V浮点单元基本结构.png" alt="使用Tomasulo算法的RISC-V浮点单元基本结构" style="zoom:67%;" />

<ul>
<li><p>标记字段</p>
<p>这个示例中为4位，用于选定5个保留站之一或5个载入缓冲区之一</p>
<p>指令被发射并开始等待操作数之后，将使用一个保留站编号来等待引用该操作数（规定一多余编号为操作数已就绪）</p>
</li>
<li><p>具体步骤：</p>
<ul>
<li><p>发射issue（分派dispatch）</p>
<p>从指令队列FIFO中取指，判断有无空闲保留站以及操作数是否在寄存器中。无空闲保留站则该指令停顿；1）操作数在reg中，则将指令和操作数一并发送到保留站，2）不在reg中，则跟踪产生该操作数的功能单元，并对该reg重命名，以消除WRW和WAR冒险</p>
</li>
<li><p>执行excute</p>
<p>功能单元中，若有操作数不可用，则等待以避免RAW冒险，同时监视CDB</p>
</li>
</ul>
<p>对于存储单元，载入缓冲区中指令在存储器可用时立即执行；存储缓冲区中指令需要等待存储的值</p>
<p>为保护异常行为，任一指令需等到其之前所有分支全部完成后执行</p>
<ul>
<li><p>写结果</p>
<p>计算结果——&gt;CBD——&gt;Reg、保留站、缓冲区</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="附录A-指令集基本原理"><a href="#附录A-指令集基本原理" class="headerlink" title="附录A 指令集基本原理"></a>附录A 指令集基本原理</h2><p>指令集分类、<strong>评估</strong>【整数程序CINT2000和浮点程序CFP2000、SPECint92程序…】、编译器的影响。RISC-V</p>
<p>1、ISA分类</p>
<ul>
<li><p>以内部存储类型为最基本区别，操作数可以显式示或隐式命名</p>
<p>按内部存储类型分为四类：栈体系结构、累加器~、通用寄存器~（寄存器—存储器【寄存器-存储器体系结构】；寄存器—寄存器【载入-存储体系结构】）</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E5%9B%9B%E7%B1%BB%E6%8C%87%E4%BB%A4%E9%9B%86.png" alt="四类指令集"></p>
<p>1980年后基本都是载入-存储体系结构，因访问寄存器速度快于存储器；对编译器来说效率更高</p>
</li>
<li><p>按照操作数个数以及其中多少个是内存地址分类</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/ISA%E6%8C%89%E6%93%8D%E4%BD%9C%E6%95%B0%E4%B8%AA%E6%95%B0%E5%88%86%E7%B1%BB.png" alt="ISA按操作数个数分类"></p>
</li>
<li><p>需要多少个寄存器？——编译器决定</p>
</li>
</ul>
<p>2、存储器寻址</p>
<ul>
<li><p>存储器存储相关问题——字节顺序（大端&#x2F;小端）；字节对齐</p>
</li>
<li><p>寻址方式</p>
<p>最常用三种：位移量寻址、立即数、寄存器间接
另外：自动递增&#x2F;递减寻址；比例寻址</p>
</li>
</ul>
<p>3、操作数类型和大小——字节、半字、字和双字</p>
<p>4、指令集中的操作——10种简单指令占所执行指令的96%</p>
<p>5、控制流指令</p>
<ul>
<li><p>四种控制力变化——条件分支、跳转、过程调用、过程返回</p>
</li>
<li><p>寻址方式</p>
<ul>
<li>目标地址已知——<strong>PC相对寻址</strong>——偏移量，与位置无关</li>
<li>目标地址未知——e.g.返回和间接寻址（case或Switch语句；虚拟函数；函数指针；动态共享库）</li>
</ul>
</li>
<li><p>条件分支——大多是&lt;，以及&lt;&#x3D;</p>
<p><img src="%E3%80%8A%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%9A%E9%87%8F%E5%8C%96%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E3%80%8B/%E5%88%86%E6%94%AF%E6%9D%A1%E4%BB%B6%E6%B1%82%E5%80%BC%E6%96%B9%E6%B3%95.png" alt="分支条件求值方法"></p>
</li>
<li><p>过程调用</p>
<p>过程调用和返回包括控制转移（至少保存返回地址）和状态保存过程</p>
<p>保存位置——特殊的链接寄存器或通用寄存器</p>
<p><strong>保存基本约定</strong>——要么由调用者保存，要么由被调用者保存；如今大多系统采用这<strong>两种机制的组合方式</strong>，由应用程序二进制接口<strong>ABI指定什么寄存器该由谁保存</strong>。</p>
</li>
</ul>
<p>6、指令集编码</p>
<p>定长、变长（intel 80x86、VAX）、混合（risc-v compressed）</p>
<p>7、编译器</p>
<ul>
<li><p>目前编译器结构</p>
<img src="《计算机体系结构：量化研究方法》/目前编译器结构.png" alt="目前编译器结构" style="zoom: 50%;" />
</li>
<li><p>寄存器分配</p>
<p>图着色技术（求解时间是图形大小的指数函数【NP完全问题】）</p>
</li>
</ul>

    </div>

    
    
    

    
      <div>
        
<div>
    
        <div style="text-align:center;color: #ccc;font-size:24px;">
            <center><i>> --------------- THE END -------------- <</i></center>
        </div>
    
</div>
      </div>
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"># 学习笔记</a>
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" rel="tag"># 计算机体系结构</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/10/26/%E6%9C%AA%E5%AE%8C%E6%88%90/%E5%9F%BA%E5%9B%A0%E5%88%86%E6%9E%90%E8%AF%BE%E9%A2%98/" rel="prev" title="基因分析课题">
      <i class="fa fa-chevron-left"></i> 基因分析课题
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/11/01/%E9%9A%8F%E7%AC%94/%E6%80%9D%E8%80%83/%E8%BF%87%E7%A8%8B%E3%80%81%E7%BB%93%E6%9E%9C%E4%B8%8E%E5%BF%83%E6%80%81/" rel="next" title="过程、结果与心态">
      过程、结果与心态 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E9%87%8F%E5%8C%96%E8%AE%BE%E8%AE%A1%E4%B8%8E%E7%A0%94%E7%A9%B6%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">一、量化设计与研究基础</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AD%98%E5%82%A8%E5%99%A8%E7%BB%93%E6%9E%84%E5%B1%82%E6%AC%A1%E8%AE%BE%E8%AE%A1"><span class="nav-number">2.</span> <span class="nav-text">二、存储器结构层次设计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%8C%87%E4%BB%A4%E7%BA%A7%E5%B9%B6%E8%A1%8CILP%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">三、指令级并行ILP及其应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E6%8C%87%E4%BB%A4%E9%9B%86%E5%B9%B6%E8%A1%8C%E6%A6%82%E5%BF%B5%E5%8F%8A%E6%8C%91%E6%88%98"><span class="nav-number">3.1.</span> <span class="nav-text">1、指令集并行概念及挑战</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E5%88%A9%E7%94%A8ILP%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BC%96%E8%AF%91%E5%99%A8%E6%8A%80%E6%9C%AF"><span class="nav-number">3.2.</span> <span class="nav-text">2、利用ILP的基本编译器技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81%E9%AB%98%E7%BA%A7%E5%88%86%E6%94%AF%E9%A2%84%E6%B5%8B%E9%99%8D%E4%BD%8E%E5%88%86%E6%94%AF%E6%88%90%E6%9C%AC"><span class="nav-number">3.3.</span> <span class="nav-text">3、高级分支预测降低分支成本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81%E5%8A%A8%E6%80%81%E8%B0%83%E5%BA%A6"><span class="nav-number">3.4.</span> <span class="nav-text">4、动态调度</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95A-%E6%8C%87%E4%BB%A4%E9%9B%86%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">附录A 指令集基本原理</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SWQ"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">SWQ</p>
  <div class="site-description" itemprop="description">舟遥遥以轻扬，风飘飘而吹衣</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">234</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xidianswq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xidianswq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/qq_32971095" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_32971095" rel="noopener" target="_blank"><i class="fa fa-link fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://qm.qq.com/q/fJkfzkochO" title="QQ → https:&#x2F;&#x2F;qm.qq.com&#x2F;q&#x2F;fJkfzkochO" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
      <span class="links-of-author-item">
        <a href="/3209507800@qq.com" title="E-Mail → 3209507800@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/348651384" title="bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;348651384" rel="noopener" target="_blank"><i class="fa fa-tv fa-fw"></i>bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/profiles/76561199188319035/" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;profiles&#x2F;76561199188319035&#x2F;" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://c6.y.qq.com/base/fcgi-bin/u?__=sZVdegbNTeC3" title="Music → https:&#x2F;&#x2F;c6.y.qq.com&#x2F;base&#x2F;fcgi-bin&#x2F;u?__&#x3D;sZVdegbNTeC3" rel="noopener" target="_blank"><i class="fa fa-music fa-fw"></i>Music</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1309889000&auto=1&height=66"></iframe>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021-8 ~ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SWQ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">25:15</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span>
    <span class="post-meta-divider">|</span>
<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
            clearInterval(int); // 停止检测
        }  
    }
       	
});
</script> 

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

<script src="/js/floating-history.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'H2FYHQwVGaUkawg5DkrA6d6M-gzGzoHsz',
      appKey     : 'zndS0u9Qj7qj8CqnJINs2MGT',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : 'https://h2fyhqwv.lc-cn-n1-shared.com'
    });
  }, window.Valine);
});
</script>


  <script async src="/js/cursor/fireworks.js"></script>


<script>
  (function() {
    var guard = window.__SITE_PASSWORD_GUARD__;
    var overlay = document.getElementById('password-protect');
    var input = document.getElementById('site-password-input');
    var submit = document.getElementById('site-password-submit');
    var errorEl = document.getElementById('site-password-error');

    if (!guard || guard.enabled === false || !guard.password) {
      if (overlay) {
        overlay.setAttribute('aria-hidden', 'true');
        if (typeof overlay.remove === 'function') {
          overlay.remove();
        } else {
          overlay.style.display = 'none';
        }
      }
      return;
    }

    var PASSWORD = String(guard.password || '');
    var storageKey = guard.storageKey;
    var docEl = document.documentElement;

    if (!overlay || !input || !submit || !errorEl) {
      return;
    }

    var unlocked = docEl.classList.contains('content-unlocked');
    overlay.setAttribute('aria-hidden', unlocked ? 'true' : 'false');

    if (unlocked) {
      return;
    }

    function showError(message) {
      errorEl.textContent = message || '';
    }

    function unlockSite() {
      docEl.classList.remove('content-locked');
      docEl.classList.add('content-unlocked');
      overlay.setAttribute('aria-hidden', 'true');
      showError('');
      try {
        window.localStorage && localStorage.setItem(storageKey, '1');
      } catch (err) {
        // Ignore storage failures.
      }
      if (typeof overlay.remove === 'function') {
        overlay.remove();
      } else {
        overlay.style.display = 'none';
      }
    }

    function validatePassword() {
      var value = (input.value || '').trim();
      if (!value) {
        showError('请输入密码');
        input.focus();
        return;
      }
      if (value.toLowerCase() === PASSWORD.toLowerCase()) {
        unlockSite();
      } else {
        showError('密码错误，请重试');
        input.value = '';
        input.focus();
      }
    }

    submit.addEventListener('click', validatePassword);
    input.addEventListener('keydown', function(event) {
      if (event.key === 'Enter') {
        event.preventDefault();
        validatePassword();
      }
    });
    input.addEventListener('input', function() {
      if (errorEl.textContent) {
        showError('');
      }
    });

    setTimeout(function() {
      input.focus();
    }, 100);
  })();
</script>
</body>
</html>
